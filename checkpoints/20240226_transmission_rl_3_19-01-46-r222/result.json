{"custom_metrics": {"reward_total_mean": -16.0, "reward_total_min": -16, "reward_total_max": -16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0, "reward_score_mean": 0.0, "reward_score_min": 0.0, "reward_score_max": 0.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9988771989941597, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 4.13111851811409, "policy_loss": -0.13068950877835353, "vf_loss": 5.077309644222259, "vf_explained_var": -0.0015142440795898437, "kl": 0.0, "entropy": 108.79244187672933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "sampler_results": {"episode_reward_max": -16.0, "episode_reward_min": -16.0, "episode_reward_mean": -16.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -16.0, "reward_total_min": -16, "reward_total_max": -16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0, "reward_score_mean": 0.0, "reward_score_min": 0.0, "reward_score_max": 0.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.824370601720977, "mean_inference_ms": 12.859202267830831, "mean_action_processing_ms": 0.5797884385255809, "mean_env_wait_ms": 0.4003838024176584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42560622096061707, "StateBufferConnector_ms": 0.005567073822021484, "ViewRequirementAgentConnector_ms": 0.2271905541419983}}, "episode_reward_max": -16.0, "episode_reward_min": -16.0, "episode_reward_mean": -16.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.824370601720977, "mean_inference_ms": 12.859202267830831, "mean_action_processing_ms": 0.5797884385255809, "mean_env_wait_ms": 0.4003838024176584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42560622096061707, "StateBufferConnector_ms": 0.005567073822021484, "ViewRequirementAgentConnector_ms": 0.2271905541419983}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.474435498887637, "num_agent_steps_trained_throughput_per_sec": 4.474435498887637, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 114427.786, "sample_time_ms": 8072.934, "load_time_ms": 0.647, "load_throughput": 791845.003, "learn_time_ms": 106353.219, "learn_throughput": 4.814, "synch_weights_time_ms": 0.016}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "done": false, "episodes_total": 32, "training_iteration": 1, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-21-15", "timestamp": 1709011275, "time_this_iter_s": 114.42997169494629, "time_total_s": 114.42997169494629, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 114.42997169494629, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.319135802469134, "ram_util_percent": 13.37098765432099}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"reward_total_mean": -15.96875, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0009765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0009765625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 3.670830927292506, "policy_loss": -0.11948641935984293, "vf_loss": 4.515598726272583, "vf_explained_var": -0.01824109603961309, "kl": 0.0, "entropy": 108.01627298990886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96875, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96875, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0009765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0009765625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9926446862439082, "mean_inference_ms": 14.438009215156189, "mean_action_processing_ms": 0.6448558703903033, "mean_env_wait_ms": 0.4518154968419871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.47422051429748535, "StateBufferConnector_ms": 0.0053707510232925415, "ViewRequirementAgentConnector_ms": 0.3045227378606796}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96875, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9926446862439082, "mean_inference_ms": 14.438009215156189, "mean_action_processing_ms": 0.6448558703903033, "mean_env_wait_ms": 0.4518154968419871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.47422051429748535, "StateBufferConnector_ms": 0.0053707510232925415, "ViewRequirementAgentConnector_ms": 0.3045227378606796}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.8250799952774197, "num_agent_steps_trained_throughput_per_sec": 3.8250799952774197, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 124140.582, "sample_time_ms": 9971.483, "load_time_ms": 0.491, "load_throughput": 1042214.826, "learn_time_ms": 114167.797, "learn_throughput": 4.485, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 64, "training_iteration": 2, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-23-32", "timestamp": 1709011412, "time_this_iter_s": 133.8567452430725, "time_total_s": 248.2867169380188, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 248.2867169380188, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.999481865284974, "ram_util_percent": 13.441450777202071}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.895833333333334, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0032552083333333335, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0032552083333333335, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 3.4396915197372437, "policy_loss": -0.12123282399649421, "vf_loss": 4.2423110942045845, "vf_explained_var": -0.01934977521498998, "kl": 0.0, "entropy": 107.52908617655436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.895833333333334, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.895833333333334, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0032552083333333335, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0032552083333333335, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2755995871758308, "mean_inference_ms": 16.783479443339647, "mean_action_processing_ms": 0.7196121667214318, "mean_env_wait_ms": 0.49400275046634134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5786841114362081, "StateBufferConnector_ms": 0.005404154459635417, "ViewRequirementAgentConnector_ms": 0.49926017721494037}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.895833333333334, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2755995871758308, "mean_inference_ms": 16.783479443339647, "mean_action_processing_ms": 0.7196121667214318, "mean_env_wait_ms": 0.49400275046634134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5786841114362081, "StateBufferConnector_ms": 0.005404154459635417, "ViewRequirementAgentConnector_ms": 0.49926017721494037}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.5980090284761572, "num_agent_steps_trained_throughput_per_sec": 2.5980090284761572, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 148451.703, "sample_time_ms": 13248.633, "load_time_ms": 3.097, "load_throughput": 165339.431, "learn_time_ms": 135199.201, "learn_throughput": 3.787, "synch_weights_time_ms": 0.013}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 96, "training_iteration": 3, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-26-49", "timestamp": 1709011609, "time_this_iter_s": 197.08590412139893, "time_total_s": 445.3726210594177, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 445.3726210594177, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.810469314079423, "ram_util_percent": 13.28808664259928}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 3.5233914613723756, "policy_loss": -0.1192617142572999, "vf_loss": 4.339678847789765, "vf_explained_var": -0.017412554721037546, "kl": 0.0, "entropy": 107.51234505971273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6865012348640547, "mean_inference_ms": 20.35313873560938, "mean_action_processing_ms": 0.8174388971636666, "mean_env_wait_ms": 0.5562961547591599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7360613346099854, "StateBufferConnector_ms": 0.005370378494262695, "ViewRequirementAgentConnector_ms": 0.6324577331542969}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6865012348640547, "mean_inference_ms": 20.35313873560938, "mean_action_processing_ms": 0.8174388971636666, "mean_env_wait_ms": 0.5562961547591599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7360613346099854, "StateBufferConnector_ms": 0.005370378494262695, "ViewRequirementAgentConnector_ms": 0.6324577331542969}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.399434716362467, "num_agent_steps_trained_throughput_per_sec": 2.399434716362467, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 164684.668, "sample_time_ms": 15010.158, "load_time_ms": 2.394, "load_throughput": 213903.446, "learn_time_ms": 149671.382, "learn_throughput": 3.421, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 128, "training_iteration": 4, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-30-22", "timestamp": 1709011822, "time_this_iter_s": 213.39689707756042, "time_total_s": 658.7695181369781, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 658.7695181369781, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.230794701986756, "ram_util_percent": 13.126158940397346}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 3.168798545996348, "policy_loss": -0.11408895961940288, "vf_loss": 3.911071652173996, "vf_explained_var": 0.07723196347554524, "kl": 0.0, "entropy": 108.27904980977377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0402119882472287, "mean_inference_ms": 23.43718243344567, "mean_action_processing_ms": 0.8935930716347127, "mean_env_wait_ms": 0.6005928332317322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7137656211853027, "StateBufferConnector_ms": 0.0050852298736572266, "ViewRequirementAgentConnector_ms": 0.7010035514831543}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0402119882472287, "mean_inference_ms": 23.43718243344567, "mean_action_processing_ms": 0.8935930716347127, "mean_env_wait_ms": 0.6005928332317322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7137656211853027, "StateBufferConnector_ms": 0.0050852298736572266, "ViewRequirementAgentConnector_ms": 0.7010035514831543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.7901713552448144, "num_agent_steps_trained_throughput_per_sec": 2.7901713552448144, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 168447.983, "sample_time_ms": 15448.579, "load_time_ms": 1.976, "load_throughput": 259126.342, "learn_time_ms": 152996.715, "learn_throughput": 3.346, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 160, "training_iteration": 5, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-33-26", "timestamp": 1709012006, "time_this_iter_s": 183.51145792007446, "time_total_s": 842.2809760570526, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 842.2809760570526, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.65868725868726, "ram_util_percent": 12.927027027027025}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 3.2145412961641946, "policy_loss": -0.10901797488331795, "vf_loss": 3.959525978565216, "vf_explained_var": 0.06640306115150452, "kl": 0.0, "entropy": 108.20064773559571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.206760501441421, "mean_inference_ms": 25.024051277908328, "mean_action_processing_ms": 0.9223014612523428, "mean_env_wait_ms": 0.6257540630121902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6477153301239014, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.640291690826416}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.206760501441421, "mean_inference_ms": 25.024051277908328, "mean_action_processing_ms": 0.9223014612523428, "mean_env_wait_ms": 0.6257540630121902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6477153301239014, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.640291690826416}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.7426699419703837, "num_agent_steps_trained_throughput_per_sec": 2.7426699419703837, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 171486.547, "sample_time_ms": 15736.216, "load_time_ms": 1.692, "load_throughput": 302576.129, "learn_time_ms": 155747.924, "learn_throughput": 3.287, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "episodes_total": 192, "training_iteration": 6, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-36-33", "timestamp": 1709012193, "time_this_iter_s": 186.6925654411316, "time_total_s": 1028.9735414981842, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1028.9735414981842, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 15.675757575757578, "ram_util_percent": 12.32878787878788}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 2.899201112985611, "policy_loss": -0.12908791719625393, "vf_loss": 3.6077554285526277, "vf_explained_var": -0.04970640043417613, "kl": 0.0, "entropy": 108.31854330698648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2607531907190492, "mean_inference_ms": 25.63060781889301, "mean_action_processing_ms": 0.9321756242572431, "mean_env_wait_ms": 0.6390227730524178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5852296352386475, "StateBufferConnector_ms": 0.004844188690185547, "ViewRequirementAgentConnector_ms": 0.529517650604248}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2607531907190492, "mean_inference_ms": 25.63060781889301, "mean_action_processing_ms": 0.9321756242572431, "mean_env_wait_ms": 0.6390227730524178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5852296352386475, "StateBufferConnector_ms": 0.004844188690185547, "ViewRequirementAgentConnector_ms": 0.529517650604248}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.7634565485569342, "num_agent_steps_trained_throughput_per_sec": 2.7634565485569342, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 173456.352, "sample_time_ms": 15877.511, "load_time_ms": 1.486, "load_throughput": 344439.785, "learn_time_ms": 157576.224, "learn_throughput": 3.249, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "done": false, "episodes_total": 224, "training_iteration": 7, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-39-38", "timestamp": 1709012378, "time_this_iter_s": 185.28427290916443, "time_total_s": 1214.2578144073486, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1214.2578144073486, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 15.022605363984672, "ram_util_percent": 11.977394636015328}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 2.528065716226896, "policy_loss": -0.1181360440949599, "vf_loss": 3.1525553385416667, "vf_explained_var": 0.16119361023108164, "kl": 0.0, "entropy": 108.18336563110351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.285016919508926, "mean_inference_ms": 26.002704724419655, "mean_action_processing_ms": 0.9283368739197951, "mean_env_wait_ms": 0.6451199474172475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5617237091064453, "StateBufferConnector_ms": 0.007451534271240234, "ViewRequirementAgentConnector_ms": 0.5154330730438232}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.285016919508926, "mean_inference_ms": 26.002704724419655, "mean_action_processing_ms": 0.9283368739197951, "mean_env_wait_ms": 0.6451199474172475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5617237091064453, "StateBufferConnector_ms": 0.007451534271240234, "ViewRequirementAgentConnector_ms": 0.5154330730438232}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9005672400590816, "num_agent_steps_trained_throughput_per_sec": 2.9005672400590816, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 173838.954, "sample_time_ms": 16024.219, "load_time_ms": 1.342, "load_throughput": 381537.47, "learn_time_ms": 157812.327, "learn_throughput": 3.244, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 256, "training_iteration": 8, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-42-35", "timestamp": 1709012555, "time_this_iter_s": 176.52613830566406, "time_total_s": 1390.7839527130127, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1390.7839527130127, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.02008032128514, "ram_util_percent": 11.97710843373494}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 2.264357433716456, "policy_loss": -0.1032307560245196, "vf_loss": 2.820628794034322, "vf_explained_var": 0.1671003927787145, "kl": 0.0, "entropy": 108.73496685028076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2875639723565477, "mean_inference_ms": 26.19206792055375, "mean_action_processing_ms": 0.9161312044510339, "mean_env_wait_ms": 0.6450931733263766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5651705265045166, "StateBufferConnector_ms": 0.011486053466796875, "ViewRequirementAgentConnector_ms": 0.49497151374816895}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2875639723565477, "mean_inference_ms": 26.19206792055375, "mean_action_processing_ms": 0.9161312044510339, "mean_env_wait_ms": 0.6450931733263766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5651705265045166, "StateBufferConnector_ms": 0.011486053466796875, "ViewRequirementAgentConnector_ms": 0.49497151374816895}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8271582270611604, "num_agent_steps_trained_throughput_per_sec": 2.8271582270611604, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 174645.798, "sample_time_ms": 15986.289, "load_time_ms": 1.226, "load_throughput": 417464.476, "learn_time_ms": 158656.574, "learn_throughput": 3.227, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 288, "training_iteration": 9, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-45-36", "timestamp": 1709012736, "time_this_iter_s": 181.1087384223938, "time_total_s": 1571.8926911354065, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1571.8926911354065, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 15.126953125, "ram_util_percent": 11.9703125}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 2.225030494729678, "policy_loss": -0.11519516911357641, "vf_loss": 2.7880304038524626, "vf_explained_var": 0.3228406478961309, "kl": 0.0, "entropy": 107.86862373352051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.288383176278809, "mean_inference_ms": 26.089152564258438, "mean_action_processing_ms": 0.9053291947770742, "mean_env_wait_ms": 0.6399158907392345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.524705171585083, "StateBufferConnector_ms": 0.016269922256469727, "ViewRequirementAgentConnector_ms": 0.48526620864868164}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.288383176278809, "mean_inference_ms": 26.089152564258438, "mean_action_processing_ms": 0.9053291947770742, "mean_env_wait_ms": 0.6399158907392345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.524705171585083, "StateBufferConnector_ms": 0.016269922256469727, "ViewRequirementAgentConnector_ms": 0.48526620864868164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.874492886402482, "num_agent_steps_trained_throughput_per_sec": 2.874492886402482, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 174993.052, "sample_time_ms": 15667.703, "load_time_ms": 1.132, "load_throughput": 452168.456, "learn_time_ms": 159322.63, "learn_throughput": 3.214, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 320, "training_iteration": 10, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-48-34", "timestamp": 1709012914, "time_this_iter_s": 178.14472913742065, "time_total_s": 1750.0374202728271, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1750.0374202728271, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 15.136254980079682, "ram_util_percent": 11.975298804780877}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.8011651555697124, "policy_loss": -0.11308175877978405, "vf_loss": 2.280540137489637, "vf_explained_var": 0.3884770060578982, "kl": 0.0, "entropy": 107.65665760040284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.98, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.000625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.000625, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2839287535055597, "mean_inference_ms": 25.88468895689516, "mean_action_processing_ms": 0.9010178614349406, "mean_env_wait_ms": 0.6350048399383311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5527541637420654, "StateBufferConnector_ms": 0.01372671127319336, "ViewRequirementAgentConnector_ms": 0.46835899353027344}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2839287535055597, "mean_inference_ms": 25.88468895689516, "mean_action_processing_ms": 0.9010178614349406, "mean_env_wait_ms": 0.6350048399383311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5527541637420654, "StateBufferConnector_ms": 0.01372671127319336, "ViewRequirementAgentConnector_ms": 0.46835899353027344}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.833927140934867, "num_agent_steps_trained_throughput_per_sec": 2.833927140934867, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 181617.073, "sample_time_ms": 16416.624, "load_time_ms": 1.099, "load_throughput": 465811.385, "learn_time_ms": 165197.801, "learn_throughput": 3.099, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 352, "training_iteration": 11, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-51-35", "timestamp": 1709013095, "time_this_iter_s": 180.6836051940918, "time_total_s": 1930.721025466919, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1930.721025466919, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 15.144140625, "ram_util_percent": 11.898046875}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 2.3010841737190884, "policy_loss": -0.1013950804869334, "vf_loss": 2.8621962487697603, "vf_explained_var": 0.37362091094255445, "kl": 0.0, "entropy": 107.80723005930582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2795725822182207, "mean_inference_ms": 25.765051156600475, "mean_action_processing_ms": 0.9036560168930973, "mean_env_wait_ms": 0.6302527603841872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.563715934753418, "StateBufferConnector_ms": 0.009710311889648438, "ViewRequirementAgentConnector_ms": 0.44249749183654785}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2795725822182207, "mean_inference_ms": 25.765051156600475, "mean_action_processing_ms": 0.9036560168930973, "mean_env_wait_ms": 0.6302527603841872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.563715934753418, "StateBufferConnector_ms": 0.009710311889648438, "ViewRequirementAgentConnector_ms": 0.44249749183654785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0926867683620385, "num_agent_steps_trained_throughput_per_sec": 3.0926867683620385, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 184786.916, "sample_time_ms": 16955.409, "load_time_ms": 1.092, "load_throughput": 468811.24, "learn_time_ms": 167828.86, "learn_throughput": 3.051, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "episodes_total": 384, "training_iteration": 12, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-54-20", "timestamp": 1709013260, "time_this_iter_s": 165.5705304145813, "time_total_s": 2096.2915558815002, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2096.2915558815002, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 15.341880341880342, "ram_util_percent": 11.911965811965812}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.6522302453716595, "policy_loss": -0.11628292485450704, "vf_loss": 2.106920083363851, "vf_explained_var": 0.4017525061964989, "kl": 0.0, "entropy": 108.04099146525066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2489122016391074, "mean_inference_ms": 25.654015287334445, "mean_action_processing_ms": 0.9012267757454375, "mean_env_wait_ms": 0.626971367741413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5361576080322266, "StateBufferConnector_ms": 0.0188140869140625, "ViewRequirementAgentConnector_ms": 0.4038827419281006}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2489122016391074, "mean_inference_ms": 25.654015287334445, "mean_action_processing_ms": 0.9012267757454375, "mean_env_wait_ms": 0.626971367741413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5361576080322266, "StateBufferConnector_ms": 0.0188140869140625, "ViewRequirementAgentConnector_ms": 0.4038827419281006}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.99090583469977, "num_agent_steps_trained_throughput_per_sec": 2.99090583469977, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 182198.078, "sample_time_ms": 16139.928, "load_time_ms": 0.315, "load_throughput": 1624789.02, "learn_time_ms": 166056.25, "learn_throughput": 3.083, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "done": false, "episodes_total": 416, "training_iteration": 13, "trial_id": "1b5c8_00222", "date": "2024-02-27_06-57-11", "timestamp": 1709013431, "time_this_iter_s": 171.19617557525635, "time_total_s": 2267.4877314567566, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2267.4877314567566, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.459504132231404, "ram_util_percent": 11.934297520661158}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.3872043122847875, "policy_loss": -0.11109361400206884, "vf_loss": 1.7849988659222922, "vf_explained_var": 0.30330077807108563, "kl": 0.0, "entropy": 107.60610160827636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2322619166279427, "mean_inference_ms": 25.65697053119956, "mean_action_processing_ms": 0.8965538405912747, "mean_env_wait_ms": 0.6253134292757043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5188963413238525, "StateBufferConnector_ms": 0.018822908401489258, "ViewRequirementAgentConnector_ms": 0.4790925979614258}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2322619166279427, "mean_inference_ms": 25.65697053119956, "mean_action_processing_ms": 0.8965538405912747, "mean_env_wait_ms": 0.6253134292757043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5188963413238525, "StateBufferConnector_ms": 0.018822908401489258, "ViewRequirementAgentConnector_ms": 0.4790925979614258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8279391698133476, "num_agent_steps_trained_throughput_per_sec": 2.8279391698133476, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 178964.776, "sample_time_ms": 15873.905, "load_time_ms": 0.315, "load_throughput": 1624666.098, "learn_time_ms": 163088.976, "learn_throughput": 3.139, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "episodes_total": 448, "training_iteration": 14, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-00-13", "timestamp": 1709013613, "time_this_iter_s": 181.07973670959473, "time_total_s": 2448.5674681663513, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2448.5674681663513, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 14.951953125, "ram_util_percent": 11.971875}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.6555378869175912, "policy_loss": -0.10861258382598558, "vf_loss": 2.101722584168116, "vf_explained_var": 0.16375940243403117, "kl": 0.0, "entropy": 107.70480937957764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2171601694009757, "mean_inference_ms": 25.595173460337833, "mean_action_processing_ms": 0.8902048343714363, "mean_env_wait_ms": 0.6222641259673798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5418739318847656, "StateBufferConnector_ms": 0.018804311752319336, "ViewRequirementAgentConnector_ms": 0.44899582862854004}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2171601694009757, "mean_inference_ms": 25.595173460337833, "mean_action_processing_ms": 0.8902048343714363, "mean_env_wait_ms": 0.6222641259673798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5418739318847656, "StateBufferConnector_ms": 0.018804311752319336, "ViewRequirementAgentConnector_ms": 0.44899582862854004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8754331953432226, "num_agent_steps_trained_throughput_per_sec": 2.8754331953432226, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 178420.661, "sample_time_ms": 15728.837, "load_time_ms": 0.313, "load_throughput": 1634434.621, "learn_time_ms": 162689.941, "learn_throughput": 3.147, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 480, "training_iteration": 15, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-03-11", "timestamp": 1709013791, "time_this_iter_s": 178.07291102409363, "time_total_s": 2626.640379190445, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2626.640379190445, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 15.445238095238095, "ram_util_percent": 11.931746031746032}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.6861889610687892, "policy_loss": -0.05757192187011242, "vf_loss": 2.0774314274390537, "vf_explained_var": 0.029862412810325624, "kl": 0.0, "entropy": 108.12718035380045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2115943641614892, "mean_inference_ms": 25.611189730898115, "mean_action_processing_ms": 0.8864516710013174, "mean_env_wait_ms": 0.6190825220884425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5427651405334473, "StateBufferConnector_ms": 0.004838228225708008, "ViewRequirementAgentConnector_ms": 0.5081753730773926}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2115943641614892, "mean_inference_ms": 25.611189730898115, "mean_action_processing_ms": 0.8864516710013174, "mean_env_wait_ms": 0.6190825220884425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5427651405334473, "StateBufferConnector_ms": 0.004838228225708008, "ViewRequirementAgentConnector_ms": 0.5081753730773926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.889552889651925, "num_agent_steps_trained_throughput_per_sec": 2.889552889651925, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 177471.725, "sample_time_ms": 15388.849, "load_time_ms": 0.313, "load_throughput": 1638175.031, "learn_time_ms": 162081.012, "learn_throughput": 3.159, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 512, "training_iteration": 16, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-06-08", "timestamp": 1709013968, "time_this_iter_s": 177.2034707069397, "time_total_s": 2803.8438498973846, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2803.8438498973846, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 15.597199999999999, "ram_util_percent": 11.944400000000002}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.092220439016819, "policy_loss": -0.11216088713457187, "vf_loss": 1.4348410099744797, "vf_explained_var": 0.11650401055812835, "kl": 0.0, "entropy": 107.5633160909017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.195995173533579, "mean_inference_ms": 25.592755942714888, "mean_action_processing_ms": 0.887712739108083, "mean_env_wait_ms": 0.6130065507723645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5747182369232178, "StateBufferConnector_ms": 0.004875659942626953, "ViewRequirementAgentConnector_ms": 0.42766880989074707}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.195995173533579, "mean_inference_ms": 25.592755942714888, "mean_action_processing_ms": 0.887712739108083, "mean_env_wait_ms": 0.6130065507723645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5747182369232178, "StateBufferConnector_ms": 0.004875659942626953, "ViewRequirementAgentConnector_ms": 0.42766880989074707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.886656685358526, "num_agent_steps_trained_throughput_per_sec": 2.886656685358526, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 176680.985, "sample_time_ms": 15316.798, "load_time_ms": 0.323, "load_throughput": 1587084.213, "learn_time_ms": 161362.607, "learn_throughput": 3.173, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "done": false, "episodes_total": 544, "training_iteration": 17, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-09-05", "timestamp": 1709014145, "time_this_iter_s": 177.3740234375, "time_total_s": 2981.2178733348846, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2981.2178733348846, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 15.1444, "ram_util_percent": 11.972}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.8208032975594202, "policy_loss": -0.11355486071358124, "vf_loss": 2.304499703645706, "vf_explained_var": 0.0642011433839798, "kl": 0.0, "entropy": 107.40491746266683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1804093575360537, "mean_inference_ms": 25.54699204443422, "mean_action_processing_ms": 0.8913667991177684, "mean_env_wait_ms": 0.6068517027418424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5488955974578857, "StateBufferConnector_ms": 0.004834175109863281, "ViewRequirementAgentConnector_ms": 0.46221280097961426}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1804093575360537, "mean_inference_ms": 25.54699204443422, "mean_action_processing_ms": 0.8913667991177684, "mean_env_wait_ms": 0.6068517027418424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5488955974578857, "StateBufferConnector_ms": 0.004834175109863281, "ViewRequirementAgentConnector_ms": 0.46221280097961426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2388218388257135, "num_agent_steps_trained_throughput_per_sec": 3.2388218388257135, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 174837.483, "sample_time_ms": 15141.369, "load_time_ms": 0.316, "load_throughput": 1618909.648, "learn_time_ms": 159694.553, "learn_throughput": 3.206, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "episodes_total": 576, "training_iteration": 18, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-11-44", "timestamp": 1709014304, "time_this_iter_s": 158.0912380218506, "time_total_s": 3139.3091113567352, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3139.3091113567352, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 16.25470852017937, "ram_util_percent": 11.930493273542606}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1195375601450601, "policy_loss": -0.07713333653906981, "vf_loss": 1.4256551817059517, "vf_explained_var": 0.09459675500790278, "kl": 0.0, "entropy": 107.14289302825928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1744826618133795, "mean_inference_ms": 25.59993591535117, "mean_action_processing_ms": 0.8999391766715652, "mean_env_wait_ms": 0.6039796056961784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5268478393554688, "StateBufferConnector_ms": 0.008858680725097656, "ViewRequirementAgentConnector_ms": 0.421001672744751}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1744826618133795, "mean_inference_ms": 25.59993591535117, "mean_action_processing_ms": 0.8999391766715652, "mean_env_wait_ms": 0.6039796056961784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5268478393554688, "StateBufferConnector_ms": 0.008858680725097656, "ViewRequirementAgentConnector_ms": 0.421001672744751}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8465885705188, "num_agent_steps_trained_throughput_per_sec": 2.8465885705188, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 174713.867, "sample_time_ms": 15288.309, "load_time_ms": 0.313, "load_throughput": 1635056.836, "learn_time_ms": 159424.631, "learn_throughput": 3.212, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "done": false, "episodes_total": 608, "training_iteration": 19, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-14-44", "timestamp": 1709014484, "time_this_iter_s": 179.8786542415619, "time_total_s": 3319.187765598297, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3319.187765598297, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 15.293307086614174, "ram_util_percent": 11.946850393700787}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.2326092240711053, "policy_loss": -0.1180038199139138, "vf_loss": 1.6090542977054914, "vf_explained_var": 0.0685840219259262, "kl": 0.0, "entropy": 106.76165053049723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1759975685011, "mean_inference_ms": 25.658125831271217, "mean_action_processing_ms": 0.9060561406408957, "mean_env_wait_ms": 0.6046227344873348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4893989562988281, "StateBufferConnector_ms": 0.008844614028930664, "ViewRequirementAgentConnector_ms": 0.40009474754333496}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1759975685011, "mean_inference_ms": 25.658125831271217, "mean_action_processing_ms": 0.9060561406408957, "mean_env_wait_ms": 0.6046227344873348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4893989562988281, "StateBufferConnector_ms": 0.008844614028930664, "ViewRequirementAgentConnector_ms": 0.40009474754333496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0464880551003644, "num_agent_steps_trained_throughput_per_sec": 3.0464880551003644, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 173708.266, "sample_time_ms": 15634.355, "load_time_ms": 0.314, "load_throughput": 1628608.864, "learn_time_ms": 158072.967, "learn_throughput": 3.239, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "episodes_total": 640, "training_iteration": 20, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-17-32", "timestamp": 1709014652, "time_this_iter_s": 168.06735181808472, "time_total_s": 3487.255117416382, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3487.255117416382, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 15.492857142857144, "ram_util_percent": 11.97689075630252}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.5348175620039304, "policy_loss": -0.06472846250981093, "vf_loss": 1.9056208938360215, "vf_explained_var": 0.027549564838409424, "kl": 0.0, "entropy": 106.10462582906088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1812978769152824, "mean_inference_ms": 25.721554736128255, "mean_action_processing_ms": 0.9092181658720122, "mean_env_wait_ms": 0.6054016946444435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4695465564727783, "StateBufferConnector_ms": 0.009658575057983398, "ViewRequirementAgentConnector_ms": 0.421123743057251}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1812978769152824, "mean_inference_ms": 25.721554736128255, "mean_action_processing_ms": 0.9092181658720122, "mean_env_wait_ms": 0.6054016946444435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4695465564727783, "StateBufferConnector_ms": 0.009658575057983398, "ViewRequirementAgentConnector_ms": 0.421123743057251}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2137537772781606, "num_agent_steps_trained_throughput_per_sec": 3.2137537772781606, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 171572.987, "sample_time_ms": 15643.549, "load_time_ms": 0.942, "load_throughput": 543309.125, "learn_time_ms": 155927.865, "learn_throughput": 3.284, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 672, "training_iteration": 21, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-20-11", "timestamp": 1709014811, "time_this_iter_s": 159.3214566707611, "time_total_s": 3646.576574087143, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3646.576574087143, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 15.608849557522122, "ram_util_percent": 11.922123893805312}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8604758101205031, "policy_loss": -0.10285272899394234, "vf_loss": 1.147662511219581, "vf_explained_var": -0.03920305420955022, "kl": 0.0, "entropy": 106.15410531361898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1828514243054262, "mean_inference_ms": 25.690455386818247, "mean_action_processing_ms": 0.9089765074235711, "mean_env_wait_ms": 0.6070065462952625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5154256820678711, "StateBufferConnector_ms": 0.009538888931274414, "ViewRequirementAgentConnector_ms": 0.4630472660064697}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1828514243054262, "mean_inference_ms": 25.690455386818247, "mean_action_processing_ms": 0.9089765074235711, "mean_env_wait_ms": 0.6070065462952625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5154256820678711, "StateBufferConnector_ms": 0.009538888931274414, "ViewRequirementAgentConnector_ms": 0.4630472660064697}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1363470008187995, "num_agent_steps_trained_throughput_per_sec": 3.1363470008187995, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 171342.527, "sample_time_ms": 15287.649, "load_time_ms": 1.351, "load_throughput": 379032.361, "learn_time_ms": 156052.905, "learn_throughput": 3.281, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "episodes_total": 704, "training_iteration": 22, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-22-54", "timestamp": 1709014974, "time_this_iter_s": 163.26542592048645, "time_total_s": 3809.8420000076294, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3809.8420000076294, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 16.085714285714285, "ram_util_percent": 11.94935064935065}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5383711367845535, "policy_loss": -0.08616819183031718, "vf_loss": 0.7440456171830495, "vf_explained_var": 0.4014678011337916, "kl": 0.0, "entropy": 105.81770572662353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1880131879365496, "mean_inference_ms": 25.653891023002316, "mean_action_processing_ms": 0.9079761021221873, "mean_env_wait_ms": 0.6060435475825544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6266288757324219, "StateBufferConnector_ms": 0.009505987167358398, "ViewRequirementAgentConnector_ms": 0.4928717613220215}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1880131879365496, "mean_inference_ms": 25.653891023002316, "mean_action_processing_ms": 0.9079761021221873, "mean_env_wait_ms": 0.6060435475825544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6266288757324219, "StateBufferConnector_ms": 0.009505987167358398, "ViewRequirementAgentConnector_ms": 0.4928717613220215}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9176254825760424, "num_agent_steps_trained_throughput_per_sec": 2.9176254825760424, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 171772.485, "sample_time_ms": 15747.262, "load_time_ms": 1.411, "load_throughput": 362891.605, "learn_time_ms": 156023.226, "learn_throughput": 3.282, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "done": false, "episodes_total": 736, "training_iteration": 23, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-25-50", "timestamp": 1709015150, "time_this_iter_s": 175.5027973651886, "time_total_s": 3985.344797372818, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3985.344797372818, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 15.519354838709676, "ram_util_percent": 11.902822580645163}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5985210843384265, "policy_loss": -0.06108516218761603, "vf_loss": 0.7858226142823697, "vf_explained_var": 0.38637523651123046, "kl": 0.0, "entropy": 106.36866232554118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.9, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.003125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.003125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1832578063763823, "mean_inference_ms": 25.57679190505136, "mean_action_processing_ms": 0.905940438201325, "mean_env_wait_ms": 0.6057536622770763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6440248489379883, "StateBufferConnector_ms": 0.008662939071655273, "ViewRequirementAgentConnector_ms": 0.47405385971069336}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1832578063763823, "mean_inference_ms": 25.57679190505136, "mean_action_processing_ms": 0.905940438201325, "mean_env_wait_ms": 0.6057536622770763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6440248489379883, "StateBufferConnector_ms": 0.008662939071655273, "ViewRequirementAgentConnector_ms": 0.47405385971069336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0445776805574774, "num_agent_steps_trained_throughput_per_sec": 3.0445776805574774, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 170484.21, "sample_time_ms": 15357.229, "load_time_ms": 1.457, "load_throughput": 351504.836, "learn_time_ms": 155124.908, "learn_throughput": 3.301, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 768, "training_iteration": 24, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-28-38", "timestamp": 1709015318, "time_this_iter_s": 168.1866798400879, "time_total_s": 4153.531477212906, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4153.531477212906, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 15.134453781512605, "ram_util_percent": 11.90294117647059}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.4974852924545606, "policy_loss": -0.11663790810853243, "vf_loss": 0.731636343151331, "vf_explained_var": 0.25896543910106024, "kl": 0.0, "entropy": 105.32688840230306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.183872578866999, "mean_inference_ms": 25.57474469932967, "mean_action_processing_ms": 0.905626453467666, "mean_env_wait_ms": 0.6050960024865144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6231508255004883, "StateBufferConnector_ms": 0.004773616790771484, "ViewRequirementAgentConnector_ms": 0.4703073501586914}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.183872578866999, "mean_inference_ms": 25.57474469932967, "mean_action_processing_ms": 0.905626453467666, "mean_env_wait_ms": 0.6050960024865144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6231508255004883, "StateBufferConnector_ms": 0.004773616790771484, "ViewRequirementAgentConnector_ms": 0.4703073501586914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.827263748240772, "num_agent_steps_trained_throughput_per_sec": 2.827263748240772, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 170787.579, "sample_time_ms": 15471.54, "load_time_ms": 1.452, "load_throughput": 352647.735, "learn_time_ms": 155313.983, "learn_throughput": 3.297, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 800, "training_iteration": 25, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-31-39", "timestamp": 1709015499, "time_this_iter_s": 181.0987846851349, "time_total_s": 4334.630261898041, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4334.630261898041, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 15.29453125, "ram_util_percent": 11.948046875000001}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6041741984585921, "policy_loss": -0.10868609097475807, "vf_loss": 0.8492668848484755, "vf_explained_var": 0.588840385278066, "kl": 0.0, "entropy": 105.67498830159505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1820176978174675, "mean_inference_ms": 25.5768217040937, "mean_action_processing_ms": 0.9054945460439342, "mean_env_wait_ms": 0.6041426376487804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5467073917388916, "StateBufferConnector_ms": 0.008102893829345703, "ViewRequirementAgentConnector_ms": 0.4620330333709717}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1820176978174675, "mean_inference_ms": 25.5768217040937, "mean_action_processing_ms": 0.9054945460439342, "mean_env_wait_ms": 0.6041426376487804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5467073917388916, "StateBufferConnector_ms": 0.008102893829345703, "ViewRequirementAgentConnector_ms": 0.4620330333709717}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.908293028689574, "num_agent_steps_trained_throughput_per_sec": 2.908293028689574, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 170673.405, "sample_time_ms": 15699.15, "load_time_ms": 1.456, "load_throughput": 351545.116, "learn_time_ms": 154972.182, "learn_throughput": 3.304, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "episodes_total": 832, "training_iteration": 26, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-34-35", "timestamp": 1709015675, "time_this_iter_s": 176.0574028491974, "time_total_s": 4510.687664747238, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4510.687664747238, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 15.65282258064516, "ram_util_percent": 11.864112903225807}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8164220984404286, "policy_loss": -0.13154190474500257, "vf_loss": 1.129357935488224, "vf_explained_var": 0.7652827486395836, "kl": 0.0, "entropy": 106.0636370340983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1917336952348943, "mean_inference_ms": 25.6287745178291, "mean_action_processing_ms": 0.9073615609091885, "mean_env_wait_ms": 0.6033958837839173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5628466606140137, "StateBufferConnector_ms": 0.008149147033691406, "ViewRequirementAgentConnector_ms": 0.5707437992095947}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1917336952348943, "mean_inference_ms": 25.6287745178291, "mean_action_processing_ms": 0.9073615609091885, "mean_env_wait_ms": 0.6033958837839173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5628466606140137, "StateBufferConnector_ms": 0.008149147033691406, "ViewRequirementAgentConnector_ms": 0.5707437992095947}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.012287240567223, "num_agent_steps_trained_throughput_per_sec": 3.012287240567223, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 169933.674, "sample_time_ms": 15763.042, "load_time_ms": 1.45, "load_throughput": 352983.932, "learn_time_ms": 154168.568, "learn_throughput": 3.321, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "done": false, "episodes_total": 864, "training_iteration": 27, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-37-25", "timestamp": 1709015845, "time_this_iter_s": 169.97572803497314, "time_total_s": 4680.663392782211, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4680.663392782211, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 15.638075313807533, "ram_util_percent": 11.851046025104608}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.900208983446161, "policy_loss": -0.11027325671166181, "vf_loss": 1.2038391115764777, "vf_explained_var": 0.6397292385498683, "kl": 0.0, "entropy": 105.46086241404215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.96, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.00125, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1990349480861533, "mean_inference_ms": 25.666644978751524, "mean_action_processing_ms": 0.9108251606524975, "mean_env_wait_ms": 0.6019531588959903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6141419410705566, "StateBufferConnector_ms": 0.008194446563720703, "ViewRequirementAgentConnector_ms": 0.5783376693725586}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1990349480861533, "mean_inference_ms": 25.666644978751524, "mean_action_processing_ms": 0.9108251606524975, "mean_env_wait_ms": 0.6019531588959903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6141419410705566, "StateBufferConnector_ms": 0.008194446563720703, "ViewRequirementAgentConnector_ms": 0.5783376693725586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8534356718643363, "num_agent_steps_trained_throughput_per_sec": 2.8534356718643363, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 172068.738, "sample_time_ms": 15833.132, "load_time_ms": 1.45, "load_throughput": 353111.623, "learn_time_ms": 156233.543, "learn_throughput": 3.277, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "episodes_total": 896, "training_iteration": 28, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-40-25", "timestamp": 1709016025, "time_this_iter_s": 179.4458577632904, "time_total_s": 4860.109250545502, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4860.109250545502, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 15.55236220472441, "ram_util_percent": 11.843307086614175}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5433935688498119, "policy_loss": -0.059047030905882515, "vf_loss": 0.7177182714144389, "vf_explained_var": 0.7389530276258787, "kl": 0.0, "entropy": 105.83282883961995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.94, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.001875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.001875, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1999370881036695, "mean_inference_ms": 25.690667199646537, "mean_action_processing_ms": 0.9136464313233412, "mean_env_wait_ms": 0.600548417518559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5740110874176025, "StateBufferConnector_ms": 0.00484013557434082, "ViewRequirementAgentConnector_ms": 0.5162909030914307}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1999370881036695, "mean_inference_ms": 25.690667199646537, "mean_action_processing_ms": 0.9136464313233412, "mean_env_wait_ms": 0.600548417518559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5740110874176025, "StateBufferConnector_ms": 0.00484013557434082, "ViewRequirementAgentConnector_ms": 0.5162909030914307}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.928383938884016, "num_agent_steps_trained_throughput_per_sec": 2.928383938884016, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 171566.343, "sample_time_ms": 15647.746, "load_time_ms": 1.452, "load_throughput": 352607.203, "learn_time_ms": 155916.527, "learn_throughput": 3.284, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "done": false, "episodes_total": 928, "training_iteration": 29, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-43-20", "timestamp": 1709016200, "time_this_iter_s": 174.84944581985474, "time_total_s": 5034.958696365356, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5034.958696365356, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 15.224696356275304, "ram_util_percent": 11.891497975708507}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.41387607843304675, "policy_loss": -0.12933207576473554, "vf_loss": 0.6471516241629919, "vf_explained_var": 0.7994551757971445, "kl": 0.0, "entropy": 106.2446626663208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1960453597061305, "mean_inference_ms": 25.6991433441285, "mean_action_processing_ms": 0.915038529635509, "mean_env_wait_ms": 0.5989440003446951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.533031702041626, "StateBufferConnector_ms": 0.004765987396240234, "ViewRequirementAgentConnector_ms": 0.4652135372161865}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1960453597061305, "mean_inference_ms": 25.6991433441285, "mean_action_processing_ms": 0.915038529635509, "mean_env_wait_ms": 0.5989440003446951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.533031702041626, "StateBufferConnector_ms": 0.004765987396240234, "ViewRequirementAgentConnector_ms": 0.4652135372161865}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.945316525668022, "num_agent_steps_trained_throughput_per_sec": 2.945316525668022, "timesteps_total": 15360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 172143.637, "sample_time_ms": 15586.101, "load_time_ms": 1.449, "load_throughput": 353256.839, "learn_time_ms": 156555.481, "learn_throughput": 3.27, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "episodes_total": 960, "training_iteration": 30, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-46-14", "timestamp": 1709016374, "time_this_iter_s": 173.8484025001526, "time_total_s": 5208.807098865509, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5208.807098865509, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 15.602439024390243, "ram_util_percent": 11.87967479674797}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.7113052022953829, "policy_loss": -0.11458636770645778, "vf_loss": 0.9839268296957016, "vf_explained_var": 0.7741239666938782, "kl": 0.0, "entropy": 107.08272908528646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.92, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0025, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.0025, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1954134903519615, "mean_inference_ms": 25.74559242937029, "mean_action_processing_ms": 0.9148104667095056, "mean_env_wait_ms": 0.5988068165943484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5775735378265381, "StateBufferConnector_ms": 0.005310773849487305, "ViewRequirementAgentConnector_ms": 0.48347926139831543}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1954134903519615, "mean_inference_ms": 25.74559242937029, "mean_action_processing_ms": 0.9148104667095056, "mean_env_wait_ms": 0.5988068165943484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5775735378265381, "StateBufferConnector_ms": 0.005310773849487305, "ViewRequirementAgentConnector_ms": 0.48347926139831543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.7476483044549034, "num_agent_steps_trained_throughput_per_sec": 2.7476483044549034, "timesteps_total": 15872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 174846.231, "sample_time_ms": 15835.974, "load_time_ms": 0.818, "load_throughput": 626088.527, "learn_time_ms": 159008.837, "learn_throughput": 3.22, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "done": false, "episodes_total": 992, "training_iteration": 31, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-49-20", "timestamp": 1709016560, "time_this_iter_s": 186.35020565986633, "time_total_s": 5395.157304525375, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5395.157304525375, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 14.99809885931559, "ram_util_percent": 11.894296577946768}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6566834955476224, "policy_loss": -0.10816180330390732, "vf_loss": 0.9111992694437504, "vf_explained_var": 0.6499452983339628, "kl": 0.0, "entropy": 107.08005358378092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.86, "reward_total_min": -16, "reward_total_max": -14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.004375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.0625, "reward_score_mean": 0.004375, "reward_score_min": 0.0, "reward_score_max": 0.0625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1986367673188227, "mean_inference_ms": 25.804363105424343, "mean_action_processing_ms": 0.9134013631985417, "mean_env_wait_ms": 0.6003255506330715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5756533145904541, "StateBufferConnector_ms": 0.005349397659301758, "ViewRequirementAgentConnector_ms": 0.5308051109313965}}, "episode_reward_max": -14.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1986367673188227, "mean_inference_ms": 25.804363105424343, "mean_action_processing_ms": 0.9134013631985417, "mean_env_wait_ms": 0.6003255506330715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5756533145904541, "StateBufferConnector_ms": 0.005349397659301758, "ViewRequirementAgentConnector_ms": 0.5308051109313965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.395592097341575, "num_agent_steps_trained_throughput_per_sec": 3.395592097341575, "timesteps_total": 16384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 173599.878, "sample_time_ms": 16095.242, "load_time_ms": 0.41, "load_throughput": 1249045.337, "learn_time_ms": 157503.633, "learn_throughput": 3.251, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 1024, "training_iteration": 32, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-51-51", "timestamp": 1709016711, "time_this_iter_s": 150.78874135017395, "time_total_s": 5545.946045875549, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5545.946045875549, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 15.254716981132075, "ram_util_percent": 11.97311320754717}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5887530762236566, "policy_loss": -0.06000182010854284, "vf_loss": 0.7728948492556811, "vf_explained_var": 0.726597648859024, "kl": 0.0, "entropy": 106.30993728637695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.201657705170698, "mean_inference_ms": 25.85743759047029, "mean_action_processing_ms": 0.9126612276662995, "mean_env_wait_ms": 0.6025382002228187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5622580051422119, "StateBufferConnector_ms": 0.008767843246459961, "ViewRequirementAgentConnector_ms": 0.4943654537200928}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.201657705170698, "mean_inference_ms": 25.85743759047029, "mean_action_processing_ms": 0.9126612276662995, "mean_env_wait_ms": 0.6025382002228187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5622580051422119, "StateBufferConnector_ms": 0.008767843246459961, "ViewRequirementAgentConnector_ms": 0.4943654537200928}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.310280809938178, "num_agent_steps_trained_throughput_per_sec": 4.310280809938178, "timesteps_total": 16896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 167929.937, "sample_time_ms": 16015.975, "load_time_ms": 0.325, "load_throughput": 1576366.181, "learn_time_ms": 151913.053, "learn_throughput": 3.37, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "done": false, "episodes_total": 1056, "training_iteration": 33, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-53-50", "timestamp": 1709016830, "time_this_iter_s": 118.79076814651489, "time_total_s": 5664.736814022064, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5664.736814022064, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 15.107784431137725, "ram_util_percent": 11.967664670658682}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8398250653408468, "policy_loss": 0.07918209897664687, "vf_loss": 0.9061928262313207, "vf_explained_var": 0.5275477295120558, "kl": 0.0, "entropy": 106.95141531626383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.72, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00875, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.206994040678577, "mean_inference_ms": 25.88990639689169, "mean_action_processing_ms": 0.9125317104008539, "mean_env_wait_ms": 0.602961029662356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5274908542633057, "StateBufferConnector_ms": 0.008364439010620117, "ViewRequirementAgentConnector_ms": 0.4692099094390869}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.206994040678577, "mean_inference_ms": 25.88990639689169, "mean_action_processing_ms": 0.9125317104008539, "mean_env_wait_ms": 0.602961029662356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5274908542633057, "StateBufferConnector_ms": 0.008364439010620117, "ViewRequirementAgentConnector_ms": 0.4692099094390869}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.203537278667938, "num_agent_steps_trained_throughput_per_sec": 3.203537278667938, "timesteps_total": 17408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 167095.484, "sample_time_ms": 16354.412, "load_time_ms": 0.276, "load_throughput": 1856239.647, "learn_time_ms": 150740.231, "learn_throughput": 3.397, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "episodes_total": 1088, "training_iteration": 34, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-56-30", "timestamp": 1709016990, "time_this_iter_s": 159.85213112831116, "time_total_s": 5824.588945150375, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5824.588945150375, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 15.542477876106194, "ram_util_percent": 11.967256637168143}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.114319665543735, "policy_loss": -0.10916506098583341, "vf_loss": 1.4575998711089293, "vf_explained_var": -0.22561924854914348, "kl": 0.0, "entropy": 105.9922861735026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.212119570002767, "mean_inference_ms": 25.907513384510093, "mean_action_processing_ms": 0.9130151992328464, "mean_env_wait_ms": 0.603007113406887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5553319454193115, "StateBufferConnector_ms": 0.014218568801879883, "ViewRequirementAgentConnector_ms": 0.4589240550994873}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.212119570002767, "mean_inference_ms": 25.907513384510093, "mean_action_processing_ms": 0.9130151992328464, "mean_env_wait_ms": 0.603007113406887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5553319454193115, "StateBufferConnector_ms": 0.014218568801879883, "ViewRequirementAgentConnector_ms": 0.4589240550994873}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8673819513895813, "num_agent_steps_trained_throughput_per_sec": 2.8673819513895813, "timesteps_total": 17920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 166842.112, "sample_time_ms": 16253.472, "load_time_ms": 0.281, "load_throughput": 1820672.868, "learn_time_ms": 150587.78, "learn_throughput": 3.4, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "done": false, "episodes_total": 1120, "training_iteration": 35, "trial_id": "1b5c8_00222", "date": "2024-02-27_07-59-28", "timestamp": 1709017168, "time_this_iter_s": 178.57714700698853, "time_total_s": 6003.166092157364, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6003.166092157364, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 15.012252964426876, "ram_util_percent": 11.975494071146246}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.82, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6845542014886935, "policy_loss": -0.1074733947403729, "vf_loss": 0.9435829387356838, "vf_explained_var": 0.22741607030232747, "kl": 0.0, "entropy": 106.23066622416178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.82, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.221078664866374, "mean_inference_ms": 25.94386401147065, "mean_action_processing_ms": 0.9151569509973876, "mean_env_wait_ms": 0.6030224262465409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6693785190582275, "StateBufferConnector_ms": 0.011044025421142578, "ViewRequirementAgentConnector_ms": 0.4288327693939209}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.221078664866374, "mean_inference_ms": 25.94386401147065, "mean_action_processing_ms": 0.9151569509973876, "mean_env_wait_ms": 0.6030224262465409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6693785190582275, "StateBufferConnector_ms": 0.011044025421142578, "ViewRequirementAgentConnector_ms": 0.4288327693939209}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.942020169019065, "num_agent_steps_trained_throughput_per_sec": 2.942020169019065, "timesteps_total": 18432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 166640.291, "sample_time_ms": 16352.91, "load_time_ms": 0.277, "load_throughput": 1845392.84, "learn_time_ms": 150286.536, "learn_throughput": 3.407, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "episodes_total": 1152, "training_iteration": 36, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-02-22", "timestamp": 1709017342, "time_this_iter_s": 174.0350558757782, "time_total_s": 6177.201148033142, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6177.201148033142, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 15.255691056910567, "ram_util_percent": 11.970731707317073}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6678046221689632, "policy_loss": -0.0941902577256163, "vf_loss": 0.907803425565362, "vf_explained_var": 0.2018597776691119, "kl": 0.0, "entropy": 106.17726872762044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.88, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00375, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.224459010366343, "mean_inference_ms": 25.977962938105655, "mean_action_processing_ms": 0.9159311642952594, "mean_env_wait_ms": 0.6034692046047889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6471381187438965, "StateBufferConnector_ms": 0.010847091674804688, "ViewRequirementAgentConnector_ms": 0.3961009979248047}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.224459010366343, "mean_inference_ms": 25.977962938105655, "mean_action_processing_ms": 0.9159311642952594, "mean_env_wait_ms": 0.6034692046047889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6471381187438965, "StateBufferConnector_ms": 0.010847091674804688, "ViewRequirementAgentConnector_ms": 0.3961009979248047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8146352622175, "num_agent_steps_trained_throughput_per_sec": 2.8146352622175, "timesteps_total": 18944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 167833.875, "sample_time_ms": 16340.158, "load_time_ms": 0.278, "load_throughput": 1844917.223, "learn_time_ms": 151492.875, "learn_throughput": 3.38, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "done": false, "episodes_total": 1184, "training_iteration": 37, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-05-24", "timestamp": 1709017524, "time_this_iter_s": 181.917959690094, "time_total_s": 6359.119107723236, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6359.119107723236, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 15.438671875, "ram_util_percent": 11.858984375000002}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.33502164281283814, "policy_loss": -0.12585363937541844, "vf_loss": 0.5490642792234818, "vf_explained_var": 0.39588137914737065, "kl": 0.0, "entropy": 106.22031904856364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2266849959240576, "mean_inference_ms": 26.007395222723652, "mean_action_processing_ms": 0.9175626168871096, "mean_env_wait_ms": 0.6036434245692321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6366066932678223, "StateBufferConnector_ms": 0.005037784576416016, "ViewRequirementAgentConnector_ms": 0.4342532157897949}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2266849959240576, "mean_inference_ms": 26.007395222723652, "mean_action_processing_ms": 0.9175626168871096, "mean_env_wait_ms": 0.6036434245692321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6366066932678223, "StateBufferConnector_ms": 0.005037784576416016, "ViewRequirementAgentConnector_ms": 0.4342532157897949}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9589387213619793, "num_agent_steps_trained_throughput_per_sec": 2.9589387213619793, "timesteps_total": 19456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 167194.095, "sample_time_ms": 16317.631, "load_time_ms": 0.279, "load_throughput": 1833732.088, "learn_time_ms": 150875.617, "learn_throughput": 3.394, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "episodes_total": 1216, "training_iteration": 38, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-08-17", "timestamp": 1709017697, "time_this_iter_s": 173.05143761634827, "time_total_s": 6532.170545339584, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6532.170545339584, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 15.736326530612244, "ram_util_percent": 11.947346938775512}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5977723885948459, "policy_loss": -0.03906262597690026, "vf_loss": 0.7586940959095955, "vf_explained_var": 0.19736719578504563, "kl": 0.0, "entropy": 105.62292213439942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2247165614795135, "mean_inference_ms": 26.019855775179057, "mean_action_processing_ms": 0.9169413022179356, "mean_env_wait_ms": 0.6044499628252392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5196232795715332, "StateBufferConnector_ms": 0.0048024654388427734, "ViewRequirementAgentConnector_ms": 0.44770312309265137}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2247165614795135, "mean_inference_ms": 26.019855775179057, "mean_action_processing_ms": 0.9169413022179356, "mean_env_wait_ms": 0.6044499628252392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5196232795715332, "StateBufferConnector_ms": 0.0048024654388427734, "ViewRequirementAgentConnector_ms": 0.44770312309265137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.852757344075203, "num_agent_steps_trained_throughput_per_sec": 2.852757344075203, "timesteps_total": 19968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 167657.596, "sample_time_ms": 16345.207, "load_time_ms": 0.28, "load_throughput": 1826246.831, "learn_time_ms": 151311.537, "learn_throughput": 3.384, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "done": false, "episodes_total": 1248, "training_iteration": 39, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-11-17", "timestamp": 1709017877, "time_this_iter_s": 179.48681712150574, "time_total_s": 6711.65736246109, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6711.65736246109, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 15.32755905511811, "ram_util_percent": 11.920078740157482}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.755183153723677, "policy_loss": 0.012479623903830846, "vf_loss": 0.8848206681509813, "vf_explained_var": -0.047082600990931193, "kl": 0.0, "entropy": 104.01138763427734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.222075987050837, "mean_inference_ms": 26.017119354240368, "mean_action_processing_ms": 0.9157033412029993, "mean_env_wait_ms": 0.605445805057514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.49514126777648926, "StateBufferConnector_ms": 0.0048694610595703125, "ViewRequirementAgentConnector_ms": 0.46046924591064453}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.222075987050837, "mean_inference_ms": 26.017119354240368, "mean_action_processing_ms": 0.9157033412029993, "mean_env_wait_ms": 0.605445805057514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.49514126777648926, "StateBufferConnector_ms": 0.0048694610595703125, "ViewRequirementAgentConnector_ms": 0.46046924591064453}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8693935814708307, "num_agent_steps_trained_throughput_per_sec": 2.8693935814708307, "timesteps_total": 20480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 168117.557, "sample_time_ms": 16343.285, "load_time_ms": 0.646, "load_throughput": 793073.214, "learn_time_ms": 151773.048, "learn_throughput": 3.373, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 1280, "training_iteration": 40, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-14-16", "timestamp": 1709018056, "time_this_iter_s": 178.44467687606812, "time_total_s": 6890.102039337158, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6890.102039337158, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 15.266666666666666, "ram_util_percent": 11.961111111111112}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.47939624323820074, "policy_loss": -0.07638822427640359, "vf_loss": 0.6621344205612938, "vf_explained_var": -0.11953879197438558, "kl": 0.0, "entropy": 104.61673043568929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.221879604187627, "mean_inference_ms": 26.02853320592223, "mean_action_processing_ms": 0.9137456106774874, "mean_env_wait_ms": 0.6074782327750999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5201797485351562, "StateBufferConnector_ms": 0.004891872406005859, "ViewRequirementAgentConnector_ms": 0.4968602657318115}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.221879604187627, "mean_inference_ms": 26.02853320592223, "mean_action_processing_ms": 0.9137456106774874, "mean_env_wait_ms": 0.6074782327750999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5201797485351562, "StateBufferConnector_ms": 0.004891872406005859, "ViewRequirementAgentConnector_ms": 0.4968602657318115}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.955474202792507, "num_agent_steps_trained_throughput_per_sec": 2.955474202792507, "timesteps_total": 20992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 166807.225, "sample_time_ms": 16225.735, "load_time_ms": 0.653, "load_throughput": 783867.589, "learn_time_ms": 150579.672, "learn_throughput": 3.4, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "done": false, "episodes_total": 1312, "training_iteration": 41, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-17-09", "timestamp": 1709018229, "time_this_iter_s": 173.24296140670776, "time_total_s": 7063.345000743866, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7063.345000743866, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 15.713114754098358, "ram_util_percent": 11.971311475409834}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.4890725320360313, "policy_loss": -0.10708719457810124, "vf_loss": 0.710235525543491, "vf_explained_var": 0.20544400910536448, "kl": 0.0, "entropy": 105.17279955546061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.84, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.005, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.005, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.222439155968159, "mean_inference_ms": 26.0518890385723, "mean_action_processing_ms": 0.9117814482798167, "mean_env_wait_ms": 0.6089976667425849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5499658584594727, "StateBufferConnector_ms": 0.023821115493774414, "ViewRequirementAgentConnector_ms": 0.5475783348083496}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.222439155968159, "mean_inference_ms": 26.0518890385723, "mean_action_processing_ms": 0.9117814482798167, "mean_env_wait_ms": 0.6089976667425849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5499658584594727, "StateBufferConnector_ms": 0.023821115493774414, "ViewRequirementAgentConnector_ms": 0.5475783348083496}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.8073258472902043, "num_agent_steps_trained_throughput_per_sec": 2.8073258472902043, "timesteps_total": 21504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 169966.849, "sample_time_ms": 16238.227, "load_time_ms": 1.468, "load_throughput": 348815.666, "learn_time_ms": 153725.971, "learn_throughput": 3.331, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 1344, "training_iteration": 42, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-20-12", "timestamp": 1709018412, "time_this_iter_s": 182.4032564163208, "time_total_s": 7245.748257160187, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7245.748257160187, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 15.027131782945736, "ram_util_percent": 12.058139534883718}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.7050365544855595, "policy_loss": -0.11085368363807599, "vf_loss": 0.9720117125660181, "vf_explained_var": 0.7610538552204767, "kl": 0.0, "entropy": 105.37387275695801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "sampler_results": {"episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.125, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.222207863109087, "mean_inference_ms": 26.0787770984044, "mean_action_processing_ms": 0.9107123449552503, "mean_env_wait_ms": 0.6101958682311296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5770339965820312, "StateBufferConnector_ms": 0.03427290916442871, "ViewRequirementAgentConnector_ms": 0.5567400455474854}}, "episode_reward_max": -12.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.222207863109087, "mean_inference_ms": 26.0787770984044, "mean_action_processing_ms": 0.9107123449552503, "mean_env_wait_ms": 0.6101958682311296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5770339965820312, "StateBufferConnector_ms": 0.03427290916442871, "ViewRequirementAgentConnector_ms": 0.5567400455474854}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9235523958543883, "num_agent_steps_trained_throughput_per_sec": 2.9235523958543883, "timesteps_total": 22016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22016, "timers": {"training_iteration_time_ms": 175601.214, "sample_time_ms": 16282.35, "load_time_ms": 1.466, "load_throughput": 349303.607, "learn_time_ms": 159316.219, "learn_throughput": 3.214, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "done": false, "episodes_total": 1376, "training_iteration": 43, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-23-07", "timestamp": 1709018587, "time_this_iter_s": 175.14475679397583, "time_total_s": 7420.893013954163, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7420.893013954163, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 15.22307692307692, "ram_util_percent": 11.974898785425106}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8486801608155171, "policy_loss": -0.08881124056254824, "vf_loss": 1.1168814146270354, "vf_explained_var": 0.6967595433195432, "kl": 0.0, "entropy": 105.50362167358398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.8, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.00625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.00625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2193229782919524, "mean_inference_ms": 26.093787657234497, "mean_action_processing_ms": 0.9098754722089041, "mean_env_wait_ms": 0.610015586567016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6189432144165039, "StateBufferConnector_ms": 0.03427600860595703, "ViewRequirementAgentConnector_ms": 0.4668240547180176}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2193229782919524, "mean_inference_ms": 26.093787657234497, "mean_action_processing_ms": 0.9098754722089041, "mean_env_wait_ms": 0.610015586567016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6189432144165039, "StateBufferConnector_ms": 0.03427600860595703, "ViewRequirementAgentConnector_ms": 0.4668240547180176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1282460641765315, "num_agent_steps_trained_throughput_per_sec": 3.1282460641765315, "timesteps_total": 22528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 175985.883, "sample_time_ms": 16149.535, "load_time_ms": 1.465, "load_throughput": 349536.711, "learn_time_ms": 159833.731, "learn_throughput": 3.203, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "episodes_total": 1408, "training_iteration": 44, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-25-51", "timestamp": 1709018751, "time_this_iter_s": 163.6928129196167, "time_total_s": 7584.585826873779, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7584.585826873779, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 15.104310344827585, "ram_util_percent": 11.900862068965518}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.64, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1683081495265166, "policy_loss": -0.1000979688949883, "vf_loss": 1.5111170049756766, "vf_explained_var": 0.6722573990623156, "kl": 0.0, "entropy": 105.5763323465983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.64, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01125, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2133611954783134, "mean_inference_ms": 26.083732942507048, "mean_action_processing_ms": 0.9094808979475744, "mean_env_wait_ms": 0.6086438810873678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5686080455780029, "StateBufferConnector_ms": 0.015384435653686523, "ViewRequirementAgentConnector_ms": 0.42038655281066895}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2133611954783134, "mean_inference_ms": 26.083732942507048, "mean_action_processing_ms": 0.9094808979475744, "mean_env_wait_ms": 0.6086438810873678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5686080455780029, "StateBufferConnector_ms": 0.015384435653686523, "ViewRequirementAgentConnector_ms": 0.42038655281066895}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0135226568742737, "num_agent_steps_trained_throughput_per_sec": 3.0135226568742737, "timesteps_total": 23040, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 175119.957, "sample_time_ms": 16006.409, "load_time_ms": 1.462, "load_throughput": 350209.336, "learn_time_ms": 159110.942, "learn_throughput": 3.218, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 1440, "training_iteration": 45, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-28-40", "timestamp": 1709018920, "time_this_iter_s": 169.9238395690918, "time_total_s": 7754.509666442871, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7754.509666442871, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 14.919583333333332, "ram_util_percent": 11.9625}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.54, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.014375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.014375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1493858394523462, "policy_loss": 0.011023199651390314, "vf_loss": 1.3561895740528902, "vf_explained_var": 0.5723782554268837, "kl": 0.0, "entropy": 106.24954535166422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.54, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.014375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.014375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2071947556581755, "mean_inference_ms": 26.063679508542833, "mean_action_processing_ms": 0.9090134287711547, "mean_env_wait_ms": 0.6067723412565682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5575594902038574, "StateBufferConnector_ms": 0.004822254180908203, "ViewRequirementAgentConnector_ms": 0.421222448348999}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2071947556581755, "mean_inference_ms": 26.063679508542833, "mean_action_processing_ms": 0.9090134287711547, "mean_env_wait_ms": 0.6067723412565682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5575594902038574, "StateBufferConnector_ms": 0.004822254180908203, "ViewRequirementAgentConnector_ms": 0.421222448348999}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.013691895241021, "num_agent_steps_trained_throughput_per_sec": 3.013691895241021, "timesteps_total": 23552, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 174706.078, "sample_time_ms": 15812.809, "load_time_ms": 1.458, "load_throughput": 351056.635, "learn_time_ms": 158890.67, "learn_throughput": 3.222, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "episodes_total": 1472, "training_iteration": 46, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-31-30", "timestamp": 1709019090, "time_this_iter_s": 169.8978033065796, "time_total_s": 7924.407469749451, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7924.407469749451, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 15.236250000000002, "ram_util_percent": 11.872916666666669}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.36, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.02, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.02, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8267610187797497, "policy_loss": -0.08616952626034617, "vf_loss": 1.0876207942763965, "vf_explained_var": 0.47031316260496775, "kl": 0.0, "entropy": 105.09471638997395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.36, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.02, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.02, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -10.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.201719569026395, "mean_inference_ms": 26.044381658564017, "mean_action_processing_ms": 0.9077868708010299, "mean_env_wait_ms": 0.6069344594703068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.47795772552490234, "StateBufferConnector_ms": 0.012115955352783203, "ViewRequirementAgentConnector_ms": 0.43771791458129883}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -10.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.201719569026395, "mean_inference_ms": 26.044381658564017, "mean_action_processing_ms": 0.9077868708010299, "mean_env_wait_ms": 0.6069344594703068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.47795772552490234, "StateBufferConnector_ms": 0.012115955352783203, "ViewRequirementAgentConnector_ms": 0.43771791458129883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1217793565516745, "num_agent_steps_trained_throughput_per_sec": 3.1217793565516745, "timesteps_total": 24064, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24064, "timers": {"training_iteration_time_ms": 172916.347, "sample_time_ms": 15757.384, "load_time_ms": 1.456, "load_throughput": 351763.935, "learn_time_ms": 157156.382, "learn_throughput": 3.258, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "done": false, "episodes_total": 1504, "training_iteration": 47, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-34-14", "timestamp": 1709019254, "time_this_iter_s": 164.01883482933044, "time_total_s": 8088.426304578781, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8088.426304578781, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 15.180172413793102, "ram_util_percent": 11.924137931034485}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.48, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.4988561618452271, "policy_loss": -0.09692397930969794, "vf_loss": 0.7097833164036274, "vf_explained_var": 0.8616228391726811, "kl": 0.0, "entropy": 105.42510509490967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.48, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.48, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01625, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2001597141841405, "mean_inference_ms": 26.040495851832528, "mean_action_processing_ms": 0.9076077167562369, "mean_env_wait_ms": 0.6076020843345161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.601109504699707, "StateBufferConnector_ms": 0.012049674987792969, "ViewRequirementAgentConnector_ms": 0.436084508895874}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.48, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2001597141841405, "mean_inference_ms": 26.040495851832528, "mean_action_processing_ms": 0.9076077167562369, "mean_env_wait_ms": 0.6076020843345161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.601109504699707, "StateBufferConnector_ms": 0.012049674987792969, "ViewRequirementAgentConnector_ms": 0.436084508895874}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.0504589699405584, "num_agent_steps_trained_throughput_per_sec": 3.0504589699405584, "timesteps_total": 24576, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 172397.204, "sample_time_ms": 15793.043, "load_time_ms": 1.452, "load_throughput": 352555.104, "learn_time_ms": 156601.582, "learn_throughput": 3.269, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 1536, "training_iteration": 48, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-37-02", "timestamp": 1709019422, "time_this_iter_s": 167.85681653022766, "time_total_s": 8256.283121109009, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8256.283121109009, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 14.916877637130803, "ram_util_percent": 11.965822784810127}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.4, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.5069365800668797, "policy_loss": -0.07147515178658068, "vf_loss": 1.8804425172507764, "vf_explained_var": 0.6335973843932152, "kl": 0.0, "entropy": 104.75140342712402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.4, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.200414386282739, "mean_inference_ms": 26.030630622032227, "mean_action_processing_ms": 0.9075826355299106, "mean_env_wait_ms": 0.608699147535785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6632363796234131, "StateBufferConnector_ms": 0.012070655822753906, "ViewRequirementAgentConnector_ms": 0.4215576648712158}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.200414386282739, "mean_inference_ms": 26.030630622032227, "mean_action_processing_ms": 0.9075826355299106, "mean_env_wait_ms": 0.608699147535785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6632363796234131, "StateBufferConnector_ms": 0.012070655822753906, "ViewRequirementAgentConnector_ms": 0.4215576648712158}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.919250893555178, "num_agent_steps_trained_throughput_per_sec": 2.919250893555178, "timesteps_total": 25088, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25088, "timers": {"training_iteration_time_ms": 171988.402, "sample_time_ms": 15703.87, "load_time_ms": 1.447, "load_throughput": 353768.948, "learn_time_ms": 156281.982, "learn_throughput": 3.276, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "done": false, "episodes_total": 1568, "training_iteration": 49, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-39-58", "timestamp": 1709019598, "time_this_iter_s": 175.41287755966187, "time_total_s": 8431.69599866867, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8431.69599866867, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 14.776612903225805, "ram_util_percent": 11.963709677419354}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.56, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6898473028404017, "policy_loss": -0.0711261527457585, "vf_loss": 0.9065865563849608, "vf_explained_var": 0.8039142146706582, "kl": 0.0, "entropy": 104.06137371063232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.56, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.01375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.01375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.201947742184111, "mean_inference_ms": 26.016304947372657, "mean_action_processing_ms": 0.9084681395400076, "mean_env_wait_ms": 0.60858572029249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6703827381134033, "StateBufferConnector_ms": 0.012120485305786133, "ViewRequirementAgentConnector_ms": 0.45305633544921875}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.201947742184111, "mean_inference_ms": 26.016304947372657, "mean_action_processing_ms": 0.9084681395400076, "mean_env_wait_ms": 0.60858572029249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6703827381134033, "StateBufferConnector_ms": 0.012120485305786133, "ViewRequirementAgentConnector_ms": 0.45305633544921875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9438732036424327, "num_agent_steps_trained_throughput_per_sec": 2.9438732036424327, "timesteps_total": 25600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 171536.962, "sample_time_ms": 15699.4, "load_time_ms": 1.084, "load_throughput": 472504.048, "learn_time_ms": 155835.377, "learn_throughput": 3.286, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 1600, "training_iteration": 50, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-42-52", "timestamp": 1709019772, "time_this_iter_s": 173.93563652038574, "time_total_s": 8605.631635189056, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8605.631635189056, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 15.166260162601624, "ram_util_percent": 11.8979674796748}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.46, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.016875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.016875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.7015982761047781, "policy_loss": -0.08956253436238816, "vf_loss": 0.9425502899723749, "vf_explained_var": 0.8900134573380153, "kl": 0.0, "entropy": 103.94632231394449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.46, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.46, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.016875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.016875, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -12.0, -16.0, -14.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2002925555907096, "mean_inference_ms": 25.985238770119217, "mean_action_processing_ms": 0.9076858713164532, "mean_env_wait_ms": 0.6079296060154402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5989408493041992, "StateBufferConnector_ms": 0.00995779037475586, "ViewRequirementAgentConnector_ms": 0.45456528663635254}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.46, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -10.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -12.0, -16.0, -14.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2002925555907096, "mean_inference_ms": 25.985238770119217, "mean_action_processing_ms": 0.9076858713164532, "mean_env_wait_ms": 0.6079296060154402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5989408493041992, "StateBufferConnector_ms": 0.00995779037475586, "ViewRequirementAgentConnector_ms": 0.45456528663635254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.152717091956711, "num_agent_steps_trained_throughput_per_sec": 3.152717091956711, "timesteps_total": 26112, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26112, "timers": {"training_iteration_time_ms": 170453.138, "sample_time_ms": 15432.453, "load_time_ms": 1.512, "load_throughput": 338532.931, "learn_time_ms": 155018.668, "learn_throughput": 3.303, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "done": false, "episodes_total": 1632, "training_iteration": 51, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-45-34", "timestamp": 1709019934, "time_this_iter_s": 162.41561794281006, "time_total_s": 8768.047253131866, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8768.047253131866, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 15.191266375545853, "ram_util_percent": 11.897379912663757}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.54, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.014375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.014375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5377258908003568, "policy_loss": -0.08943103107934197, "vf_loss": 0.7471640720342596, "vf_explained_var": 0.772225355108579, "kl": 0.0, "entropy": 105.29639689127605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "sampler_results": {"episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.54, "reward_total_min": -16, "reward_total_max": -10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.014375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.1875, "reward_score_mean": 0.014375, "reward_score_min": 0.0, "reward_score_max": 0.1875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -12.0, -16.0, -14.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2003412906707185, "mean_inference_ms": 25.973852197686732, "mean_action_processing_ms": 0.908193000355294, "mean_env_wait_ms": 0.6077502952136109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5828585624694824, "StateBufferConnector_ms": 0.010004758834838867, "ViewRequirementAgentConnector_ms": 0.4886350631713867}}, "episode_reward_max": -10.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -12.0, -16.0, -14.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2003412906707185, "mean_inference_ms": 25.973852197686732, "mean_action_processing_ms": 0.908193000355294, "mean_env_wait_ms": 0.6077502952136109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5828585624694824, "StateBufferConnector_ms": 0.010004758834838867, "ViewRequirementAgentConnector_ms": 0.4886350631713867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9277159611767485, "num_agent_steps_trained_throughput_per_sec": 2.9277159611767485, "timesteps_total": 26624, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 169703.178, "sample_time_ms": 15459.811, "load_time_ms": 0.695, "load_throughput": 736776.906, "learn_time_ms": 154242.2, "learn_throughput": 3.319, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "episodes_total": 1664, "training_iteration": 52, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-48-29", "timestamp": 1709020109, "time_this_iter_s": 174.89325833320618, "time_total_s": 8942.940511465073, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8942.940511465073, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 15.24758064516129, "ram_util_percent": 11.90403225806452}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.22, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.024375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.024375, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.097078204403321, "policy_loss": -0.06883800231541197, "vf_loss": 1.3890155179426074, "vf_explained_var": 0.8652277986208597, "kl": 0.0, "entropy": 104.8209280649821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.22, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.22, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.024375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.024375, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -12.0, -16.0, -14.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -12.0, -16.0, -4.0, -10.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1988354546666016, "mean_inference_ms": 25.96656528930871, "mean_action_processing_ms": 0.9080882997629698, "mean_env_wait_ms": 0.6078076665814953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5914533138275146, "StateBufferConnector_ms": 0.02536296844482422, "ViewRequirementAgentConnector_ms": 0.43567419052124023}}, "episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.22, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -14.0, -12.0, -16.0, -14.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -12.0, -16.0, -4.0, -10.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1988354546666016, "mean_inference_ms": 25.96656528930871, "mean_action_processing_ms": 0.9080882997629698, "mean_env_wait_ms": 0.6078076665814953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5914533138275146, "StateBufferConnector_ms": 0.02536296844482422, "ViewRequirementAgentConnector_ms": 0.43567419052124023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1087670023580096, "num_agent_steps_trained_throughput_per_sec": 3.1087670023580096, "timesteps_total": 27136, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27136, "timers": {"training_iteration_time_ms": 168659.788, "sample_time_ms": 15430.373, "load_time_ms": 0.695, "load_throughput": 736524.213, "learn_time_ms": 153228.204, "learn_throughput": 3.341, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "done": false, "episodes_total": 1696, "training_iteration": 53, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-51-14", "timestamp": 1709020274, "time_this_iter_s": 164.71024560928345, "time_total_s": 9107.650757074356, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9107.650757074356, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 15.164655172413791, "ram_util_percent": 11.927586206896553}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -15.12, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0275, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.0275, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.9319782036046187, "policy_loss": -0.10152473617345095, "vf_loss": 1.2312648410598437, "vf_explained_var": 0.9449408526221911, "kl": 0.0, "entropy": 105.539381980896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -15.12, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0275, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.0275, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -12.0, -16.0, -4.0, -10.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1977278429313376, "mean_inference_ms": 25.963999813991414, "mean_action_processing_ms": 0.9091945688606262, "mean_env_wait_ms": 0.608028564795601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5807464122772217, "StateBufferConnector_ms": 0.020170927047729492, "ViewRequirementAgentConnector_ms": 0.44517087936401367}}, "episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -15.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -14.0, -14.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -12.0, -16.0, -4.0, -10.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1977278429313376, "mean_inference_ms": 25.963999813991414, "mean_action_processing_ms": 0.9091945688606262, "mean_env_wait_ms": 0.608028564795601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5807464122772217, "StateBufferConnector_ms": 0.020170927047729492, "ViewRequirementAgentConnector_ms": 0.44517087936401367}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9947301816322356, "num_agent_steps_trained_throughput_per_sec": 2.9947301816322356, "timesteps_total": 27648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 169389.489, "sample_time_ms": 15342.77, "load_time_ms": 0.697, "load_throughput": 734885.924, "learn_time_ms": 154045.5, "learn_throughput": 3.324, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "episodes_total": 1728, "training_iteration": 54, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-54-05", "timestamp": 1709020445, "time_this_iter_s": 170.97740507125854, "time_total_s": 9278.628162145615, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9278.628162145615, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 14.886363636363637, "ram_util_percent": 11.99710743801653}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.72, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.04, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.04, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6850170190135638, "policy_loss": -0.09279584279671932, "vf_loss": 0.9266481913626194, "vf_explained_var": 0.9245290984710057, "kl": 0.0, "entropy": 105.48087266286214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "sampler_results": {"episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.72, "reward_total_min": -16, "reward_total_max": -4, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.04, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.04, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -12.0, -16.0, -4.0, -10.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.197494531354266, "mean_inference_ms": 25.96538762264383, "mean_action_processing_ms": 0.9118649539321376, "mean_env_wait_ms": 0.6096772101017838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6565670967102051, "StateBufferConnector_ms": 0.021074771881103516, "ViewRequirementAgentConnector_ms": 0.4772300720214844}}, "episode_reward_max": -4.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -12.0, -16.0, -4.0, -10.0, -16.0, -16.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.197494531354266, "mean_inference_ms": 25.96538762264383, "mean_action_processing_ms": 0.9118649539321376, "mean_env_wait_ms": 0.6096772101017838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6565670967102051, "StateBufferConnector_ms": 0.021074771881103516, "ViewRequirementAgentConnector_ms": 0.4772300720214844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.90044399638566, "num_agent_steps_trained_throughput_per_sec": 4.90044399638566, "timesteps_total": 28160, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28160, "timers": {"training_iteration_time_ms": 162847.439, "sample_time_ms": 15609.251, "load_time_ms": 0.699, "load_throughput": 732729.51, "learn_time_ms": 147236.948, "learn_throughput": 3.477, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "done": false, "episodes_total": 1760, "training_iteration": 55, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-55-49", "timestamp": 1709020549, "time_this_iter_s": 104.49342775344849, "time_total_s": 9383.121589899063, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9383.121589899063, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.001360544217686, "ram_util_percent": 9.337414965986396}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.7, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.040625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.040625, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.147264729688565, "policy_loss": -0.071705098139743, "vf_loss": 1.452221017330885, "vf_explained_var": 0.70874432772398, "kl": 0.0, "entropy": 105.45454788208008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.7, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.040625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.040625, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -14.0, -14.0, -16.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1953850934760886, "mean_inference_ms": 25.941256861274482, "mean_action_processing_ms": 0.9157577472443154, "mean_env_wait_ms": 0.6110950328961181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6209027767181396, "StateBufferConnector_ms": 0.008936643600463867, "ViewRequirementAgentConnector_ms": 0.49066925048828125}}, "episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -14.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -14.0, -14.0, -16.0, -2.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1953850934760886, "mean_inference_ms": 25.941256861274482, "mean_action_processing_ms": 0.9157577472443154, "mean_env_wait_ms": 0.6110950328961181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6209027767181396, "StateBufferConnector_ms": 0.008936643600463867, "ViewRequirementAgentConnector_ms": 0.49066925048828125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.486692878072521, "num_agent_steps_trained_throughput_per_sec": 3.486692878072521, "timesteps_total": 28672, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 160542.711, "sample_time_ms": 15437.831, "load_time_ms": 0.701, "load_throughput": 730859.221, "learn_time_ms": 145103.014, "learn_throughput": 3.529, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 1792, "training_iteration": 56, "trial_id": "1b5c8_00222", "date": "2024-02-27_08-58-16", "timestamp": 1709020696, "time_this_iter_s": 146.85070061683655, "time_total_s": 9529.9722905159, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9529.9722905159, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.08550724637681, "ram_util_percent": 9.730917874396134}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.62, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.043125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.043125, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.036296911040942, "policy_loss": 0.16471176923563083, "vf_loss": 1.0383639152161777, "vf_explained_var": 0.8834093143542607, "kl": 0.0, "entropy": 109.43169498443604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "sampler_results": {"episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.62, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.62, "reward_total_min": -16, "reward_total_max": -2, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.043125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4375, "reward_score_mean": 0.043125, "reward_score_min": 0.0, "reward_score_max": 0.4375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -16.0, -16.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -14.0, -14.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1944177925338963, "mean_inference_ms": 25.932744249798343, "mean_action_processing_ms": 0.9192462136621813, "mean_env_wait_ms": 0.6133333919554215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6640355587005615, "StateBufferConnector_ms": 0.008949995040893555, "ViewRequirementAgentConnector_ms": 0.538642168045044}}, "episode_reward_max": -2.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.62, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -12.0, -16.0, -16.0, -16.0, -4.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -10.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -14.0, -14.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1944177925338963, "mean_inference_ms": 25.932744249798343, "mean_action_processing_ms": 0.9192462136621813, "mean_env_wait_ms": 0.6133333919554215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6640355587005615, "StateBufferConnector_ms": 0.008949995040893555, "ViewRequirementAgentConnector_ms": 0.538642168045044}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.9910066826575994, "num_agent_steps_trained_throughput_per_sec": 2.9910066826575994, "timesteps_total": 29184, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29184, "timers": {"training_iteration_time_ms": 161259.791, "sample_time_ms": 15490.163, "load_time_ms": 0.707, "load_throughput": 723765.174, "learn_time_ms": 145765.765, "learn_throughput": 3.512, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "done": false, "episodes_total": 1824, "training_iteration": 57, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-01-08", "timestamp": 1709020868, "time_this_iter_s": 171.19094252586365, "time_total_s": 9701.163233041763, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9701.163233041763, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 16.622222222222224, "ram_util_percent": 9.860905349794239}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -14.1, "reward_total_min": -16, "reward_total_max": 6, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.059375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6875, "reward_score_mean": 0.059375, "reward_score_min": 0.0, "reward_score_max": 0.6875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.5731281995773316, "policy_loss": -0.06670636882384619, "vf_loss": 1.9536187122265498, "vf_explained_var": 0.9437866980830828, "kl": 0.0, "entropy": 105.8788849512736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "sampler_results": {"episode_reward_max": 6.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.1, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -14.1, "reward_total_min": -16, "reward_total_max": 6, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.059375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.6875, "reward_score_mean": 0.059375, "reward_score_min": 0.0, "reward_score_max": 0.6875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -14.0, -14.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -6.0, 0.0, -16.0, 6.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.190680732623048, "mean_inference_ms": 25.912177499642997, "mean_action_processing_ms": 0.9204157571421407, "mean_env_wait_ms": 0.6144716198026035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5850210189819336, "StateBufferConnector_ms": 0.008019685745239258, "ViewRequirementAgentConnector_ms": 0.4947669506072998}}, "episode_reward_max": 6.0, "episode_reward_min": -16.0, "episode_reward_mean": -14.1, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -16.0, -16.0, -16.0, -12.0, -16.0, -14.0, -14.0, -14.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -6.0, 0.0, -16.0, 6.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -4.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.190680732623048, "mean_inference_ms": 25.912177499642997, "mean_action_processing_ms": 0.9204157571421407, "mean_env_wait_ms": 0.6144716198026035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5850210189819336, "StateBufferConnector_ms": 0.008019685745239258, "ViewRequirementAgentConnector_ms": 0.4947669506072998}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.235219452564702, "num_agent_steps_trained_throughput_per_sec": 3.235219452564702, "timesteps_total": 29696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 160301.253, "sample_time_ms": 15394.257, "load_time_ms": 0.711, "load_throughput": 720535.38, "learn_time_ms": 144903.136, "learn_throughput": 3.533, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "episodes_total": 1856, "training_iteration": 58, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-03-46", "timestamp": 1709021026, "time_this_iter_s": 158.26628041267395, "time_total_s": 9859.429513454437, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9859.429513454437, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.747767857142858, "ram_util_percent": 11.984375}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -13.16, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.08875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.08875, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.4197687551379203, "policy_loss": -0.08075341871784379, "vf_loss": 1.7876487297316392, "vf_explained_var": 0.9294733439882596, "kl": 0.0, "entropy": 107.5523276646932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -13.16, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.08875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.08875, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-14.0, -14.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -6.0, 0.0, -16.0, 6.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -2.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.188272166948558, "mean_inference_ms": 25.901561448499756, "mean_action_processing_ms": 0.9202646550949504, "mean_env_wait_ms": 0.6145755629345815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.640026330947876, "StateBufferConnector_ms": 0.006273031234741211, "ViewRequirementAgentConnector_ms": 0.4364023208618164}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -13.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.0, -14.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -6.0, 0.0, -16.0, 6.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -2.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.188272166948558, "mean_inference_ms": 25.901561448499756, "mean_action_processing_ms": 0.9202646550949504, "mean_env_wait_ms": 0.6145755629345815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.640026330947876, "StateBufferConnector_ms": 0.006273031234741211, "ViewRequirementAgentConnector_ms": 0.4364023208618164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.752588992456241, "num_agent_steps_trained_throughput_per_sec": 3.752588992456241, "timesteps_total": 30208, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30208, "timers": {"training_iteration_time_ms": 156406.42, "sample_time_ms": 15382.917, "load_time_ms": 0.714, "load_throughput": 717334.285, "learn_time_ms": 141019.628, "learn_throughput": 3.631, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "done": false, "episodes_total": 1888, "training_iteration": 59, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-06-03", "timestamp": 1709021163, "time_this_iter_s": 136.44392824172974, "time_total_s": 9995.873441696167, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9995.873441696167, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.132291666666664, "ram_util_percent": 13.814583333333331}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.34, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.114375, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.3619340101877848, "policy_loss": -0.06027309893785666, "vf_loss": 1.6943479875723522, "vf_explained_var": 0.96338243385156, "kl": 0.0, "entropy": 108.50101839701334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.34, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.114375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.114375, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -6.0, 0.0, -16.0, 6.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -2.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -6.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.185311329085201, "mean_inference_ms": 25.88021794421785, "mean_action_processing_ms": 0.9193632381900884, "mean_env_wait_ms": 0.613757738096094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6105906963348389, "StateBufferConnector_ms": 0.008774995803833008, "ViewRequirementAgentConnector_ms": 0.4230191707611084}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -6.0, -16.0, -16.0, -6.0, 0.0, -16.0, 6.0, -16.0, -10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -8.0, -16.0, -16.0, -4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -2.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -6.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.185311329085201, "mean_inference_ms": 25.88021794421785, "mean_action_processing_ms": 0.9193632381900884, "mean_env_wait_ms": 0.613757738096094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6105906963348389, "StateBufferConnector_ms": 0.008774995803833008, "ViewRequirementAgentConnector_ms": 0.4230191707611084}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.3943723549082865, "num_agent_steps_trained_throughput_per_sec": 3.3943723549082865, "timesteps_total": 30720, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 154098.159, "sample_time_ms": 15310.583, "load_time_ms": 0.711, "load_throughput": 719907.358, "learn_time_ms": 138783.714, "learn_throughput": 3.689, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "episodes_total": 1920, "training_iteration": 60, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-08-34", "timestamp": 1709021314, "time_this_iter_s": 150.84263610839844, "time_total_s": 10146.716077804565, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10146.716077804565, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 23.0285046728972, "ram_util_percent": 14.061214953271026}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.42, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.143125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.143125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 2.9059784760077796, "policy_loss": 0.052228162072909375, "vf_loss": 3.399818571905295, "vf_explained_var": 0.921561494966348, "kl": 0.0, "entropy": 109.86585006713867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.42, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.42, "reward_total_min": -16, "reward_total_max": 10, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.143125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.8125, "reward_score_mean": 0.143125, "reward_score_min": 0.0, "reward_score_max": 0.8125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-8.0, -16.0, -16.0, -4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -2.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 6.0, -4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -6.0, -16.0, -16.0, 4.0, -4.0, -16.0, -16.0, -16.0, -4.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.183626985860916, "mean_inference_ms": 25.87611460418251, "mean_action_processing_ms": 0.91786374879986, "mean_env_wait_ms": 0.612138487214845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6168622970581055, "StateBufferConnector_ms": 0.012709617614746094, "ViewRequirementAgentConnector_ms": 0.38065195083618164}}, "episode_reward_max": 10.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.42, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-8.0, -16.0, -16.0, -4.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -6.0, 10.0, -16.0, -16.0, -16.0, -16.0, -4.0, -16.0, -16.0, -16.0, -16.0, -2.0, -2.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 6.0, -4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -6.0, -16.0, -16.0, 4.0, -4.0, -16.0, -16.0, -16.0, -4.0, 8.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.183626985860916, "mean_inference_ms": 25.87611460418251, "mean_action_processing_ms": 0.91786374879986, "mean_env_wait_ms": 0.612138487214845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6168622970581055, "StateBufferConnector_ms": 0.012709617614746094, "ViewRequirementAgentConnector_ms": 0.38065195083618164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.6178151963741962, "num_agent_steps_trained_throughput_per_sec": 3.6178151963741962, "timesteps_total": 31232, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31232, "timers": {"training_iteration_time_ms": 152010.386, "sample_time_ms": 15576.71, "load_time_ms": 0.274, "load_throughput": 1869815.976, "learn_time_ms": 136430.255, "learn_throughput": 3.753, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "done": false, "episodes_total": 1952, "training_iteration": 61, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-10-55", "timestamp": 1709021455, "time_this_iter_s": 141.52665638923645, "time_total_s": 10288.242734193802, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10288.242734193802, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 23.380499999999998, "ram_util_percent": 14.054999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.7, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.134375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.134375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1846296469370523, "policy_loss": -0.08845360040043791, "vf_loss": 1.516689103624473, "vf_explained_var": 0.9688451980551084, "kl": 0.0, "entropy": 111.49641602834066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.7, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.134375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.134375, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 6.0, -4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -6.0, -16.0, -16.0, 4.0, -4.0, -16.0, -16.0, -16.0, -4.0, 8.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.185407681655125, "mean_inference_ms": 25.898687932386885, "mean_action_processing_ms": 0.9178377209462295, "mean_env_wait_ms": 0.6120769025150163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7014241218566895, "StateBufferConnector_ms": 0.017788171768188477, "ViewRequirementAgentConnector_ms": 0.44817233085632324}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, -16.0, -16.0, -16.0, 0.0, -16.0, 2.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 6.0, -4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -6.0, -16.0, -16.0, 4.0, -4.0, -16.0, -16.0, -16.0, -4.0, 8.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.185407681655125, "mean_inference_ms": 25.898687932386885, "mean_action_processing_ms": 0.9178377209462295, "mean_env_wait_ms": 0.6120769025150163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7014241218566895, "StateBufferConnector_ms": 0.017788171768188477, "ViewRequirementAgentConnector_ms": 0.44817233085632324}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1685631476706737, "num_agent_steps_trained_throughput_per_sec": 3.1685631476706737, "timesteps_total": 31744, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 150681.094, "sample_time_ms": 15694.403, "load_time_ms": 0.28, "load_throughput": 1825315.468, "learn_time_ms": 134983.261, "learn_throughput": 3.793, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "episodes_total": 1984, "training_iteration": 62, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-13-37", "timestamp": 1709021617, "time_this_iter_s": 161.6072292327881, "time_total_s": 10449.84996342659, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10449.84996342659, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.625877192982454, "ram_util_percent": 14.090350877192982}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.56, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.13875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.2746015921235085, "policy_loss": -0.06669470333339025, "vf_loss": 1.5979548156261445, "vf_explained_var": 0.9923401807745298, "kl": 0.0, "entropy": 112.48784993489583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.56, "reward_total_min": -16, "reward_total_max": 8, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.75, "reward_score_mean": 0.13875, "reward_score_min": 0.0, "reward_score_max": 0.75, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 6.0, -4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -6.0, -16.0, -16.0, 4.0, -4.0, -16.0, -16.0, -16.0, -4.0, 8.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, 6.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1872692146776433, "mean_inference_ms": 25.926701649935904, "mean_action_processing_ms": 0.9181884141771282, "mean_env_wait_ms": 0.6121515787002965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6589343547821045, "StateBufferConnector_ms": 0.021858930587768555, "ViewRequirementAgentConnector_ms": 0.4478118419647217}}, "episode_reward_max": 8.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, -2.0, -16.0, -16.0, -16.0, 6.0, -4.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, 0.0, -6.0, -16.0, -16.0, 4.0, -4.0, -16.0, -16.0, -16.0, -4.0, 8.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, 6.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1872692146776433, "mean_inference_ms": 25.926701649935904, "mean_action_processing_ms": 0.9181884141771282, "mean_env_wait_ms": 0.6121515787002965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6589343547821045, "StateBufferConnector_ms": 0.021858930587768555, "ViewRequirementAgentConnector_ms": 0.4478118419647217}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.536719941306504, "num_agent_steps_trained_throughput_per_sec": 3.536719941306504, "timesteps_total": 32256, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 148688.232, "sample_time_ms": 15677.455, "load_time_ms": 0.277, "load_throughput": 1845075.735, "learn_time_ms": 133007.379, "learn_throughput": 3.849, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 2016, "training_iteration": 63, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-16-02", "timestamp": 1709021762, "time_this_iter_s": 144.775239944458, "time_total_s": 10594.625203371048, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10594.625203371048, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 23.51365853658537, "ram_util_percent": 14.069268292682926}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.68, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.16625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.6502636378010114, "policy_loss": -0.09618688089928279, "vf_loss": 2.0806357329090437, "vf_explained_var": 0.9911638990044593, "kl": 0.0, "entropy": 111.40802536010742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.68, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.16625, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -4.0, 8.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, 6.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, 10.0, 4.0, -16.0, 4.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.193258931639991, "mean_inference_ms": 25.98107257990422, "mean_action_processing_ms": 0.9215781266971145, "mean_env_wait_ms": 0.6152851535759952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6771664619445801, "StateBufferConnector_ms": 0.022130489349365234, "ViewRequirementAgentConnector_ms": 0.5051743984222412}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -4.0, 8.0, -16.0, 0.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, 4.0, -16.0, -2.0, -16.0, -16.0, -16.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, 6.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, 10.0, 4.0, -16.0, 4.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.193258931639991, "mean_inference_ms": 25.98107257990422, "mean_action_processing_ms": 0.9215781266971145, "mean_env_wait_ms": 0.6152851535759952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6771664619445801, "StateBufferConnector_ms": 0.022130489349365234, "ViewRequirementAgentConnector_ms": 0.5051743984222412}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.7296575641847, "num_agent_steps_trained_throughput_per_sec": 3.7296575641847, "timesteps_total": 32768, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 145319.334, "sample_time_ms": 16239.801, "load_time_ms": 0.277, "load_throughput": 1848410.783, "learn_time_ms": 129076.131, "learn_throughput": 3.967, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 2048, "training_iteration": 64, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-18-19", "timestamp": 1709021899, "time_this_iter_s": 137.28330326080322, "time_total_s": 10731.908506631851, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10731.908506631851, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.839690721649482, "ram_util_percent": 14.027319587628865}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1610486840208372, "policy_loss": -0.06165742356485377, "vf_loss": 1.4566722442706426, "vf_explained_var": 0.9942330867052078, "kl": 0.0, "entropy": 109.93031787872314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "sampler_results": {"episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.56, "reward_total_min": -16, "reward_total_max": 12, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17, "reward_percentile_min": 0.0, "reward_percentile_max": 0.875, "reward_score_mean": 0.17, "reward_score_min": 0.0, "reward_score_max": 0.875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, 6.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, 10.0, 4.0, -16.0, 4.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1946547146914326, "mean_inference_ms": 26.00978618487432, "mean_action_processing_ms": 0.9231073158662525, "mean_env_wait_ms": 0.6169658837098708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.597041130065918, "StateBufferConnector_ms": 0.011678218841552734, "ViewRequirementAgentConnector_ms": 0.4525320529937744}}, "episode_reward_max": 12.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, 6.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, 2.0, 6.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, 10.0, 4.0, -16.0, 4.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1946547146914326, "mean_inference_ms": 26.00978618487432, "mean_action_processing_ms": 0.9231073158662525, "mean_env_wait_ms": 0.6169658837098708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.597041130065918, "StateBufferConnector_ms": 0.011678218841552734, "ViewRequirementAgentConnector_ms": 0.4525320529937744}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.6238357980264655, "num_agent_steps_trained_throughput_per_sec": 3.6238357980264655, "timesteps_total": 33280, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33280, "timers": {"training_iteration_time_ms": 148999.977, "sample_time_ms": 15972.945, "load_time_ms": 0.274, "load_throughput": 1869653.185, "learn_time_ms": 133023.655, "learn_throughput": 3.849, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "done": false, "episodes_total": 2080, "training_iteration": 65, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-20-41", "timestamp": 1709022041, "time_this_iter_s": 141.29603576660156, "time_total_s": 10873.204542398453, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10873.204542398453, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 23.6725, "ram_util_percent": 14.013}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.06, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.185625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.185625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.747321347395579, "policy_loss": -0.06495952936044584, "vf_loss": 2.159062800804774, "vf_explained_var": 0.9953596333662669, "kl": 0.0, "entropy": 110.26987012227376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.06, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.185625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.185625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, 10.0, 4.0, -16.0, 4.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 10.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, 10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.196588476301066, "mean_inference_ms": 26.038615339883467, "mean_action_processing_ms": 0.9247347861684116, "mean_env_wait_ms": 0.618549302240108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5558273792266846, "StateBufferConnector_ms": 0.01859450340270996, "ViewRequirementAgentConnector_ms": 0.49005699157714844}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 2.0, -16.0, 4.0, 10.0, 4.0, -16.0, 4.0, -16.0, -16.0, -16.0, 12.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, 4.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 10.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, 10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.196588476301066, "mean_inference_ms": 26.038615339883467, "mean_action_processing_ms": 0.9247347861684116, "mean_env_wait_ms": 0.618549302240108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5558273792266846, "StateBufferConnector_ms": 0.01859450340270996, "ViewRequirementAgentConnector_ms": 0.49005699157714844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.4275883707283357, "num_agent_steps_trained_throughput_per_sec": 3.4275883707283357, "timesteps_total": 33792, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 149253.192, "sample_time_ms": 16218.732, "load_time_ms": 0.274, "load_throughput": 1867052.38, "learn_time_ms": 133031.716, "learn_throughput": 3.849, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "episodes_total": 2112, "training_iteration": 66, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-23-10", "timestamp": 1709022190, "time_this_iter_s": 149.38507747650146, "time_total_s": 11022.589619874954, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11022.589619874954, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 23.581428571428575, "ram_util_percent": 13.980952380952381}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.3, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.146875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.146875, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.7083032680054506, "policy_loss": -0.06298321078065783, "vf_loss": 2.1102240711450575, "vf_explained_var": 0.9783985028664272, "kl": 0.0, "entropy": 110.40700810750326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.3, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.3, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.146875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.146875, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 10.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.192382326526403, "mean_inference_ms": 26.011597840282366, "mean_action_processing_ms": 0.9234815690154101, "mean_env_wait_ms": 0.6175120338268303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4944148063659668, "StateBufferConnector_ms": 0.014119625091552734, "ViewRequirementAgentConnector_ms": 0.44167184829711914}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.3, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 10.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.192382326526403, "mean_inference_ms": 26.011597840282366, "mean_action_processing_ms": 0.9234815690154101, "mean_env_wait_ms": 0.6175120338268303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4944148063659668, "StateBufferConnector_ms": 0.014119625091552734, "ViewRequirementAgentConnector_ms": 0.44167184829711914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.6447323183910125, "num_agent_steps_trained_throughput_per_sec": 3.6447323183910125, "timesteps_total": 34304, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34304, "timers": {"training_iteration_time_ms": 146182.88, "sample_time_ms": 15862.647, "load_time_ms": 0.27, "load_throughput": 1895061.461, "learn_time_ms": 130319.483, "learn_throughput": 3.929, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "done": false, "episodes_total": 2144, "training_iteration": 67, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-25-30", "timestamp": 1709022330, "time_this_iter_s": 140.48142004013062, "time_total_s": 11163.071039915085, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11163.071039915085, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 23.42060301507538, "ram_util_percent": 13.979899497487436}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.34, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.145625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.7556076116859913, "policy_loss": -0.030126522046824297, "vf_loss": 2.1274363074451683, "vf_explained_var": 0.9602187107006709, "kl": 0.0, "entropy": 110.56543553670248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.34, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.145625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.145625, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 10.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1804613612543555, "mean_inference_ms": 25.911021807794604, "mean_action_processing_ms": 0.920277247928568, "mean_env_wait_ms": 0.6153212546104129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4139840602874756, "StateBufferConnector_ms": 0.014037609100341797, "ViewRequirementAgentConnector_ms": 0.37420129776000977}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 10.0, -16.0, -16.0, -16.0, 8.0, -16.0, -16.0, -16.0, 10.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1804613612543555, "mean_inference_ms": 25.911021807794604, "mean_action_processing_ms": 0.920277247928568, "mean_env_wait_ms": 0.6153212546104129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4139840602874756, "StateBufferConnector_ms": 0.014037609100341797, "ViewRequirementAgentConnector_ms": 0.37420129776000977}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.3106668481168455, "num_agent_steps_trained_throughput_per_sec": 4.3106668481168455, "timesteps_total": 34816, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 142234.573, "sample_time_ms": 14940.825, "load_time_ms": 0.266, "load_throughput": 1922890.086, "learn_time_ms": 127293.011, "learn_throughput": 4.022, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "episodes_total": 2176, "training_iteration": 68, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-27-29", "timestamp": 1709022449, "time_this_iter_s": 118.78812527656555, "time_total_s": 11281.85916519165, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11281.85916519165, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.685119047619047, "ram_util_percent": 14.051785714285714}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 2.999491600195567, "policy_loss": 0.024153649318031968, "vf_loss": 3.544672139485677, "vf_explained_var": 0.9945611466964086, "kl": 0.0, "entropy": 108.6212220509847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, 6.0, 10.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, 12.0, -16.0, 12.0, -16.0, -16.0, 4.0, 12.0, -16.0, -16.0, -16.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.164749294736689, "mean_inference_ms": 25.778419312698446, "mean_action_processing_ms": 0.9160852619623856, "mean_env_wait_ms": 0.612707495909547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3888852596282959, "StateBufferConnector_ms": 0.0071032047271728516, "ViewRequirementAgentConnector_ms": 0.30239224433898926}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, 6.0, 10.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, 12.0, -16.0, 12.0, -16.0, -16.0, 4.0, 12.0, -16.0, -16.0, -16.0, 12.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.164749294736689, "mean_inference_ms": 25.778419312698446, "mean_action_processing_ms": 0.9160852619623856, "mean_env_wait_ms": 0.612707495909547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3888852596282959, "StateBufferConnector_ms": 0.0071032047271728516, "ViewRequirementAgentConnector_ms": 0.30239224433898926}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.2824296609411, "num_agent_steps_trained_throughput_per_sec": 4.2824296609411, "timesteps_total": 35328, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35328, "timers": {"training_iteration_time_ms": 140546.489, "sample_time_ms": 14619.81, "load_time_ms": 0.265, "load_throughput": 1929455.209, "learn_time_ms": 125925.954, "learn_throughput": 4.066, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "done": false, "episodes_total": 2208, "training_iteration": 69, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-29-29", "timestamp": 1709022569, "time_this_iter_s": 119.56300687789917, "time_total_s": 11401.42217206955, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11401.42217206955, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 23.716470588235293, "ram_util_percent": 14.007058823529414}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.34, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.176875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.176875, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6583801108102004, "policy_loss": -0.010130256476501624, "vf_loss": 0.7964305451139808, "vf_explained_var": 0.9569843878348668, "kl": 0.0, "entropy": 109.55191014607747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "sampler_results": {"episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.34, "reward_total_min": -16, "reward_total_max": 14, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.176875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.9375, "reward_score_mean": 0.176875, "reward_score_min": 0.0, "reward_score_max": 0.9375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, 6.0, 10.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, 12.0, -16.0, 12.0, -16.0, -16.0, 4.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.144686321567797, "mean_inference_ms": 25.61687018827399, "mean_action_processing_ms": 0.9113701733647779, "mean_env_wait_ms": 0.6097139974885323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3532066345214844, "StateBufferConnector_ms": 0.007048368453979492, "ViewRequirementAgentConnector_ms": 0.23182320594787598}}, "episode_reward_max": 14.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, 4.0, 10.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, 6.0, 10.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, 12.0, -16.0, 12.0, -16.0, -16.0, 4.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.144686321567797, "mean_inference_ms": 25.61687018827399, "mean_action_processing_ms": 0.9113701733647779, "mean_env_wait_ms": 0.6097139974885323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3532066345214844, "StateBufferConnector_ms": 0.007048368453979492, "ViewRequirementAgentConnector_ms": 0.23182320594787598}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.048827828928683, "num_agent_steps_trained_throughput_per_sec": 4.048827828928683, "timesteps_total": 35840, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 138108.335, "sample_time_ms": 14041.886, "load_time_ms": 0.269, "load_throughput": 1902954.052, "learn_time_ms": 124065.711, "learn_throughput": 4.127, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "episodes_total": 2240, "training_iteration": 70, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-31-35", "timestamp": 1709022695, "time_this_iter_s": 126.47400665283203, "time_total_s": 11527.896178722382, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11527.896178722382, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.53072625698324, "ram_util_percent": 13.998882681564247}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.190625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.190625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.6930703562994798, "policy_loss": 0.2276932182100912, "vf_loss": 1.7457786706276237, "vf_explained_var": 0.9660824288924535, "kl": 0.0, "entropy": 107.75066916147868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.190625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.190625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 10.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, 6.0, 10.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, 12.0, -16.0, 12.0, -16.0, -16.0, 4.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1273243892845306, "mean_inference_ms": 25.47545523492684, "mean_action_processing_ms": 0.9072506651029897, "mean_env_wait_ms": 0.606871151473797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42273712158203125, "StateBufferConnector_ms": 0.004564762115478516, "ViewRequirementAgentConnector_ms": 0.2643001079559326}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 10.0, -16.0, -16.0, 10.0, 12.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, 8.0, -16.0, 6.0, 10.0, -16.0, -16.0, -16.0, 2.0, 10.0, -16.0, 12.0, -16.0, 12.0, -16.0, -16.0, 4.0, 12.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1273243892845306, "mean_inference_ms": 25.47545523492684, "mean_action_processing_ms": 0.9072506651029897, "mean_env_wait_ms": 0.606871151473797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42273712158203125, "StateBufferConnector_ms": 0.004564762115478516, "ViewRequirementAgentConnector_ms": 0.2643001079559326}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352, "num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.193813635064303, "num_agent_steps_trained_throughput_per_sec": 4.193813635064303, "timesteps_total": 36352, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36352, "timers": {"training_iteration_time_ms": 136164.605, "sample_time_ms": 13225.733, "load_time_ms": 0.266, "load_throughput": 1924785.917, "learn_time_ms": 122938.139, "learn_throughput": 4.165, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 36352, "num_env_steps_trained": 36352, "num_agent_steps_sampled": 36352, "num_agent_steps_trained": 36352}, "done": false, "episodes_total": 2272, "training_iteration": 71, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-33-37", "timestamp": 1709022817, "time_this_iter_s": 122.08972406387329, "time_total_s": 11649.985902786255, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11649.985902786255, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 23.540116279069764, "ram_util_percent": 14.06220930232558}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.04, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.155, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.7280778353412947, "policy_loss": 0.056371673569083215, "vf_loss": 1.991588938732942, "vf_explained_var": 0.9980950112144152, "kl": 0.0, "entropy": 106.93367284138998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.04, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.04, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.155, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1107602270732206, "mean_inference_ms": 25.33926558017047, "mean_action_processing_ms": 0.9036054993394315, "mean_env_wait_ms": 0.6040715372246788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4449927806854248, "StateBufferConnector_ms": 0.004603147506713867, "ViewRequirementAgentConnector_ms": 0.28498291969299316}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.04, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1107602270732206, "mean_inference_ms": 25.33926558017047, "mean_action_processing_ms": 0.9036054993394315, "mean_env_wait_ms": 0.6040715372246788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4449927806854248, "StateBufferConnector_ms": 0.004603147506713867, "ViewRequirementAgentConnector_ms": 0.28498291969299316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.4517797139139565, "num_agent_steps_trained_throughput_per_sec": 4.4517797139139565, "timesteps_total": 36864, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 131506.88, "sample_time_ms": 12533.508, "load_time_ms": 0.261, "load_throughput": 1958668.048, "learn_time_ms": 118972.642, "learn_throughput": 4.304, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "episodes_total": 2304, "training_iteration": 72, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-35-33", "timestamp": 1709022933, "time_this_iter_s": 115.01492190361023, "time_total_s": 11765.000824689865, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11765.000824689865, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.522699386503067, "ram_util_percent": 14.074233128834358}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.38, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.238125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.238125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.783117916683356, "policy_loss": -0.05853328425437212, "vf_loss": 2.194053141027689, "vf_explained_var": 0.9979649454355239, "kl": 0.0, "entropy": 109.1068644841512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.38, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.238125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.238125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 14.0, 16.0, -16.0, 14.0, 14.0, 12.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0944756847705137, "mean_inference_ms": 25.199928513012836, "mean_action_processing_ms": 0.8997926918512665, "mean_env_wait_ms": 0.601147888865095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.46416306495666504, "StateBufferConnector_ms": 0.004583120346069336, "ViewRequirementAgentConnector_ms": 0.2940371036529541}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, 10.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 14.0, 16.0, -16.0, 14.0, 14.0, 12.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0944756847705137, "mean_inference_ms": 25.199928513012836, "mean_action_processing_ms": 0.8997926918512665, "mean_env_wait_ms": 0.601147888865095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.46416306495666504, "StateBufferConnector_ms": 0.004583120346069336, "ViewRequirementAgentConnector_ms": 0.2940371036529541}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376, "num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.582834341389929, "num_agent_steps_trained_throughput_per_sec": 4.582834341389929, "timesteps_total": 37376, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37376, "timers": {"training_iteration_time_ms": 128202.316, "sample_time_ms": 11836.794, "load_time_ms": 0.264, "load_throughput": 1936763.752, "learn_time_ms": 116364.806, "learn_throughput": 4.4, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 37376, "num_env_steps_trained": 37376, "num_agent_steps_sampled": 37376, "num_agent_steps_trained": 37376}, "done": false, "episodes_total": 2336, "training_iteration": 73, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-37-24", "timestamp": 1709023044, "time_this_iter_s": 111.72597241401672, "time_total_s": 11876.726797103882, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11876.726797103882, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 23.439873417721518, "ram_util_percent": 14.080379746835444}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.24375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.24375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.5776561384399732, "policy_loss": -0.03814439089037478, "vf_loss": 1.9249856953819593, "vf_explained_var": 0.9984634647766749, "kl": 0.0, "entropy": 109.12333532969157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.24375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.24375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 14.0, 16.0, -16.0, 14.0, 14.0, 12.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.080204655523123, "mean_inference_ms": 25.076760030326582, "mean_action_processing_ms": 0.8962901375177887, "mean_env_wait_ms": 0.5985387248340374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4247274398803711, "StateBufferConnector_ms": 0.0072574615478515625, "ViewRequirementAgentConnector_ms": 0.2810211181640625}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 14.0, 16.0, -16.0, 14.0, 14.0, 12.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.080204655523123, "mean_inference_ms": 25.076760030326582, "mean_action_processing_ms": 0.8962901375177887, "mean_env_wait_ms": 0.5985387248340374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4247274398803711, "StateBufferConnector_ms": 0.0072574615478515625, "ViewRequirementAgentConnector_ms": 0.2810211181640625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.9797769527354716, "num_agent_steps_trained_throughput_per_sec": 3.9797769527354716, "timesteps_total": 37888, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 127339.558, "sample_time_ms": 10834.246, "load_time_ms": 0.266, "load_throughput": 1921857.569, "learn_time_ms": 116504.607, "learn_throughput": 4.395, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "episodes_total": 2368, "training_iteration": 74, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-39-33", "timestamp": 1709023173, "time_this_iter_s": 128.65521264076233, "time_total_s": 12005.382009744644, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12005.382009744644, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 23.070879120879123, "ram_util_percent": 14.070329670329672}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.24625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.24625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.2406391973296802, "policy_loss": -0.02516386741772294, "vf_loss": 1.508015870054563, "vf_explained_var": 0.9990247815847397, "kl": 0.0, "entropy": 110.66726710001628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.12, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.24625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.24625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, 14.0, -16.0, 14.0, 16.0, -16.0, 14.0, 14.0, 12.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0678730943940864, "mean_inference_ms": 24.98427961562917, "mean_action_processing_ms": 0.8932688917738973, "mean_env_wait_ms": 0.5963317239430864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.41722583770751953, "StateBufferConnector_ms": 0.007269144058227539, "ViewRequirementAgentConnector_ms": 0.2782883644104004}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 14.0, 14.0, -16.0, 14.0, 16.0, -16.0, 14.0, 14.0, 12.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, 10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0678730943940864, "mean_inference_ms": 24.98427961562917, "mean_action_processing_ms": 0.8932688917738973, "mean_env_wait_ms": 0.5963317239430864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.41722583770751953, "StateBufferConnector_ms": 0.007269144058227539, "ViewRequirementAgentConnector_ms": 0.2782883644104004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.489770669047157, "num_agent_steps_trained_throughput_per_sec": 4.489770669047157, "timesteps_total": 38400, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 124614.583, "sample_time_ms": 10816.646, "load_time_ms": 0.265, "load_throughput": 1931711.476, "learn_time_ms": 113797.239, "learn_throughput": 4.499, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38400, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38400}, "done": false, "episodes_total": 2400, "training_iteration": 75, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-41-27", "timestamp": 1709023287, "time_this_iter_s": 114.05488538742065, "time_total_s": 12119.436895132065, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12119.436895132065, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 23.132098765432097, "ram_util_percent": 14.070370370370368}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.5957264848053456, "policy_loss": 0.050765814088905854, "vf_loss": 1.8405905655740449, "vf_explained_var": 0.9691743140419324, "kl": 0.0, "entropy": 111.78641459147136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.056953217879051, "mean_inference_ms": 24.899512703077047, "mean_action_processing_ms": 0.890327779296487, "mean_env_wait_ms": 0.5942041763109736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.45231103897094727, "StateBufferConnector_ms": 0.010471105575561523, "ViewRequirementAgentConnector_ms": 0.3081080913543701}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.056953217879051, "mean_inference_ms": 24.899512703077047, "mean_action_processing_ms": 0.890327779296487, "mean_env_wait_ms": 0.5942041763109736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.45231103897094727, "StateBufferConnector_ms": 0.010471105575561523, "ViewRequirementAgentConnector_ms": 0.3081080913543701}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.951413447728915, "num_agent_steps_trained_throughput_per_sec": 3.951413447728915, "timesteps_total": 38912, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 122634.355, "sample_time_ms": 10176.024, "load_time_ms": 0.264, "load_throughput": 1940964.975, "learn_time_ms": 112457.637, "learn_throughput": 4.553, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "episodes_total": 2432, "training_iteration": 76, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-43-37", "timestamp": 1709023417, "time_this_iter_s": 129.5786349773407, "time_total_s": 12249.015530109406, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12249.015530109406, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 23.51748633879782, "ram_util_percent": 14.067759562841529}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.48, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.20375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.20375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.7194825803240141, "policy_loss": -0.05740942963554214, "vf_loss": 2.1169022298107545, "vf_explained_var": 0.9530796766281128, "kl": 0.0, "entropy": 111.62486629486084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.48, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.48, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.20375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.20375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0457712535796055, "mean_inference_ms": 24.814967481107182, "mean_action_processing_ms": 0.8875291258528085, "mean_env_wait_ms": 0.5919232654290542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42902374267578125, "StateBufferConnector_ms": 0.007775306701660156, "ViewRequirementAgentConnector_ms": 0.3167705535888672}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.48, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0457712535796055, "mean_inference_ms": 24.814967481107182, "mean_action_processing_ms": 0.8875291258528085, "mean_env_wait_ms": 0.5919232654290542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42902374267578125, "StateBufferConnector_ms": 0.007775306701660156, "ViewRequirementAgentConnector_ms": 0.3167705535888672}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424, "num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.91681896557831, "num_agent_steps_trained_throughput_per_sec": 4.91681896557831, "timesteps_total": 39424, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39424, "timers": {"training_iteration_time_ms": 118999.92, "sample_time_ms": 9871.721, "load_time_ms": 0.263, "load_throughput": 1944832.139, "learn_time_ms": 109127.495, "learn_throughput": 4.692, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 39424, "num_env_steps_trained": 39424, "num_agent_steps_sampled": 39424, "num_agent_steps_trained": 39424}, "done": false, "episodes_total": 2464, "training_iteration": 77, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-45-21", "timestamp": 1709023521, "time_this_iter_s": 104.13724255561829, "time_total_s": 12353.152772665024, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12353.152772665024, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 23.469594594594593, "ram_util_percent": 14.072297297297297}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.82, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.193125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.193125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8894863833983739, "policy_loss": 0.012415741880734762, "vf_loss": 1.0448990715434774, "vf_explained_var": 0.9899679809808731, "kl": 0.0, "entropy": 113.04893506368002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.82, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.82, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.193125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.193125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0350033755653283, "mean_inference_ms": 24.719076801059337, "mean_action_processing_ms": 0.8843646567979689, "mean_env_wait_ms": 0.5895329609919437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.44369077682495117, "StateBufferConnector_ms": 0.008064031600952148, "ViewRequirementAgentConnector_ms": 0.30150294303894043}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.82, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, 14.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0350033755653283, "mean_inference_ms": 24.719076801059337, "mean_action_processing_ms": 0.8843646567979689, "mean_env_wait_ms": 0.5895329609919437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.44369077682495117, "StateBufferConnector_ms": 0.008064031600952148, "ViewRequirementAgentConnector_ms": 0.30150294303894043}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.392351715925097, "num_agent_steps_trained_throughput_per_sec": 4.392351715925097, "timesteps_total": 39936, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 118779.033, "sample_time_ms": 10491.684, "load_time_ms": 0.267, "load_throughput": 1920654.367, "learn_time_ms": 108286.63, "learn_throughput": 4.728, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "episodes_total": 2496, "training_iteration": 78, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-47-17", "timestamp": 1709023637, "time_this_iter_s": 116.57110524177551, "time_total_s": 12469.7238779068, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12469.7238779068, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.970303030303025, "ram_util_percent": 14.053939393939391}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.8, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.096669727563858, "policy_loss": -0.11116562923416495, "vf_loss": 1.4389559626579285, "vf_explained_var": 0.9995259885986646, "kl": 0.0, "entropy": 112.9021479288737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.8, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.8, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.024983279274173, "mean_inference_ms": 24.63091406485848, "mean_action_processing_ms": 0.8815677549249565, "mean_env_wait_ms": 0.587388617821519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4336667060852051, "StateBufferConnector_ms": 0.004778146743774414, "ViewRequirementAgentConnector_ms": 0.30396533012390137}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.8, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.024983279274173, "mean_inference_ms": 24.63091406485848, "mean_action_processing_ms": 0.8815677549249565, "mean_env_wait_ms": 0.587388617821519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4336667060852051, "StateBufferConnector_ms": 0.004778146743774414, "ViewRequirementAgentConnector_ms": 0.30396533012390137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448, "num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.286268271679943, "num_agent_steps_trained_throughput_per_sec": 4.286268271679943, "timesteps_total": 40448, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40448, "timers": {"training_iteration_time_ms": 118768.326, "sample_time_ms": 10439.535, "load_time_ms": 0.268, "load_throughput": 1907009.722, "learn_time_ms": 108328.065, "learn_throughput": 4.726, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 40448, "num_env_steps_trained": 40448, "num_agent_steps_sampled": 40448, "num_agent_steps_trained": 40448}, "done": false, "episodes_total": 2528, "training_iteration": 79, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-49-17", "timestamp": 1709023757, "time_this_iter_s": 119.45598888397217, "time_total_s": 12589.179866790771, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12589.179866790771, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 22.894082840236685, "ram_util_percent": 14.07396449704142}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2325, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2325, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.9001090322931607, "policy_loss": -0.09005234700938065, "vf_loss": 1.1796298333676531, "vf_explained_var": 0.9772138719757398, "kl": 0.0, "entropy": 112.49221096038818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.56, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.56, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2325, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2325, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.016727853236459, "mean_inference_ms": 24.560781102122696, "mean_action_processing_ms": 0.8792981114822632, "mean_env_wait_ms": 0.5857767185392347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4672117233276367, "StateBufferConnector_ms": 0.004896879196166992, "ViewRequirementAgentConnector_ms": 0.3230631351470947}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.56, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 14.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.016727853236459, "mean_inference_ms": 24.560781102122696, "mean_action_processing_ms": 0.8792981114822632, "mean_env_wait_ms": 0.5857767185392347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4672117233276367, "StateBufferConnector_ms": 0.004896879196166992, "ViewRequirementAgentConnector_ms": 0.3230631351470947}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.2771588575006865, "num_agent_steps_trained_throughput_per_sec": 4.2771588575006865, "timesteps_total": 40960, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 118093.252, "sample_time_ms": 10746.05, "load_time_ms": 2.016, "load_throughput": 253935.726, "learn_time_ms": 107344.734, "learn_throughput": 4.77, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 2560, "training_iteration": 80, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-51-17", "timestamp": 1709023877, "time_this_iter_s": 119.71042895317078, "time_total_s": 12708.890295743942, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12708.890295743942, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 22.87869822485207, "ram_util_percent": 14.08165680473373}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -6.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.29125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.29125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.084609046081702, "policy_loss": -0.1262520092073828, "vf_loss": 1.4425606355071068, "vf_explained_var": 0.999723435441653, "kl": 0.0, "entropy": 111.66847858428955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -6.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.29125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.29125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0103354053168605, "mean_inference_ms": 24.503585784505532, "mean_action_processing_ms": 0.8775533919631309, "mean_env_wait_ms": 0.5851362702463974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5335371494293213, "StateBufferConnector_ms": 0.004961967468261719, "ViewRequirementAgentConnector_ms": 0.36198949813842773}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0103354053168605, "mean_inference_ms": 24.503585784505532, "mean_action_processing_ms": 0.8775533919631309, "mean_env_wait_ms": 0.5851362702463974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5335371494293213, "StateBufferConnector_ms": 0.004961967468261719, "ViewRequirementAgentConnector_ms": 0.36198949813842773}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472, "num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.07074694745252, "num_agent_steps_trained_throughput_per_sec": 4.07074694745252, "timesteps_total": 41472, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41472, "timers": {"training_iteration_time_ms": 118462.338, "sample_time_ms": 11236.526, "load_time_ms": 2.019, "load_throughput": 253626.82, "learn_time_ms": 107223.338, "learn_throughput": 4.775, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 41472, "num_env_steps_trained": 41472, "num_agent_steps_sampled": 41472, "num_agent_steps_trained": 41472}, "done": false, "episodes_total": 2592, "training_iteration": 81, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-53-22", "timestamp": 1709024002, "time_this_iter_s": 125.78021478652954, "time_total_s": 12834.670510530472, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12834.670510530472, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.241011235955053, "ram_util_percent": 14.07247191011236}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -6.7, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.290625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.290625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6138755223403375, "policy_loss": -0.09201175899555286, "vf_loss": 0.840959583222866, "vf_explained_var": 0.9998451044162114, "kl": 0.0, "entropy": 112.70274880727132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.7, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -6.7, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.290625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.290625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.005232489436629, "mean_inference_ms": 24.453230088494728, "mean_action_processing_ms": 0.8768403448893852, "mean_env_wait_ms": 0.5851427689848966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5381069183349609, "StateBufferConnector_ms": 0.008482217788696289, "ViewRequirementAgentConnector_ms": 0.39304256439208984}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -6.7, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.005232489436629, "mean_inference_ms": 24.453230088494728, "mean_action_processing_ms": 0.8768403448893852, "mean_env_wait_ms": 0.5851427689848966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5381069183349609, "StateBufferConnector_ms": 0.008482217788696289, "ViewRequirementAgentConnector_ms": 0.39304256439208984}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.754820992889154, "num_agent_steps_trained_throughput_per_sec": 4.754820992889154, "timesteps_total": 41984, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 117729.338, "sample_time_ms": 11344.065, "load_time_ms": 2.016, "load_throughput": 253962.754, "learn_time_ms": 106382.808, "learn_throughput": 4.813, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "episodes_total": 2624, "training_iteration": 82, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-55-10", "timestamp": 1709024110, "time_this_iter_s": 107.68492817878723, "time_total_s": 12942.355438709259, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 12942.355438709259, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 22.695394736842104, "ram_util_percent": 14.069078947368421}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.22, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.243125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.243125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.0459298690160115, "policy_loss": -0.08603367590500663, "vf_loss": 1.348566005161653, "vf_explained_var": 0.8960429127017657, "kl": 0.0, "entropy": 112.14962679545084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.22, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.22, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.243125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.243125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.996482832308207, "mean_inference_ms": 24.372950633456067, "mean_action_processing_ms": 0.8748528077487314, "mean_env_wait_ms": 0.5842917424281601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.48955512046813965, "StateBufferConnector_ms": 0.008208274841308594, "ViewRequirementAgentConnector_ms": 0.3242220878601074}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.22, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 12.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.996482832308207, "mean_inference_ms": 24.372950633456067, "mean_action_processing_ms": 0.8748528077487314, "mean_env_wait_ms": 0.5842917424281601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.48955512046813965, "StateBufferConnector_ms": 0.008208274841308594, "ViewRequirementAgentConnector_ms": 0.3242220878601074}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496, "num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.945071017793678, "num_agent_steps_trained_throughput_per_sec": 4.945071017793678, "timesteps_total": 42496, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 42496, "timers": {"training_iteration_time_ms": 116910.957, "sample_time_ms": 11197.317, "load_time_ms": 2.035, "load_throughput": 251541.313, "learn_time_ms": 105711.138, "learn_throughput": 4.843, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 42496, "num_env_steps_trained": 42496, "num_agent_steps_sampled": 42496, "num_agent_steps_trained": 42496}, "done": false, "episodes_total": 2656, "training_iteration": 83, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-56-54", "timestamp": 1709024214, "time_this_iter_s": 103.55153846740723, "time_total_s": 13045.906977176666, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13045.906977176666, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 24.31904761904762, "ram_util_percent": 14.06938775510204}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.04, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.155, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5070329822910329, "policy_loss": -0.08387237855543693, "vf_loss": 0.7039757503351818, "vf_explained_var": 0.9787819643815359, "kl": 0.0, "entropy": 113.3271951675415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.04, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.04, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.155, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.155, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9860658674034424, "mean_inference_ms": 24.283395783549075, "mean_action_processing_ms": 0.8728371544492071, "mean_env_wait_ms": 0.5830100474052092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4020857810974121, "StateBufferConnector_ms": 0.008405447006225586, "ViewRequirementAgentConnector_ms": 0.30759263038635254}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.04, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 12.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9860658674034424, "mean_inference_ms": 24.283395783549075, "mean_action_processing_ms": 0.8728371544492071, "mean_env_wait_ms": 0.5830100474052092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4020857810974121, "StateBufferConnector_ms": 0.008405447006225586, "ViewRequirementAgentConnector_ms": 0.30759263038635254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.918132628694415, "num_agent_steps_trained_throughput_per_sec": 4.918132628694415, "timesteps_total": 43008, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 114456.369, "sample_time_ms": 11324.763, "load_time_ms": 2.032, "load_throughput": 252025.449, "learn_time_ms": 103129.103, "learn_throughput": 4.965, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "episodes_total": 2688, "training_iteration": 84, "trial_id": "1b5c8_00222", "date": "2024-02-27_09-58-38", "timestamp": 1709024318, "time_this_iter_s": 104.10953879356384, "time_total_s": 13150.01651597023, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13150.01651597023, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 23.368027210884353, "ram_util_percent": 14.097959183673467}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.6, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5529724091912309, "policy_loss": -0.014473176980391144, "vf_loss": 0.6760269203533729, "vf_explained_var": 0.9998621061444283, "kl": 0.0, "entropy": 117.5484141031901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.6, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.974481507664362, "mean_inference_ms": 24.183023933788306, "mean_action_processing_ms": 0.8693375054440904, "mean_env_wait_ms": 0.5807913729070691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3247661590576172, "StateBufferConnector_ms": 0.004534006118774414, "ViewRequirementAgentConnector_ms": 0.26655030250549316}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.974481507664362, "mean_inference_ms": 24.183023933788306, "mean_action_processing_ms": 0.8693375054440904, "mean_env_wait_ms": 0.5807913729070691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3247661590576172, "StateBufferConnector_ms": 0.004534006118774414, "ViewRequirementAgentConnector_ms": 0.26655030250549316}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520, "num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.269785917586874, "num_agent_steps_trained_throughput_per_sec": 4.269785917586874, "timesteps_total": 43520, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 43520, "timers": {"training_iteration_time_ms": 115043.902, "sample_time_ms": 10896.872, "load_time_ms": 2.032, "load_throughput": 252028.407, "learn_time_ms": 104144.529, "learn_throughput": 4.916, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 43520, "num_env_steps_trained": 43520, "num_agent_steps_sampled": 43520, "num_agent_steps_trained": 43520}, "done": false, "episodes_total": 2720, "training_iteration": 85, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-00-38", "timestamp": 1709024438, "time_this_iter_s": 119.91710662841797, "time_total_s": 13269.933622598648, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13269.933622598648, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 23.163313609467455, "ram_util_percent": 14.095266272189345}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.0, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.0535039850588268, "policy_loss": 0.044284945850570995, "vf_loss": 1.2023341899272055, "vf_explained_var": 0.955504909157753, "kl": 0.0, "entropy": 117.0366689046224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.0, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.966724293494087, "mean_inference_ms": 24.111063301841664, "mean_action_processing_ms": 0.8675091675909705, "mean_env_wait_ms": 0.5800292015743931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.39426255226135254, "StateBufferConnector_ms": 0.0056612491607666016, "ViewRequirementAgentConnector_ms": 0.3275339603424072}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.966724293494087, "mean_inference_ms": 24.111063301841664, "mean_action_processing_ms": 0.8675091675909705, "mean_env_wait_ms": 0.5800292015743931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.39426255226135254, "StateBufferConnector_ms": 0.0056612491607666016, "ViewRequirementAgentConnector_ms": 0.3275339603424072}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.126930862243223, "num_agent_steps_trained_throughput_per_sec": 4.126930862243223, "timesteps_total": 44032, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 114492.827, "sample_time_ms": 11157.873, "load_time_ms": 2.032, "load_throughput": 252016.576, "learn_time_ms": 103332.454, "learn_throughput": 4.955, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "episodes_total": 2752, "training_iteration": 86, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-02-42", "timestamp": 1709024562, "time_this_iter_s": 124.0680844783783, "time_total_s": 13394.001707077026, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13394.001707077026, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 23.969318181818178, "ram_util_percent": 13.935795454545454}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.166875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.166875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.44393125362694263, "policy_loss": -0.08188553249929101, "vf_loss": 0.6264324055208514, "vf_explained_var": 0.9465604439377785, "kl": 0.0, "entropy": 116.9218365987142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.166875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.166875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9599180329634818, "mean_inference_ms": 24.048560384443732, "mean_action_processing_ms": 0.8658277385647832, "mean_env_wait_ms": 0.5794204944314265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4159858226776123, "StateBufferConnector_ms": 0.005485057830810547, "ViewRequirementAgentConnector_ms": 0.3198251724243164}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9599180329634818, "mean_inference_ms": 24.048560384443732, "mean_action_processing_ms": 0.8658277385647832, "mean_env_wait_ms": 0.5794204944314265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4159858226776123, "StateBufferConnector_ms": 0.005485057830810547, "ViewRequirementAgentConnector_ms": 0.3198251724243164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544, "num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.248360403294039, "num_agent_steps_trained_throughput_per_sec": 4.248360403294039, "timesteps_total": 44544, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 44544, "timers": {"training_iteration_time_ms": 116131.298, "sample_time_ms": 11410.094, "load_time_ms": 2.031, "load_throughput": 252072.782, "learn_time_ms": 104718.703, "learn_throughput": 4.889, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 44544, "num_env_steps_trained": 44544, "num_agent_steps_sampled": 44544, "num_agent_steps_trained": 44544}, "done": false, "episodes_total": 2784, "training_iteration": 87, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-04-43", "timestamp": 1709024683, "time_this_iter_s": 120.52321934700012, "time_total_s": 13514.524926424026, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13514.524926424026, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.561176470588236, "ram_util_percent": 13.990588235294116}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.166875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.166875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1486868515300255, "policy_loss": -0.059600804730628926, "vf_loss": 1.4394948232918978, "vf_explained_var": 0.9998663052916527, "kl": 0.0, "entropy": 118.35506699879964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.66, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.66, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.166875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.166875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9518341035601154, "mean_inference_ms": 23.977185551938746, "mean_action_processing_ms": 0.8643622162254297, "mean_env_wait_ms": 0.5789415093389281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42711782455444336, "StateBufferConnector_ms": 0.005500316619873047, "ViewRequirementAgentConnector_ms": 0.31110405921936035}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.66, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9518341035601154, "mean_inference_ms": 23.977185551938746, "mean_action_processing_ms": 0.8643622162254297, "mean_env_wait_ms": 0.5789415093389281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.42711782455444336, "StateBufferConnector_ms": 0.005500316619873047, "ViewRequirementAgentConnector_ms": 0.31110405921936035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 4.941376223495507, "num_agent_steps_trained_throughput_per_sec": 4.941376223495507, "timesteps_total": 45056, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 114836.157, "sample_time_ms": 11050.94, "load_time_ms": 2.029, "load_throughput": 252312.676, "learn_time_ms": 103782.71, "learn_throughput": 4.933, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "episodes_total": 2816, "training_iteration": 88, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-06-31", "timestamp": 1709024791, "time_this_iter_s": 103.61977648735046, "time_total_s": 13618.144702911377, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13618.144702911377, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 23.57272727272727, "ram_util_percent": 14.04155844155844}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.16625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.7202128511232634, "policy_loss": -0.09001943667729696, "vf_loss": 0.9652711110810439, "vf_explained_var": 0.999895279109478, "kl": 0.0, "entropy": 119.75048764546712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16625, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.16625, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9433977250780674, "mean_inference_ms": 23.908130375402425, "mean_action_processing_ms": 0.8623099192066702, "mean_env_wait_ms": 0.5778283484510305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.40462183952331543, "StateBufferConnector_ms": 0.009436607360839844, "ViewRequirementAgentConnector_ms": 0.2936685085296631}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 12.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9433977250780674, "mean_inference_ms": 23.908130375402425, "mean_action_processing_ms": 0.8623099192066702, "mean_env_wait_ms": 0.5778283484510305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.40462183952331543, "StateBufferConnector_ms": 0.009436607360839844, "ViewRequirementAgentConnector_ms": 0.2936685085296631}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568, "num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.110492163989977, "num_agent_steps_trained_throughput_per_sec": 5.110492163989977, "timesteps_total": 45568, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 45568, "timers": {"training_iteration_time_ms": 112909.637, "sample_time_ms": 11132.863, "load_time_ms": 2.025, "load_throughput": 252811.693, "learn_time_ms": 101774.264, "learn_throughput": 5.031, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 45568, "num_env_steps_trained": 45568, "num_agent_steps_sampled": 45568, "num_agent_steps_trained": 45568}, "done": false, "episodes_total": 2848, "training_iteration": 89, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-08-11", "timestamp": 1709024891, "time_this_iter_s": 100.19114470481873, "time_total_s": 13718.335847616196, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13718.335847616196, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 24.144680851063832, "ram_util_percent": 13.99148936170213}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1275, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1275, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.591307001778235, "policy_loss": -0.0579991349329551, "vf_loss": 0.7735515577563395, "vf_explained_var": 0.27394352356592816, "kl": 0.0, "entropy": 120.27727769215902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1275, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.1275, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.932179552130464, "mean_inference_ms": 23.813107810877927, "mean_action_processing_ms": 0.8596823865619025, "mean_env_wait_ms": 0.5759783582100084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.37926411628723145, "StateBufferConnector_ms": 0.009397745132446289, "ViewRequirementAgentConnector_ms": 0.2581963539123535}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.932179552130464, "mean_inference_ms": 23.813107810877927, "mean_action_processing_ms": 0.8596823865619025, "mean_env_wait_ms": 0.5759783582100084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.37926411628723145, "StateBufferConnector_ms": 0.009397745132446289, "ViewRequirementAgentConnector_ms": 0.2581963539123535}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.443208008253583, "num_agent_steps_trained_throughput_per_sec": 5.443208008253583, "timesteps_total": 46080, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 110345.293, "sample_time_ms": 10699.304, "load_time_ms": 0.274, "load_throughput": 1870141.642, "learn_time_ms": 99645.236, "learn_throughput": 5.138, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "episodes_total": 2880, "training_iteration": 90, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-09-45", "timestamp": 1709024985, "time_this_iter_s": 94.06704688072205, "time_total_s": 13812.402894496918, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13812.402894496918, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 23.33233082706767, "ram_util_percent": 14.04812030075188}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -12.26, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.116875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.116875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.9059030525231113, "policy_loss": -0.08491833799052984, "vf_loss": 1.1804161395256718, "vf_explained_var": 0.9613262136777242, "kl": 0.0, "entropy": 122.0917199452718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -12.26, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.116875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.116875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.919158287033513, "mean_inference_ms": 23.705253192279244, "mean_action_processing_ms": 0.856685123932441, "mean_env_wait_ms": 0.573907170014971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3266022205352783, "StateBufferConnector_ms": 0.009294986724853516, "ViewRequirementAgentConnector_ms": 0.23490238189697266}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -12.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.919158287033513, "mean_inference_ms": 23.705253192279244, "mean_action_processing_ms": 0.856685123932441, "mean_env_wait_ms": 0.573907170014971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3266022205352783, "StateBufferConnector_ms": 0.009294986724853516, "ViewRequirementAgentConnector_ms": 0.23490238189697266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592, "num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.792830573205907, "num_agent_steps_trained_throughput_per_sec": 5.792830573205907, "timesteps_total": 46592, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 46592, "timers": {"training_iteration_time_ms": 106606.26, "sample_time_ms": 9973.508, "load_time_ms": 0.274, "load_throughput": 1866078.943, "learn_time_ms": 96632.001, "learn_throughput": 5.298, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 46592, "num_env_steps_trained": 46592, "num_agent_steps_sampled": 46592, "num_agent_steps_trained": 46592}, "done": false, "episodes_total": 2912, "training_iteration": 91, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-11-14", "timestamp": 1709025074, "time_this_iter_s": 88.38983702659607, "time_total_s": 13900.792731523514, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13900.792731523514, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 23.661111111111104, "ram_util_percent": 13.939682539682538}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.126875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.126875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.4377698661914716, "policy_loss": -0.10070031688859066, "vf_loss": 0.6415070387845238, "vf_explained_var": 0.9999210109313329, "kl": 0.0, "entropy": 121.90943349202475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.94, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.94, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.126875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.126875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9038162132862038, "mean_inference_ms": 23.57646073406163, "mean_action_processing_ms": 0.853045778048887, "mean_env_wait_ms": 0.5715343224390917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3123321533203125, "StateBufferConnector_ms": 0.009216547012329102, "ViewRequirementAgentConnector_ms": 0.20166397094726562}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.94, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9038162132862038, "mean_inference_ms": 23.57646073406163, "mean_action_processing_ms": 0.853045778048887, "mean_env_wait_ms": 0.5715343224390917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3123321533203125, "StateBufferConnector_ms": 0.009216547012329102, "ViewRequirementAgentConnector_ms": 0.20166397094726562}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.608292896863677, "num_agent_steps_trained_throughput_per_sec": 5.608292896863677, "timesteps_total": 47104, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 104967.58, "sample_time_ms": 9510.737, "load_time_ms": 0.277, "load_throughput": 1850321.944, "learn_time_ms": 95456.083, "learn_throughput": 5.364, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "episodes_total": 2944, "training_iteration": 92, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-12-45", "timestamp": 1709025165, "time_this_iter_s": 91.29812526702881, "time_total_s": 13992.090856790543, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13992.090856790543, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 23.515503875968992, "ram_util_percent": 13.972868217054264}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.34, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.176875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.176875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5514280230272561, "policy_loss": -0.10039866384274015, "vf_loss": 0.7765544354605178, "vf_explained_var": 0.8665166467428207, "kl": 0.0, "entropy": 120.63445688883463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.34, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.34, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.176875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.176875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.888070666842708, "mean_inference_ms": 23.4439789373224, "mean_action_processing_ms": 0.8491124387929235, "mean_env_wait_ms": 0.5690541421564002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2830336093902588, "StateBufferConnector_ms": 0.007541179656982422, "ViewRequirementAgentConnector_ms": 0.19534063339233398}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.34, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.888070666842708, "mean_inference_ms": 23.4439789373224, "mean_action_processing_ms": 0.8491124387929235, "mean_env_wait_ms": 0.5690541421564002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2830336093902588, "StateBufferConnector_ms": 0.007541179656982422, "ViewRequirementAgentConnector_ms": 0.19534063339233398}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616, "num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.077833145616246, "num_agent_steps_trained_throughput_per_sec": 6.077833145616246, "timesteps_total": 47616, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 47616, "timers": {"training_iteration_time_ms": 103037.89, "sample_time_ms": 9528.151, "load_time_ms": 0.253, "load_throughput": 2021541.606, "learn_time_ms": 93509.033, "learn_throughput": 5.475, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 47616, "num_env_steps_trained": 47616, "num_agent_steps_sampled": 47616, "num_agent_steps_trained": 47616}, "done": false, "episodes_total": 2976, "training_iteration": 93, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-14-10", "timestamp": 1709025250, "time_this_iter_s": 84.24526476860046, "time_total_s": 14076.336121559143, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14076.336121559143, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 23.729411764705883, "ram_util_percent": 14.010924369747897}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.226875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.226875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.7065962874951462, "policy_loss": -0.0920037212005506, "vf_loss": 0.9514129826799035, "vf_explained_var": 0.9999122714002927, "kl": 0.0, "entropy": 120.82610263824463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.74, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.74, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.226875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.226875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8740875975449636, "mean_inference_ms": 23.326316677565718, "mean_action_processing_ms": 0.8451845522194081, "mean_env_wait_ms": 0.5666479403269488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.31865739822387695, "StateBufferConnector_ms": 0.007514476776123047, "ViewRequirementAgentConnector_ms": 0.20599031448364258}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.74, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8740875975449636, "mean_inference_ms": 23.326316677565718, "mean_action_processing_ms": 0.8451845522194081, "mean_env_wait_ms": 0.5666479403269488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.31865739822387695, "StateBufferConnector_ms": 0.007514476776123047, "ViewRequirementAgentConnector_ms": 0.20599031448364258}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.538400662508661, "num_agent_steps_trained_throughput_per_sec": 5.538400662508661, "timesteps_total": 48128, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 101871.981, "sample_time_ms": 9211.058, "load_time_ms": 0.257, "load_throughput": 1993949.534, "learn_time_ms": 92660.22, "learn_throughput": 5.526, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "episodes_total": 3008, "training_iteration": 94, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-15-42", "timestamp": 1709025342, "time_this_iter_s": 92.45016837120056, "time_total_s": 14168.786289930344, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14168.786289930344, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 14.030534351145038}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.36, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2075, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2075, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.46019080517192684, "policy_loss": -0.06811140986780326, "vf_loss": 0.6293934115519126, "vf_explained_var": 0.9999465679128965, "kl": 0.0, "entropy": 121.61910050710043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.36, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2075, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2075, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.86023713959718, "mean_inference_ms": 23.20942399497978, "mean_action_processing_ms": 0.8415264777675151, "mean_env_wait_ms": 0.5642766708574684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3039240837097168, "StateBufferConnector_ms": 0.011510848999023438, "ViewRequirementAgentConnector_ms": 0.20485234260559082}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.86023713959718, "mean_inference_ms": 23.20942399497978, "mean_action_processing_ms": 0.8415264777675151, "mean_env_wait_ms": 0.5642766708574684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3039240837097168, "StateBufferConnector_ms": 0.011510848999023438, "ViewRequirementAgentConnector_ms": 0.20485234260559082}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640, "num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.586246743606306, "num_agent_steps_trained_throughput_per_sec": 5.586246743606306, "timesteps_total": 48640, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 48640, "timers": {"training_iteration_time_ms": 99046.115, "sample_time_ms": 8910.265, "load_time_ms": 0.258, "load_throughput": 1982536.603, "learn_time_ms": 90135.145, "learn_throughput": 5.68, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 48640, "num_env_steps_trained": 48640, "num_agent_steps_sampled": 48640, "num_agent_steps_trained": 48640}, "done": false, "episodes_total": 3040, "training_iteration": 95, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-17-14", "timestamp": 1709025434, "time_this_iter_s": 91.65842199325562, "time_total_s": 14260.4447119236, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14260.4447119236, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.046923076923072, "ram_util_percent": 14.043076923076923}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.06, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.248125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.248125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6344844550515215, "policy_loss": -0.09402920364712676, "vf_loss": 0.8679155386984349, "vf_explained_var": 0.999924344321092, "kl": 0.0, "entropy": 120.37641595204671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.06, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.248125, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.248125, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.84584122837667, "mean_inference_ms": 23.09020170033185, "mean_action_processing_ms": 0.8378535781313022, "mean_env_wait_ms": 0.5618580647816493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.305769681930542, "StateBufferConnector_ms": 0.00838923454284668, "ViewRequirementAgentConnector_ms": 0.2016592025756836}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 14.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.84584122837667, "mean_inference_ms": 23.09020170033185, "mean_action_processing_ms": 0.8378535781313022, "mean_env_wait_ms": 0.5618580647816493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.305769681930542, "StateBufferConnector_ms": 0.00838923454284668, "ViewRequirementAgentConnector_ms": 0.2016592025756836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.855417605484284, "num_agent_steps_trained_throughput_per_sec": 6.855417605484284, "timesteps_total": 49152, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 94108.346, "sample_time_ms": 8333.431, "load_time_ms": 0.257, "load_throughput": 1995802.647, "learn_time_ms": 85774.216, "learn_throughput": 5.969, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "episodes_total": 3072, "training_iteration": 96, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-18-29", "timestamp": 1709025509, "time_this_iter_s": 74.69013571739197, "time_total_s": 14335.134847640991, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14335.134847640991, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 23.219047619047622, "ram_util_percent": 14.098095238095235}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.249375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.249375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.36261539108430346, "policy_loss": -0.1200042085411648, "vf_loss": 0.5749693870544433, "vf_explained_var": 0.9999465242028236, "kl": 0.0, "entropy": 122.82914822896322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.02, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.249375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.249375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8297930769549895, "mean_inference_ms": 22.958184617641, "mean_action_processing_ms": 0.8340523035347306, "mean_env_wait_ms": 0.5591674536828238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2609279155731201, "StateBufferConnector_ms": 0.00831294059753418, "ViewRequirementAgentConnector_ms": 0.1692028045654297}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8297930769549895, "mean_inference_ms": 22.958184617641, "mean_action_processing_ms": 0.8340523035347306, "mean_env_wait_ms": 0.5591674536828238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2609279155731201, "StateBufferConnector_ms": 0.00831294059753418, "ViewRequirementAgentConnector_ms": 0.1692028045654297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664, "num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.340382390414107, "num_agent_steps_trained_throughput_per_sec": 6.340382390414107, "timesteps_total": 49664, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49664, "timers": {"training_iteration_time_ms": 90131.863, "sample_time_ms": 7664.18, "load_time_ms": 0.251, "load_throughput": 2036108.512, "learn_time_ms": 82467.01, "learn_throughput": 6.209, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 49664, "num_env_steps_trained": 49664, "num_agent_steps_sampled": 49664, "num_agent_steps_trained": 49664}, "done": false, "episodes_total": 3104, "training_iteration": 97, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-19-50", "timestamp": 1709025590, "time_this_iter_s": 80.75703430175781, "time_total_s": 14415.891881942749, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14415.891881942749, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 23.56315789473684, "ram_util_percent": 14.073684210526316}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.38, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.269375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.269375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.9139837449416518, "policy_loss": -0.03792551842828592, "vf_loss": 1.1340581331402064, "vf_explained_var": 0.9580148388942082, "kl": 0.0, "entropy": 121.73690954844157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.38, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.269375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.269375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [14.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8142387423989454, "mean_inference_ms": 22.82963906902326, "mean_action_processing_ms": 0.8301963347968018, "mean_env_wait_ms": 0.5563064018780036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2750396728515625, "StateBufferConnector_ms": 0.011535882949829102, "ViewRequirementAgentConnector_ms": 0.18788385391235352}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8142387423989454, "mean_inference_ms": 22.82963906902326, "mean_action_processing_ms": 0.8301963347968018, "mean_env_wait_ms": 0.5563064018780036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2750396728515625, "StateBufferConnector_ms": 0.011535882949829102, "ViewRequirementAgentConnector_ms": 0.18788385391235352}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.106759735436376, "num_agent_steps_trained_throughput_per_sec": 6.106759735436376, "timesteps_total": 50176, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 88154.53, "sample_time_ms": 7538.973, "load_time_ms": 0.249, "load_throughput": 2052847.384, "learn_time_ms": 80614.902, "learn_throughput": 6.351, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "episodes_total": 3136, "training_iteration": 98, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-21-14", "timestamp": 1709025674, "time_this_iter_s": 83.84675645828247, "time_total_s": 14499.738638401031, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14499.738638401031, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 24.022689075630247, "ram_util_percent": 14.07394957983193}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.36, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.27, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.27, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.3111460583284497, "policy_loss": -0.07930670891267558, "vf_loss": 0.4651663303996126, "vf_explained_var": 0.9999609604477883, "kl": 0.0, "entropy": 121.92366479237874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.36, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.36, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.27, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.27, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798996372455982, "mean_inference_ms": 22.700703402860594, "mean_action_processing_ms": 0.8262589020650972, "mean_env_wait_ms": 0.553500888538452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.33361315727233887, "StateBufferConnector_ms": 0.0074672698974609375, "ViewRequirementAgentConnector_ms": 0.17718982696533203}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.36, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798996372455982, "mean_inference_ms": 22.700703402860594, "mean_action_processing_ms": 0.8262589020650972, "mean_env_wait_ms": 0.553500888538452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.33361315727233887, "StateBufferConnector_ms": 0.0074672698974609375, "ViewRequirementAgentConnector_ms": 0.17718982696533203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688, "num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.231030840082911, "num_agent_steps_trained_throughput_per_sec": 6.231030840082911, "timesteps_total": 50688, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 50688, "timers": {"training_iteration_time_ms": 86352.866, "sample_time_ms": 6960.33, "load_time_ms": 0.247, "load_throughput": 2071261.235, "learn_time_ms": 79391.903, "learn_throughput": 6.449, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 50688, "num_env_steps_trained": 50688, "num_agent_steps_sampled": 50688, "num_agent_steps_trained": 50688}, "done": false, "episodes_total": 3168, "training_iteration": 99, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-22-36", "timestamp": 1709025756, "time_this_iter_s": 82.17428159713745, "time_total_s": 14581.912919998169, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14581.912919998169, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 23.80258620689655, "ram_util_percent": 14.053448275862067}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.38, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.269375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.269375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.4868809327793618, "policy_loss": -0.09223840814083814, "vf_loss": 0.6899344675242901, "vf_explained_var": 0.9999377315243085, "kl": 0.0, "entropy": 122.67850131988526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.38, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.38, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.269375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.269375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7853275192694, "mean_inference_ms": 22.584686766009625, "mean_action_processing_ms": 0.8229561758104492, "mean_env_wait_ms": 0.551149919638417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3756294250488281, "StateBufferConnector_ms": 0.008817911148071289, "ViewRequirementAgentConnector_ms": 0.1992931365966797}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.38, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7853275192694, "mean_inference_ms": 22.584686766009625, "mean_action_processing_ms": 0.8229561758104492, "mean_env_wait_ms": 0.551149919638417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3756294250488281, "StateBufferConnector_ms": 0.008817911148071289, "ViewRequirementAgentConnector_ms": 0.1992931365966797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.206115774709883, "num_agent_steps_trained_throughput_per_sec": 6.206115774709883, "timesteps_total": 51200, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 85196.575, "sample_time_ms": 6956.881, "load_time_ms": 0.245, "load_throughput": 2088382.425, "learn_time_ms": 78239.068, "learn_throughput": 6.544, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "episodes_total": 3200, "training_iteration": 100, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-23-58", "timestamp": 1709025838, "time_this_iter_s": 82.50398445129395, "time_total_s": 14664.416904449463, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14664.416904449463, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 23.54358974358974, "ram_util_percent": 14.052991452991447}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5898799727981289, "policy_loss": -0.042313005899389584, "vf_loss": 0.753163784230128, "vf_explained_var": 0.929422314465046, "kl": 0.0, "entropy": 124.07180411020914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.770908716927073, "mean_inference_ms": 22.46431262684418, "mean_action_processing_ms": 0.8195909074910158, "mean_env_wait_ms": 0.5489294979204025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.36037445068359375, "StateBufferConnector_ms": 0.0056858062744140625, "ViewRequirementAgentConnector_ms": 0.18443083763122559}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.770908716927073, "mean_inference_ms": 22.46431262684418, "mean_action_processing_ms": 0.8195909074910158, "mean_env_wait_ms": 0.5489294979204025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.36037445068359375, "StateBufferConnector_ms": 0.0056858062744140625, "ViewRequirementAgentConnector_ms": 0.18443083763122559}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712, "num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.109226675568027, "num_agent_steps_trained_throughput_per_sec": 6.109226675568027, "timesteps_total": 51712, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 51712, "timers": {"training_iteration_time_ms": 84738.83, "sample_time_ms": 6897.096, "load_time_ms": 0.244, "load_throughput": 2096128.5, "learn_time_ms": 77841.106, "learn_throughput": 6.578, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 51712, "num_env_steps_trained": 51712, "num_agent_steps_sampled": 51712, "num_agent_steps_trained": 51712}, "done": false, "episodes_total": 3232, "training_iteration": 101, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-25-22", "timestamp": 1709025922, "time_this_iter_s": 83.81263995170593, "time_total_s": 14748.229544401169, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14748.229544401169, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 23.58571428571429, "ram_util_percent": 14.052941176470583}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"reward_total_mean": -8.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1733367131091654, "policy_loss": -0.0647115336265415, "vf_loss": 1.474950118161117, "vf_explained_var": 0.9426720256606738, "kl": 0.0, "entropy": 126.22369480133057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.68, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.68, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.758423812957535, "mean_inference_ms": 22.36153558023123, "mean_action_processing_ms": 0.8172588407568909, "mean_env_wait_ms": 0.5471163685566927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.358853816986084, "StateBufferConnector_ms": 0.0057184696197509766, "ViewRequirementAgentConnector_ms": 0.22042036056518555}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.68, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 14.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.758423812957535, "mean_inference_ms": 22.36153558023123, "mean_action_processing_ms": 0.8172588407568909, "mean_env_wait_ms": 0.5471163685566927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.358853816986084, "StateBufferConnector_ms": 0.0057184696197509766, "ViewRequirementAgentConnector_ms": 0.22042036056518555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.832767230557455, "num_agent_steps_trained_throughput_per_sec": 5.832767230557455, "timesteps_total": 52224, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 84387.487, "sample_time_ms": 7058.917, "load_time_ms": 0.245, "load_throughput": 2091025.947, "learn_time_ms": 77327.943, "learn_throughput": 6.621, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "episodes_total": 3264, "training_iteration": 102, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-26-50", "timestamp": 1709026010, "time_this_iter_s": 87.7847044467926, "time_total_s": 14836.014248847961, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14836.014248847961, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 23.587903225806453, "ram_util_percent": 14.0508064516129}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5469548624164114, "policy_loss": -0.04674811502918601, "vf_loss": 0.7073086774131904, "vf_explained_var": 0.9661829029520352, "kl": 0.0, "entropy": 123.27140165964762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.17875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.17875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7460217215822076, "mean_inference_ms": 22.259846473156095, "mean_action_processing_ms": 0.814637344471953, "mean_env_wait_ms": 0.5455748018982146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.34808802604675293, "StateBufferConnector_ms": 0.004355430603027344, "ViewRequirementAgentConnector_ms": 0.21845316886901855}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 14.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7460217215822076, "mean_inference_ms": 22.259846473156095, "mean_action_processing_ms": 0.814637344471953, "mean_env_wait_ms": 0.5455748018982146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.34808802604675293, "StateBufferConnector_ms": 0.004355430603027344, "ViewRequirementAgentConnector_ms": 0.21845316886901855}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736, "num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.090065468688116, "num_agent_steps_trained_throughput_per_sec": 6.090065468688116, "timesteps_total": 52736, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 52736, "timers": {"training_iteration_time_ms": 84370.565, "sample_time_ms": 7076.811, "load_time_ms": 0.25, "load_throughput": 2050886.876, "learn_time_ms": 77293.106, "learn_throughput": 6.624, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 52736, "num_env_steps_trained": 52736, "num_agent_steps_sampled": 52736, "num_agent_steps_trained": 52736}, "done": false, "episodes_total": 3296, "training_iteration": 103, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-28-14", "timestamp": 1709026094, "time_this_iter_s": 84.07622241973877, "time_total_s": 14920.0904712677, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14920.0904712677, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 23.515126050420175, "ram_util_percent": 14.056302521008403}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.159375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.159375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.772321621576945, "policy_loss": 0.20196839827112853, "vf_loss": 0.679490932651485, "vf_explained_var": 0.9269138852755229, "kl": 0.0, "entropy": 126.56352113087972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.9, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.159375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.159375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7338073503434943, "mean_inference_ms": 22.158808664236588, "mean_action_processing_ms": 0.8120713803215, "mean_env_wait_ms": 0.5438932263716224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3436431884765625, "StateBufferConnector_ms": 0.004265546798706055, "ViewRequirementAgentConnector_ms": 0.21837615966796875}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7338073503434943, "mean_inference_ms": 22.158808664236588, "mean_action_processing_ms": 0.8120713803215, "mean_env_wait_ms": 0.5438932263716224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3436431884765625, "StateBufferConnector_ms": 0.004265546798706055, "ViewRequirementAgentConnector_ms": 0.21837615966796875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.1030896567493365, "num_agent_steps_trained_throughput_per_sec": 6.1030896567493365, "timesteps_total": 53248, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 83515.212, "sample_time_ms": 6795.251, "load_time_ms": 0.248, "load_throughput": 2066875.503, "learn_time_ms": 76719.31, "learn_throughput": 6.674, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "episodes_total": 3328, "training_iteration": 104, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-29-38", "timestamp": 1709026178, "time_this_iter_s": 83.89666533470154, "time_total_s": 15003.987136602402, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15003.987136602402, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 23.55762711864407, "ram_util_percent": 14.074576271186437}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.26, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.179375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.179375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.9978143217973411, "policy_loss": -0.06957282954826952, "vf_loss": 1.2716328382492066, "vf_explained_var": 0.9998916849493981, "kl": 0.0, "entropy": 130.4311798731486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.26, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.26, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.179375, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.179375, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.720932245381751, "mean_inference_ms": 22.052634202705494, "mean_action_processing_ms": 0.8089327685957506, "mean_env_wait_ms": 0.542068691450332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2952461242675781, "StateBufferConnector_ms": 0.004236936569213867, "ViewRequirementAgentConnector_ms": 0.19024252891540527}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.26, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 14.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.720932245381751, "mean_inference_ms": 22.052634202705494, "mean_action_processing_ms": 0.8089327685957506, "mean_env_wait_ms": 0.542068691450332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2952461242675781, "StateBufferConnector_ms": 0.004236936569213867, "ViewRequirementAgentConnector_ms": 0.19024252891540527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760, "num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.89107606282028, "num_agent_steps_trained_throughput_per_sec": 5.89107606282028, "timesteps_total": 53760, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 53760, "timers": {"training_iteration_time_ms": 83040.957, "sample_time_ms": 6814.012, "load_time_ms": 0.248, "load_throughput": 2064491.106, "learn_time_ms": 76226.294, "learn_throughput": 6.717, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 53760, "num_env_steps_trained": 53760, "num_agent_steps_sampled": 53760, "num_agent_steps_trained": 53760}, "done": false, "episodes_total": 3360, "training_iteration": 105, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-31-05", "timestamp": 1709026265, "time_this_iter_s": 86.91582655906677, "time_total_s": 15090.902963161469, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15090.902963161469, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 23.12113821138211, "ram_util_percent": 14.04390243902439}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1385737835274388, "policy_loss": 0.0268836736989518, "vf_loss": 1.3244132074993105, "vf_explained_var": 0.8355771933992704, "kl": 0.0, "entropy": 129.6248607635498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7071542717885126, "mean_inference_ms": 21.93873662081085, "mean_action_processing_ms": 0.8056387431013511, "mean_env_wait_ms": 0.5397376281910237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26704907417297363, "StateBufferConnector_ms": 0.00422978401184082, "ViewRequirementAgentConnector_ms": 0.17781281471252441}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7071542717885126, "mean_inference_ms": 21.93873662081085, "mean_action_processing_ms": 0.8056387431013511, "mean_env_wait_ms": 0.5397376281910237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26704907417297363, "StateBufferConnector_ms": 0.00422978401184082, "ViewRequirementAgentConnector_ms": 0.17781281471252441}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.348363292717107, "num_agent_steps_trained_throughput_per_sec": 6.348363292717107, "timesteps_total": 54272, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 83637.482, "sample_time_ms": 6744.443, "load_time_ms": 0.252, "load_throughput": 2034179.831, "learn_time_ms": 76892.373, "learn_throughput": 6.659, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "episodes_total": 3392, "training_iteration": 106, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-32-26", "timestamp": 1709026346, "time_this_iter_s": 80.66327691078186, "time_total_s": 15171.56624007225, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15171.56624007225, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 22.995652173913044, "ram_util_percent": 14.079130434782607}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.4, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.26875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.26875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.2506671322354426, "policy_loss": -0.06076191077008843, "vf_loss": 0.37102132582416136, "vf_explained_var": 0.9999732027451197, "kl": 0.0, "entropy": 130.62656421661376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.4, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.4, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.26875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.26875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6949401645528854, "mean_inference_ms": 21.840384482920843, "mean_action_processing_ms": 0.8029119257064751, "mean_env_wait_ms": 0.5376365056354001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.30944395065307617, "StateBufferConnector_ms": 0.004324197769165039, "ViewRequirementAgentConnector_ms": 0.1939072608947754}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.4, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6949401645528854, "mean_inference_ms": 21.840384482920843, "mean_action_processing_ms": 0.8029119257064751, "mean_env_wait_ms": 0.5376365056354001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.30944395065307617, "StateBufferConnector_ms": 0.004324197769165039, "ViewRequirementAgentConnector_ms": 0.1939072608947754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784, "num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.368430573548753, "num_agent_steps_trained_throughput_per_sec": 6.368430573548753, "timesteps_total": 54784, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 54784, "timers": {"training_iteration_time_ms": 83601.917, "sample_time_ms": 7037.239, "load_time_ms": 0.253, "load_throughput": 2020970.871, "learn_time_ms": 76564.006, "learn_throughput": 6.687, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 54784, "num_env_steps_trained": 54784, "num_agent_steps_sampled": 54784, "num_agent_steps_trained": 54784}, "done": false, "episodes_total": 3424, "training_iteration": 107, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-33-46", "timestamp": 1709026426, "time_this_iter_s": 80.40129113197327, "time_total_s": 15251.967531204224, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15251.967531204224, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 23.190265486725664, "ram_util_percent": 13.991150442477876}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -7.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6201439862449963, "policy_loss": 0.053632663547371826, "vf_loss": 0.6749138746410608, "vf_explained_var": 0.9665076856811842, "kl": 0.0, "entropy": 131.40547637939454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -7.72, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.25875, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.25875, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6821465787902934, "mean_inference_ms": 21.73719837800571, "mean_action_processing_ms": 0.8000139800033031, "mean_env_wait_ms": 0.535436555984565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2899601459503174, "StateBufferConnector_ms": 0.00431060791015625, "ViewRequirementAgentConnector_ms": 0.1800251007080078}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -7.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 14.0, -16.0, 16.0, -16.0, 16.0, 16.0, 14.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6821465787902934, "mean_inference_ms": 21.73719837800571, "mean_action_processing_ms": 0.8000139800033031, "mean_env_wait_ms": 0.535436555984565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2899601459503174, "StateBufferConnector_ms": 0.00431060791015625, "ViewRequirementAgentConnector_ms": 0.1800251007080078}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.008823400714907, "num_agent_steps_trained_throughput_per_sec": 7.008823400714907, "timesteps_total": 55296, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 82522.844, "sample_time_ms": 6870.577, "load_time_ms": 0.255, "load_throughput": 2010564.224, "learn_time_ms": 75651.596, "learn_throughput": 6.768, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "episodes_total": 3456, "training_iteration": 108, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-34-59", "timestamp": 1709026499, "time_this_iter_s": 73.05546283721924, "time_total_s": 15325.022994041443, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15325.022994041443, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 23.9576923076923, "ram_util_percent": 13.949038461538462}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6638063494116068, "policy_loss": 0.2687756359577179, "vf_loss": 0.4706202658514182, "vf_explained_var": 0.9239544918139776, "kl": 0.0, "entropy": 131.85555686950684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.64, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.23, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.23, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.670214754630532, "mean_inference_ms": 21.642317524808423, "mean_action_processing_ms": 0.79750108099218, "mean_env_wait_ms": 0.5334458445224753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.31111741065979004, "StateBufferConnector_ms": 0.004311084747314453, "ViewRequirementAgentConnector_ms": 0.19828319549560547}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.64, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.670214754630532, "mean_inference_ms": 21.642317524808423, "mean_action_processing_ms": 0.79750108099218, "mean_env_wait_ms": 0.5334458445224753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.31111741065979004, "StateBufferConnector_ms": 0.004311084747314453, "ViewRequirementAgentConnector_ms": 0.19828319549560547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808, "num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.911721189774689, "num_agent_steps_trained_throughput_per_sec": 6.911721189774689, "timesteps_total": 55808, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 55808, "timers": {"training_iteration_time_ms": 81713.611, "sample_time_ms": 6994.258, "load_time_ms": 0.255, "load_throughput": 2006618.995, "learn_time_ms": 74718.686, "learn_throughput": 6.852, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 55808, "num_env_steps_trained": 55808, "num_agent_steps_sampled": 55808, "num_agent_steps_trained": 55808}, "done": false, "episodes_total": 3488, "training_iteration": 109, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-36-13", "timestamp": 1709026573, "time_this_iter_s": 74.08171796798706, "time_total_s": 15399.10471200943, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15399.10471200943, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 23.00096153846154, "ram_util_percent": 13.912500000000001}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.708858996629715, "policy_loss": 0.2654823279629151, "vf_loss": 0.5282172810286283, "vf_explained_var": 0.9401753604412079, "kl": 0.0, "entropy": 140.60150388081868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6570355684957296, "mean_inference_ms": 21.534207473205033, "mean_action_processing_ms": 0.7944532475370554, "mean_env_wait_ms": 0.531266750916191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26616501808166504, "StateBufferConnector_ms": 0.0041828155517578125, "ViewRequirementAgentConnector_ms": 0.17344307899475098}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6570355684957296, "mean_inference_ms": 21.534207473205033, "mean_action_processing_ms": 0.7944532475370554, "mean_env_wait_ms": 0.531266750916191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.26616501808166504, "StateBufferConnector_ms": 0.0041828155517578125, "ViewRequirementAgentConnector_ms": 0.17344307899475098}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.135081795755245, "num_agent_steps_trained_throughput_per_sec": 7.135081795755245, "timesteps_total": 56320, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 80639.496, "sample_time_ms": 6740.745, "load_time_ms": 0.254, "load_throughput": 2018501.408, "learn_time_ms": 73898.093, "learn_throughput": 6.928, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "episodes_total": 3520, "training_iteration": 110, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-37-25", "timestamp": 1709026645, "time_this_iter_s": 71.7627604007721, "time_total_s": 15470.867472410202, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15470.867472410202, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 23.321568627450972, "ram_util_percent": 13.959803921568627}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5841011125128717, "policy_loss": 0.10476494988737008, "vf_loss": 0.5710576691819976, "vf_explained_var": 0.9626937806606293, "kl": 0.0, "entropy": 137.16624590555827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.643772732998714, "mean_inference_ms": 21.424580873865434, "mean_action_processing_ms": 0.7913242786221316, "mean_env_wait_ms": 0.5290107377316553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2616386413574219, "StateBufferConnector_ms": 0.0041239261627197266, "ViewRequirementAgentConnector_ms": 0.17064809799194336}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.643772732998714, "mean_inference_ms": 21.424580873865434, "mean_action_processing_ms": 0.7913242786221316, "mean_env_wait_ms": 0.5290107377316553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2616386413574219, "StateBufferConnector_ms": 0.0041239261627197266, "ViewRequirementAgentConnector_ms": 0.17064809799194336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832, "num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.862217269103364, "num_agent_steps_trained_throughput_per_sec": 6.862217269103364, "timesteps_total": 56832, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 56832, "timers": {"training_iteration_time_ms": 79719.875, "sample_time_ms": 6684.349, "load_time_ms": 0.255, "load_throughput": 2005681.935, "learn_time_ms": 73034.869, "learn_throughput": 7.01, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 56832, "num_env_steps_trained": 56832, "num_agent_steps_sampled": 56832, "num_agent_steps_trained": 56832}, "done": false, "episodes_total": 3552, "training_iteration": 111, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-38-40", "timestamp": 1709026720, "time_this_iter_s": 74.61613988876343, "time_total_s": 15545.483612298965, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15545.483612298965, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 23.504761904761907, "ram_util_percent": 13.933333333333334}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.6, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5455384027057638, "policy_loss": 0.06276245155992607, "vf_loss": 0.5751556469748418, "vf_explained_var": 0.99994697868824, "kl": 0.0, "entropy": 136.6278081258138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.6, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.6, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.2, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.2, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6300834939975832, "mean_inference_ms": 21.310740329999927, "mean_action_processing_ms": 0.7878853900531755, "mean_env_wait_ms": 0.5265901359917396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2327711582183838, "StateBufferConnector_ms": 0.004008769989013672, "ViewRequirementAgentConnector_ms": 0.1462411880493164}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.6, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6300834939975832, "mean_inference_ms": 21.310740329999927, "mean_action_processing_ms": 0.7878853900531755, "mean_env_wait_ms": 0.5265901359917396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2327711582183838, "StateBufferConnector_ms": 0.004008769989013672, "ViewRequirementAgentConnector_ms": 0.1462411880493164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.054966531723101, "num_agent_steps_trained_throughput_per_sec": 7.054966531723101, "timesteps_total": 57344, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 78199.179, "sample_time_ms": 6342.611, "load_time_ms": 0.251, "load_throughput": 2041722.426, "learn_time_ms": 71855.926, "learn_throughput": 7.125, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "episodes_total": 3584, "training_iteration": 112, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-39-52", "timestamp": 1709026792, "time_this_iter_s": 72.57765340805054, "time_total_s": 15618.061265707016, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15618.061265707016, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 23.670873786407768, "ram_util_percent": 14.018446601941749}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5294474580325186, "policy_loss": -0.011409751046448946, "vf_loss": 0.6443508219284316, "vf_explained_var": 0.8067485397060712, "kl": 0.0, "entropy": 139.63703956604004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.616998491051396, "mean_inference_ms": 21.20042152592258, "mean_action_processing_ms": 0.784596774715951, "mean_env_wait_ms": 0.5242332099079323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23931431770324707, "StateBufferConnector_ms": 0.0041942596435546875, "ViewRequirementAgentConnector_ms": 0.15781450271606445}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.616998491051396, "mean_inference_ms": 21.20042152592258, "mean_action_processing_ms": 0.784596774715951, "mean_env_wait_ms": 0.5242332099079323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23931431770324707, "StateBufferConnector_ms": 0.0041942596435546875, "ViewRequirementAgentConnector_ms": 0.15781450271606445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856, "num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.12430581446444, "num_agent_steps_trained_throughput_per_sec": 7.12430581446444, "timesteps_total": 57856, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57856, "timers": {"training_iteration_time_ms": 76978.711, "sample_time_ms": 6190.564, "load_time_ms": 0.278, "load_throughput": 1839228.887, "learn_time_ms": 70787.479, "learn_throughput": 7.233, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 57856, "num_env_steps_trained": 57856, "num_agent_steps_sampled": 57856, "num_agent_steps_trained": 57856}, "done": false, "episodes_total": 3616, "training_iteration": 113, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-41-04", "timestamp": 1709026864, "time_this_iter_s": 71.87134599685669, "time_total_s": 15689.932611703873, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15689.932611703873, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 23.52254901960784, "ram_util_percent": 13.971568627450974}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.24, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.18, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.18, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8144058521836997, "policy_loss": 0.1461114447331056, "vf_loss": 0.79617327041924, "vf_explained_var": 0.9999430914719899, "kl": 0.0, "entropy": 135.74099299112956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.24, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.24, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.18, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.18, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6042282294080827, "mean_inference_ms": 21.092103518701276, "mean_action_processing_ms": 0.7813886137505557, "mean_env_wait_ms": 0.5219272480886008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24093151092529297, "StateBufferConnector_ms": 0.004244565963745117, "ViewRequirementAgentConnector_ms": 0.15893173217773438}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.24, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6042282294080827, "mean_inference_ms": 21.092103518701276, "mean_action_processing_ms": 0.7813886137505557, "mean_env_wait_ms": 0.5219272480886008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24093151092529297, "StateBufferConnector_ms": 0.004244565963745117, "ViewRequirementAgentConnector_ms": 0.15893173217773438}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.760839091760173, "num_agent_steps_trained_throughput_per_sec": 7.760839091760173, "timesteps_total": 58368, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 75186.742, "sample_time_ms": 6141.257, "load_time_ms": 0.279, "load_throughput": 1835456.109, "learn_time_ms": 69044.819, "learn_throughput": 7.415, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "episodes_total": 3648, "training_iteration": 114, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-42-10", "timestamp": 1709026930, "time_this_iter_s": 65.97694396972656, "time_total_s": 15755.9095556736, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15755.9095556736, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 22.849462365591396, "ram_util_percent": 14.034408602150537}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.0780103170623383, "policy_loss": 0.32115923228363197, "vf_loss": 0.9016753466023754, "vf_explained_var": 0.607528226574262, "kl": 0.0, "entropy": 158.67896690368653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.2, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.2, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.15, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.15, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.591519674882309, "mean_inference_ms": 20.983686822673235, "mean_action_processing_ms": 0.7781777237130634, "mean_env_wait_ms": 0.5196334305557887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2410581111907959, "StateBufferConnector_ms": 0.004275798797607422, "ViewRequirementAgentConnector_ms": 0.15818452835083008}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.2, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.591519674882309, "mean_inference_ms": 20.983686822673235, "mean_action_processing_ms": 0.7781777237130634, "mean_env_wait_ms": 0.5196334305557887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2410581111907959, "StateBufferConnector_ms": 0.004275798797607422, "ViewRequirementAgentConnector_ms": 0.15818452835083008}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880, "num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.493231599352143, "num_agent_steps_trained_throughput_per_sec": 7.493231599352143, "timesteps_total": 58880, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 58880, "timers": {"training_iteration_time_ms": 73328.463, "sample_time_ms": 5937.826, "load_time_ms": 0.277, "load_throughput": 1848729.036, "learn_time_ms": 67389.975, "learn_throughput": 7.598, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 58880, "num_env_steps_trained": 58880, "num_agent_steps_sampled": 58880, "num_agent_steps_trained": 58880}, "done": false, "episodes_total": 3680, "training_iteration": 115, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-43-19", "timestamp": 1709026999, "time_this_iter_s": 68.33326983451843, "time_total_s": 15824.242825508118, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15824.242825508118, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 22.61134020618557, "ram_util_percent": 14.00721649484536}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.7483876016611855, "policy_loss": 0.18808990524460872, "vf_loss": 1.858862364074836, "vf_explained_var": 0.6702682331204415, "kl": 0.0, "entropy": 161.41913859049478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.578580369559499, "mean_inference_ms": 20.875410046072844, "mean_action_processing_ms": 0.7748742177357638, "mean_env_wait_ms": 0.5173048707962535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23456501960754395, "StateBufferConnector_ms": 0.004050731658935547, "ViewRequirementAgentConnector_ms": 0.15239286422729492}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.578580369559499, "mean_inference_ms": 20.875410046072844, "mean_action_processing_ms": 0.7748742177357638, "mean_env_wait_ms": 0.5173048707962535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23456501960754395, "StateBufferConnector_ms": 0.004050731658935547, "ViewRequirementAgentConnector_ms": 0.15239286422729492}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.570582810147141, "num_agent_steps_trained_throughput_per_sec": 7.570582810147141, "timesteps_total": 59392, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 72026.411, "sample_time_ms": 5914.02, "load_time_ms": 0.273, "load_throughput": 1877335.124, "learn_time_ms": 66111.746, "learn_throughput": 7.744, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "episodes_total": 3712, "training_iteration": 116, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-44-26", "timestamp": 1709027066, "time_this_iter_s": 67.63482809066772, "time_total_s": 15891.877653598785, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15891.877653598785, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 22.6125, "ram_util_percent": 14.029166666666667}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -11.84, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.13, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8844025140007337, "policy_loss": -0.036628646900256474, "vf_loss": 1.0972714579974612, "vf_explained_var": 0.3119480922818184, "kl": 0.0, "entropy": 162.5149274190267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -11.84, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.13, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.13, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5660579196751474, "mean_inference_ms": 20.770905299393352, "mean_action_processing_ms": 0.771671251766335, "mean_env_wait_ms": 0.5150515327066253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24222517013549805, "StateBufferConnector_ms": 0.0040585994720458984, "ViewRequirementAgentConnector_ms": 0.15044856071472168}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -11.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5660579196751474, "mean_inference_ms": 20.770905299393352, "mean_action_processing_ms": 0.771671251766335, "mean_env_wait_ms": 0.5150515327066253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24222517013549805, "StateBufferConnector_ms": 0.0040585994720458984, "ViewRequirementAgentConnector_ms": 0.15044856071472168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904, "num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.529070331785008, "num_agent_steps_trained_throughput_per_sec": 7.529070331785008, "timesteps_total": 59904, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 59904, "timers": {"training_iteration_time_ms": 70787.062, "sample_time_ms": 5628.297, "load_time_ms": 0.27, "load_throughput": 1896567.736, "learn_time_ms": 65158.132, "learn_throughput": 7.858, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 59904, "num_env_steps_trained": 59904, "num_agent_steps_sampled": 59904, "num_agent_steps_trained": 59904}, "done": false, "episodes_total": 3744, "training_iteration": 117, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-45-34", "timestamp": 1709027134, "time_this_iter_s": 68.00776720046997, "time_total_s": 15959.885420799255, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15959.885420799255, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 22.51875, "ram_util_percent": 14.046875}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.228874366544187, "policy_loss": 0.26847713499640424, "vf_loss": 1.144170294391612, "vf_explained_var": 0.9999167750279109, "kl": 0.0, "entropy": 159.02318751017253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5537348588627946, "mean_inference_ms": 20.668062517803342, "mean_action_processing_ms": 0.7685231410528007, "mean_env_wait_ms": 0.5128257808472221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24109673500061035, "StateBufferConnector_ms": 0.004019737243652344, "ViewRequirementAgentConnector_ms": 0.15118765830993652}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5537348588627946, "mean_inference_ms": 20.668062517803342, "mean_action_processing_ms": 0.7685231410528007, "mean_env_wait_ms": 0.5128257808472221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24109673500061035, "StateBufferConnector_ms": 0.004019737243652344, "ViewRequirementAgentConnector_ms": 0.15118765830993652}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.717708226791013, "num_agent_steps_trained_throughput_per_sec": 7.717708226791013, "timesteps_total": 60416, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 70116.078, "sample_time_ms": 5576.799, "load_time_ms": 0.269, "load_throughput": 1906501.818, "learn_time_ms": 64538.652, "learn_throughput": 7.933, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "episodes_total": 3776, "training_iteration": 118, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-46-41", "timestamp": 1709027201, "time_this_iter_s": 66.34558534622192, "time_total_s": 16026.231006145477, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16026.231006145477, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 22.327659574468086, "ram_util_percent": 14.069148936170214}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.88, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.16, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.1403042919312913, "policy_loss": 0.2730692816587786, "vf_loss": 1.0331813689010838, "vf_explained_var": 0.8152072772383689, "kl": 0.0, "entropy": 170.46312777201334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.88, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.88, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.16, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.16, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5416260757342313, "mean_inference_ms": 20.566135816873704, "mean_action_processing_ms": 0.7654428478555717, "mean_env_wait_ms": 0.5106372251749831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24187803268432617, "StateBufferConnector_ms": 0.004025936126708984, "ViewRequirementAgentConnector_ms": 0.15140223503112793}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.88, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5416260757342313, "mean_inference_ms": 20.566135816873704, "mean_action_processing_ms": 0.7654428478555717, "mean_env_wait_ms": 0.5106372251749831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24187803268432617, "StateBufferConnector_ms": 0.004025936126708984, "ViewRequirementAgentConnector_ms": 0.15140223503112793}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928, "num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.382082631547454, "num_agent_steps_trained_throughput_per_sec": 7.382082631547454, "timesteps_total": 60928, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 60928, "timers": {"training_iteration_time_ms": 69644.084, "sample_time_ms": 5383.3, "load_time_ms": 0.269, "load_throughput": 1905994.185, "learn_time_ms": 64260.159, "learn_throughput": 7.968, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 60928, "num_env_steps_trained": 60928, "num_agent_steps_sampled": 60928, "num_agent_steps_trained": 60928}, "done": false, "episodes_total": 3808, "training_iteration": 119, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-47-50", "timestamp": 1709027270, "time_this_iter_s": 69.36175560951233, "time_total_s": 16095.59276175499, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16095.59276175499, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 22.749999999999996, "ram_util_percent": 14.071428571428571}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6199329146184027, "policy_loss": 0.17955560854946573, "vf_loss": 0.5246439903664092, "vf_explained_var": 0.8359057207902273, "kl": 0.0, "entropy": 171.01054395039876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5295414290635496, "mean_inference_ms": 20.464669771281525, "mean_action_processing_ms": 0.7623408086079922, "mean_env_wait_ms": 0.5084579712910073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23737621307373047, "StateBufferConnector_ms": 0.003988742828369141, "ViewRequirementAgentConnector_ms": 0.14816880226135254}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, 16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5295414290635496, "mean_inference_ms": 20.464669771281525, "mean_action_processing_ms": 0.7623408086079922, "mean_env_wait_ms": 0.5084579712910073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23737621307373047, "StateBufferConnector_ms": 0.003988742828369141, "ViewRequirementAgentConnector_ms": 0.14816880226135254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.196132112702762, "num_agent_steps_trained_throughput_per_sec": 7.196132112702762, "timesteps_total": 61440, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 69583.206, "sample_time_ms": 5403.802, "load_time_ms": 0.27, "load_throughput": 1898411.994, "learn_time_ms": 64178.775, "learn_throughput": 7.978, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "episodes_total": 3840, "training_iteration": 120, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-49-01", "timestamp": 1709027341, "time_this_iter_s": 71.15403199195862, "time_total_s": 16166.746793746948, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16166.746793746948, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 22.880000000000006, "ram_util_percent": 14.064}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -10.24, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.18, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.18, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5726758788650235, "policy_loss": 0.038732251369704804, "vf_loss": 0.6361143289754788, "vf_explained_var": 0.9999477982521057, "kl": 0.0, "entropy": 169.9094093322754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.24, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -10.24, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.18, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.18, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.517773995347385, "mean_inference_ms": 20.365621028793186, "mean_action_processing_ms": 0.7593252379170086, "mean_env_wait_ms": 0.5064053873427597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2333509922027588, "StateBufferConnector_ms": 0.004019975662231445, "ViewRequirementAgentConnector_ms": 0.14907097816467285}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -10.24, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.517773995347385, "mean_inference_ms": 20.365621028793186, "mean_action_processing_ms": 0.7593252379170086, "mean_env_wait_ms": 0.5064053873427597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2333509922027588, "StateBufferConnector_ms": 0.004019975662231445, "ViewRequirementAgentConnector_ms": 0.14907097816467285}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952, "num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.562112257884675, "num_agent_steps_trained_throughput_per_sec": 7.562112257884675, "timesteps_total": 61952, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 61952, "timers": {"training_iteration_time_ms": 68892.656, "sample_time_ms": 5413.975, "load_time_ms": 0.267, "load_throughput": 1915856.587, "learn_time_ms": 63478.059, "learn_throughput": 8.066, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 61952, "num_env_steps_trained": 61952, "num_agent_steps_sampled": 61952, "num_agent_steps_trained": 61952}, "done": false, "episodes_total": 3872, "training_iteration": 121, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-50-09", "timestamp": 1709027409, "time_this_iter_s": 67.71059679985046, "time_total_s": 16234.457390546799, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16234.457390546799, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 23.559375, "ram_util_percent": 13.978124999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.6978913474207123, "policy_loss": 0.27372845318168404, "vf_loss": 0.5053269256837666, "vf_explained_var": 0.7452487265070279, "kl": 0.0, "entropy": 182.54772911071777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.506260453351586, "mean_inference_ms": 20.269285965781897, "mean_action_processing_ms": 0.7563786798804073, "mean_env_wait_ms": 0.5044002942159449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2326502799987793, "StateBufferConnector_ms": 0.0040743350982666016, "ViewRequirementAgentConnector_ms": 0.15376687049865723}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.506260453351586, "mean_inference_ms": 20.269285965781897, "mean_action_processing_ms": 0.7563786798804073, "mean_env_wait_ms": 0.5044002942159449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2326502799987793, "StateBufferConnector_ms": 0.0040743350982666016, "ViewRequirementAgentConnector_ms": 0.15376687049865723}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.796451716499122, "num_agent_steps_trained_throughput_per_sec": 7.796451716499122, "timesteps_total": 62464, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 68202.447, "sample_time_ms": 5393.614, "load_time_ms": 0.274, "load_throughput": 1868677.034, "learn_time_ms": 62808.204, "learn_throughput": 8.152, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "episodes_total": 3904, "training_iteration": 122, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-51-15", "timestamp": 1709027475, "time_this_iter_s": 65.67569279670715, "time_total_s": 16300.133083343506, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16300.133083343506, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 23.19032258064516, "ram_util_percent": 14.015053763440859}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.1971467152548333, "policy_loss": 0.004683597292751074, "vf_loss": 0.2292911493840317, "vf_explained_var": 0.9999813382824262, "kl": 0.0, "entropy": 181.28277498881022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -8.96, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.22, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.22, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4947776674043287, "mean_inference_ms": 20.173401808348917, "mean_action_processing_ms": 0.7534621323076907, "mean_env_wait_ms": 0.5023838798342206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2317056655883789, "StateBufferConnector_ms": 0.0040264129638671875, "ViewRequirementAgentConnector_ms": 0.14946460723876953}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -8.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4947776674043287, "mean_inference_ms": 20.173401808348917, "mean_action_processing_ms": 0.7534621323076907, "mean_env_wait_ms": 0.5023838798342206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2317056655883789, "StateBufferConnector_ms": 0.0040264129638671875, "ViewRequirementAgentConnector_ms": 0.14946460723876953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976, "num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.866635068500469, "num_agent_steps_trained_throughput_per_sec": 7.866635068500469, "timesteps_total": 62976, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 62976, "timers": {"training_iteration_time_ms": 67524.283, "sample_time_ms": 5325.125, "load_time_ms": 0.241, "load_throughput": 2125379.699, "learn_time_ms": 62198.577, "learn_throughput": 8.232, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 62976, "num_env_steps_trained": 62976, "num_agent_steps_sampled": 62976, "num_agent_steps_trained": 62976}, "done": false, "episodes_total": 3936, "training_iteration": 123, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-52-20", "timestamp": 1709027540, "time_this_iter_s": 65.0896475315094, "time_total_s": 16365.222730875015, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16365.222730875015, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 22.561956521739138, "ram_util_percent": 14.033695652173913}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.5365439348233243, "policy_loss": 0.25388700775802137, "vf_loss": 0.3367436300342282, "vf_explained_var": 0.9999601488312085, "kl": 0.0, "entropy": 180.02580451965332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.28, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.21, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.21, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4834193252027945, "mean_inference_ms": 20.079594900812378, "mean_action_processing_ms": 0.7505650367204768, "mean_env_wait_ms": 0.5003151694280062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23379182815551758, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.15164518356323242}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4834193252027945, "mean_inference_ms": 20.079594900812378, "mean_action_processing_ms": 0.7505650367204768, "mean_env_wait_ms": 0.5003151694280062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23379182815551758, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.15164518356323242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.151654773304838, "num_agent_steps_trained_throughput_per_sec": 7.151654773304838, "timesteps_total": 63488, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 68086.241, "sample_time_ms": 5341.48, "load_time_ms": 0.239, "load_throughput": 2142342.027, "learn_time_ms": 62744.186, "learn_throughput": 8.16, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "episodes_total": 3968, "training_iteration": 124, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-53-32", "timestamp": 1709027612, "time_this_iter_s": 71.59652757644653, "time_total_s": 16436.81925845146, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16436.81925845146, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 23.35588235294118, "ram_util_percent": 14.017647058823531}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 1.2765598726458847, "policy_loss": 0.042677068058401345, "vf_loss": 1.4699876242006817, "vf_explained_var": 0.3515024334192276, "kl": 0.0, "entropy": 180.1592674255371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.472402457235512, "mean_inference_ms": 19.987192064591312, "mean_action_processing_ms": 0.7477164498272038, "mean_env_wait_ms": 0.49828338485573725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.231703519821167, "StateBufferConnector_ms": 0.0039272308349609375, "ViewRequirementAgentConnector_ms": 0.1517939567565918}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.472402457235512, "mean_inference_ms": 19.987192064591312, "mean_action_processing_ms": 0.7477164498272038, "mean_env_wait_ms": 0.49828338485573725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.231703519821167, "StateBufferConnector_ms": 0.0039272308349609375, "ViewRequirementAgentConnector_ms": 0.1517939567565918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.625511614472332, "num_agent_steps_trained_throughput_per_sec": 7.625511614472332, "timesteps_total": 64000, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 67967.712, "sample_time_ms": 5367.596, "load_time_ms": 0.238, "load_throughput": 2149633.281, "learn_time_ms": 62599.544, "learn_throughput": 8.179, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 4000, "training_iteration": 125, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-54-39", "timestamp": 1709027679, "time_this_iter_s": 67.14787817001343, "time_total_s": 16503.967136621475, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16503.967136621475, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 23.25531914893617, "ram_util_percent": 13.859574468085105}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0015685994242562252, "total_loss": 0.8168957332770029, "policy_loss": -0.08665134732921918, "vf_loss": 1.0764418012152115, "vf_explained_var": 0.9999460056424141, "kl": 0.0, "entropy": 179.96286366780598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "sampler_results": {"episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -9.92, "reward_total_min": -16, "reward_total_max": 16, "reward_lower_bound_mean": -16.0, "reward_lower_bound_min": -16, "reward_lower_bound_max": -16, "reward_upper_bound_mean": 16.0, "reward_upper_bound_min": 16, "reward_upper_bound_max": 16, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.19, "reward_percentile_min": 0.0, "reward_percentile_max": 1.0, "reward_score_mean": 0.19, "reward_score_min": 0.0, "reward_score_max": 1.0, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.461583389387874, "mean_inference_ms": 19.896162245752862, "mean_action_processing_ms": 0.7449292386152903, "mean_env_wait_ms": 0.4963010808605544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23255419731140137, "StateBufferConnector_ms": 0.003941774368286133, "ViewRequirementAgentConnector_ms": 0.15193533897399902}}, "episode_reward_max": 16.0, "episode_reward_min": -16.0, "episode_reward_mean": -9.92, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, 16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0, 16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, -16.0, 16.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.461583389387874, "mean_inference_ms": 19.896162245752862, "mean_action_processing_ms": 0.7449292386152903, "mean_env_wait_ms": 0.4963010808605544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23255419731140137, "StateBufferConnector_ms": 0.003941774368286133, "ViewRequirementAgentConnector_ms": 0.15193533897399902}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 8.082861391003776, "num_agent_steps_trained_throughput_per_sec": 8.082861391003776, "timesteps_total": 64512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 67539.082, "sample_time_ms": 5348.105, "load_time_ms": 0.24, "load_throughput": 2135100.068, "learn_time_ms": 62190.403, "learn_throughput": 8.233, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "episodes_total": 4032, "training_iteration": 126, "trial_id": "1b5c8_00222", "date": "2024-02-27_10-55-42", "timestamp": 1709027742, "time_this_iter_s": 63.348578453063965, "time_total_s": 16567.31571507454, "pid": 118854, "hostname": "tikgpu09", "node_ip": "129.132.190.199", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_binary", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fa65cb01870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0015685994242562258, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_3.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fa65ea87010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.009052954818474573, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.8393831223585584, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9383010411169525, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16567.31571507454, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 22.694444444444443, "ram_util_percent": 13.959999999999996}, "checkpoint_dir_name": null}
