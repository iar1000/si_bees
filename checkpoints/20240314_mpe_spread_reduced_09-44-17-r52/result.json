{"custom_metrics": {"collisions_mean": 137.0, "collisions_min": 86, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9991750986754209, "cur_kl_coeff": 0.2, "cur_lr": 0.0019524851312189488, "total_loss": 2.4418866944879336, "policy_loss": 0.0034618644835962644, "vf_loss": 4.0062322409331115, "vf_explained_var": 0.11316421991107108, "kl": 0.02517892733890692, "entropy": 2.713404775213921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500}, "sampler_results": {"episode_reward_max": -465.41998119259483, "episode_reward_min": -1034.4608060726487, "episode_reward_mean": -771.3370728144783, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 137.0, "collisions_min": 86, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6551251318015274, "mean_inference_ms": 8.93437085462446, "mean_action_processing_ms": 0.4462294938896999, "mean_env_wait_ms": 1.029562349559688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8477187156677246, "StateBufferConnector_ms": 0.006601810455322266, "ViewRequirementAgentConnector_ms": 0.2647209167480469}}, "episode_reward_max": -465.41998119259483, "episode_reward_min": -1034.4608060726487, "episode_reward_mean": -771.3370728144783, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6551251318015274, "mean_inference_ms": 8.93437085462446, "mean_action_processing_ms": 0.4462294938896999, "mean_env_wait_ms": 1.029562349559688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8477187156677246, "StateBufferConnector_ms": 0.006601810455322266, "ViewRequirementAgentConnector_ms": 0.2647209167480469}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500, "num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.105506888571567, "num_agent_steps_trained_throughput_per_sec": 5.105506888571567, "timesteps_total": 7500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 7500, "timers": {"training_iteration_time_ms": 1469001.996, "sample_time_ms": 30256.133, "load_time_ms": 0.715, "load_throughput": 3498752.085, "learn_time_ms": 1438742.9, "learn_throughput": 1.738, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "0b7ab_00052", "date": "2024-03-14_14-04-54", "timestamp": 1710421494, "time_this_iter_s": 1469.002622127533, "time_total_s": 1469.002622127533, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1469.002622127533, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.674063400576365, "ram_util_percent": 15.03059558117195}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"collisions_mean": 116.2, "collisions_min": 50, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9990703357533477, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 2.5200257359886136, "policy_loss": 0.00030563583011449923, "vf_loss": 4.1413797282281966, "vf_explained_var": 0.22432948474226327, "kl": 0.014141152747624907, "entropy": 2.638928700315541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2610.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "sampler_results": {"episode_reward_max": -433.67450068948926, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -765.8514314773975, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 116.2, "collisions_min": 50, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6634002754493078, "mean_inference_ms": 8.997252967461732, "mean_action_processing_ms": 0.4462102960250364, "mean_env_wait_ms": 1.0312853492257166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8369195461273193, "StateBufferConnector_ms": 0.006483793258666992, "ViewRequirementAgentConnector_ms": 0.2867245674133301}}, "episode_reward_max": -433.67450068948926, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -765.8514314773975, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6634002754493078, "mean_inference_ms": 8.997252967461732, "mean_action_processing_ms": 0.4462102960250364, "mean_env_wait_ms": 1.0312853492257166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8369195461273193, "StateBufferConnector_ms": 0.006483793258666992, "ViewRequirementAgentConnector_ms": 0.2867245674133301}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.094099596162804, "num_agent_steps_trained_throughput_per_sec": 5.094099596162804, "timesteps_total": 15000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 1470646.778, "sample_time_ms": 30620.793, "load_time_ms": 0.883, "load_throughput": 2830546.632, "learn_time_ms": 1440022.954, "learn_throughput": 1.736, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "0b7ab_00052", "date": "2024-03-14_14-29-38", "timestamp": 1710422978, "time_this_iter_s": 1472.2923741340637, "time_total_s": 2941.2949962615967, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2941.2949962615967, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.769424631478834, "ram_util_percent": 15.69020446980504}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"collisions_mean": 109.26666666666667, "collisions_min": 48, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9999130652553734, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 2.6874009400466994, "policy_loss": -0.014752741316440462, "vf_loss": 4.441091547717993, "vf_explained_var": 0.4564731087150245, "kl": 0.015435682714570279, "entropy": 2.603094243044141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4350.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500}, "sampler_results": {"episode_reward_max": -403.9026621464352, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -724.6884274004632, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 109.26666666666667, "collisions_min": 48, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6669629923289635, "mean_inference_ms": 9.020334847822927, "mean_action_processing_ms": 0.4451043639299784, "mean_env_wait_ms": 1.0307993419658181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8322334289550781, "StateBufferConnector_ms": 0.006376107533772786, "ViewRequirementAgentConnector_ms": 0.2918672561645508}}, "episode_reward_max": -403.9026621464352, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -724.6884274004632, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6669629923289635, "mean_inference_ms": 9.020334847822927, "mean_action_processing_ms": 0.4451043639299784, "mean_env_wait_ms": 1.0307993419658181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8322334289550781, "StateBufferConnector_ms": 0.006376107533772786, "ViewRequirementAgentConnector_ms": 0.2918672561645508}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.081668167288696, "num_agent_steps_trained_throughput_per_sec": 5.081668167288696, "timesteps_total": 22500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 22500, "timers": {"training_iteration_time_ms": 1472395.605, "sample_time_ms": 30625.268, "load_time_ms": 0.85, "load_throughput": 2942407.633, "learn_time_ms": 1441767.347, "learn_throughput": 1.734, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "0b7ab_00052", "date": "2024-03-14_14-54-15", "timestamp": 1710424455, "time_this_iter_s": 1475.8942592144012, "time_total_s": 4417.189255475998, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4417.189255475998, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 40.15842105263158, "ram_util_percent": 16.792822966507178}, "checkpoint_dir_name": "checkpoint_000002"}
{"custom_metrics": {"collisions_mean": 101.55, "collisions_min": 44, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 2.3182408822648197, "policy_loss": -0.020707720878865868, "vf_loss": 3.8438978216257587, "vf_explained_var": 0.4954767580690055, "kl": 0.013872104161734684, "entropy": 2.488834080065804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6090.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": -349.76752698775005, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -669.2302133138104, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 101.55, "collisions_min": 44, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6710650970094048, "mean_inference_ms": 9.052543661630944, "mean_action_processing_ms": 0.4451660721490547, "mean_env_wait_ms": 1.0303812839042255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8341294527053833, "StateBufferConnector_ms": 0.006358623504638672, "ViewRequirementAgentConnector_ms": 0.297965407371521}}, "episode_reward_max": -349.76752698775005, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -669.2302133138104, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6710650970094048, "mean_inference_ms": 9.052543661630944, "mean_action_processing_ms": 0.4451660721490547, "mean_env_wait_ms": 1.0303812839042255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8341294527053833, "StateBufferConnector_ms": 0.006358623504638672, "ViewRequirementAgentConnector_ms": 0.297965407371521}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.104709658108603, "num_agent_steps_trained_throughput_per_sec": 5.104709658108603, "timesteps_total": 30000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 1471604.56, "sample_time_ms": 30860.465, "load_time_ms": 0.991, "load_throughput": 2521827.802, "learn_time_ms": 1440741.04, "learn_throughput": 1.735, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "0b7ab_00052", "date": "2024-03-14_15-18-44", "timestamp": 1710425924, "time_this_iter_s": 1469.2325308322906, "time_total_s": 5886.421786308289, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5886.421786308289, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.294668587896254, "ram_util_percent": 15.374351585014413}, "checkpoint_dir_name": "checkpoint_000003"}
{"custom_metrics": {"collisions_mean": 97.36, "collisions_min": 34, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 2.1527268020104318, "policy_loss": -0.017055232552865028, "vf_loss": 3.565191922893469, "vf_explained_var": 0.3588950277745039, "kl": 0.014270904945390185, "entropy": 2.324499570843817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7830.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500}, "sampler_results": {"episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -615.8261041568142, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 97.36, "collisions_min": 34, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6746617303865705, "mean_inference_ms": 9.07630858993876, "mean_action_processing_ms": 0.4455113733315495, "mean_env_wait_ms": 1.0306928549338255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.828519344329834, "StateBufferConnector_ms": 0.006339550018310547, "ViewRequirementAgentConnector_ms": 0.29840993881225586}}, "episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -615.8261041568142, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6746617303865705, "mean_inference_ms": 9.07630858993876, "mean_action_processing_ms": 0.4455113733315495, "mean_env_wait_ms": 1.0306928549338255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.828519344329834, "StateBufferConnector_ms": 0.006339550018310547, "ViewRequirementAgentConnector_ms": 0.29840993881225586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500, "num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.121601909370641, "num_agent_steps_trained_throughput_per_sec": 5.121601909370641, "timesteps_total": 37500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 37500, "timers": {"training_iteration_time_ms": 1470160.759, "sample_time_ms": 30941.443, "load_time_ms": 0.954, "load_throughput": 2619344.524, "learn_time_ms": 1439216.318, "learn_throughput": 1.737, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "0b7ab_00052", "date": "2024-03-14_15-43-09", "timestamp": 1710427389, "time_this_iter_s": 1464.386915922165, "time_total_s": 7350.8087022304535, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7350.8087022304535, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.910795180722886, "ram_util_percent": 15.88053012048193}, "checkpoint_dir_name": "checkpoint_000004"}
{"custom_metrics": {"collisions_mean": 103.3, "collisions_min": 34, "collisions_max": 226, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 2.1449597689280306, "policy_loss": -0.009652471807838856, "vf_loss": 3.5395007955274362, "vf_explained_var": 0.4395284029259079, "kl": 0.015720972181337986, "entropy": 2.348000890838689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9570.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "sampler_results": {"episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -583.9067094323377, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 103.3, "collisions_min": 34, "collisions_max": 226, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6777205243722155, "mean_inference_ms": 9.09406031573311, "mean_action_processing_ms": 0.44585729923541073, "mean_env_wait_ms": 1.0310181990989287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8315614859263102, "StateBufferConnector_ms": 0.006393988927205403, "ViewRequirementAgentConnector_ms": 0.3001550833384196}}, "episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -583.9067094323377, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6777205243722155, "mean_inference_ms": 9.09406031573311, "mean_action_processing_ms": 0.44585729923541073, "mean_env_wait_ms": 1.0310181990989287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8315614859263102, "StateBufferConnector_ms": 0.006393988927205403, "ViewRequirementAgentConnector_ms": 0.3001550833384196}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.119856078212382, "num_agent_steps_trained_throughput_per_sec": 5.119856078212382, "timesteps_total": 45000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 1469281.448, "sample_time_ms": 30984.081, "load_time_ms": 0.928, "load_throughput": 2693144.985, "learn_time_ms": 1438294.332, "learn_throughput": 1.738, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "0b7ab_00052", "date": "2024-03-14_16-07-34", "timestamp": 1710428854, "time_this_iter_s": 1464.8866622447968, "time_total_s": 8815.69536447525, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 8815.69536447525, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.29556840077072, "ram_util_percent": 13.571001926782275}, "checkpoint_dir_name": "checkpoint_000005"}
{"custom_metrics": {"collisions_mean": 102.85714285714286, "collisions_min": 34, "collisions_max": 226, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.6521056242177434, "policy_loss": -0.00851148094783869, "vf_loss": 2.7271247353019383, "vf_explained_var": 0.37293492764577096, "kl": 0.013863653374797629, "entropy": 2.173131330259915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11310.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500}, "sampler_results": {"episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -557.649822202837, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 102.85714285714286, "collisions_min": 34, "collisions_max": 226, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.67949240988953, "mean_inference_ms": 9.104346163218967, "mean_action_processing_ms": 0.4458627144351197, "mean_env_wait_ms": 1.0308993077278525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8289405277797154, "StateBufferConnector_ms": 0.006365094866071429, "ViewRequirementAgentConnector_ms": 0.3027139391217913}}, "episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -557.649822202837, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.67949240988953, "mean_inference_ms": 9.104346163218967, "mean_action_processing_ms": 0.4458627144351197, "mean_env_wait_ms": 1.0308993077278525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8289405277797154, "StateBufferConnector_ms": 0.006365094866071429, "ViewRequirementAgentConnector_ms": 0.3027139391217913}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500, "num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.113590571977599, "num_agent_steps_trained_throughput_per_sec": 5.113590571977599, "timesteps_total": 52500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 52500, "timers": {"training_iteration_time_ms": 1468909.779, "sample_time_ms": 30923.793, "load_time_ms": 0.901, "load_throughput": 2774325.131, "learn_time_ms": 1437982.978, "learn_throughput": 1.739, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "0b7ab_00052", "date": "2024-03-14_16-32-02", "timestamp": 1710430322, "time_this_iter_s": 1466.681536436081, "time_total_s": 10282.376900911331, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10282.376900911331, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.27908653846154, "ram_util_percent": 14.068413461538459}, "checkpoint_dir_name": "checkpoint_000006"}
{"custom_metrics": {"collisions_mean": 106.1, "collisions_min": 22, "collisions_max": 276, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4531495786684125, "policy_loss": 0.00408848152300557, "vf_loss": 2.3810317741685556, "vf_explained_var": 0.345318511847792, "kl": 0.009400897340089, "entropy": 2.1907930538572113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13050.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -536.9366483752689, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 106.1, "collisions_min": 22, "collisions_max": 276, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6812904655236494, "mean_inference_ms": 9.114802722497158, "mean_action_processing_ms": 0.44599745529879853, "mean_env_wait_ms": 1.0309844074241235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8328813314437866, "StateBufferConnector_ms": 0.006355643272399902, "ViewRequirementAgentConnector_ms": 0.30479520559310913}}, "episode_reward_max": -279.2903687131307, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -536.9366483752689, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6812904655236494, "mean_inference_ms": 9.114802722497158, "mean_action_processing_ms": 0.44599745529879853, "mean_env_wait_ms": 1.0309844074241235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8328813314437866, "StateBufferConnector_ms": 0.006355643272399902, "ViewRequirementAgentConnector_ms": 0.30479520559310913}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.135178471764479, "num_agent_steps_trained_throughput_per_sec": 5.135178471764479, "timesteps_total": 60000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 1467860.301, "sample_time_ms": 30994.72, "load_time_ms": 0.893, "load_throughput": 2798628.144, "learn_time_ms": 1436862.609, "learn_throughput": 1.74, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "0b7ab_00052", "date": "2024-03-14_16-56-22", "timestamp": 1710431782, "time_this_iter_s": 1460.5158579349518, "time_total_s": 11742.892758846283, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11742.892758846283, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.28394584139265, "ram_util_percent": 14.291634429400386}, "checkpoint_dir_name": "checkpoint_000007"}
{"custom_metrics": {"collisions_mean": 110.44444444444444, "collisions_min": 22, "collisions_max": 276, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5060616045084985, "policy_loss": 0.001233120366459948, "vf_loss": 2.471406861591613, "vf_explained_var": 0.3856641880054584, "kl": 0.012312496914714813, "entropy": 2.098779751240522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14790.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500}, "sampler_results": {"episode_reward_max": -273.9455402556831, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -519.6925254550914, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 110.44444444444444, "collisions_min": 22, "collisions_max": 276, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6822955563193842, "mean_inference_ms": 9.121130152297944, "mean_action_processing_ms": 0.4459974692609401, "mean_env_wait_ms": 1.0309079169576996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8312132623460557, "StateBufferConnector_ms": 0.006333986918131511, "ViewRequirementAgentConnector_ms": 0.3036411603291829}}, "episode_reward_max": -273.9455402556831, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -519.6925254550914, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6822955563193842, "mean_inference_ms": 9.121130152297944, "mean_action_processing_ms": 0.4459974692609401, "mean_env_wait_ms": 1.0309079169576996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8312132623460557, "StateBufferConnector_ms": 0.006333986918131511, "ViewRequirementAgentConnector_ms": 0.3036411603291829}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500, "num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.3671087147047984, "num_agent_steps_trained_throughput_per_sec": 5.3671087147047984, "timesteps_total": 67500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 67500, "timers": {"training_iteration_time_ms": 1460031.423, "sample_time_ms": 30939.063, "load_time_ms": 0.878, "load_throughput": 2848875.204, "learn_time_ms": 1429089.428, "learn_throughput": 1.749, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "0b7ab_00052", "date": "2024-03-14_17-19-40", "timestamp": 1710433180, "time_this_iter_s": 1397.402338027954, "time_total_s": 13140.295096874237, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13140.295096874237, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.3071104387292, "ram_util_percent": 14.51865859808371}, "checkpoint_dir_name": "checkpoint_000008"}
{"custom_metrics": {"collisions_mean": 108.76, "collisions_min": 22, "collisions_max": 276, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4449130357224387, "policy_loss": -0.004084268246573964, "vf_loss": 2.380875132258596, "vf_explained_var": 0.3470441482875539, "kl": 0.009505386971816725, "entropy": 2.0991608569676847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16530.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000}, "sampler_results": {"episode_reward_max": -273.9455402556831, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -502.06548861522117, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 108.76, "collisions_min": 22, "collisions_max": 276, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.682080246647454, "mean_inference_ms": 9.121865059758605, "mean_action_processing_ms": 0.44571033810536176, "mean_env_wait_ms": 1.030358120019539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8261532783508301, "StateBufferConnector_ms": 0.0062792301177978516, "ViewRequirementAgentConnector_ms": 0.2995743751525879}}, "episode_reward_max": -273.9455402556831, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -502.06548861522117, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-465.41998119259483, -580.1251778886088, -1022.6480667017378, -923.4091976585132, -1034.4608060726487, -967.9836997003752, -467.59524773051305, -860.4676192321681, -612.7457741354967, -778.5151578321271, -626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.682080246647454, "mean_inference_ms": 9.121865059758605, "mean_action_processing_ms": 0.44571033810536176, "mean_env_wait_ms": 1.030358120019539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8261532783508301, "StateBufferConnector_ms": 0.0062792301177978516, "ViewRequirementAgentConnector_ms": 0.2995743751525879}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.448173212295503, "num_agent_steps_trained_throughput_per_sec": 5.448173212295503, "timesteps_total": 75000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 1451689.098, "sample_time_ms": 30783.36, "load_time_ms": 0.864, "load_throughput": 2892304.297, "learn_time_ms": 1420902.863, "learn_throughput": 1.759, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "0b7ab_00052", "date": "2024-03-14_17-42-37", "timestamp": 1710434557, "time_this_iter_s": 1376.6102886199951, "time_total_s": 14516.905385494232, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14516.905385494232, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.30736949846469, "ram_util_percent": 14.520163766632548}, "checkpoint_dir_name": "checkpoint_000009"}
{"custom_metrics": {"collisions_mean": 113.26, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.600639369550774, "policy_loss": -0.007923405163589565, "vf_loss": 2.6421255422049557, "vf_explained_var": 0.3341272593572222, "kl": 0.012444508324292605, "entropy": 2.04897759789708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18270.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500}, "sampler_results": {"episode_reward_max": -273.9455402556831, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -466.26702992837085, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 113.26, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.683944261010464, "mean_inference_ms": 9.1387589564621, "mean_action_processing_ms": 0.44524758119498814, "mean_env_wait_ms": 1.0296670624327535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8228518962860107, "StateBufferConnector_ms": 0.00619816780090332, "ViewRequirementAgentConnector_ms": 0.2992699146270752}}, "episode_reward_max": -273.9455402556831, "episode_reward_min": -1039.1171833396913, "episode_reward_mean": -466.26702992837085, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-626.5431023860488, -890.071395556504, -714.7197461181828, -907.6794334646319, -1039.1171833396913, -640.5909994331238, -1011.2081474575938, -711.230838232926, -433.67450068948926, -628.8225547249745, -533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.683944261010464, "mean_inference_ms": 9.1387589564621, "mean_action_processing_ms": 0.44524758119498814, "mean_env_wait_ms": 1.0296670624327535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8228518962860107, "StateBufferConnector_ms": 0.00619816780090332, "ViewRequirementAgentConnector_ms": 0.2992699146270752}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500, "num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.424056929605771, "num_agent_steps_trained_throughput_per_sec": 5.424056929605771, "timesteps_total": 82500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 82500, "timers": {"training_iteration_time_ms": 1443061.78, "sample_time_ms": 30735.963, "load_time_ms": 0.86, "load_throughput": 2906655.579, "learn_time_ms": 1412323.002, "learn_throughput": 1.77, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500}, "done": false, "episodes_total": 110, "training_iteration": 11, "trial_id": "0b7ab_00052", "date": "2024-03-14_18-05-40", "timestamp": 1710435940, "time_this_iter_s": 1382.7309167385101, "time_total_s": 15899.636302232742, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 15899.636302232742, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 39.55461499235084, "ram_util_percent": 15.144722080571139}, "checkpoint_dir_name": "checkpoint_000010"}
{"custom_metrics": {"collisions_mean": 117.4, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.3820624340347003, "policy_loss": -0.0015282374705005994, "vf_loss": 2.2732958963205077, "vf_explained_var": 0.42492522819973955, "kl": 0.009295715404583127, "entropy": 2.04474858045578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20010.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": -273.9455402556831, "episode_reward_min": -895.040107962651, "episode_reward_mean": -426.64018949495664, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 117.4, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6837427051451377, "mean_inference_ms": 9.140548927437992, "mean_action_processing_ms": 0.4446958896987409, "mean_env_wait_ms": 1.028418867347502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8196983337402344, "StateBufferConnector_ms": 0.006150245666503906, "ViewRequirementAgentConnector_ms": 0.2953007221221924}}, "episode_reward_max": -273.9455402556831, "episode_reward_min": -895.040107962651, "episode_reward_mean": -426.64018949495664, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-533.3563531001101, -481.95579749653655, -403.9026621464352, -644.6279410621319, -895.040107962651, -683.9565609927942, -791.7814706348599, -624.5196132904313, -567.3618552672078, -797.1218305127924, -417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6837427051451377, "mean_inference_ms": 9.140548927437992, "mean_action_processing_ms": 0.4446958896987409, "mean_env_wait_ms": 1.028418867347502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8196983337402344, "StateBufferConnector_ms": 0.006150245666503906, "ViewRequirementAgentConnector_ms": 0.2953007221221924}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.405785752003573, "num_agent_steps_trained_throughput_per_sec": 5.405785752003573, "timesteps_total": 90000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 1434572.859, "sample_time_ms": 30607.817, "load_time_ms": 0.904, "load_throughput": 2764940.407, "learn_time_ms": 1403962.223, "learn_throughput": 1.781, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "0b7ab_00052", "date": "2024-03-14_18-28-48", "timestamp": 1710437328, "time_this_iter_s": 1387.4043653011322, "time_total_s": 17287.040667533875, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17287.040667533875, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.56140172676485, "ram_util_percent": 15.391264601320469}, "checkpoint_dir_name": "checkpoint_000011"}
{"custom_metrics": {"collisions_mean": 123.32, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5214088484537842, "policy_loss": 0.0032036826683572313, "vf_loss": 2.4946972299581285, "vf_explained_var": 0.3453485536506806, "kl": 0.009746119573495911, "entropy": 2.009442812272872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21750.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500}, "sampler_results": {"episode_reward_max": -273.9455402556831, "episode_reward_min": -667.2612207667826, "episode_reward_mean": -399.9658631197165, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 123.32, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6829838160808768, "mean_inference_ms": 9.140097581580086, "mean_action_processing_ms": 0.4444283199675168, "mean_env_wait_ms": 1.0272946761965367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8170368671417236, "StateBufferConnector_ms": 0.006122112274169922, "ViewRequirementAgentConnector_ms": 0.2917778491973877}}, "episode_reward_max": -273.9455402556831, "episode_reward_min": -667.2612207667826, "episode_reward_mean": -399.9658631197165, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-417.4053942038179, -627.5541957324403, -454.5930596746401, -544.6630058960951, -349.76752698775005, -667.2612207667826, -426.828256438327, -396.43378784941615, -510.56820565193385, -633.4810573373143, -486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6829838160808768, "mean_inference_ms": 9.140097581580086, "mean_action_processing_ms": 0.4444283199675168, "mean_env_wait_ms": 1.0272946761965367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8170368671417236, "StateBufferConnector_ms": 0.006122112274169922, "ViewRequirementAgentConnector_ms": 0.2917778491973877}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500, "num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.391877497340217, "num_agent_steps_trained_throughput_per_sec": 5.391877497340217, "timesteps_total": 97500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 97500, "timers": {"training_iteration_time_ms": 1426081.646, "sample_time_ms": 30534.002, "load_time_ms": 0.892, "load_throughput": 2801282.325, "learn_time_ms": 1395544.876, "learn_throughput": 1.791, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500}, "done": false, "episodes_total": 130, "training_iteration": 13, "trial_id": "0b7ab_00052", "date": "2024-03-14_18-52-00", "timestamp": 1710438720, "time_this_iter_s": 1390.9835031032562, "time_total_s": 18678.02417063713, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 18678.02417063713, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 39.32857142857143, "ram_util_percent": 14.717578520770008}, "checkpoint_dir_name": "checkpoint_000012"}
{"custom_metrics": {"collisions_mean": 127.94, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5205257096354603, "policy_loss": -0.009452202792504224, "vf_loss": 2.514785384755025, "vf_explained_var": 0.3831345801380859, "kl": 0.008316737517657465, "entropy": 2.012890218592238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23490.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "sampler_results": {"episode_reward_max": -273.9455402556831, "episode_reward_min": -535.6175646508435, "episode_reward_mean": -384.472600654222, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 127.94, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6810361308531059, "mean_inference_ms": 9.130011307467726, "mean_action_processing_ms": 0.4438774779887303, "mean_env_wait_ms": 1.0260922547446225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8139326572418213, "StateBufferConnector_ms": 0.0060672760009765625, "ViewRequirementAgentConnector_ms": 0.2865610122680664}}, "episode_reward_max": -273.9455402556831, "episode_reward_min": -535.6175646508435, "episode_reward_mean": -384.472600654222, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-486.78714088181266, -416.28490609542484, -319.3458472236618, -279.2903687131307, -398.8976121977597, -409.9758328928301, -421.065214847079, -387.1251972937199, -482.11623059593336, -421.2083245469371, -415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6810361308531059, "mean_inference_ms": 9.130011307467726, "mean_action_processing_ms": 0.4438774779887303, "mean_env_wait_ms": 1.0260922547446225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8139326572418213, "StateBufferConnector_ms": 0.0060672760009765625, "ViewRequirementAgentConnector_ms": 0.2865610122680664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.39278598088687, "num_agent_steps_trained_throughput_per_sec": 5.39278598088687, "timesteps_total": 105000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 105000, "timers": {"training_iteration_time_ms": 1418233.183, "sample_time_ms": 30368.562, "load_time_ms": 0.821, "load_throughput": 3046149.377, "learn_time_ms": 1387861.935, "learn_throughput": 1.801, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "0b7ab_00052", "date": "2024-03-14_19-15-12", "timestamp": 1710440112, "time_this_iter_s": 1390.7489581108093, "time_total_s": 20068.77312874794, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20068.77312874794, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.322807906741005, "ram_util_percent": 14.68530157121135}, "checkpoint_dir_name": "checkpoint_000013"}
{"custom_metrics": {"collisions_mean": 134.1, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.2393363767033898, "policy_loss": -0.001971843540026196, "vf_loss": 2.0384150506778695, "vf_explained_var": 0.427035289694523, "kl": 0.010576971775929549, "entropy": 1.9935624489153938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25230.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500}, "sampler_results": {"episode_reward_max": -265.9987273824866, "episode_reward_min": -535.6175646508435, "episode_reward_mean": -379.9666512131207, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 134.1, "collisions_min": 22, "collisions_max": 318, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6782924752293753, "mean_inference_ms": 9.116995676064544, "mean_action_processing_ms": 0.4431510517212216, "mean_env_wait_ms": 1.0244700144076375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8112888336181641, "StateBufferConnector_ms": 0.006035327911376953, "ViewRequirementAgentConnector_ms": 0.2839946746826172}}, "episode_reward_max": -265.9987273824866, "episode_reward_min": -535.6175646508435, "episode_reward_mean": -379.9666512131207, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-415.0041568162366, -381.7121909949966, -441.84312993887613, -383.1003563351602, -380.62529100208354, -436.9469454945572, -494.9089579376808, -443.8112700937048, -426.9167567667122, -438.2283027195444, -341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6782924752293753, "mean_inference_ms": 9.116995676064544, "mean_action_processing_ms": 0.4431510517212216, "mean_env_wait_ms": 1.0244700144076375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8112888336181641, "StateBufferConnector_ms": 0.006035327911376953, "ViewRequirementAgentConnector_ms": 0.2839946746826172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500, "num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.3985484816079135, "num_agent_steps_trained_throughput_per_sec": 5.3985484816079135, "timesteps_total": 112500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 112500, "timers": {"training_iteration_time_ms": 1410720.857, "sample_time_ms": 30250.72, "load_time_ms": 0.812, "load_throughput": 3077981.624, "learn_time_ms": 1380467.471, "learn_throughput": 1.811, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500}, "done": false, "episodes_total": 150, "training_iteration": 15, "trial_id": "0b7ab_00052", "date": "2024-03-14_19-38-23", "timestamp": 1710441503, "time_this_iter_s": 1389.2646839618683, "time_total_s": 21458.03781270981, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 21458.03781270981, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.33613786112519, "ram_util_percent": 14.721135326913327}, "checkpoint_dir_name": "checkpoint_000014"}
{"custom_metrics": {"collisions_mean": 133.12, "collisions_min": 22, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.3302540488470207, "policy_loss": -0.018487698594161748, "vf_loss": 2.2154181783740547, "vf_explained_var": 0.40202484195944904, "kl": 0.01031588688420434, "entropy": 1.9437289851150295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26970.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -240.65587589704683, "episode_reward_min": -562.525553109307, "episode_reward_mean": -370.67786343046237, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 133.12, "collisions_min": 22, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6749519832626691, "mean_inference_ms": 9.101618595138389, "mean_action_processing_ms": 0.4423121080295258, "mean_env_wait_ms": 1.0226803790517343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8116748332977295, "StateBufferConnector_ms": 0.00599360466003418, "ViewRequirementAgentConnector_ms": 0.2823061943054199}}, "episode_reward_max": -240.65587589704683, "episode_reward_min": -562.525553109307, "episode_reward_mean": -370.67786343046237, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-341.5273757461721, -473.9051756704227, -474.08517981128756, -317.51725115621633, -408.1930579622627, -420.8822122559878, -325.90992578522906, -376.0003087734646, -431.08143294845803, -431.98306814882176, -398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6749519832626691, "mean_inference_ms": 9.101618595138389, "mean_action_processing_ms": 0.4423121080295258, "mean_env_wait_ms": 1.0226803790517343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8116748332977295, "StateBufferConnector_ms": 0.00599360466003418, "ViewRequirementAgentConnector_ms": 0.2823061943054199}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.401501891841555, "num_agent_steps_trained_throughput_per_sec": 5.401501891841555, "timesteps_total": 120000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 1403082.636, "sample_time_ms": 30115.68, "load_time_ms": 0.805, "load_throughput": 3106155.578, "learn_time_ms": 1372964.349, "learn_throughput": 1.821, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "0b7ab_00052", "date": "2024-03-14_20-01-32", "timestamp": 1710442892, "time_this_iter_s": 1388.5050563812256, "time_total_s": 22846.542869091034, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22846.542869091034, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 39.78364652107669, "ram_util_percent": 14.93133570340274}, "checkpoint_dir_name": "checkpoint_000015"}
{"custom_metrics": {"collisions_mean": 140.3, "collisions_min": 22, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4037069447306467, "policy_loss": -0.0018498857385189883, "vf_loss": 2.3101148938481835, "vf_explained_var": 0.31378296969950886, "kl": 0.007969923373432192, "entropy": 1.9957696549508763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28710.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500}, "sampler_results": {"episode_reward_max": -240.65587589704683, "episode_reward_min": -562.525553109307, "episode_reward_mean": -367.5260004192021, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 140.3, "collisions_min": 22, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6716754815118862, "mean_inference_ms": 9.086860989443505, "mean_action_processing_ms": 0.4415982933644244, "mean_env_wait_ms": 1.0209981375509412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8122518062591553, "StateBufferConnector_ms": 0.005973100662231445, "ViewRequirementAgentConnector_ms": 0.27810001373291016}}, "episode_reward_max": -240.65587589704683, "episode_reward_min": -562.525553109307, "episode_reward_mean": -367.5260004192021, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-398.0416448723068, -374.2161644841936, -366.607003098913, -411.4600995595001, -314.0874497440998, -405.2303051564222, -477.3977080322495, -426.92034715758666, -372.15284768017864, -373.330746037473, -396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6716754815118862, "mean_inference_ms": 9.086860989443505, "mean_action_processing_ms": 0.4415982933644244, "mean_env_wait_ms": 1.0209981375509412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8122518062591553, "StateBufferConnector_ms": 0.005973100662231445, "ViewRequirementAgentConnector_ms": 0.27810001373291016}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500, "num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.400345136510065, "num_agent_steps_trained_throughput_per_sec": 5.400345136510065, "timesteps_total": 127500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 127500, "timers": {"training_iteration_time_ms": 1395294.669, "sample_time_ms": 30040.271, "load_time_ms": 0.834, "load_throughput": 2995845.833, "learn_time_ms": 1365251.795, "learn_throughput": 1.831, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500}, "done": false, "episodes_total": 170, "training_iteration": 17, "trial_id": "0b7ab_00052", "date": "2024-03-14_20-24-41", "timestamp": 1710444281, "time_this_iter_s": 1388.8022282123566, "time_total_s": 24235.34509730339, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 24235.34509730339, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.30751269035533, "ram_util_percent": 14.32015228426396}, "checkpoint_dir_name": "checkpoint_000016"}
{"custom_metrics": {"collisions_mean": 144.16, "collisions_min": 36, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4955027743296205, "policy_loss": -0.00859868376269594, "vf_loss": 2.4718081132433882, "vf_explained_var": 0.25081461140479167, "kl": 0.009076648806142229, "entropy": 2.0179233682566675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30450.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000}, "sampler_results": {"episode_reward_max": -240.65587589704683, "episode_reward_min": -562.525553109307, "episode_reward_mean": -365.15363030333833, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 144.16, "collisions_min": 36, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6677614481834808, "mean_inference_ms": 9.068768085853657, "mean_action_processing_ms": 0.4407344807255471, "mean_env_wait_ms": 1.0190409128336197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8069562911987305, "StateBufferConnector_ms": 0.005942583084106445, "ViewRequirementAgentConnector_ms": 0.2738051414489746}}, "episode_reward_max": -240.65587589704683, "episode_reward_min": -562.525553109307, "episode_reward_mean": -365.15363030333833, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-396.08917134563194, -492.53767259430754, -451.2429232574756, -399.1950569923454, -374.8582706505916, -413.0179030446825, -273.9455402556831, -306.6118993196909, -398.91678040012545, -310.9802030761847, -356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6677614481834808, "mean_inference_ms": 9.068768085853657, "mean_action_processing_ms": 0.4407344807255471, "mean_env_wait_ms": 1.0190409128336197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8069562911987305, "StateBufferConnector_ms": 0.005942583084106445, "ViewRequirementAgentConnector_ms": 0.2738051414489746}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.413280161294785, "num_agent_steps_trained_throughput_per_sec": 5.413280161294785, "timesteps_total": 135000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 135000, "timers": {"training_iteration_time_ms": 1387791.429, "sample_time_ms": 29859.228, "load_time_ms": 0.823, "load_throughput": 3036006.717, "learn_time_ms": 1357929.572, "learn_throughput": 1.841, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "0b7ab_00052", "date": "2024-03-14_20-47-47", "timestamp": 1710445667, "time_this_iter_s": 1385.4838654994965, "time_total_s": 25620.828962802887, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25620.828962802887, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.33791348600509, "ram_util_percent": 13.672519083969465}, "checkpoint_dir_name": "checkpoint_000017"}
{"custom_metrics": {"collisions_mean": 142.14, "collisions_min": 36, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.382449268183307, "policy_loss": -0.0016042479399548865, "vf_loss": 2.274312735203354, "vf_explained_var": 0.39980761247804797, "kl": 0.008779755907663386, "entropy": 1.9609867174049904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32190.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500}, "sampler_results": {"episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -358.97947500152475, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 142.14, "collisions_min": 36, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6640215069725866, "mean_inference_ms": 9.051397651387049, "mean_action_processing_ms": 0.4399283984841225, "mean_env_wait_ms": 1.017124058205801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8052361011505127, "StateBufferConnector_ms": 0.005913257598876953, "ViewRequirementAgentConnector_ms": 0.2713203430175781}}, "episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -358.97947500152475, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-356.6110776044891, -356.86042365110734, -353.0149808693411, -297.92432276867396, -345.7644549583037, -350.8630368096774, -351.5827069813387, -313.51762110547, -395.8021449167479, -312.2808008987377, -455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6640215069725866, "mean_inference_ms": 9.051397651387049, "mean_action_processing_ms": 0.4399283984841225, "mean_env_wait_ms": 1.017124058205801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8052361011505127, "StateBufferConnector_ms": 0.005913257598876953, "ViewRequirementAgentConnector_ms": 0.2713203430175781}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500, "num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.462036050822836, "num_agent_steps_trained_throughput_per_sec": 5.462036050822836, "timesteps_total": 142500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 142500, "timers": {"training_iteration_time_ms": 1385362.82, "sample_time_ms": 29787.962, "load_time_ms": 0.845, "load_throughput": 2957233.911, "learn_time_ms": 1355572.239, "learn_throughput": 1.844, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500}, "done": false, "episodes_total": 190, "training_iteration": 19, "trial_id": "0b7ab_00052", "date": "2024-03-14_21-10-41", "timestamp": 1710447041, "time_this_iter_s": 1373.1163651943207, "time_total_s": 26993.945327997208, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26993.945327997208, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.88264887063656, "ram_util_percent": 12.136396303901437}, "checkpoint_dir_name": "checkpoint_000018"}
{"custom_metrics": {"collisions_mean": 149.94, "collisions_min": 40, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.456431015250514, "policy_loss": -0.0012657256443695775, "vf_loss": 2.3944646801414162, "vf_explained_var": 0.3572638196849275, "kl": 0.010989186264572938, "entropy": 2.0324535861782644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33930.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -363.2948413550686, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 149.94, "collisions_min": 40, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6609861553815295, "mean_inference_ms": 9.03655515745063, "mean_action_processing_ms": 0.4392844445004358, "mean_env_wait_ms": 1.0155078986082573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.806481122970581, "StateBufferConnector_ms": 0.005922079086303711, "ViewRequirementAgentConnector_ms": 0.27190375328063965}}, "episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -363.2948413550686, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-455.04115251096187, -283.954221980482, -426.91590044153355, -359.0541206643953, -493.43304473157076, -321.10986252100827, -371.06526622647516, -515.9735451488909, -402.6719056793088, -504.3058395551316, -310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6609861553815295, "mean_inference_ms": 9.03655515745063, "mean_action_processing_ms": 0.4392844445004358, "mean_env_wait_ms": 1.0155078986082573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.806481122970581, "StateBufferConnector_ms": 0.005922079086303711, "ViewRequirementAgentConnector_ms": 0.27190375328063965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.502196854059592, "num_agent_steps_trained_throughput_per_sec": 5.502196854059592, "timesteps_total": 150000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 1384011.19, "sample_time_ms": 29760.423, "load_time_ms": 0.845, "load_throughput": 2957650.975, "learn_time_ms": 1354248.146, "learn_throughput": 1.846, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "0b7ab_00052", "date": "2024-03-14_21-33-24", "timestamp": 1710448404, "time_this_iter_s": 1363.093965768814, "time_total_s": 28357.03929376602, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 28357.03929376602, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 36.386335403726704, "ram_util_percent": 11.462111801242235}, "checkpoint_dir_name": "checkpoint_000019"}
{"custom_metrics": {"collisions_mean": 141.92, "collisions_min": 30, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.2364304278183718, "policy_loss": -0.003849538154338069, "vf_loss": 2.036547571146625, "vf_explained_var": 0.37700353672449616, "kl": 0.01093050292016289, "entropy": 1.9630855008788493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35670.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500}, "sampler_results": {"episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -353.0839756297128, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 141.92, "collisions_min": 30, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6583516649385437, "mean_inference_ms": 9.022863499754909, "mean_action_processing_ms": 0.4387377738322392, "mean_env_wait_ms": 1.0140121104485846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8062059879302979, "StateBufferConnector_ms": 0.005925893783569336, "ViewRequirementAgentConnector_ms": 0.2722032070159912}}, "episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -353.0839756297128, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-310.6722484117626, -307.13796415360923, -427.85462033115186, -413.8380785126931, -347.9590829881422, -352.0194103674788, -369.41279620128824, -385.86928323720446, -428.7210978286236, -297.48927602979467, -363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6583516649385437, "mean_inference_ms": 9.022863499754909, "mean_action_processing_ms": 0.4387377738322392, "mean_env_wait_ms": 1.0140121104485846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8062059879302979, "StateBufferConnector_ms": 0.005925893783569336, "ViewRequirementAgentConnector_ms": 0.2722032070159912}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500, "num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.513560742308952, "num_agent_steps_trained_throughput_per_sec": 5.513560742308952, "timesteps_total": 157500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 157500, "timers": {"training_iteration_time_ms": 1381766.551, "sample_time_ms": 29713.389, "load_time_ms": 0.882, "load_throughput": 2835905.341, "learn_time_ms": 1352050.525, "learn_throughput": 1.849, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500}, "done": false, "episodes_total": 210, "training_iteration": 21, "trial_id": "0b7ab_00052", "date": "2024-03-14_21-56-05", "timestamp": 1710449765, "time_this_iter_s": 1360.2844469547272, "time_total_s": 29717.32374072075, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 29717.32374072075, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 36.29766718506999, "ram_util_percent": 11.28315189217211}, "checkpoint_dir_name": "checkpoint_000020"}
{"custom_metrics": {"collisions_mean": 142.74, "collisions_min": 30, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5209260868474617, "policy_loss": 0.00027466842840457786, "vf_loss": 2.497490667337659, "vf_explained_var": 0.3645322705137319, "kl": 0.01224448759578876, "entropy": 1.9581293843258387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37410.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "sampler_results": {"episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -353.51128422227544, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 142.74, "collisions_min": 30, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6558797206924174, "mean_inference_ms": 9.010376380836993, "mean_action_processing_ms": 0.43821692530393136, "mean_env_wait_ms": 1.0125866200494675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8053996562957764, "StateBufferConnector_ms": 0.00592350959777832, "ViewRequirementAgentConnector_ms": 0.2725222110748291}}, "episode_reward_max": -214.16775467956995, "episode_reward_min": -562.525553109307, "episode_reward_mean": -353.51128422227544, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-363.43363073611044, -482.9521121700236, -494.14173227367894, -289.8075818286338, -353.58117543326296, -411.6792306601722, -344.91091643149474, -344.02452019794566, -289.6065689099131, -382.05408630069473, -535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6558797206924174, "mean_inference_ms": 9.010376380836993, "mean_action_processing_ms": 0.43821692530393136, "mean_env_wait_ms": 1.0125866200494675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8053996562957764, "StateBufferConnector_ms": 0.00592350959777832, "ViewRequirementAgentConnector_ms": 0.2725222110748291}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000, "num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.53225366735401, "num_agent_steps_trained_throughput_per_sec": 5.53225366735401, "timesteps_total": 165000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 165000, "timers": {"training_iteration_time_ms": 1378594.934, "sample_time_ms": 29666.76, "load_time_ms": 0.826, "load_throughput": 3026717.469, "learn_time_ms": 1348925.595, "learn_throughput": 1.853, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "0b7ab_00052", "date": "2024-03-14_22-18-41", "timestamp": 1710451121, "time_this_iter_s": 1355.6883373260498, "time_total_s": 31073.0120780468, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 31073.0120780468, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 35.77709090909091, "ram_util_percent": 10.792363636363635}, "checkpoint_dir_name": "checkpoint_000021"}
{"custom_metrics": {"collisions_mean": 142.64, "collisions_min": 10, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5607601796226018, "policy_loss": 0.01301627954917735, "vf_loss": 2.543398872428927, "vf_explained_var": 0.31895993441000753, "kl": 0.009603821222594105, "entropy": 1.8934608615677933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39150.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500}, "sampler_results": {"episode_reward_max": -182.76935433965033, "episode_reward_min": -562.525553109307, "episode_reward_mean": -351.6900470341105, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 142.64, "collisions_min": 10, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6535149204046584, "mean_inference_ms": 8.998317861850843, "mean_action_processing_ms": 0.43769049654132475, "mean_env_wait_ms": 1.0112240786181403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8044824600219727, "StateBufferConnector_ms": 0.0059125423431396484, "ViewRequirementAgentConnector_ms": 0.2721695899963379}}, "episode_reward_max": -182.76935433965033, "episode_reward_min": -562.525553109307, "episode_reward_mean": -351.6900470341105, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-535.6175646508435, -292.9896591183184, -288.7083728341566, -296.57454123447474, -357.2410727874588, -299.2534815106097, -431.85763480988567, -333.6598483410503, -327.5568292518985, -315.77045945036576, -372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6535149204046584, "mean_inference_ms": 8.998317861850843, "mean_action_processing_ms": 0.43769049654132475, "mean_env_wait_ms": 1.0112240786181403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8044824600219727, "StateBufferConnector_ms": 0.0059125423431396484, "ViewRequirementAgentConnector_ms": 0.2721695899963379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500, "num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.53518650157237, "num_agent_steps_trained_throughput_per_sec": 5.53518650157237, "timesteps_total": 172500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 172500, "timers": {"training_iteration_time_ms": 1374993.608, "sample_time_ms": 29604.237, "load_time_ms": 0.87, "load_throughput": 2873362.015, "learn_time_ms": 1345386.765, "learn_throughput": 1.858, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500}, "done": false, "episodes_total": 230, "training_iteration": 23, "trial_id": "0b7ab_00052", "date": "2024-03-14_22-41-17", "timestamp": 1710452477, "time_this_iter_s": 1354.969985485077, "time_total_s": 32427.982063531876, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 32427.982063531876, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 41.38399168399168, "ram_util_percent": 16.13981288981289}, "checkpoint_dir_name": "checkpoint_000022"}
{"custom_metrics": {"collisions_mean": 145.04, "collisions_min": 10, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4214574221265368, "policy_loss": -0.006523715355701145, "vf_loss": 2.346545036000082, "vf_explained_var": 0.3238074684965199, "kl": 0.008958595061037286, "entropy": 1.8090139720631742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40890.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -182.76935433965033, "episode_reward_min": -562.525553109307, "episode_reward_mean": -350.61562996998305, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 145.04, "collisions_min": 10, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6511080049256963, "mean_inference_ms": 8.98612588805892, "mean_action_processing_ms": 0.43710650712727067, "mean_env_wait_ms": 1.009856308512413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8028759956359863, "StateBufferConnector_ms": 0.005935192108154297, "ViewRequirementAgentConnector_ms": 0.27118802070617676}}, "episode_reward_max": -182.76935433965033, "episode_reward_min": -562.525553109307, "episode_reward_mean": -350.61562996998305, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-372.83446466520866, -492.45459407857805, -374.35687927456974, -349.07109325213173, -273.18135988088517, -399.96117849142007, -361.084639092363, -346.08922382326585, -265.9987273824866, -336.4695712372563, -240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6511080049256963, "mean_inference_ms": 8.98612588805892, "mean_action_processing_ms": 0.43710650712727067, "mean_env_wait_ms": 1.009856308512413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8028759956359863, "StateBufferConnector_ms": 0.005935192108154297, "ViewRequirementAgentConnector_ms": 0.27118802070617676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.470598276840809, "num_agent_steps_trained_throughput_per_sec": 5.470598276840809, "timesteps_total": 180000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 1373015.448, "sample_time_ms": 29503.026, "load_time_ms": 0.873, "load_throughput": 2862771.65, "learn_time_ms": 1343509.796, "learn_throughput": 1.861, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "0b7ab_00052", "date": "2024-03-14_23-04-08", "timestamp": 1710453848, "time_this_iter_s": 1370.9674894809723, "time_total_s": 33798.94955301285, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 33798.94955301285, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 46.13244215938304, "ram_util_percent": 17.762365038560414}, "checkpoint_dir_name": "checkpoint_000023"}
{"custom_metrics": {"collisions_mean": 143.92, "collisions_min": 10, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.2173380883113514, "policy_loss": -0.0006149721915309114, "vf_loss": 2.0007829718034844, "vf_explained_var": 0.42195201019446055, "kl": 0.008918990773913563, "entropy": 1.8918149095157097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42630.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500}, "sampler_results": {"episode_reward_max": -182.76935433965033, "episode_reward_min": -562.525553109307, "episode_reward_mean": -346.9676713718106, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 143.92, "collisions_min": 10, "collisions_max": 340, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6491262347247968, "mean_inference_ms": 8.976070469847004, "mean_action_processing_ms": 0.4365965291558355, "mean_env_wait_ms": 1.008747905232656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.806107759475708, "StateBufferConnector_ms": 0.005953073501586914, "ViewRequirementAgentConnector_ms": 0.2715427875518799}}, "episode_reward_max": -182.76935433965033, "episode_reward_min": -562.525553109307, "episode_reward_mean": -346.9676713718106, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-240.65587589704683, -305.74652824607017, -268.3303275641714, -417.38337105948807, -246.05031325721248, -365.68655925868836, -365.67002519676186, -290.4631945609366, -251.7068316840374, -562.525553109307, -370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6491262347247968, "mean_inference_ms": 8.976070469847004, "mean_action_processing_ms": 0.4365965291558355, "mean_env_wait_ms": 1.008747905232656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.806107759475708, "StateBufferConnector_ms": 0.005953073501586914, "ViewRequirementAgentConnector_ms": 0.2715427875518799}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500, "num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.23409351761614, "num_agent_steps_trained_throughput_per_sec": 5.23409351761614, "timesteps_total": 187500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 187500, "timers": {"training_iteration_time_ms": 1377380.503, "sample_time_ms": 29614.976, "load_time_ms": 0.937, "load_throughput": 2669422.876, "learn_time_ms": 1347762.862, "learn_throughput": 1.855, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500}, "done": false, "episodes_total": 250, "training_iteration": 25, "trial_id": "0b7ab_00052", "date": "2024-03-14_23-28-02", "timestamp": 1710455282, "time_this_iter_s": 1432.9150085449219, "time_total_s": 35231.86456155777, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 35231.86456155777, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 60.31151008362026, "ram_util_percent": 21.92464338416134}, "checkpoint_dir_name": "checkpoint_000024"}
{"custom_metrics": {"collisions_mean": 146.72, "collisions_min": 10, "collisions_max": 322, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.999894576579675, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.6112004392419075, "policy_loss": -0.0008583349954529569, "vf_loss": 2.647822470080921, "vf_explained_var": 0.4287841691710483, "kl": 0.012563439592410979, "entropy": 2.002724277836153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44370.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000}, "sampler_results": {"episode_reward_max": -182.76935433965033, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -355.34328206656704, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 146.72, "collisions_min": 10, "collisions_max": 322, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6474786508996107, "mean_inference_ms": 8.968078191767523, "mean_action_processing_ms": 0.43618244723305766, "mean_env_wait_ms": 1.007847936892769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8064186573028564, "StateBufferConnector_ms": 0.005940437316894531, "ViewRequirementAgentConnector_ms": 0.2705421447753906}}, "episode_reward_max": -182.76935433965033, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -355.34328206656704, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-370.01171391320304, -417.33994020467077, -534.8337671962896, -311.0734564499655, -333.03266389243714, -412.8143070667597, -338.74720872545913, -407.63542112762286, -291.7988841714731, -268.6113243844186, -416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6474786508996107, "mean_inference_ms": 8.968078191767523, "mean_action_processing_ms": 0.43618244723305766, "mean_env_wait_ms": 1.007847936892769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8064186573028564, "StateBufferConnector_ms": 0.005940437316894531, "ViewRequirementAgentConnector_ms": 0.2705421447753906}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000, "num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.247746514347945, "num_agent_steps_trained_throughput_per_sec": 5.247746514347945, "timesteps_total": 195000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 195000, "timers": {"training_iteration_time_ms": 1381448.721, "sample_time_ms": 29717.708, "load_time_ms": 0.931, "load_throughput": 2684045.358, "learn_time_ms": 1351728.386, "learn_throughput": 1.849, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "0b7ab_00052", "date": "2024-03-14_23-51-52", "timestamp": 1710456712, "time_this_iter_s": 1429.1869885921478, "time_total_s": 36661.05155014992, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 36661.05155014992, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 60.713510848126234, "ram_util_percent": 23.68264299802761}, "checkpoint_dir_name": "checkpoint_000025"}
{"custom_metrics": {"collisions_mean": 142.0, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.515633050671072, "policy_loss": 0.0001100109279926481, "vf_loss": 2.4898341910763717, "vf_explained_var": 0.4798624882067757, "kl": 0.01065178663275324, "entropy": 1.9173894970581449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46110.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500}, "sampler_results": {"episode_reward_max": -182.76935433965033, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -353.85844084510865, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 142.0, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.646167430589344, "mean_inference_ms": 8.96188501909273, "mean_action_processing_ms": 0.4358466023095465, "mean_env_wait_ms": 1.0071738809698998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.807018518447876, "StateBufferConnector_ms": 0.005963563919067383, "ViewRequirementAgentConnector_ms": 0.2715940475463867}}, "episode_reward_max": -182.76935433965033, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -353.85844084510865, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-416.5785047382037, -449.82771468323676, -343.9614504373903, -259.45764962234284, -344.95879189557496, -420.5230789759343, -361.75068714047944, -366.8717706119172, -307.00885224833405, -411.26880388313043, -261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.646167430589344, "mean_inference_ms": 8.96188501909273, "mean_action_processing_ms": 0.4358466023095465, "mean_env_wait_ms": 1.0071738809698998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.807018518447876, "StateBufferConnector_ms": 0.005963563919067383, "ViewRequirementAgentConnector_ms": 0.2715940475463867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.235921856909575, "num_agent_steps_trained_throughput_per_sec": 5.235921856909575, "timesteps_total": 202500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 202500, "timers": {"training_iteration_time_ms": 1385809.96, "sample_time_ms": 29818.426, "load_time_ms": 0.958, "load_throughput": 2609761.318, "learn_time_ms": 1355988.906, "learn_throughput": 1.844, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500}, "done": false, "episodes_total": 270, "training_iteration": 27, "trial_id": "0b7ab_00052", "date": "2024-03-15_00-15-45", "timestamp": 1710458145, "time_this_iter_s": 1432.4145514965057, "time_total_s": 38093.46610164642, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 38093.46610164642, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 60.3628261939931, "ram_util_percent": 23.979468242245197}, "checkpoint_dir_name": "checkpoint_000026"}
{"custom_metrics": {"collisions_mean": 134.6, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4752844126981377, "policy_loss": -0.006353457159116522, "vf_loss": 2.432469722748488, "vf_explained_var": 0.3900541891996888, "kl": 0.013845279524233275, "entropy": 1.8438466400250622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47850.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "sampler_results": {"episode_reward_max": -182.76935433965033, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -348.4090632454383, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 134.6, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6452027744288058, "mean_inference_ms": 8.957355262117794, "mean_action_processing_ms": 0.4355898731753189, "mean_env_wait_ms": 1.0067095292110166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8094274997711182, "StateBufferConnector_ms": 0.005980968475341797, "ViewRequirementAgentConnector_ms": 0.2717859745025635}}, "episode_reward_max": -182.76935433965033, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -348.4090632454383, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-261.6028815193315, -233.03238477172658, -338.0106718448914, -429.211649763157, -327.65581007546507, -214.16775467956995, -379.26070574336484, -255.06690135931586, -421.09573004364637, -340.87540095489675, -414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6452027744288058, "mean_inference_ms": 8.957355262117794, "mean_action_processing_ms": 0.4355898731753189, "mean_env_wait_ms": 1.0067095292110166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8094274997711182, "StateBufferConnector_ms": 0.005980968475341797, "ViewRequirementAgentConnector_ms": 0.2717859745025635}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.259294656576471, "num_agent_steps_trained_throughput_per_sec": 5.259294656576471, "timesteps_total": 210000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 210000, "timers": {"training_iteration_time_ms": 1389866.475, "sample_time_ms": 29918.315, "load_time_ms": 0.952, "load_throughput": 2625378.067, "learn_time_ms": 1359945.586, "learn_throughput": 1.838, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "0b7ab_00052", "date": "2024-03-15_00-39-31", "timestamp": 1710459571, "time_this_iter_s": 1426.0487957000732, "time_total_s": 39519.5148973465, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 39519.5148973465, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 60.33211462450593, "ram_util_percent": 24.291699604743084}, "checkpoint_dir_name": "checkpoint_000027"}
{"custom_metrics": {"collisions_mean": 139.16, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4130902938020211, "policy_loss": 0.003194091678597033, "vf_loss": 2.3150515779339034, "vf_explained_var": 0.38246153257359033, "kl": 0.012439345129754576, "entropy": 1.7721246082207252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49590.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -352.1237986302666, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 139.16, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6444229580669265, "mean_inference_ms": 8.953796828341911, "mean_action_processing_ms": 0.43536838324838045, "mean_env_wait_ms": 1.006365715492249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8108081817626953, "StateBufferConnector_ms": 0.0059893131256103516, "ViewRequirementAgentConnector_ms": 0.2715766429901123}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -352.1237986302666, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-414.7814659671764, -236.41546667142396, -387.9692734115438, -358.5059252210997, -343.11381380376747, -457.5928162211472, -287.08909891765904, -480.50433142527805, -486.39892987448945, -413.387084404681, -373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6444229580669265, "mean_inference_ms": 8.953796828341911, "mean_action_processing_ms": 0.43536838324838045, "mean_env_wait_ms": 1.006365715492249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8108081817626953, "StateBufferConnector_ms": 0.0059893131256103516, "ViewRequirementAgentConnector_ms": 0.2715766429901123}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500, "num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.286659248166809, "num_agent_steps_trained_throughput_per_sec": 5.286659248166809, "timesteps_total": 217500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 217500, "timers": {"training_iteration_time_ms": 1394421.571, "sample_time_ms": 29967.264, "load_time_ms": 0.964, "load_throughput": 2592020.567, "learn_time_ms": 1364451.725, "learn_throughput": 1.832, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500}, "done": false, "episodes_total": 290, "training_iteration": 29, "trial_id": "0b7ab_00052", "date": "2024-03-15_01-03-11", "timestamp": 1710460991, "time_this_iter_s": 1418.6675276756287, "time_total_s": 40938.182425022125, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 40938.182425022125, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 59.8808648111332, "ram_util_percent": 24.632604373757456}, "checkpoint_dir_name": "checkpoint_000028"}
{"custom_metrics": {"collisions_mean": 138.54, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.610948838759749, "policy_loss": -0.0005264819883366768, "vf_loss": 2.646669385025556, "vf_explained_var": 0.3675302584280913, "kl": 0.012953257477299012, "entropy": 1.7861706529540577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51330.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -349.62901649249665, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 138.54, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6439161447364279, "mean_inference_ms": 8.951964485365293, "mean_action_processing_ms": 0.4352499868911994, "mean_env_wait_ms": 1.0062290195607002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8120033740997314, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.2709226608276367}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -349.62901649249665, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-373.53179655369456, -272.64913988604366, -305.42388818209565, -224.3864105664114, -393.1919522575405, -245.40346491588423, -344.5115455516938, -334.64987057953294, -336.88546683985203, -281.80475159143873, -409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6439161447364279, "mean_inference_ms": 8.951964485365293, "mean_action_processing_ms": 0.4352499868911994, "mean_env_wait_ms": 1.0062290195607002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8120033740997314, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.2709226608276367}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000, "num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.338638532059524, "num_agent_steps_trained_throughput_per_sec": 5.338638532059524, "timesteps_total": 225000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 225000, "timers": {"training_iteration_time_ms": 1398597.637, "sample_time_ms": 30067.307, "load_time_ms": 0.959, "load_throughput": 2607814.171, "learn_time_ms": 1368527.771, "learn_throughput": 1.827, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "0b7ab_00052", "date": "2024-03-15_01-26-36", "timestamp": 1710462396, "time_this_iter_s": 1404.854586839676, "time_total_s": 42343.0370118618, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 42343.0370118618, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 54.498142570281125, "ram_util_percent": 22.65963855421687}, "checkpoint_dir_name": "checkpoint_000029"}
{"custom_metrics": {"collisions_mean": 141.76, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.225363305047099, "policy_loss": 0.004417444312752321, "vf_loss": 2.004390635564067, "vf_explained_var": 0.34040620714083486, "kl": 0.011590658821892409, "entropy": 1.7687193290255536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53070.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -349.26199541054905, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 141.76, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.643477907111386, "mean_inference_ms": 8.9507063909692, "mean_action_processing_ms": 0.4351407088391436, "mean_env_wait_ms": 1.0061801957389462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8125097751617432, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.2709319591522217}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -349.26199541054905, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-409.57745240820725, -477.8204318047098, -462.09488570384246, -394.4510862210971, -268.14330158897275, -451.1946800728304, -274.40191398790057, -439.79624625145027, -254.97990884342025, -251.24481043556997, -308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.643477907111386, "mean_inference_ms": 8.9507063909692, "mean_action_processing_ms": 0.4351407088391436, "mean_env_wait_ms": 1.0061801957389462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8125097751617432, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.2709319591522217}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500, "num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.539541243079181, "num_agent_steps_trained_throughput_per_sec": 5.539541243079181, "timesteps_total": 232500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 232500, "timers": {"training_iteration_time_ms": 1397959.663, "sample_time_ms": 30072.254, "load_time_ms": 0.961, "load_throughput": 2600763.927, "learn_time_ms": 1367884.847, "learn_throughput": 1.828, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "done": false, "episodes_total": 310, "training_iteration": 31, "trial_id": "0b7ab_00052", "date": "2024-03-15_01-49-11", "timestamp": 1710463751, "time_this_iter_s": 1353.90474152565, "time_total_s": 43696.94175338745, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 43696.94175338745, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 44.08335933437337, "ram_util_percent": 17.612064482579303}, "checkpoint_dir_name": "checkpoint_000030"}
{"custom_metrics": {"collisions_mean": 140.22, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.2623886344405748, "policy_loss": -0.011889862477640225, "vf_loss": 2.0913736535471745, "vf_explained_var": 0.3829926926856754, "kl": 0.013254225902647736, "entropy": 1.8784474303667573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54810.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -343.0820359009945, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 140.22, "collisions_min": 10, "collisions_max": 312, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6429440509635318, "mean_inference_ms": 8.949035736695219, "mean_action_processing_ms": 0.43497606440111997, "mean_env_wait_ms": 1.0061039713471243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8097383975982666, "StateBufferConnector_ms": 0.005995512008666992, "ViewRequirementAgentConnector_ms": 0.26855015754699707}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -343.0820359009945, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-308.18060321105753, -349.5905010366867, -508.64682295289776, -182.76935433965033, -381.6865801137207, -448.0488534642983, -452.73423873087756, -322.3663608928984, -361.70173695350996, -258.3427844298444, -223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6429440509635318, "mean_inference_ms": 8.949035736695219, "mean_action_processing_ms": 0.43497606440111997, "mean_env_wait_ms": 1.0061039713471243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8097383975982666, "StateBufferConnector_ms": 0.005995512008666992, "ViewRequirementAgentConnector_ms": 0.26855015754699707}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.55189886869217, "num_agent_steps_trained_throughput_per_sec": 5.55189886869217, "timesteps_total": 240000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 1397479.958, "sample_time_ms": 29974.763, "load_time_ms": 0.934, "load_throughput": 2676850.812, "learn_time_ms": 1367502.671, "learn_throughput": 1.828, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "0b7ab_00052", "date": "2024-03-15_02-11-43", "timestamp": 1710465103, "time_this_iter_s": 1350.8912601470947, "time_total_s": 45047.833013534546, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 45047.833013534546, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 42.13057291666667, "ram_util_percent": 16.520625}, "checkpoint_dir_name": "checkpoint_000031"}
{"custom_metrics": {"collisions_mean": 142.24, "collisions_min": 12, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5278034681859747, "policy_loss": -0.004127596046550778, "vf_loss": 2.5167727019466546, "vf_explained_var": 0.42253582097333053, "kl": 0.010803578534819546, "entropy": 1.919525737049936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56550.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -345.0338014773581, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 142.24, "collisions_min": 12, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6423631796422, "mean_inference_ms": 8.94714866655749, "mean_action_processing_ms": 0.4347750282992902, "mean_env_wait_ms": 1.0060222797670741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8102390766143799, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.2675955295562744}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -345.0338014773581, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-223.3192018731892, -326.2876986301913, -438.08069566351554, -408.5109637204645, -366.0854826125697, -470.889885143539, -290.05914385898024, -261.1813077175755, -298.70683336085943, -288.66654499542557, -419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6423631796422, "mean_inference_ms": 8.94714866655749, "mean_action_processing_ms": 0.4347750282992902, "mean_env_wait_ms": 1.0060222797670741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8102390766143799, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.2675955295562744}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.55608246447069, "num_agent_steps_trained_throughput_per_sec": 5.55608246447069, "timesteps_total": 247500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 247500, "timers": {"training_iteration_time_ms": 1396970.364, "sample_time_ms": 29903.57, "load_time_ms": 0.889, "load_throughput": 2813609.531, "learn_time_ms": 1367064.316, "learn_throughput": 1.829, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500}, "done": false, "episodes_total": 330, "training_iteration": 33, "trial_id": "0b7ab_00052", "date": "2024-03-15_02-34-13", "timestamp": 1710466453, "time_this_iter_s": 1349.8740260601044, "time_total_s": 46397.70703959465, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 46397.70703959465, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 42.079134063641106, "ram_util_percent": 16.496139801773605}, "checkpoint_dir_name": "checkpoint_000032"}
{"custom_metrics": {"collisions_mean": 142.96, "collisions_min": 12, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.6277984830481267, "policy_loss": -0.0015703873505451898, "vf_loss": 2.677164256906715, "vf_explained_var": 0.368764939972724, "kl": 0.010856357059862518, "entropy": 1.9202634798384262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58290.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -347.74758534195286, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 142.96, "collisions_min": 12, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6418945239931582, "mean_inference_ms": 8.94618358168356, "mean_action_processing_ms": 0.43459883997010385, "mean_env_wait_ms": 1.0059778484246165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8135204315185547, "StateBufferConnector_ms": 0.005954265594482422, "ViewRequirementAgentConnector_ms": 0.2683393955230713}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -347.74758534195286, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-419.487627629153, -421.6568995686995, -185.4591777562318, -401.59802279831, -260.00191746555487, -303.5524150238765, -332.0429186879316, -193.7940754981267, -275.2861375677891, -413.82667936524473, -316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6418945239931582, "mean_inference_ms": 8.94618358168356, "mean_action_processing_ms": 0.43459883997010385, "mean_env_wait_ms": 1.0059778484246165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8135204315185547, "StateBufferConnector_ms": 0.005954265594482422, "ViewRequirementAgentConnector_ms": 0.2683393955230713}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000, "num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.556993604483362, "num_agent_steps_trained_throughput_per_sec": 5.556993604483362, "timesteps_total": 255000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 255000, "timers": {"training_iteration_time_ms": 1394838.906, "sample_time_ms": 29938.054, "load_time_ms": 0.989, "load_throughput": 2527359.059, "learn_time_ms": 1364898.266, "learn_throughput": 1.832, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "0b7ab_00052", "date": "2024-03-15_02-56-43", "timestamp": 1710467803, "time_this_iter_s": 1349.6527569293976, "time_total_s": 47747.35979652405, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 47747.35979652405, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 42.128273343766296, "ram_util_percent": 16.664684402712567}, "checkpoint_dir_name": "checkpoint_000033"}
{"custom_metrics": {"collisions_mean": 146.76, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4272593370894366, "policy_loss": -0.0037165248407928764, "vf_loss": 2.349600129891401, "vf_explained_var": 0.33358620127727245, "kl": 0.012755464370408963, "entropy": 1.888448370804732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60030.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -351.834108645301, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 146.76, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6410255205124957, "mean_inference_ms": 8.942708400293174, "mean_action_processing_ms": 0.43430404969733927, "mean_env_wait_ms": 1.0057029126820003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8083291053771973, "StateBufferConnector_ms": 0.00609278678894043, "ViewRequirementAgentConnector_ms": 0.26659417152404785}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -1012.2964982426865, "episode_reward_mean": -351.834108645301, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-316.5568409985231, -530.7691123329806, -1012.2964982426865, -275.4957206752994, -282.88354896826837, -394.88248463792377, -411.5554871780874, -393.95364275080425, -252.99024229443873, -280.39607123037024, -270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6410255205124957, "mean_inference_ms": 8.942708400293174, "mean_action_processing_ms": 0.43430404969733927, "mean_env_wait_ms": 1.0057029126820003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8083291053771973, "StateBufferConnector_ms": 0.00609278678894043, "ViewRequirementAgentConnector_ms": 0.26659417152404785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500, "num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.553116179456153, "num_agent_steps_trained_throughput_per_sec": 5.553116179456153, "timesteps_total": 262500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 262500, "timers": {"training_iteration_time_ms": 1386606.921, "sample_time_ms": 29693.049, "load_time_ms": 0.92, "load_throughput": 2717151.667, "learn_time_ms": 1356911.303, "learn_throughput": 1.842, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500}, "done": false, "episodes_total": 350, "training_iteration": 35, "trial_id": "0b7ab_00052", "date": "2024-03-15_03-19-15", "timestamp": 1710469155, "time_this_iter_s": 1350.595121383667, "time_total_s": 49097.954917907715, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 49097.954917907715, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 42.128534167970784, "ram_util_percent": 16.56103286384976}, "checkpoint_dir_name": "checkpoint_000034"}
{"custom_metrics": {"collisions_mean": 146.38, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5841531710398127, "policy_loss": 0.009715110187193957, "vf_loss": 2.585790844861118, "vf_explained_var": 0.3953206604239584, "kl": 0.012754618479327013, "entropy": 1.8758350144172538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61770.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -345.41773903791204, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 146.38, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6398061604967507, "mean_inference_ms": 8.937212183874285, "mean_action_processing_ms": 0.4338881006420648, "mean_env_wait_ms": 1.0052094457290806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8027164936065674, "StateBufferConnector_ms": 0.006041049957275391, "ViewRequirementAgentConnector_ms": 0.2629249095916748}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -345.41773903791204, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-270.08812766272945, -240.9771685620962, -324.88862059836816, -305.4526631641238, -463.3014452040904, -240.03585268865976, -442.39571428172815, -446.20749623461165, -399.6895433177735, -404.3779332722603, -227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6398061604967507, "mean_inference_ms": 8.937212183874285, "mean_action_processing_ms": 0.4338881006420648, "mean_env_wait_ms": 1.0052094457290806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8027164936065674, "StateBufferConnector_ms": 0.006041049957275391, "ViewRequirementAgentConnector_ms": 0.2629249095916748}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.551856831260411, "num_agent_steps_trained_throughput_per_sec": 5.551856831260411, "timesteps_total": 270000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 1378778.372, "sample_time_ms": 29464.327, "load_time_ms": 0.92, "load_throughput": 2716236.659, "learn_time_ms": 1349311.481, "learn_throughput": 1.853, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "0b7ab_00052", "date": "2024-03-15_03-41-46", "timestamp": 1710470506, "time_this_iter_s": 1350.901396036148, "time_total_s": 50448.85631394386, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 50448.85631394386, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 42.11762252346194, "ram_util_percent": 16.62455683003128}, "checkpoint_dir_name": "checkpoint_000035"}
{"custom_metrics": {"collisions_mean": 150.52, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.3633137965676556, "policy_loss": 0.0029018595175758733, "vf_loss": 2.2336080307847466, "vf_explained_var": 0.3645668443934671, "kl": 0.01238807477419942, "entropy": 1.8507253241950068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63510.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -344.3998832781744, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 150.52, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6383383849752664, "mean_inference_ms": 8.930165850610797, "mean_action_processing_ms": 0.43339119033562284, "mean_env_wait_ms": 1.0045368818333333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7985002994537354, "StateBufferConnector_ms": 0.005994081497192383, "ViewRequirementAgentConnector_ms": 0.2606208324432373}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -344.3998832781744, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-227.93099746292907, -306.38789818174934, -520.2479217935578, -302.4697332347556, -261.2425053567637, -236.64512441399452, -289.02956071282364, -317.30937901725724, -437.62803706249747, -238.37838703319213, -351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6383383849752664, "mean_inference_ms": 8.930165850610797, "mean_action_processing_ms": 0.43339119033562284, "mean_env_wait_ms": 1.0045368818333333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7985002994537354, "StateBufferConnector_ms": 0.005994081497192383, "ViewRequirementAgentConnector_ms": 0.2606208324432373}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500, "num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.524409394950343, "num_agent_steps_trained_throughput_per_sec": 5.524409394950343, "timesteps_total": 277500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 277500, "timers": {"training_iteration_time_ms": 1371298.239, "sample_time_ms": 29278.726, "load_time_ms": 0.86, "load_throughput": 2906252.772, "learn_time_ms": 1342017.0, "learn_throughput": 1.863, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500}, "done": false, "episodes_total": 370, "training_iteration": 37, "trial_id": "0b7ab_00052", "date": "2024-03-15_04-04-24", "timestamp": 1710471864, "time_this_iter_s": 1357.6132106781006, "time_total_s": 51806.46952462196, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 51806.46952462196, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 42.15739491437467, "ram_util_percent": 16.57327451997924}, "checkpoint_dir_name": "checkpoint_000036"}
{"custom_metrics": {"collisions_mean": 156.78, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.468885935869084, "policy_loss": -0.0029966163566742822, "vf_loss": 2.4182124334505235, "vf_explained_var": 0.45786564017849407, "kl": 0.010193851168272284, "entropy": 1.8537114511276114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65250.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "sampler_results": {"episode_reward_max": -164.70745611415506, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -347.53739799124696, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 156.78, "collisions_min": 16, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6366059044914933, "mean_inference_ms": 8.921600771886515, "mean_action_processing_ms": 0.4327982410924085, "mean_env_wait_ms": 1.003699900368988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.793053388595581, "StateBufferConnector_ms": 0.0059261322021484375, "ViewRequirementAgentConnector_ms": 0.2573516368865967}}, "episode_reward_max": -164.70745611415506, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -347.53739799124696, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-351.7739126793816, -406.06086693927756, -479.60505172233525, -164.70745611415506, -394.34837278933696, -421.87029050020226, -450.3030457005456, -397.86998719457785, -275.324738212058, -229.58970738632502, -269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6366059044914933, "mean_inference_ms": 8.921600771886515, "mean_action_processing_ms": 0.4327982410924085, "mean_env_wait_ms": 1.003699900368988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.793053388595581, "StateBufferConnector_ms": 0.0059261322021484375, "ViewRequirementAgentConnector_ms": 0.2573516368865967}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000, "num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.531523098827844, "num_agent_steps_trained_throughput_per_sec": 5.531523098827844, "timesteps_total": 285000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 285000, "timers": {"training_iteration_time_ms": 1364280.091, "sample_time_ms": 29077.562, "load_time_ms": 0.86, "load_throughput": 2906816.733, "learn_time_ms": 1335200.04, "learn_throughput": 1.872, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "0b7ab_00052", "date": "2024-03-15_04-27-01", "timestamp": 1710473221, "time_this_iter_s": 1355.8673133850098, "time_total_s": 53162.33683800697, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 53162.33683800697, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 42.15608108108108, "ram_util_percent": 16.61720374220374}, "checkpoint_dir_name": "checkpoint_000037"}
{"custom_metrics": {"collisions_mean": 154.08, "collisions_min": 52, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9999750790582306, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4569907997906792, "policy_loss": -0.0043644341059435885, "vf_loss": 2.3994274247309257, "vf_explained_var": 0.39623015163273645, "kl": 0.013136246203727239, "entropy": 1.7416796319786159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66990.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500}, "sampler_results": {"episode_reward_max": -228.40389602191246, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -344.69009782983494, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 154.08, "collisions_min": 52, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6347048154489243, "mean_inference_ms": 8.912164971194809, "mean_action_processing_ms": 0.4321625470365786, "mean_env_wait_ms": 1.0027482772707683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7895543575286865, "StateBufferConnector_ms": 0.005896568298339844, "ViewRequirementAgentConnector_ms": 0.25581884384155273}}, "episode_reward_max": -228.40389602191246, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -344.69009782983494, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-269.4860380360792, -402.48416683671985, -305.6213199934772, -485.11733179398976, -417.09503657334386, -285.28924472744797, -440.45344537129574, -281.1473070743164, -415.0027521741728, -314.58334956042364, -324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6347048154489243, "mean_inference_ms": 8.912164971194809, "mean_action_processing_ms": 0.4321625470365786, "mean_env_wait_ms": 1.0027482772707683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7895543575286865, "StateBufferConnector_ms": 0.005896568298339844, "ViewRequirementAgentConnector_ms": 0.25581884384155273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500, "num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.559372084039686, "num_agent_steps_trained_throughput_per_sec": 5.559372084039686, "timesteps_total": 292500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 292500, "timers": {"training_iteration_time_ms": 1357320.883, "sample_time_ms": 28933.919, "load_time_ms": 0.877, "load_throughput": 2850010.872, "learn_time_ms": 1328384.447, "learn_throughput": 1.882, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500}, "done": false, "episodes_total": 390, "training_iteration": 39, "trial_id": "0b7ab_00052", "date": "2024-03-15_04-49-31", "timestamp": 1710474571, "time_this_iter_s": 1349.0752930641174, "time_total_s": 54511.41213107109, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 54511.41213107109, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 42.12529994783517, "ram_util_percent": 16.579447052686486}, "checkpoint_dir_name": "checkpoint_000038"}
{"custom_metrics": {"collisions_mean": 153.46, "collisions_min": 52, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.4660682616923968, "policy_loss": -0.004844435325545398, "vf_loss": 2.4135824053109376, "vf_explained_var": 0.46619182588725255, "kl": 0.01633527401209622, "entropy": 1.904017512277625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68730.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -228.40389602191246, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -343.0873378984454, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 153.46, "collisions_min": 52, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6327379741442232, "mean_inference_ms": 8.902128001387393, "mean_action_processing_ms": 0.4315187989624269, "mean_env_wait_ms": 1.0017156586125793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7876324653625488, "StateBufferConnector_ms": 0.005883693695068359, "ViewRequirementAgentConnector_ms": 0.2564706802368164}}, "episode_reward_max": -228.40389602191246, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -343.0873378984454, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-324.50267955255407, -258.57982253330954, -249.7002820142491, -351.58698185529073, -250.06415221269003, -300.59948013734186, -397.67478379375353, -255.39891302057478, -358.42461125234763, -329.20447235733076, -431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6327379741442232, "mean_inference_ms": 8.902128001387393, "mean_action_processing_ms": 0.4315187989624269, "mean_env_wait_ms": 1.0017156586125793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7876324653625488, "StateBufferConnector_ms": 0.005883693695068359, "ViewRequirementAgentConnector_ms": 0.2564706802368164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.564171553695224, "num_agent_steps_trained_throughput_per_sec": 5.564171553695224, "timesteps_total": 300000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 1351626.582, "sample_time_ms": 28823.317, "load_time_ms": 0.88, "load_throughput": 2840745.557, "learn_time_ms": 1322800.702, "learn_throughput": 1.89, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "0b7ab_00052", "date": "2024-03-15_05-12-00", "timestamp": 1710475920, "time_this_iter_s": 1347.9118554592133, "time_total_s": 55859.323986530304, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 55859.323986530304, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 42.099007832898174, "ram_util_percent": 16.66344647519582}, "checkpoint_dir_name": "checkpoint_000039"}
{"custom_metrics": {"collisions_mean": 151.44, "collisions_min": 46, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.340958546900094, "policy_loss": 0.0006306949842335849, "vf_loss": 2.2013025828219694, "vf_explained_var": 0.44452970935695474, "kl": 0.010848985154381352, "entropy": 1.6840440728883634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70470.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500}, "sampler_results": {"episode_reward_max": -222.0721973053833, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -342.77606649539234, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 151.44, "collisions_min": 46, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6307853727485468, "mean_inference_ms": 8.89213030686656, "mean_action_processing_ms": 0.43087078058524164, "mean_env_wait_ms": 1.0006782956388605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7857728004455566, "StateBufferConnector_ms": 0.005869865417480469, "ViewRequirementAgentConnector_ms": 0.2554643154144287}}, "episode_reward_max": -222.0721973053833, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -342.77606649539234, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-431.09294139078014, -228.40389602191246, -238.4660932500721, -283.44797944839434, -246.6633409587869, -277.56143107136637, -413.71235015295906, -291.97494556483787, -292.0738745543773, -362.3119139490535, -453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6307853727485468, "mean_inference_ms": 8.89213030686656, "mean_action_processing_ms": 0.43087078058524164, "mean_env_wait_ms": 1.0006782956388605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7857728004455566, "StateBufferConnector_ms": 0.005869865417480469, "ViewRequirementAgentConnector_ms": 0.2554643154144287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500, "num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.568631116613454, "num_agent_steps_trained_throughput_per_sec": 5.568631116613454, "timesteps_total": 307500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 307500, "timers": {"training_iteration_time_ms": 1350919.319, "sample_time_ms": 28766.478, "load_time_ms": 0.91, "load_throughput": 2747336.704, "learn_time_ms": 1322150.236, "learn_throughput": 1.891, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500}, "done": false, "episodes_total": 410, "training_iteration": 41, "trial_id": "0b7ab_00052", "date": "2024-03-15_05-34-28", "timestamp": 1710477268, "time_this_iter_s": 1346.8321845531464, "time_total_s": 57206.15617108345, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 57206.15617108345, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 42.10993204391009, "ram_util_percent": 16.66555148980659}, "checkpoint_dir_name": "checkpoint_000040"}
{"custom_metrics": {"collisions_mean": 151.88, "collisions_min": 46, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.525505300324635, "policy_loss": -0.0016143835952569699, "vf_loss": 2.5065998505586866, "vf_explained_var": 0.42925233649111344, "kl": 0.015362321699994309, "entropy": 1.9038400717507833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72210.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000}, "sampler_results": {"episode_reward_max": -222.0721973053833, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -346.5853347696682, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 151.88, "collisions_min": 46, "collisions_max": 320, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6290110943326106, "mean_inference_ms": 8.883119009718193, "mean_action_processing_ms": 0.43029401457838395, "mean_env_wait_ms": 0.9997280834118965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.786806583404541, "StateBufferConnector_ms": 0.0060465335845947266, "ViewRequirementAgentConnector_ms": 0.2559947967529297}}, "episode_reward_max": -222.0721973053833, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -346.5853347696682, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-453.52644714000456, -252.76776061348227, -417.05081032745477, -357.96905222369264, -268.18460887648484, -522.4582421248372, -278.58932726481584, -374.0701480823793, -422.55693437791814, -422.0710627307294, -307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6290110943326106, "mean_inference_ms": 8.883119009718193, "mean_action_processing_ms": 0.43029401457838395, "mean_env_wait_ms": 0.9997280834118965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.786806583404541, "StateBufferConnector_ms": 0.0060465335845947266, "ViewRequirementAgentConnector_ms": 0.2559947967529297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.58293982262362, "num_agent_steps_trained_throughput_per_sec": 5.58293982262362, "timesteps_total": 315000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 315000, "timers": {"training_iteration_time_ms": 1350168.229, "sample_time_ms": 28812.433, "load_time_ms": 0.908, "load_throughput": 2754047.381, "learn_time_ms": 1321353.161, "learn_throughput": 1.892, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "0b7ab_00052", "date": "2024-03-15_05-56-52", "timestamp": 1710478612, "time_this_iter_s": 1343.38032412529, "time_total_s": 58549.53649520874, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 58549.53649520874, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 42.13321110529072, "ram_util_percent": 16.87433211105291}, "checkpoint_dir_name": "checkpoint_000041"}
{"custom_metrics": {"collisions_mean": 146.5, "collisions_min": 44, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.3937126170459133, "policy_loss": -0.009996281718385631, "vf_loss": 2.3050020058435954, "vf_explained_var": 0.35856881861029, "kl": 0.012162078996338654, "entropy": 1.7821953988623345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73950.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500}, "sampler_results": {"episode_reward_max": -208.6536103503295, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -339.3537998596187, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 146.5, "collisions_min": 44, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.627367010560594, "mean_inference_ms": 8.874843233168091, "mean_action_processing_ms": 0.4297738188688996, "mean_env_wait_ms": 0.9988546141257109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7870631217956543, "StateBufferConnector_ms": 0.0060613155364990234, "ViewRequirementAgentConnector_ms": 0.2570476531982422}}, "episode_reward_max": -208.6536103503295, "episode_reward_min": -561.1490015704503, "episode_reward_mean": -339.3537998596187, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-307.69857496776666, -385.569775896793, -355.1453077988648, -286.0789827215911, -561.1490015704503, -271.58878306446735, -291.90889416123395, -308.63602188053494, -410.4940916935355, -464.8967102805417, -469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.627367010560594, "mean_inference_ms": 8.874843233168091, "mean_action_processing_ms": 0.4297738188688996, "mean_env_wait_ms": 0.9988546141257109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7870631217956543, "StateBufferConnector_ms": 0.0060613155364990234, "ViewRequirementAgentConnector_ms": 0.2570476531982422}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500, "num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.566868264855671, "num_agent_steps_trained_throughput_per_sec": 5.566868264855671, "timesteps_total": 322500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 322500, "timers": {"training_iteration_time_ms": 1349906.693, "sample_time_ms": 28842.487, "load_time_ms": 0.908, "load_throughput": 2754047.381, "learn_time_ms": 1321061.55, "learn_throughput": 1.892, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500}, "done": false, "episodes_total": 430, "training_iteration": 43, "trial_id": "0b7ab_00052", "date": "2024-03-15_06-19-21", "timestamp": 1710479961, "time_this_iter_s": 1347.2587957382202, "time_total_s": 59896.79529094696, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 59896.79529094696, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 42.139675901725035, "ram_util_percent": 16.851332984840568}, "checkpoint_dir_name": "checkpoint_000042"}
{"custom_metrics": {"collisions_mean": 144.5, "collisions_min": 44, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9999234824687585, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5397751089809035, "policy_loss": -0.000174181522458963, "vf_loss": 2.529114913306702, "vf_explained_var": 0.44315135061055766, "kl": 0.012542098349187096, "entropy": 2.027623063394393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75690.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000}, "sampler_results": {"episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -338.14444936555833, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 144.5, "collisions_min": 44, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.62581965050582, "mean_inference_ms": 8.866639837235402, "mean_action_processing_ms": 0.42929907200747136, "mean_env_wait_ms": 0.9980428123131517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7846307754516602, "StateBufferConnector_ms": 0.006061553955078125, "ViewRequirementAgentConnector_ms": 0.25676870346069336}}, "episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -338.14444936555833, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-469.79415548329797, -236.56379216151805, -438.48864696222734, -352.5169904518081, -265.1722578975334, -269.3059449681763, -298.8498020295567, -405.88420642812235, -446.4660235836559, -432.3163817298401, -536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.62581965050582, "mean_inference_ms": 8.866639837235402, "mean_action_processing_ms": 0.42929907200747136, "mean_env_wait_ms": 0.9980428123131517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7846307754516602, "StateBufferConnector_ms": 0.006061553955078125, "ViewRequirementAgentConnector_ms": 0.25676870346069336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.552941803016038, "num_agent_steps_trained_throughput_per_sec": 5.552941803016038, "timesteps_total": 330000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 330000, "timers": {"training_iteration_time_ms": 1350005.173, "sample_time_ms": 28821.034, "load_time_ms": 0.856, "load_throughput": 2921231.369, "learn_time_ms": 1321181.572, "learn_throughput": 1.892, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000}, "done": false, "episodes_total": 440, "training_iteration": 44, "trial_id": "0b7ab_00052", "date": "2024-03-15_06-41-52", "timestamp": 1710481312, "time_this_iter_s": 1350.637425661087, "time_total_s": 61247.43271660805, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 61247.43271660805, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 42.12578288100209, "ram_util_percent": 16.86049060542798}, "checkpoint_dir_name": "checkpoint_000043"}
{"custom_metrics": {"collisions_mean": 139.62, "collisions_min": 44, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.2872652324788332, "policy_loss": 0.007953536893701416, "vf_loss": 2.099774946208144, "vf_explained_var": 0.4983321425901062, "kl": 0.013021725151121186, "entropy": 1.8545383817505563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77430.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 112500, "num_env_steps_trained": 112500, "num_agent_steps_sampled": 337500, "num_agent_steps_trained": 337500}, "sampler_results": {"episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -333.6116577080692, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 139.62, "collisions_min": 44, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6243589576408528, "mean_inference_ms": 8.858867390653108, "mean_action_processing_ms": 0.42885691154276473, "mean_env_wait_ms": 0.9972819458996716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7841489315032959, "StateBufferConnector_ms": 0.005876064300537109, "ViewRequirementAgentConnector_ms": 0.2558159828186035}}, "episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -333.6116577080692, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-536.0694011855168, -241.2796812822381, -453.4871853809153, -368.3601742349032, -250.5485571777793, -286.6884001479677, -328.0023337196028, -370.965443424529, -427.98143557725876, -246.76007643976706, -436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6243589576408528, "mean_inference_ms": 8.858867390653108, "mean_action_processing_ms": 0.42885691154276473, "mean_env_wait_ms": 0.9972819458996716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7841489315032959, "StateBufferConnector_ms": 0.005876064300537109, "ViewRequirementAgentConnector_ms": 0.2558159828186035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337500, "num_agent_steps_trained": 337500, "num_env_steps_sampled": 112500, "num_env_steps_trained": 112500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.56365102975345, "num_agent_steps_trained_throughput_per_sec": 5.56365102975345, "timesteps_total": 337500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 337500, "timers": {"training_iteration_time_ms": 1349749.436, "sample_time_ms": 28824.573, "load_time_ms": 0.861, "load_throughput": 2902070.187, "learn_time_ms": 1320922.344, "learn_throughput": 1.893, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 112500, "num_env_steps_trained": 112500, "num_agent_steps_sampled": 337500, "num_agent_steps_trained": 337500}, "done": false, "episodes_total": 450, "training_iteration": 45, "trial_id": "0b7ab_00052", "date": "2024-03-15_07-04-20", "timestamp": 1710482660, "time_this_iter_s": 1348.0384948253632, "time_total_s": 62595.47121143341, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 62595.47121143341, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 42.14291688447465, "ram_util_percent": 16.75541035023523}, "checkpoint_dir_name": "checkpoint_000044"}
{"custom_metrics": {"collisions_mean": 136.68, "collisions_min": 28, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.47042093588984, "policy_loss": -0.007135929076011753, "vf_loss": 2.4248422026719854, "vf_explained_var": 0.5333617039453025, "kl": 0.015685128914520157, "entropy": 1.779546299302715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79170.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 115000, "num_env_steps_trained": 115000, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 345000}, "sampler_results": {"episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -330.6811639138258, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 136.68, "collisions_min": 28, "collisions_max": 294, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6229399723752913, "mean_inference_ms": 8.851665390639228, "mean_action_processing_ms": 0.42842228895898304, "mean_env_wait_ms": 0.9965475016832122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7842464447021484, "StateBufferConnector_ms": 0.00587773323059082, "ViewRequirementAgentConnector_ms": 0.25600576400756836}}, "episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -330.6811639138258, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-436.4872284992571, -431.3475002758425, -299.42011463743165, -435.7943352922068, -355.71950848797576, -387.1561967143381, -235.47170095498123, -256.99114233271433, -328.11667045754035, -269.12459136040235, -414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6229399723752913, "mean_inference_ms": 8.851665390639228, "mean_action_processing_ms": 0.42842228895898304, "mean_env_wait_ms": 0.9965475016832122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7842464447021484, "StateBufferConnector_ms": 0.00587773323059082, "ViewRequirementAgentConnector_ms": 0.25600576400756836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 345000, "num_env_steps_sampled": 115000, "num_env_steps_trained": 115000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.374977762951064, "num_agent_steps_trained_throughput_per_sec": 5.374977762951064, "timesteps_total": 345000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 345000, "timers": {"training_iteration_time_ms": 1354194.958, "sample_time_ms": 28833.293, "load_time_ms": 0.864, "load_throughput": 2894220.259, "learn_time_ms": 1325359.138, "learn_throughput": 1.886, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 115000, "num_env_steps_trained": 115000, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 345000}, "done": false, "episodes_total": 460, "training_iteration": 46, "trial_id": "0b7ab_00052", "date": "2024-03-15_07-27-36", "timestamp": 1710484056, "time_this_iter_s": 1395.356639623642, "time_total_s": 63990.82785105705, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 63990.82785105705, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 52.705855628470474, "ram_util_percent": 20.553407370015144}, "checkpoint_dir_name": "checkpoint_000045"}
{"custom_metrics": {"collisions_mean": 135.08, "collisions_min": 28, "collisions_max": 304, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.6121115582279228, "policy_loss": 0.0024844268192376557, "vf_loss": 2.6428398137034357, "vf_explained_var": 0.40932515743135034, "kl": 0.014546240900268334, "entropy": 1.7541717021972283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80910.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 117500, "num_env_steps_trained": 117500, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352500}, "sampler_results": {"episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -330.4832530743927, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 135.08, "collisions_min": 28, "collisions_max": 304, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6216050675882918, "mean_inference_ms": 8.84507256033004, "mean_action_processing_ms": 0.4280320775546912, "mean_env_wait_ms": 0.9958918713927494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7847976684570312, "StateBufferConnector_ms": 0.00587773323059082, "ViewRequirementAgentConnector_ms": 0.2562732696533203}}, "episode_reward_max": -208.6536103503295, "episode_reward_min": -536.5690015047951, "episode_reward_mean": -330.4832530743927, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-414.194977560807, -313.50071150176626, -276.08187057729157, -467.443867302075, -275.06105751156343, -272.46468326157094, -319.2294216544113, -536.5690015047951, -322.4676947166176, -254.0077299858752, -247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6216050675882918, "mean_inference_ms": 8.84507256033004, "mean_action_processing_ms": 0.4280320775546912, "mean_env_wait_ms": 0.9958918713927494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7847976684570312, "StateBufferConnector_ms": 0.00587773323059082, "ViewRequirementAgentConnector_ms": 0.2562732696533203}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352500, "num_env_steps_sampled": 117500, "num_env_steps_trained": 117500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.523191201119973, "num_agent_steps_trained_throughput_per_sec": 5.523191201119973, "timesteps_total": 352500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 352500, "timers": {"training_iteration_time_ms": 1354224.902, "sample_time_ms": 28877.681, "load_time_ms": 0.899, "load_throughput": 2780999.867, "learn_time_ms": 1325344.654, "learn_throughput": 1.886, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 117500, "num_env_steps_trained": 117500, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352500}, "done": false, "episodes_total": 470, "training_iteration": 47, "trial_id": "0b7ab_00052", "date": "2024-03-15_07-50-15", "timestamp": 1710485415, "time_this_iter_s": 1357.9127020835876, "time_total_s": 65348.74055314064, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 65348.74055314064, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 46.01645898234683, "ram_util_percent": 18.2776220145379}, "checkpoint_dir_name": "checkpoint_000046"}
{"custom_metrics": {"collisions_mean": 135.06, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.5246350725364721, "policy_loss": 0.009235659044706959, "vf_loss": 2.4887933248932335, "vf_explained_var": 0.3672711486103891, "kl": 0.012347071980079878, "entropy": 1.4163295807509586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82650.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": -128.90815556716132, "episode_reward_min": -534.5354159802633, "episode_reward_mean": -328.8259954333277, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 135.06, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6204054044610123, "mean_inference_ms": 8.839222864794753, "mean_action_processing_ms": 0.42769280131886334, "mean_env_wait_ms": 0.9953033673734535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7861804962158203, "StateBufferConnector_ms": 0.0059032440185546875, "ViewRequirementAgentConnector_ms": 0.2580595016479492}}, "episode_reward_max": -128.90815556716132, "episode_reward_min": -534.5354159802633, "episode_reward_mean": -328.8259954333277, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-247.9350817596823, -238.56343184465226, -257.7470536794644, -274.66943578846093, -320.8668426463161, -369.09266984031996, -285.45995991281035, -434.63435300628817, -381.06745020337354, -476.6871344156201, -257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6204054044610123, "mean_inference_ms": 8.839222864794753, "mean_action_processing_ms": 0.42769280131886334, "mean_env_wait_ms": 0.9953033673734535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7861804962158203, "StateBufferConnector_ms": 0.0059032440185546875, "ViewRequirementAgentConnector_ms": 0.2580595016479492}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5158527835485245, "num_agent_steps_trained_throughput_per_sec": 5.5158527835485245, "timesteps_total": 360000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 1354610.097, "sample_time_ms": 28941.983, "load_time_ms": 0.897, "load_throughput": 2787357.452, "learn_time_ms": 1325665.545, "learn_throughput": 1.886, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 480, "training_iteration": 48, "trial_id": "0b7ab_00052", "date": "2024-03-15_08-12-55", "timestamp": 1710486775, "time_this_iter_s": 1359.7192296981812, "time_total_s": 66708.45978283882, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 66708.45978283882, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 45.95365474339036, "ram_util_percent": 18.44727838258165}, "checkpoint_dir_name": "checkpoint_000047"}
{"custom_metrics": {"collisions_mean": 135.96, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0019524851312189488, "total_loss": 1.600206698469775, "policy_loss": 0.005717948585047504, "vf_loss": 2.6160394765693566, "vf_explained_var": 0.5144928304285838, "kl": 0.01834679864534821, "entropy": 1.7203403173164389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84390.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 122500, "num_env_steps_trained": 122500, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367500}, "sampler_results": {"episode_reward_max": -128.90815556716132, "episode_reward_min": -534.5354159802633, "episode_reward_mean": -332.14251240392446, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 135.96, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6193169061936938, "mean_inference_ms": 8.833938717112433, "mean_action_processing_ms": 0.4273871453760963, "mean_env_wait_ms": 0.9947800887132823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7874541282653809, "StateBufferConnector_ms": 0.005919456481933594, "ViewRequirementAgentConnector_ms": 0.2592296600341797}}, "episode_reward_max": -128.90815556716132, "episode_reward_min": -534.5354159802633, "episode_reward_mean": -332.14251240392446, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-257.03048890518807, -411.92641344114946, -417.85686294633734, -260.6934134154551, -335.3712216628643, -333.7616632468248, -409.95350234151385, -260.46622875740104, -456.95913830625125, -311.98506597932504, -235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6193169061936938, "mean_inference_ms": 8.833938717112433, "mean_action_processing_ms": 0.4273871453760963, "mean_env_wait_ms": 0.9947800887132823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7874541282653809, "StateBufferConnector_ms": 0.005919456481933594, "ViewRequirementAgentConnector_ms": 0.2592296600341797}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367500, "num_env_steps_sampled": 122500, "num_env_steps_trained": 122500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.551387979006031, "num_agent_steps_trained_throughput_per_sec": 5.551387979006031, "timesteps_total": 367500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 367500, "timers": {"training_iteration_time_ms": 1354804.123, "sample_time_ms": 28990.015, "load_time_ms": 0.837, "load_throughput": 2985779.777, "learn_time_ms": 1325811.612, "learn_throughput": 1.886, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 122500, "num_env_steps_trained": 122500, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367500}, "done": false, "episodes_total": 490, "training_iteration": 49, "trial_id": "0b7ab_00052", "date": "2024-03-15_08-35-27", "timestamp": 1710488127, "time_this_iter_s": 1351.015464067459, "time_total_s": 68059.47524690628, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 68059.47524690628, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 45.90662148070907, "ram_util_percent": 18.404014598540144}, "checkpoint_dir_name": "checkpoint_000048"}
{"custom_metrics": {"collisions_mean": 132.28, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.5235850283960362, "policy_loss": 0.004037728396661836, "vf_loss": 2.492056966804225, "vf_explained_var": 0.4113897562369533, "kl": 0.0130437093251987, "entropy": 1.4577341611357941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86130.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 125000, "num_env_steps_trained": 125000, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 375000}, "sampler_results": {"episode_reward_max": -128.90815556716132, "episode_reward_min": -534.5354159802633, "episode_reward_mean": -327.9729042821542, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 132.28, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6182435695466488, "mean_inference_ms": 8.828913628197206, "mean_action_processing_ms": 0.427082876428382, "mean_env_wait_ms": 0.9942823911000237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7859280109405518, "StateBufferConnector_ms": 0.005892753601074219, "ViewRequirementAgentConnector_ms": 0.25791454315185547}}, "episode_reward_max": -128.90815556716132, "episode_reward_min": -534.5354159802633, "episode_reward_mean": -327.9729042821542, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-235.16712031063943, -327.67098193841997, -222.0721973053833, -327.08294482855297, -299.9384938546742, -303.8520110418796, -385.2926922085984, -296.4534403485268, -294.926055109744, -352.1531014777275, -269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6182435695466488, "mean_inference_ms": 8.828913628197206, "mean_action_processing_ms": 0.427082876428382, "mean_env_wait_ms": 0.9942823911000237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7859280109405518, "StateBufferConnector_ms": 0.005892753601074219, "ViewRequirementAgentConnector_ms": 0.25791454315185547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 375000, "num_env_steps_sampled": 125000, "num_env_steps_trained": 125000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5661808270058915, "num_agent_steps_trained_throughput_per_sec": 5.5661808270058915, "timesteps_total": 375000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 375000, "timers": {"training_iteration_time_ms": 1354755.468, "sample_time_ms": 28987.324, "load_time_ms": 0.832, "load_throughput": 3003224.975, "learn_time_ms": 1325765.668, "learn_throughput": 1.886, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 125000, "num_env_steps_trained": 125000, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 375000}, "done": false, "episodes_total": 500, "training_iteration": 50, "trial_id": "0b7ab_00052", "date": "2024-03-15_08-57-55", "timestamp": 1710489475, "time_this_iter_s": 1347.4251072406769, "time_total_s": 69406.90035414696, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 69406.90035414696, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 45.7969696969697, "ram_util_percent": 18.628735632183908}, "checkpoint_dir_name": "checkpoint_000049"}
{"custom_metrics": {"collisions_mean": 133.26, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.6997181675744768, "policy_loss": -7.849074739577441e-05, "vf_loss": 2.7856806688524527, "vf_explained_var": 0.4005321528034649, "kl": 0.01727051248579238, "entropy": 1.73931650012389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87870.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 127500, "num_env_steps_trained": 127500, "num_agent_steps_sampled": 382500, "num_agent_steps_trained": 382500}, "sampler_results": {"episode_reward_max": -128.90815556716132, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -334.4796030064728, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 133.26, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6172333918020572, "mean_inference_ms": 8.824223489799682, "mean_action_processing_ms": 0.4268029220336233, "mean_env_wait_ms": 0.9938193374841123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7858834266662598, "StateBufferConnector_ms": 0.005884408950805664, "ViewRequirementAgentConnector_ms": 0.2572329044342041}}, "episode_reward_max": -128.90815556716132, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -334.4796030064728, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-269.383943350797, -371.3406469188169, -243.90267992141025, -437.8337866838859, -238.02673314817, -282.5154886532171, -399.1606711857821, -470.3478880556552, -360.2529982948035, -373.87075757757907, -253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6172333918020572, "mean_inference_ms": 8.824223489799682, "mean_action_processing_ms": 0.4268029220336233, "mean_env_wait_ms": 0.9938193374841123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7858834266662598, "StateBufferConnector_ms": 0.005884408950805664, "ViewRequirementAgentConnector_ms": 0.2572329044342041}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 382500, "num_agent_steps_trained": 382500, "num_env_steps_sampled": 127500, "num_env_steps_trained": 127500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.51872459113491, "num_agent_steps_trained_throughput_per_sec": 5.51872459113491, "timesteps_total": 382500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 382500, "timers": {"training_iteration_time_ms": 1355973.424, "sample_time_ms": 29002.775, "load_time_ms": 0.761, "load_throughput": 3285321.302, "learn_time_ms": 1326968.257, "learn_throughput": 1.884, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 127500, "num_env_steps_trained": 127500, "num_agent_steps_sampled": 382500, "num_agent_steps_trained": 382500}, "done": false, "episodes_total": 510, "training_iteration": 51, "trial_id": "0b7ab_00052", "date": "2024-03-15_09-20-35", "timestamp": 1710490835, "time_this_iter_s": 1359.011649608612, "time_total_s": 70765.91200375557, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 70765.91200375557, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 42.802331606217614, "ram_util_percent": 16.984041450777205}, "checkpoint_dir_name": "checkpoint_000050"}
{"custom_metrics": {"collisions_mean": 129.96, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.3409402484620183, "policy_loss": -0.004094421531705336, "vf_loss": 2.2045610911030877, "vf_explained_var": 0.4762079924345016, "kl": 0.013293967048083779, "entropy": 1.4964270364964145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89610.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000}, "sampler_results": {"episode_reward_max": -128.90815556716132, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -327.32939523131967, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 129.96, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6163056645883092, "mean_inference_ms": 8.819895935795655, "mean_action_processing_ms": 0.4265424580178152, "mean_env_wait_ms": 0.9933900558449884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.785982608795166, "StateBufferConnector_ms": 0.005677223205566406, "ViewRequirementAgentConnector_ms": 0.25668883323669434}}, "episode_reward_max": -128.90815556716132, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -327.32939523131967, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-253.70735259318982, -384.50373792882664, -208.6536103503295, -376.64330488991203, -241.27857707252372, -270.0771546307906, -240.3946432662472, -353.98008580096325, -239.9602129181527, -476.8922233059099, -325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6163056645883092, "mean_inference_ms": 8.819895935795655, "mean_action_processing_ms": 0.4265424580178152, "mean_env_wait_ms": 0.9933900558449884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.785982608795166, "StateBufferConnector_ms": 0.005677223205566406, "ViewRequirementAgentConnector_ms": 0.25668883323669434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.471546987451652, "num_agent_steps_trained_throughput_per_sec": 5.471546987451652, "timesteps_total": 390000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 390000, "timers": {"training_iteration_time_ms": 1358708.349, "sample_time_ms": 29025.155, "load_time_ms": 0.767, "load_throughput": 3257863.667, "learn_time_ms": 1329680.82, "learn_throughput": 1.88, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000}, "done": false, "episodes_total": 520, "training_iteration": 52, "trial_id": "0b7ab_00052", "date": "2024-03-15_09-43-26", "timestamp": 1710492206, "time_this_iter_s": 1370.7296252250671, "time_total_s": 72136.64162898064, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 72136.64162898064, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 44.98003088008235, "ram_util_percent": 17.3026762738034}, "checkpoint_dir_name": "checkpoint_000051"}
{"custom_metrics": {"collisions_mean": 130.52, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.4604068358393985, "policy_loss": 0.0037066886445036393, "vf_loss": 2.388445748277437, "vf_explained_var": 0.33002683623083706, "kl": 0.013235694094474565, "entropy": 1.6687779159895304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91350.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 132500, "num_env_steps_trained": 132500, "num_agent_steps_sampled": 397500, "num_agent_steps_trained": 397500}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -330.92914850665903, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 130.52, "collisions_min": 0, "collisions_max": 352, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6155574307992167, "mean_inference_ms": 8.8165224532833, "mean_action_processing_ms": 0.4263246659182742, "mean_env_wait_ms": 0.9930731155351612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7872898578643799, "StateBufferConnector_ms": 0.005686283111572266, "ViewRequirementAgentConnector_ms": 0.2559213638305664}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -330.92914850665903, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-325.224232185455, -383.09814073774515, -401.3586981795419, -246.54734553019046, -400.93491824320853, -241.3763656187029, -267.6960903634919, -383.46508298709205, -488.593389202827, -383.93683158149025, -451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6155574307992167, "mean_inference_ms": 8.8165224532833, "mean_action_processing_ms": 0.4263246659182742, "mean_env_wait_ms": 0.9930731155351612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7872898578643799, "StateBufferConnector_ms": 0.005686283111572266, "ViewRequirementAgentConnector_ms": 0.2559213638305664}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 397500, "num_agent_steps_trained": 397500, "num_env_steps_sampled": 132500, "num_env_steps_trained": 132500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.369324329678959, "num_agent_steps_trained_throughput_per_sec": 5.369324329678959, "timesteps_total": 397500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 397500, "timers": {"training_iteration_time_ms": 1363665.068, "sample_time_ms": 29159.196, "load_time_ms": 0.819, "load_throughput": 3052178.722, "learn_time_ms": 1334503.46, "learn_throughput": 1.873, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 132500, "num_env_steps_trained": 132500, "num_agent_steps_sampled": 397500, "num_agent_steps_trained": 397500}, "done": false, "episodes_total": 530, "training_iteration": 53, "trial_id": "0b7ab_00052", "date": "2024-03-15_10-06-45", "timestamp": 1710493605, "time_this_iter_s": 1396.8258936405182, "time_total_s": 73533.46752262115, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 73533.46752262115, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.81713709677419, "ram_util_percent": 20.258618951612902}, "checkpoint_dir_name": "checkpoint_000052"}
{"custom_metrics": {"collisions_mean": 134.34, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9998301497478594, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.4079688007721207, "policy_loss": 0.00038514021548560296, "vf_loss": 2.306787915043961, "vf_explained_var": 0.3056624962338086, "kl": 0.01430803584173256, "entropy": 1.5259317622445097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93090.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 135000, "num_env_steps_trained": 135000, "num_agent_steps_sampled": 405000, "num_agent_steps_trained": 405000}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -330.75444186823216, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 134.34, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6148669332177845, "mean_inference_ms": 8.81352898432085, "mean_action_processing_ms": 0.4261167654553741, "mean_env_wait_ms": 0.9927992464774502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7880415916442871, "StateBufferConnector_ms": 0.005689859390258789, "ViewRequirementAgentConnector_ms": 0.25623226165771484}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -330.75444186823216, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-451.07095503211644, -252.83635916916873, -318.77613119429606, -251.263658613779, -339.6286246412867, -281.3843067473683, -414.04805519889015, -299.3009554050127, -233.21696274382364, -320.5530272010815, -367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6148669332177845, "mean_inference_ms": 8.81352898432085, "mean_action_processing_ms": 0.4261167654553741, "mean_env_wait_ms": 0.9927992464774502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7880415916442871, "StateBufferConnector_ms": 0.005689859390258789, "ViewRequirementAgentConnector_ms": 0.25623226165771484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 405000, "num_agent_steps_trained": 405000, "num_env_steps_sampled": 135000, "num_env_steps_trained": 135000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.429006675020701, "num_agent_steps_trained_throughput_per_sec": 5.429006675020701, "timesteps_total": 405000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 405000, "timers": {"training_iteration_time_ms": 1366748.343, "sample_time_ms": 29196.676, "load_time_ms": 0.764, "load_throughput": 3270361.476, "learn_time_ms": 1337549.317, "learn_throughput": 1.869, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 135000, "num_env_steps_trained": 135000, "num_agent_steps_sampled": 405000, "num_agent_steps_trained": 405000}, "done": false, "episodes_total": 540, "training_iteration": 54, "trial_id": "0b7ab_00052", "date": "2024-03-15_10-29-47", "timestamp": 1710494987, "time_this_iter_s": 1381.470209121704, "time_total_s": 74914.93773174286, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 74914.93773174286, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 51.231734693877556, "ram_util_percent": 20.621632653061223}, "checkpoint_dir_name": "checkpoint_000053"}
{"custom_metrics": {"collisions_mean": 141.78, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.7480212425582924, "policy_loss": -0.006612841622507863, "vf_loss": 2.879321139382905, "vf_explained_var": 0.4314377309947178, "kl": 0.01273743546389389, "entropy": 1.8240423161750552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 94830.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled": 412500, "num_agent_steps_trained": 412500}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -338.08037311753867, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 141.78, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6142274067417508, "mean_inference_ms": 8.810871978165789, "mean_action_processing_ms": 0.42591507390311845, "mean_env_wait_ms": 0.9925660926929227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7890777587890625, "StateBufferConnector_ms": 0.00567936897277832, "ViewRequirementAgentConnector_ms": 0.2559957504272461}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -338.08037311753867, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-367.3669947073949, -212.97833880423337, -226.80252283666175, -311.1261996705836, -476.54364238978206, -237.33865453555006, -256.6349527628444, -298.6805022635276, -390.2063745391731, -439.41512663639406, -478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6142274067417508, "mean_inference_ms": 8.810871978165789, "mean_action_processing_ms": 0.42591507390311845, "mean_env_wait_ms": 0.9925660926929227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7890777587890625, "StateBufferConnector_ms": 0.00567936897277832, "ViewRequirementAgentConnector_ms": 0.2559957504272461}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412500, "num_agent_steps_trained": 412500, "num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.406109068538144, "num_agent_steps_trained_throughput_per_sec": 5.406109068538144, "timesteps_total": 412500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 412500, "timers": {"training_iteration_time_ms": 1370676.717, "sample_time_ms": 29223.839, "load_time_ms": 0.757, "load_throughput": 3304162.597, "learn_time_ms": 1341450.549, "learn_throughput": 1.864, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled": 412500, "num_agent_steps_trained": 412500}, "done": false, "episodes_total": 550, "training_iteration": 55, "trial_id": "0b7ab_00052", "date": "2024-03-15_10-52-55", "timestamp": 1710496375, "time_this_iter_s": 1387.3214230537415, "time_total_s": 76302.2591547966, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 76302.2591547966, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 51.25997968511935, "ram_util_percent": 20.668664296597257}, "checkpoint_dir_name": "checkpoint_000054"}
{"custom_metrics": {"collisions_mean": 147.86, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.8260108569010707, "policy_loss": 0.006081383410659244, "vf_loss": 2.9860160928348014, "vf_explained_var": 0.31173680726139025, "kl": 0.013823614292385046, "entropy": 1.8145818916716794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 96570.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -345.52987023337454, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 147.86, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6137178406455888, "mean_inference_ms": 8.808730620168589, "mean_action_processing_ms": 0.4257636239171714, "mean_env_wait_ms": 0.9924096806827614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7909061908721924, "StateBufferConnector_ms": 0.005692005157470703, "ViewRequirementAgentConnector_ms": 0.2571704387664795}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -345.52987023337454, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-478.06169545718916, -334.95899717939903, -268.8155251790255, -485.5765125945424, -405.74035445477654, -268.1581162217439, -244.20336972993428, -217.7946167473963, -394.7007193684612, -317.82799813691184, -534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6137178406455888, "mean_inference_ms": 8.808730620168589, "mean_action_processing_ms": 0.4257636239171714, "mean_env_wait_ms": 0.9924096806827614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7909061908721924, "StateBufferConnector_ms": 0.005692005157470703, "ViewRequirementAgentConnector_ms": 0.2571704387664795}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.423207951699769, "num_agent_steps_trained_throughput_per_sec": 5.423207951699769, "timesteps_total": 420000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 1369435.788, "sample_time_ms": 29299.865, "load_time_ms": 0.799, "load_throughput": 3129797.332, "learn_time_ms": 1340133.559, "learn_throughput": 1.865, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 560, "training_iteration": 56, "trial_id": "0b7ab_00052", "date": "2024-03-15_11-15-59", "timestamp": 1710497759, "time_this_iter_s": 1382.9473950862885, "time_total_s": 77685.20654988289, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 77685.20654988289, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 51.00423037716616, "ram_util_percent": 20.872528032619773}, "checkpoint_dir_name": "checkpoint_000055"}
{"custom_metrics": {"collisions_mean": 146.2, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.6737912132934636, "policy_loss": -0.0034192246608382585, "vf_loss": 2.752018434845511, "vf_explained_var": 0.40886033091736934, "kl": 0.012515501456800849, "entropy": 1.6549995434010165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98310.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142500, "num_agent_steps_sampled": 427500, "num_agent_steps_trained": 427500}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -344.6536756995961, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 146.2, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.613227170498159, "mean_inference_ms": 8.806642519402475, "mean_action_processing_ms": 0.42560753132706025, "mean_env_wait_ms": 0.9922594561490403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7897236347198486, "StateBufferConnector_ms": 0.0056879520416259766, "ViewRequirementAgentConnector_ms": 0.2560310363769531}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -344.6536756995961, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-534.5354159802633, -372.9613296987222, -234.3517632882957, -443.27312676838363, -260.6350370160519, -505.71594580515756, -128.90815556716132, -253.24120743240357, -265.678843386661, -285.9944265271663, -332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.613227170498159, "mean_inference_ms": 8.806642519402475, "mean_action_processing_ms": 0.42560753132706025, "mean_env_wait_ms": 0.9922594561490403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7897236347198486, "StateBufferConnector_ms": 0.0056879520416259766, "ViewRequirementAgentConnector_ms": 0.2560310363769531}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427500, "num_agent_steps_trained": 427500, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.456533511628811, "num_agent_steps_trained_throughput_per_sec": 5.456533511628811, "timesteps_total": 427500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 427500, "timers": {"training_iteration_time_ms": 1371094.628, "sample_time_ms": 29296.169, "load_time_ms": 0.759, "load_throughput": 3292128.976, "learn_time_ms": 1341796.154, "learn_throughput": 1.863, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 142500, "num_env_steps_trained": 142500, "num_agent_steps_sampled": 427500, "num_agent_steps_trained": 427500}, "done": false, "episodes_total": 570, "training_iteration": 57, "trial_id": "0b7ab_00052", "date": "2024-03-15_11-38-54", "timestamp": 1710499134, "time_this_iter_s": 1374.5010042190552, "time_total_s": 79059.70755410194, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 79059.70755410194, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 49.00692307692308, "ram_util_percent": 19.908102564102563}, "checkpoint_dir_name": "checkpoint_000056"}
{"custom_metrics": {"collisions_mean": 147.84, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.5144506219236566, "policy_loss": -0.011460949216658871, "vf_loss": 2.5023543168630065, "vf_explained_var": 0.3963440411049744, "kl": 0.013287383953401935, "entropy": 1.7146876311678996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 100050.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 145000, "num_env_steps_trained": 145000, "num_agent_steps_sampled": 435000, "num_agent_steps_trained": 435000}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -347.8319496702077, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 147.84, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6127044065796519, "mean_inference_ms": 8.804394359242037, "mean_action_processing_ms": 0.42544033487124705, "mean_env_wait_ms": 0.9920877539933055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7896177768707275, "StateBufferConnector_ms": 0.005690813064575195, "ViewRequirementAgentConnector_ms": 0.2561640739440918}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -347.8319496702077, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-332.9370719014972, -417.490672071266, -441.95427150720764, -463.9319212876385, -254.0462330918892, -344.73913001179454, -337.673273121471, -461.4860005031179, -264.07059772274147, -300.04593893804355, -214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6127044065796519, "mean_inference_ms": 8.804394359242037, "mean_action_processing_ms": 0.42544033487124705, "mean_env_wait_ms": 0.9920877539933055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7896177768707275, "StateBufferConnector_ms": 0.005690813064575195, "ViewRequirementAgentConnector_ms": 0.2561640739440918}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 435000, "num_agent_steps_trained": 435000, "num_env_steps_sampled": 145000, "num_env_steps_trained": 145000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.554496520633484, "num_agent_steps_trained_throughput_per_sec": 5.554496520633484, "timesteps_total": 435000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 435000, "timers": {"training_iteration_time_ms": 1370148.646, "sample_time_ms": 29247.726, "load_time_ms": 0.761, "load_throughput": 3285218.372, "learn_time_ms": 1340898.62, "learn_throughput": 1.864, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 145000, "num_env_steps_trained": 145000, "num_agent_steps_sampled": 435000, "num_agent_steps_trained": 435000}, "done": false, "episodes_total": 580, "training_iteration": 58, "trial_id": "0b7ab_00052", "date": "2024-03-15_12-01-25", "timestamp": 1710500485, "time_this_iter_s": 1350.259426832199, "time_total_s": 80409.96698093414, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 80409.96698093414, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 42.53348982785602, "ram_util_percent": 16.86280646844027}, "checkpoint_dir_name": "checkpoint_000057"}
{"custom_metrics": {"collisions_mean": 145.28, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.4001707094808473, "policy_loss": -0.005550061252995812, "vf_loss": 2.3050929800874886, "vf_explained_var": 0.41285097465432924, "kl": 0.012456073466187942, "entropy": 1.4712713212802493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101790.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 147500, "num_env_steps_trained": 147500, "num_agent_steps_sampled": 442500, "num_agent_steps_trained": 442500}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -341.16685265971734, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 145.28, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6121561578068866, "mean_inference_ms": 8.80196113547032, "mean_action_processing_ms": 0.42526084416977505, "mean_env_wait_ms": 0.9918877378436158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7887668609619141, "StateBufferConnector_ms": 0.005671501159667969, "ViewRequirementAgentConnector_ms": 0.25516653060913086}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -341.16685265971734, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-214.37110417332238, -443.9063598762746, -332.7562962211503, -300.08647133339707, -263.5727885744907, -306.13755840401933, -204.84227045324758, -331.83607078895665, -409.27219008517943, -232.26207691524613, -213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6121561578068866, "mean_inference_ms": 8.80196113547032, "mean_action_processing_ms": 0.42526084416977505, "mean_env_wait_ms": 0.9918877378436158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7887668609619141, "StateBufferConnector_ms": 0.005671501159667969, "ViewRequirementAgentConnector_ms": 0.25516653060913086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 442500, "num_agent_steps_trained": 442500, "num_env_steps_sampled": 147500, "num_env_steps_trained": 147500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.552124101478467, "num_agent_steps_trained_throughput_per_sec": 5.552124101478467, "timesteps_total": 442500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 442500, "timers": {"training_iteration_time_ms": 1370130.734, "sample_time_ms": 29194.766, "load_time_ms": 0.761, "load_throughput": 3283983.714, "learn_time_ms": 1340933.662, "learn_throughput": 1.864, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 147500, "num_env_steps_trained": 147500, "num_agent_steps_sampled": 442500, "num_agent_steps_trained": 442500}, "done": false, "episodes_total": 590, "training_iteration": 59, "trial_id": "0b7ab_00052", "date": "2024-03-15_12-23-56", "timestamp": 1710501836, "time_this_iter_s": 1350.8363060951233, "time_total_s": 81760.80328702927, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 81760.80328702927, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 42.19389989572471, "ram_util_percent": 16.63435870698644}, "checkpoint_dir_name": "checkpoint_000058"}
{"custom_metrics": {"collisions_mean": 145.86, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.3798187447757322, "policy_loss": 0.00023631502381772147, "vf_loss": 2.260025684244331, "vf_explained_var": 0.4113509991388211, "kl": 0.015201797127925581, "entropy": 1.8963654609075908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 103530.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -344.46646318422745, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 145.86, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6116177163670704, "mean_inference_ms": 8.799537394980687, "mean_action_processing_ms": 0.425083512596827, "mean_env_wait_ms": 0.991684727371929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7897570133209229, "StateBufferConnector_ms": 0.005682945251464844, "ViewRequirementAgentConnector_ms": 0.2564420700073242}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -688.9366037519933, "episode_reward_mean": -344.46646318422745, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-213.08843390174135, -447.66129641793356, -542.7489815664469, -206.94471926149032, -222.6413348259239, -221.1939097826686, -283.75640140590104, -688.9366037519933, -548.0802809127678, -320.226949029136, -202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6116177163670704, "mean_inference_ms": 8.799537394980687, "mean_action_processing_ms": 0.425083512596827, "mean_env_wait_ms": 0.991684727371929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7897570133209229, "StateBufferConnector_ms": 0.005682945251464844, "ViewRequirementAgentConnector_ms": 0.2564420700073242}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.555578224054846, "num_agent_steps_trained_throughput_per_sec": 5.555578224054846, "timesteps_total": 450000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 1370387.884, "sample_time_ms": 29174.813, "load_time_ms": 0.787, "load_throughput": 3175578.437, "learn_time_ms": 1341210.749, "learn_throughput": 1.864, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 600, "training_iteration": 60, "trial_id": "0b7ab_00052", "date": "2024-03-15_12-46-27", "timestamp": 1710503187, "time_this_iter_s": 1349.996417760849, "time_total_s": 83110.79970479012, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 83110.79970479012, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 42.19488517745303, "ram_util_percent": 16.598851774530267}, "checkpoint_dir_name": "checkpoint_000059"}
{"custom_metrics": {"collisions_mean": 149.66, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.4831525881063519, "policy_loss": 0.003615800602275921, "vf_loss": 2.425206661960859, "vf_explained_var": 0.39155131609275423, "kl": 0.014364662566275783, "entropy": 1.963901275995819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105270.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 152500, "num_env_steps_trained": 152500, "num_agent_steps_sampled": 457500, "num_agent_steps_trained": 457500}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -650.716825638958, "episode_reward_mean": -344.9282599628763, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 149.66, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6111577422898242, "mean_inference_ms": 8.797432982940826, "mean_action_processing_ms": 0.42493666414234155, "mean_env_wait_ms": 0.9915028796403079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7914745807647705, "StateBufferConnector_ms": 0.0057070255279541016, "ViewRequirementAgentConnector_ms": 0.2580423355102539}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -650.716825638958, "episode_reward_mean": -344.9282599628763, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-202.6455488816521, -342.98682616447326, -235.21384500426512, -202.81135781395696, -325.0533748654355, -204.3882527977999, -415.62533492739357, -195.18415675331138, -352.42990063740103, -255.27621842911645, -299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6111577422898242, "mean_inference_ms": 8.797432982940826, "mean_action_processing_ms": 0.42493666414234155, "mean_env_wait_ms": 0.9915028796403079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7914745807647705, "StateBufferConnector_ms": 0.0057070255279541016, "ViewRequirementAgentConnector_ms": 0.2580423355102539}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 457500, "num_agent_steps_trained": 457500, "num_env_steps_sampled": 152500, "num_env_steps_trained": 152500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.512926453706141, "num_agent_steps_trained_throughput_per_sec": 5.512926453706141, "timesteps_total": 457500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 457500, "timers": {"training_iteration_time_ms": 1370530.816, "sample_time_ms": 29221.421, "load_time_ms": 0.827, "load_throughput": 3024273.189, "learn_time_ms": 1341306.997, "learn_throughput": 1.864, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 152500, "num_env_steps_trained": 152500, "num_agent_steps_sampled": 457500, "num_agent_steps_trained": 457500}, "done": false, "episodes_total": 610, "training_iteration": 61, "trial_id": "0b7ab_00052", "date": "2024-03-15_13-09-08", "timestamp": 1710504548, "time_this_iter_s": 1360.4409711360931, "time_total_s": 84471.24067592621, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 84471.24067592621, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 42.181615743138266, "ram_util_percent": 16.52542723977214}, "checkpoint_dir_name": "checkpoint_000060"}
{"custom_metrics": {"collisions_mean": 151.5, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.4416417228942469, "policy_loss": 0.0021720137532757616, "vf_loss": 2.3603935642831626, "vf_explained_var": 0.5052048244352998, "kl": 0.01281010494512263, "entropy": 1.8554197376829453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 107010.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 155000, "num_env_steps_trained": 155000, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 465000}, "sampler_results": {"episode_reward_max": -99.6166586025152, "episode_reward_min": -650.716825638958, "episode_reward_mean": -350.5481615500419, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 151.5, "collisions_min": 0, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6107458283416907, "mean_inference_ms": 8.795593813362707, "mean_action_processing_ms": 0.424816560334944, "mean_env_wait_ms": 0.9913547085889838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7928643226623535, "StateBufferConnector_ms": 0.005719423294067383, "ViewRequirementAgentConnector_ms": 0.2589690685272217}}, "episode_reward_max": -99.6166586025152, "episode_reward_min": -650.716825638958, "episode_reward_mean": -350.5481615500419, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-299.27669135572063, -373.0134312794034, -227.18994076809332, -217.17236566439612, -99.6166586025152, -559.9223894854806, -359.6334337175404, -444.10038790355054, -643.5600936461734, -182.58083786791036, -343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6107458283416907, "mean_inference_ms": 8.795593813362707, "mean_action_processing_ms": 0.424816560334944, "mean_env_wait_ms": 0.9913547085889838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7928643226623535, "StateBufferConnector_ms": 0.005719423294067383, "ViewRequirementAgentConnector_ms": 0.2589690685272217}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 465000, "num_env_steps_sampled": 155000, "num_env_steps_trained": 155000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.518061721838847, "num_agent_steps_trained_throughput_per_sec": 5.518061721838847, "timesteps_total": 465000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 465000, "timers": {"training_iteration_time_ms": 1369375.355, "sample_time_ms": 29259.004, "load_time_ms": 0.824, "load_throughput": 3033284.156, "learn_time_ms": 1340113.958, "learn_throughput": 1.866, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 155000, "num_env_steps_trained": 155000, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 465000}, "done": false, "episodes_total": 620, "training_iteration": 62, "trial_id": "0b7ab_00052", "date": "2024-03-15_13-31-48", "timestamp": 1710505908, "time_this_iter_s": 1359.1748700141907, "time_total_s": 85830.4155459404, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 85830.4155459404, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 42.249585062240655, "ram_util_percent": 16.75503112033195}, "checkpoint_dir_name": "checkpoint_000061"}
{"custom_metrics": {"collisions_mean": 148.7, "collisions_min": 22, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.4466111617833215, "policy_loss": 0.00043231283646376654, "vf_loss": 2.3706034401966924, "vf_explained_var": 0.45948001941045125, "kl": 0.01393821809594462, "entropy": 1.9732969876335955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 108750.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 157500, "num_env_steps_trained": 157500, "num_agent_steps_sampled": 472500, "num_agent_steps_trained": 472500}, "sampler_results": {"episode_reward_max": -196.7630340228466, "episode_reward_min": -650.716825638958, "episode_reward_mean": -347.6316879636546, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 148.7, "collisions_min": 22, "collisions_max": 442, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6102570713359894, "mean_inference_ms": 8.793351452039998, "mean_action_processing_ms": 0.4246809211759702, "mean_env_wait_ms": 0.9911399100864249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7921745777130127, "StateBufferConnector_ms": 0.005728244781494141, "ViewRequirementAgentConnector_ms": 0.2602696418762207}}, "episode_reward_max": -196.7630340228466, "episode_reward_min": -650.716825638958, "episode_reward_mean": -347.6316879636546, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-343.4475229302123, -650.716825638958, -276.438819914941, -401.93170203763543, -262.25350443910554, -217.57561438531118, -454.59102564436273, -230.83569313294214, -411.37197847313604, -255.59774419045408, -483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6102570713359894, "mean_inference_ms": 8.793351452039998, "mean_action_processing_ms": 0.4246809211759702, "mean_env_wait_ms": 0.9911399100864249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7921745777130127, "StateBufferConnector_ms": 0.005728244781494141, "ViewRequirementAgentConnector_ms": 0.2602696418762207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472500, "num_agent_steps_trained": 472500, "num_env_steps_sampled": 157500, "num_env_steps_trained": 157500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5386355875208855, "num_agent_steps_trained_throughput_per_sec": 5.5386355875208855, "timesteps_total": 472500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 472500, "timers": {"training_iteration_time_ms": 1365105.387, "sample_time_ms": 29174.879, "load_time_ms": 0.809, "load_throughput": 3090045.382, "learn_time_ms": 1335928.133, "learn_throughput": 1.871, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 157500, "num_env_steps_trained": 157500, "num_agent_steps_sampled": 472500, "num_agent_steps_trained": 472500}, "done": false, "episodes_total": 630, "training_iteration": 63, "trial_id": "0b7ab_00052", "date": "2024-03-15_13-54-22", "timestamp": 1710507262, "time_this_iter_s": 1354.1261529922485, "time_total_s": 87184.54169893265, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 87184.54169893265, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 42.22330905306972, "ram_util_percent": 16.84094693028096}, "checkpoint_dir_name": "checkpoint_000062"}
{"custom_metrics": {"collisions_mean": 142.08, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.2934430066878833, "policy_loss": -0.0002528272542417392, "vf_loss": 2.1193698508772014, "vf_explained_var": 0.43655201347394923, "kl": 0.014197089492283833, "entropy": 1.3622502371861502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 110490.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": -196.7630340228466, "episode_reward_min": -621.3679841705923, "episode_reward_mean": -342.5485603121787, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 142.08, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6097309732724043, "mean_inference_ms": 8.791037944505877, "mean_action_processing_ms": 0.4245354999782538, "mean_env_wait_ms": 0.9908992911292529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7902183532714844, "StateBufferConnector_ms": 0.005719184875488281, "ViewRequirementAgentConnector_ms": 0.259718656539917}}, "episode_reward_max": -196.7630340228466, "episode_reward_min": -621.3679841705923, "episode_reward_mean": -342.5485603121787, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-483.72783568939474, -487.16411968929964, -262.7249636305728, -381.63330173830593, -407.0802964324997, -407.46236637936533, -477.1446122411827, -298.24118936277836, -212.7940120922564, -476.69946362182594, -415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6097309732724043, "mean_inference_ms": 8.791037944505877, "mean_action_processing_ms": 0.4245354999782538, "mean_env_wait_ms": 0.9908992911292529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7902183532714844, "StateBufferConnector_ms": 0.005719184875488281, "ViewRequirementAgentConnector_ms": 0.259718656539917}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.547173380806172, "num_agent_steps_trained_throughput_per_sec": 5.547173380806172, "timesteps_total": 480000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 1362162.563, "sample_time_ms": 29139.253, "load_time_ms": 0.806, "load_throughput": 3102663.037, "learn_time_ms": 1333020.939, "learn_throughput": 1.875, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 640, "training_iteration": 64, "trial_id": "0b7ab_00052", "date": "2024-03-15_14-16-55", "timestamp": 1710508615, "time_this_iter_s": 1352.041967868805, "time_total_s": 88536.58366680145, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 88536.58366680145, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 42.25385416666666, "ram_util_percent": 16.941041666666667}, "checkpoint_dir_name": "checkpoint_000063"}
{"custom_metrics": {"collisions_mean": 133.96, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.6977960825353144, "policy_loss": 0.009268841475526663, "vf_loss": 2.768517072978376, "vf_explained_var": 0.338624022918186, "kl": 0.015394422329629263, "entropy": 1.7665425306250309, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112230.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 162500, "num_env_steps_trained": 162500, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500}, "sampler_results": {"episode_reward_max": -196.7630340228466, "episode_reward_min": -621.3679841705923, "episode_reward_mean": -335.1803499392119, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 133.96, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6091897894136222, "mean_inference_ms": 8.788574065421283, "mean_action_processing_ms": 0.42438960666340975, "mean_env_wait_ms": 0.9906409462551128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7896261215209961, "StateBufferConnector_ms": 0.005717754364013672, "ViewRequirementAgentConnector_ms": 0.2596299648284912}}, "episode_reward_max": -196.7630340228466, "episode_reward_min": -621.3679841705923, "episode_reward_mean": -335.1803499392119, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-415.33854229841967, -431.64270125891386, -266.6456744558379, -273.6971954507912, -308.45737863630563, -237.2003491464457, -399.57653634440584, -460.70101185783005, -547.4156471101808, -621.3679841705923, -359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6091897894136222, "mean_inference_ms": 8.788574065421283, "mean_action_processing_ms": 0.42438960666340975, "mean_env_wait_ms": 0.9906409462551128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7896261215209961, "StateBufferConnector_ms": 0.005717754364013672, "ViewRequirementAgentConnector_ms": 0.2596299648284912}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500, "num_env_steps_sampled": 162500, "num_env_steps_trained": 162500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.557067441583217, "num_agent_steps_trained_throughput_per_sec": 5.557067441583217, "timesteps_total": 487500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 487500, "timers": {"training_iteration_time_ms": 1358393.894, "sample_time_ms": 29090.946, "load_time_ms": 0.851, "load_throughput": 2937187.675, "learn_time_ms": 1329300.514, "learn_throughput": 1.881, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 162500, "num_env_steps_trained": 162500, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500}, "done": false, "episodes_total": 650, "training_iteration": 65, "trial_id": "0b7ab_00052", "date": "2024-03-15_14-39-26", "timestamp": 1710509966, "time_this_iter_s": 1349.634794473648, "time_total_s": 89886.2184612751, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 89886.2184612751, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 42.19989572471324, "ram_util_percent": 16.880865484880086}, "checkpoint_dir_name": "checkpoint_000064"}
{"custom_metrics": {"collisions_mean": 127.18, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.475957698831415, "policy_loss": 0.00028687598767165824, "vf_loss": 2.419072470274465, "vf_explained_var": 0.40437977540081943, "kl": 0.014053426961129005, "entropy": 1.5814523800244105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 113970.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled": 495000, "num_agent_steps_trained": 495000}, "sampler_results": {"episode_reward_max": -196.7630340228466, "episode_reward_min": -611.469787164641, "episode_reward_mean": -326.2018319523242, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 127.18, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6086289642921838, "mean_inference_ms": 8.785853943214, "mean_action_processing_ms": 0.42423467212303917, "mean_env_wait_ms": 0.9903525815971398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.788715124130249, "StateBufferConnector_ms": 0.005710124969482422, "ViewRequirementAgentConnector_ms": 0.25994133949279785}}, "episode_reward_max": -196.7630340228466, "episode_reward_min": -611.469787164641, "episode_reward_mean": -326.2018319523242, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-359.66230816631236, -433.94902250381404, -256.96694063079354, -313.6646681536503, -317.39255324438165, -239.89902019577357, -414.8698085936666, -338.3239802695034, -222.44836698921068, -431.04178294442625, -292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6086289642921838, "mean_inference_ms": 8.785853943214, "mean_action_processing_ms": 0.42423467212303917, "mean_env_wait_ms": 0.9903525815971398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.788715124130249, "StateBufferConnector_ms": 0.005710124969482422, "ViewRequirementAgentConnector_ms": 0.25994133949279785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 495000, "num_agent_steps_trained": 495000, "num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5828612261217305, "num_agent_steps_trained_throughput_per_sec": 5.5828612261217305, "timesteps_total": 495000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 495000, "timers": {"training_iteration_time_ms": 1354439.08, "sample_time_ms": 29027.151, "load_time_ms": 0.813, "load_throughput": 3074552.118, "learn_time_ms": 1325409.538, "learn_throughput": 1.886, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled": 495000, "num_agent_steps_trained": 495000}, "done": false, "episodes_total": 660, "training_iteration": 66, "trial_id": "0b7ab_00052", "date": "2024-03-15_15-01-50", "timestamp": 1710511310, "time_this_iter_s": 1343.3991949558258, "time_total_s": 91229.61765623093, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 91229.61765623093, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 42.20545073375262, "ram_util_percent": 16.82950733752621}, "checkpoint_dir_name": "checkpoint_000065"}
{"custom_metrics": {"collisions_mean": 130.7, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.5706849516056285, "policy_loss": -0.001385964513435189, "vf_loss": 2.5766385204918767, "vf_explained_var": 0.42396641942276353, "kl": 0.015596391401654166, "entropy": 1.7642132900644565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 115710.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 167500, "num_env_steps_trained": 167500, "num_agent_steps_sampled": 502500, "num_agent_steps_trained": 502500}, "sampler_results": {"episode_reward_max": -196.7630340228466, "episode_reward_min": -611.469787164641, "episode_reward_mean": -330.4329970142702, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 130.7, "collisions_min": 22, "collisions_max": 390, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6080578037843554, "mean_inference_ms": 8.783064205909541, "mean_action_processing_ms": 0.42408000475332597, "mean_env_wait_ms": 0.9900486720384397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.789696216583252, "StateBufferConnector_ms": 0.005715370178222656, "ViewRequirementAgentConnector_ms": 0.26145315170288086}}, "episode_reward_max": -196.7630340228466, "episode_reward_min": -611.469787164641, "episode_reward_mean": -330.4329970142702, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-292.71802576539676, -234.98953489163665, -417.344850106631, -458.3735965444931, -396.608305656171, -369.63453076453817, -233.41058836609494, -295.79130426741824, -292.7821250044039, -611.469787164641, -398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6080578037843554, "mean_inference_ms": 8.783064205909541, "mean_action_processing_ms": 0.42408000475332597, "mean_env_wait_ms": 0.9900486720384397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.789696216583252, "StateBufferConnector_ms": 0.005715370178222656, "ViewRequirementAgentConnector_ms": 0.26145315170288086}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 502500, "num_agent_steps_trained": 502500, "num_env_steps_sampled": 167500, "num_env_steps_trained": 167500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.578723739981185, "num_agent_steps_trained_throughput_per_sec": 5.578723739981185, "timesteps_total": 502500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 502500, "timers": {"training_iteration_time_ms": 1351428.528, "sample_time_ms": 28997.289, "load_time_ms": 0.834, "load_throughput": 2996102.634, "learn_time_ms": 1322428.832, "learn_throughput": 1.89, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 167500, "num_env_steps_trained": 167500, "num_agent_steps_sampled": 502500, "num_agent_steps_trained": 502500}, "done": false, "episodes_total": 670, "training_iteration": 67, "trial_id": "0b7ab_00052", "date": "2024-03-15_15-24-16", "timestamp": 1710512656, "time_this_iter_s": 1344.3954455852509, "time_total_s": 92574.01310181618, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 92574.01310181618, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 42.21340314136126, "ram_util_percent": 16.695445026178007}, "checkpoint_dir_name": "checkpoint_000066"}
{"custom_metrics": {"collisions_mean": 127.22, "collisions_min": 22, "collisions_max": 308, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.3640310066024206, "policy_loss": -0.0017019662612663775, "vf_loss": 2.236530533929666, "vf_explained_var": 0.4377318679258741, "kl": 0.016138495979708522, "entropy": 1.5963073411287376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 117450.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000}, "sampler_results": {"episode_reward_max": -196.7630340228466, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -327.79390298599833, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 127.22, "collisions_min": 22, "collisions_max": 308, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6077052369682614, "mean_inference_ms": 8.780342089873248, "mean_action_processing_ms": 0.42392831556519545, "mean_env_wait_ms": 0.9897571695316314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7883634567260742, "StateBufferConnector_ms": 0.005708456039428711, "ViewRequirementAgentConnector_ms": 0.2605113983154297}}, "episode_reward_max": -196.7630340228466, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -327.79390298599833, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-398.61616900400134, -276.7429678633172, -219.96172511400368, -240.28576880113135, -263.80794008212257, -228.04418186251343, -276.61718071438827, -429.0407947833836, -212.96219130566612, -405.7864895771087, -231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6077052369682614, "mean_inference_ms": 8.780342089873248, "mean_action_processing_ms": 0.42392831556519545, "mean_env_wait_ms": 0.9897571695316314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7883634567260742, "StateBufferConnector_ms": 0.005708456039428711, "ViewRequirementAgentConnector_ms": 0.2605113983154297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5855187055303865, "num_agent_steps_trained_throughput_per_sec": 5.5855187055303865, "timesteps_total": 510000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 510000, "timers": {"training_iteration_time_ms": 1350678.59, "sample_time_ms": 29025.095, "load_time_ms": 0.842, "load_throughput": 2970638.563, "learn_time_ms": 1321651.087, "learn_throughput": 1.892, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000}, "done": false, "episodes_total": 680, "training_iteration": 68, "trial_id": "0b7ab_00052", "date": "2024-03-15_15-46-39", "timestamp": 1710513999, "time_this_iter_s": 1342.759994506836, "time_total_s": 93916.77309632301, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 93916.77309632301, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 42.210854745673835, "ram_util_percent": 16.82123754588359}, "checkpoint_dir_name": "checkpoint_000067"}
{"custom_metrics": {"collisions_mean": 132.68, "collisions_min": 22, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.5224713938316095, "policy_loss": -0.010018096375011507, "vf_loss": 2.513046572657152, "vf_explained_var": 0.3807474751582091, "kl": 0.013472789957391483, "entropy": 1.332869820624333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 119190.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 172500, "num_env_steps_trained": 172500, "num_agent_steps_sampled": 517500, "num_agent_steps_trained": 517500}, "sampler_results": {"episode_reward_max": -196.7630340228466, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -334.5409745801663, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 132.68, "collisions_min": 22, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.607341845419784, "mean_inference_ms": 8.777579332638032, "mean_action_processing_ms": 0.4237687127671048, "mean_env_wait_ms": 0.9894682853092865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7868845462799072, "StateBufferConnector_ms": 0.0056951045989990234, "ViewRequirementAgentConnector_ms": 0.259962797164917}}, "episode_reward_max": -196.7630340228466, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -334.5409745801663, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-231.57759950672363, -426.95878030592274, -478.506707581622, -399.45370717584154, -401.4009094459485, -339.62143334977515, -317.6632977394898, -225.90049572546175, -196.7630340228466, -351.15827442266936, -341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.607341845419784, "mean_inference_ms": 8.777579332638032, "mean_action_processing_ms": 0.4237687127671048, "mean_env_wait_ms": 0.9894682853092865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7868845462799072, "StateBufferConnector_ms": 0.0056951045989990234, "ViewRequirementAgentConnector_ms": 0.259962797164917}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 517500, "num_agent_steps_trained": 517500, "num_env_steps_sampled": 172500, "num_env_steps_trained": 172500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.580025945085692, "num_agent_steps_trained_throughput_per_sec": 5.580025945085692, "timesteps_total": 517500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 517500, "timers": {"training_iteration_time_ms": 1350003.131, "sample_time_ms": 28992.09, "load_time_ms": 0.843, "load_throughput": 2965765.358, "learn_time_ms": 1321008.62, "learn_throughput": 1.892, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 172500, "num_env_steps_trained": 172500, "num_agent_steps_sampled": 517500, "num_agent_steps_trained": 517500}, "done": false, "episodes_total": 690, "training_iteration": 69, "trial_id": "0b7ab_00052", "date": "2024-03-15_16-09-04", "timestamp": 1710515344, "time_this_iter_s": 1344.081918478012, "time_total_s": 95260.85501480103, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 95260.85501480103, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 42.17480356207438, "ram_util_percent": 16.872184389732848}, "checkpoint_dir_name": "checkpoint_000068"}
{"custom_metrics": {"collisions_mean": 129.76, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.1636314993488721, "policy_loss": -0.004720900494380501, "vf_loss": 1.9125906060224978, "vf_explained_var": 0.40455085977740673, "kl": 0.014762564443964144, "entropy": 0.8398296290494759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120930.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 175000, "num_env_steps_trained": 175000, "num_agent_steps_sampled": 525000, "num_agent_steps_trained": 525000}, "sampler_results": {"episode_reward_max": -184.8433073938991, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -326.63665024372625, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 129.76, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.606938188663348, "mean_inference_ms": 8.774592338042682, "mean_action_processing_ms": 0.42359049254682446, "mean_env_wait_ms": 0.9891556422658405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7850852012634277, "StateBufferConnector_ms": 0.005671024322509766, "ViewRequirementAgentConnector_ms": 0.2573056221008301}}, "episode_reward_max": -184.8433073938991, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -326.63665024372625, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-341.9780615964119, -417.88336177547774, -428.5059326507665, -352.03937412662816, -415.7736581867191, -442.7876093069666, -391.30707206642654, -404.7626376522396, -336.7646918267923, -209.65618953246477, -367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.606938188663348, "mean_inference_ms": 8.774592338042682, "mean_action_processing_ms": 0.42359049254682446, "mean_env_wait_ms": 0.9891556422658405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7850852012634277, "StateBufferConnector_ms": 0.005671024322509766, "ViewRequirementAgentConnector_ms": 0.2573056221008301}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 525000, "num_agent_steps_trained": 525000, "num_env_steps_sampled": 175000, "num_env_steps_trained": 175000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.574736351657665, "num_agent_steps_trained_throughput_per_sec": 5.574736351657665, "timesteps_total": 525000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 525000, "timers": {"training_iteration_time_ms": 1349539.191, "sample_time_ms": 28914.79, "load_time_ms": 0.816, "load_throughput": 3063414.064, "learn_time_ms": 1320622.021, "learn_throughput": 1.893, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 175000, "num_env_steps_trained": 175000, "num_agent_steps_sampled": 525000, "num_agent_steps_trained": 525000}, "done": false, "episodes_total": 700, "training_iteration": 70, "trial_id": "0b7ab_00052", "date": "2024-03-15_16-31-30", "timestamp": 1710516690, "time_this_iter_s": 1345.357069015503, "time_total_s": 96606.21208381653, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 96606.21208381653, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 42.18821372446307, "ram_util_percent": 16.93101100052384}, "checkpoint_dir_name": "checkpoint_000069"}
{"custom_metrics": {"collisions_mean": 128.96, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.55798930075132, "policy_loss": 0.0004146407821333443, "vf_loss": 2.5531133598037834, "vf_explained_var": 0.46116895470125924, "kl": 0.015136272039621736, "entropy": 1.4595166624539757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 122670.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled": 532500, "num_agent_steps_trained": 532500}, "sampler_results": {"episode_reward_max": -184.8433073938991, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -324.92318550534065, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 128.96, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.606454565148502, "mean_inference_ms": 8.771294914619112, "mean_action_processing_ms": 0.42337878916826227, "mean_env_wait_ms": 0.9888129028377667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.782860279083252, "StateBufferConnector_ms": 0.005639791488647461, "ViewRequirementAgentConnector_ms": 0.2555084228515625}}, "episode_reward_max": -184.8433073938991, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -324.92318550534065, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-367.293878274856, -233.36024077049544, -409.4523405883267, -397.86295476297755, -306.6041620521473, -321.8221324574976, -374.65178217295284, -261.0322994015821, -274.7168566844368, -346.80832782609065, -349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.606454565148502, "mean_inference_ms": 8.771294914619112, "mean_action_processing_ms": 0.42337878916826227, "mean_env_wait_ms": 0.9888129028377667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.782860279083252, "StateBufferConnector_ms": 0.005639791488647461, "ViewRequirementAgentConnector_ms": 0.2555084228515625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532500, "num_agent_steps_trained": 532500, "num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.582393216323226, "num_agent_steps_trained_throughput_per_sec": 5.582393216323226, "timesteps_total": 532500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 532500, "timers": {"training_iteration_time_ms": 1347846.274, "sample_time_ms": 28820.343, "load_time_ms": 0.776, "load_throughput": 3220442.26, "learn_time_ms": 1319023.634, "learn_throughput": 1.895, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled": 532500, "num_agent_steps_trained": 532500}, "done": false, "episodes_total": 710, "training_iteration": 71, "trial_id": "0b7ab_00052", "date": "2024-03-15_16-53-54", "timestamp": 1710518034, "time_this_iter_s": 1343.5120241641998, "time_total_s": 97949.72410798073, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 97949.72410798073, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 42.208123689727465, "ram_util_percent": 16.87882599580713}, "checkpoint_dir_name": "checkpoint_000070"}
{"custom_metrics": {"collisions_mean": 126.5, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.5347676688987204, "policy_loss": -0.007755193462188559, "vf_loss": 2.528527328663174, "vf_explained_var": 0.49102755993947217, "kl": 0.014873561030421048, "entropy": 1.1147140525672157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 124410.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": -184.8433073938991, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -319.18331045800574, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 126.5, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6059549132745417, "mean_inference_ms": 8.767861377488094, "mean_action_processing_ms": 0.42316365514922366, "mean_env_wait_ms": 0.9884581659136975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7813026905059814, "StateBufferConnector_ms": 0.005643129348754883, "ViewRequirementAgentConnector_ms": 0.25526952743530273}}, "episode_reward_max": -184.8433073938991, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -319.18331045800574, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-349.99061859826026, -222.26114111024359, -271.55586709715726, -229.8770368945388, -444.4169051880209, -434.03396078746925, -220.69002363776175, -262.32890377840414, -265.11620314128606, -414.1482114188967, -428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6059549132745417, "mean_inference_ms": 8.767861377488094, "mean_action_processing_ms": 0.42316365514922366, "mean_env_wait_ms": 0.9884581659136975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7813026905059814, "StateBufferConnector_ms": 0.005643129348754883, "ViewRequirementAgentConnector_ms": 0.25526952743530273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.6023096720400085, "num_agent_steps_trained_throughput_per_sec": 5.6023096720400085, "timesteps_total": 540000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 1345802.34, "sample_time_ms": 28774.647, "load_time_ms": 0.797, "load_throughput": 3138509.428, "learn_time_ms": 1317025.393, "learn_throughput": 1.898, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 720, "training_iteration": 72, "trial_id": "0b7ab_00052", "date": "2024-03-15_17-16-13", "timestamp": 1710519373, "time_this_iter_s": 1338.7355489730835, "time_total_s": 99288.45965695381, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 99288.45965695381, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 42.29889531825355, "ram_util_percent": 16.594266175697}, "checkpoint_dir_name": "checkpoint_000071"}
{"custom_metrics": {"collisions_mean": 129.44, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.325316326917168, "policy_loss": 0.007153962862185449, "vf_loss": 2.1597554970061643, "vf_explained_var": 0.4293356578240449, "kl": 0.014055434570864554, "entropy": 1.185178499722361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126150.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 182500, "num_env_steps_trained": 182500, "num_agent_steps_sampled": 547500, "num_agent_steps_trained": 547500}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -317.2789422179426, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 129.44, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6054251829517812, "mean_inference_ms": 8.764253655905375, "mean_action_processing_ms": 0.4229383281065991, "mean_env_wait_ms": 0.988092311858926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7799797058105469, "StateBufferConnector_ms": 0.005671501159667969, "ViewRequirementAgentConnector_ms": 0.25400614738464355}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -548.6983493159106, "episode_reward_mean": -317.2789422179426, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-428.7599710005761, -243.50987946221, -245.08042973321233, -539.9566286840588, -212.60462948822908, -368.23153728398086, -212.89767761351246, -245.17300112962639, -215.34681524359854, -284.88709600048765, -462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6054251829517812, "mean_inference_ms": 8.764253655905375, "mean_action_processing_ms": 0.4229383281065991, "mean_env_wait_ms": 0.988092311858926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7799797058105469, "StateBufferConnector_ms": 0.005671501159667969, "ViewRequirementAgentConnector_ms": 0.25400614738464355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 547500, "num_agent_steps_trained": 547500, "num_env_steps_sampled": 182500, "num_env_steps_trained": 182500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.615110762918913, "num_agent_steps_trained_throughput_per_sec": 5.615110762918913, "timesteps_total": 547500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 547500, "timers": {"training_iteration_time_ms": 1343958.086, "sample_time_ms": 28717.894, "load_time_ms": 0.758, "load_throughput": 3297616.202, "learn_time_ms": 1315237.945, "learn_throughput": 1.901, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 182500, "num_env_steps_trained": 182500, "num_agent_steps_sampled": 547500, "num_agent_steps_trained": 547500}, "done": false, "episodes_total": 730, "training_iteration": 73, "trial_id": "0b7ab_00052", "date": "2024-03-15_17-38-29", "timestamp": 1710520709, "time_this_iter_s": 1335.6835494041443, "time_total_s": 100624.14320635796, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 100624.14320635796, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 43.546308016877646, "ram_util_percent": 16.90116033755275}, "checkpoint_dir_name": "checkpoint_000072"}
{"custom_metrics": {"collisions_mean": 134.46, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.7048525885243944, "policy_loss": 0.012406451092904497, "vf_loss": 2.7743285189329208, "vf_explained_var": 0.3568507153069836, "kl": 0.01625894274622483, "entropy": 1.647819770398903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 127890.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 185000, "num_env_steps_trained": 185000, "num_agent_steps_sampled": 555000, "num_agent_steps_trained": 555000}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -557.657537934711, "episode_reward_mean": -325.25159665910564, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 134.46, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6049163369703296, "mean_inference_ms": 8.760553240191037, "mean_action_processing_ms": 0.4227225845506178, "mean_env_wait_ms": 0.987740320520926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7788479328155518, "StateBufferConnector_ms": 0.0056765079498291016, "ViewRequirementAgentConnector_ms": 0.2531569004058838}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -557.657537934711, "episode_reward_mean": -325.25159665910564, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-462.393195747104, -317.35481747668524, -231.77677035860103, -382.2262269032609, -416.4051176219237, -266.0834906629915, -274.9033027217549, -288.1498258172309, -220.62965328937497, -297.9287229818584, -254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6049163369703296, "mean_inference_ms": 8.760553240191037, "mean_action_processing_ms": 0.4227225845506178, "mean_env_wait_ms": 0.987740320520926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7788479328155518, "StateBufferConnector_ms": 0.0056765079498291016, "ViewRequirementAgentConnector_ms": 0.2531569004058838}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 555000, "num_agent_steps_trained": 555000, "num_env_steps_sampled": 185000, "num_env_steps_trained": 185000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.606248228636165, "num_agent_steps_trained_throughput_per_sec": 5.606248228636165, "timesteps_total": 555000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 555000, "timers": {"training_iteration_time_ms": 1342533.398, "sample_time_ms": 28688.833, "load_time_ms": 0.793, "load_throughput": 3151053.28, "learn_time_ms": 1313842.283, "learn_throughput": 1.903, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 185000, "num_env_steps_trained": 185000, "num_agent_steps_sampled": 555000, "num_agent_steps_trained": 555000}, "done": false, "episodes_total": 740, "training_iteration": 74, "trial_id": "0b7ab_00052", "date": "2024-03-15_18-00-48", "timestamp": 1710522048, "time_this_iter_s": 1337.7951338291168, "time_total_s": 101961.93834018707, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 101961.93834018707, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 43.731842105263155, "ram_util_percent": 16.933157894736844}, "checkpoint_dir_name": "checkpoint_000073"}
{"custom_metrics": {"collisions_mean": 130.2, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.484632329970609, "policy_loss": -0.003290297696902149, "vf_loss": 2.438491923944361, "vf_explained_var": 0.4710191347818265, "kl": 0.015067682338531618, "entropy": 1.3186819207474547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 129630.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 187500, "num_env_steps_trained": 187500, "num_agent_steps_sampled": 562500, "num_agent_steps_trained": 562500}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -557.657537934711, "episode_reward_mean": -321.8775090028793, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 130.2, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6044443402643962, "mean_inference_ms": 8.757094888559696, "mean_action_processing_ms": 0.4225237284466749, "mean_env_wait_ms": 0.9874033175770035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7792119979858398, "StateBufferConnector_ms": 0.005692005157470703, "ViewRequirementAgentConnector_ms": 0.25443434715270996}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -557.657537934711, "episode_reward_mean": -321.8775090028793, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-254.08439224633076, -351.2995328889925, -297.2993440580831, -211.48734655567847, -253.24378579792358, -548.6983493159106, -288.02167495289615, -268.2489226320441, -256.21880280750094, -335.5890707855939, -389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6044443402643962, "mean_inference_ms": 8.757094888559696, "mean_action_processing_ms": 0.4225237284466749, "mean_env_wait_ms": 0.9874033175770035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7792119979858398, "StateBufferConnector_ms": 0.005692005157470703, "ViewRequirementAgentConnector_ms": 0.25443434715270996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 562500, "num_agent_steps_trained": 562500, "num_env_steps_sampled": 187500, "num_env_steps_trained": 187500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.563707165019857, "num_agent_steps_trained_throughput_per_sec": 5.563707165019857, "timesteps_total": 562500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 562500, "timers": {"training_iteration_time_ms": 1342372.333, "sample_time_ms": 28720.098, "load_time_ms": 0.772, "load_throughput": 3237344.86, "learn_time_ms": 1313649.962, "learn_throughput": 1.903, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 187500, "num_env_steps_trained": 187500, "num_agent_steps_sampled": 562500, "num_agent_steps_trained": 562500}, "done": false, "episodes_total": 750, "training_iteration": 75, "trial_id": "0b7ab_00052", "date": "2024-03-15_18-23-17", "timestamp": 1710523397, "time_this_iter_s": 1348.024126291275, "time_total_s": 103309.96246647835, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 103309.96246647835, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 43.68908045977012, "ram_util_percent": 16.91332288401254}, "checkpoint_dir_name": "checkpoint_000074"}
{"custom_metrics": {"collisions_mean": 132.62, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.5653379054390826, "policy_loss": -0.007571204953784144, "vf_loss": 2.5778995969514735, "vf_explained_var": 0.3626278383978482, "kl": 0.015756867230761452, "entropy": 1.3873903733560409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 131370.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 570000, "num_agent_steps_trained": 570000}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -557.657537934711, "episode_reward_mean": -324.51699175155204, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 132.62, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6039783984023521, "mean_inference_ms": 8.753623009892399, "mean_action_processing_ms": 0.42232275505434247, "mean_env_wait_ms": 0.987068172619054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.778261661529541, "StateBufferConnector_ms": 0.005682229995727539, "ViewRequirementAgentConnector_ms": 0.2529613971710205}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -557.657537934711, "episode_reward_mean": -324.51699175155204, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-389.2831678737876, -432.68320068510366, -261.78094605301936, -238.336539027058, -372.4614232543577, -455.0032770540012, -426.73973111201065, -440.5449861708662, -315.83600171070754, -418.6656849452227, -375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6039783984023521, "mean_inference_ms": 8.753623009892399, "mean_action_processing_ms": 0.42232275505434247, "mean_env_wait_ms": 0.987068172619054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.778261661529541, "StateBufferConnector_ms": 0.005682229995727539, "ViewRequirementAgentConnector_ms": 0.2529613971710205}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 570000, "num_agent_steps_trained": 570000, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.543791651864614, "num_agent_steps_trained_throughput_per_sec": 5.543791651864614, "timesteps_total": 570000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 570000, "timers": {"training_iteration_time_ms": 1343319.086, "sample_time_ms": 28695.691, "load_time_ms": 0.811, "load_throughput": 3081418.79, "learn_time_ms": 1314621.072, "learn_throughput": 1.902, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 570000, "num_agent_steps_trained": 570000}, "done": false, "episodes_total": 760, "training_iteration": 76, "trial_id": "0b7ab_00052", "date": "2024-03-15_18-45-51", "timestamp": 1710524751, "time_this_iter_s": 1352.8666965961456, "time_total_s": 104662.8291630745, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 104662.8291630745, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 43.67615825091098, "ram_util_percent": 16.969234773555442}, "checkpoint_dir_name": "checkpoint_000075"}
{"custom_metrics": {"collisions_mean": 128.84, "collisions_min": 14, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.6129159797710935, "policy_loss": -0.021066235934301205, "vf_loss": 2.6802248793943173, "vf_explained_var": 0.45759350897251877, "kl": 0.013358268978707455, "entropy": 1.8688301222120551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 133110.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 192500, "num_env_steps_trained": 192500, "num_agent_steps_sampled": 577500, "num_agent_steps_trained": 577500}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -326.46554269188414, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 128.84, "collisions_min": 14, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.60352435535384, "mean_inference_ms": 8.750177380683683, "mean_action_processing_ms": 0.4221210924665319, "mean_env_wait_ms": 0.9867367297017773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7769501209259033, "StateBufferConnector_ms": 0.005681753158569336, "ViewRequirementAgentConnector_ms": 0.2516963481903076}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -326.46554269188414, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-375.3681158384206, -358.95200780708177, -399.56140497465367, -247.81846309300272, -315.7587907030924, -206.42803168873152, -235.99875012162343, -465.97012288542385, -451.6560135739423, -281.70154501826573, -210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.60352435535384, "mean_inference_ms": 8.750177380683683, "mean_action_processing_ms": 0.4221210924665319, "mean_env_wait_ms": 0.9867367297017773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7769501209259033, "StateBufferConnector_ms": 0.005681753158569336, "ViewRequirementAgentConnector_ms": 0.2516963481903076}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 577500, "num_agent_steps_trained": 577500, "num_env_steps_sampled": 192500, "num_env_steps_trained": 192500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5840375889759555, "num_agent_steps_trained_throughput_per_sec": 5.5840375889759555, "timesteps_total": 577500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 577500, "timers": {"training_iteration_time_ms": 1343191.151, "sample_time_ms": 28685.104, "load_time_ms": 0.792, "load_throughput": 3156935.12, "learn_time_ms": 1314503.726, "learn_throughput": 1.902, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 192500, "num_env_steps_trained": 192500, "num_agent_steps_sampled": 577500, "num_agent_steps_trained": 577500}, "done": false, "episodes_total": 770, "training_iteration": 77, "trial_id": "0b7ab_00052", "date": "2024-03-15_19-08-16", "timestamp": 1710526096, "time_this_iter_s": 1343.1161761283875, "time_total_s": 106005.94533920288, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 106005.94533920288, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 43.624463069669986, "ram_util_percent": 16.66448402304871}, "checkpoint_dir_name": "checkpoint_000076"}
{"custom_metrics": {"collisions_mean": 128.3, "collisions_min": 14, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0019524851312189488, "total_loss": 1.615370261336773, "policy_loss": -0.0018549259235525783, "vf_loss": 2.6361583177942314, "vf_explained_var": 0.5023688450626943, "kl": 0.035600616016904264, "entropy": 1.4105664452805515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 134850.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 195000, "num_env_steps_trained": 195000, "num_agent_steps_sampled": 585000, "num_agent_steps_trained": 585000}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -328.19710590702374, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 128.3, "collisions_min": 14, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6028807803721026, "mean_inference_ms": 8.746851930586747, "mean_action_processing_ms": 0.4219225966064129, "mean_env_wait_ms": 0.9864110283727966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7778513431549072, "StateBufferConnector_ms": 0.0056765079498291016, "ViewRequirementAgentConnector_ms": 0.25197672843933105}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -328.19710590702374, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-210.3702374247835, -342.28584682226347, -302.1529392525069, -422.3807922979868, -287.0196008363662, -314.41965675889725, -402.3412150209702, -464.18421517860537, -417.0258074110692, -464.39225752097684, -367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6028807803721026, "mean_inference_ms": 8.746851930586747, "mean_action_processing_ms": 0.4219225966064129, "mean_env_wait_ms": 0.9864110283727966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7778513431549072, "StateBufferConnector_ms": 0.0056765079498291016, "ViewRequirementAgentConnector_ms": 0.25197672843933105}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 585000, "num_agent_steps_trained": 585000, "num_env_steps_sampled": 195000, "num_env_steps_trained": 195000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.56477305158737, "num_agent_steps_trained_throughput_per_sec": 5.56477305158737, "timesteps_total": 585000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 585000, "timers": {"training_iteration_time_ms": 1343691.736, "sample_time_ms": 28655.565, "load_time_ms": 0.831, "load_throughput": 3009430.876, "learn_time_ms": 1315033.803, "learn_throughput": 1.901, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 195000, "num_env_steps_trained": 195000, "num_agent_steps_sampled": 585000, "num_agent_steps_trained": 585000}, "done": false, "episodes_total": 780, "training_iteration": 78, "trial_id": "0b7ab_00052", "date": "2024-03-15_19-30-44", "timestamp": 1710527444, "time_this_iter_s": 1347.7658414840698, "time_total_s": 107353.71118068695, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 107353.71118068695, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 43.59947753396029, "ram_util_percent": 16.7742946708464}, "checkpoint_dir_name": "checkpoint_000077"}
{"custom_metrics": {"collisions_mean": 121.3, "collisions_min": 14, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.3918495705568006, "policy_loss": -0.0025442178579229303, "vf_loss": 2.282698810896997, "vf_explained_var": 0.3739390206062931, "kl": 0.011674788351630369, "entropy": 1.1002727536447132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 136590.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 197500, "num_env_steps_trained": 197500, "num_agent_steps_sampled": 592500, "num_agent_steps_trained": 592500}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -320.6378581832642, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 121.3, "collisions_min": 14, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6022694256200265, "mean_inference_ms": 8.743768087304401, "mean_action_processing_ms": 0.421740017414794, "mean_env_wait_ms": 0.9860995131056863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7782595157623291, "StateBufferConnector_ms": 0.0056798458099365234, "ViewRequirementAgentConnector_ms": 0.25221967697143555}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -320.6378581832642, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-367.7699134489397, -196.55152848124334, -184.8433073938991, -211.95435418143992, -217.61245322265626, -227.67910172275535, -272.8276421971706, -205.764704708904, -314.4036629049834, -379.1651373703063, -226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6022694256200265, "mean_inference_ms": 8.743768087304401, "mean_action_processing_ms": 0.421740017414794, "mean_env_wait_ms": 0.9860995131056863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7782595157623291, "StateBufferConnector_ms": 0.0056798458099365234, "ViewRequirementAgentConnector_ms": 0.25221967697143555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592500, "num_agent_steps_trained": 592500, "num_env_steps_sampled": 197500, "num_env_steps_trained": 197500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.560893446614596, "num_agent_steps_trained_throughput_per_sec": 5.560893446614596, "timesteps_total": 592500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 592500, "timers": {"training_iteration_time_ms": 1344154.171, "sample_time_ms": 28688.858, "load_time_ms": 0.837, "load_throughput": 2988588.041, "learn_time_ms": 1315462.93, "learn_throughput": 1.9, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 197500, "num_env_steps_trained": 197500, "num_agent_steps_sampled": 592500, "num_agent_steps_trained": 592500}, "done": false, "episodes_total": 790, "training_iteration": 79, "trial_id": "0b7ab_00052", "date": "2024-03-15_19-53-14", "timestamp": 1710528794, "time_this_iter_s": 1348.706271648407, "time_total_s": 108702.41745233536, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 108702.41745233536, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 43.63815240083508, "ram_util_percent": 16.765553235908143}, "checkpoint_dir_name": "checkpoint_000078"}
{"custom_metrics": {"collisions_mean": 121.44, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.4683112161940541, "policy_loss": 0.002868186876354418, "vf_loss": 2.398392162609032, "vf_explained_var": 0.3954797594711698, "kl": 0.012825904188135081, "entropy": 1.1510148742404798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 138330.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -323.1435639117828, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 121.44, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6017663411330747, "mean_inference_ms": 8.741252272781706, "mean_action_processing_ms": 0.4216086771923766, "mean_env_wait_ms": 0.9858404429240122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.779491662979126, "StateBufferConnector_ms": 0.005717277526855469, "ViewRequirementAgentConnector_ms": 0.25469231605529785}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -323.1435639117828, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-226.69284788933888, -239.47340769376834, -372.55626855676724, -434.23659332518855, -234.06958304323877, -447.66121077706714, -461.490233457761, -450.3105842833563, -369.31440844773186, -334.3069774081205, -236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6017663411330747, "mean_inference_ms": 8.741252272781706, "mean_action_processing_ms": 0.4216086771923766, "mean_env_wait_ms": 0.9858404429240122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.779491662979126, "StateBufferConnector_ms": 0.005717277526855469, "ViewRequirementAgentConnector_ms": 0.25469231605529785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.541965181080829, "num_agent_steps_trained_throughput_per_sec": 5.541965181080829, "timesteps_total": 600000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 1344949.718, "sample_time_ms": 28814.491, "load_time_ms": 0.839, "load_throughput": 2978909.091, "learn_time_ms": 1316132.838, "learn_throughput": 1.9, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 800, "training_iteration": 80, "trial_id": "0b7ab_00052", "date": "2024-03-15_20-15-48", "timestamp": 1710530148, "time_this_iter_s": 1353.3125667572021, "time_total_s": 110055.73001909256, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 110055.73001909256, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 43.670395421436005, "ram_util_percent": 16.815192507804376}, "checkpoint_dir_name": "checkpoint_000079"}
{"custom_metrics": {"collisions_mean": 118.7, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.4832247392691928, "policy_loss": -0.0009808920099046723, "vf_loss": 2.428677071031483, "vf_explained_var": 0.4104037416734915, "kl": 0.013370382303292442, "entropy": 1.365551477798325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 140070.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 202500, "num_env_steps_trained": 202500, "num_agent_steps_sampled": 607500, "num_agent_steps_trained": 607500}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -319.9344111344351, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 118.7, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.601284432106776, "mean_inference_ms": 8.738805209835359, "mean_action_processing_ms": 0.42148433879936364, "mean_env_wait_ms": 0.9855930942014807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7789063453674316, "StateBufferConnector_ms": 0.005723237991333008, "ViewRequirementAgentConnector_ms": 0.25472116470336914}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -319.9344111344351, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-236.7566038750896, -217.79965126323697, -280.8811393922149, -206.0479669747985, -254.8878638782504, -219.2849163760961, -349.05793807728725, -422.2972453005771, -271.465235252025, -261.13890986828835, -271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.601284432106776, "mean_inference_ms": 8.738805209835359, "mean_action_processing_ms": 0.42148433879936364, "mean_env_wait_ms": 0.9855930942014807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7789063453674316, "StateBufferConnector_ms": 0.005723237991333008, "ViewRequirementAgentConnector_ms": 0.25472116470336914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 607500, "num_agent_steps_trained": 607500, "num_env_steps_sampled": 202500, "num_env_steps_trained": 202500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.539474211562187, "num_agent_steps_trained_throughput_per_sec": 5.539474211562187, "timesteps_total": 607500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 607500, "timers": {"training_iteration_time_ms": 1345990.65, "sample_time_ms": 28813.553, "load_time_ms": 0.872, "load_throughput": 2867860.952, "learn_time_ms": 1317174.656, "learn_throughput": 1.898, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 202500, "num_env_steps_trained": 202500, "num_agent_steps_sampled": 607500, "num_agent_steps_trained": 607500}, "done": false, "episodes_total": 810, "training_iteration": 81, "trial_id": "0b7ab_00052", "date": "2024-03-15_20-38-22", "timestamp": 1710531502, "time_this_iter_s": 1353.92116689682, "time_total_s": 111409.65118598938, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 111409.65118598938, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 43.68822916666667, "ram_util_percent": 16.84838541666667}, "checkpoint_dir_name": "checkpoint_000080"}
{"custom_metrics": {"collisions_mean": 120.64, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.3386759348550876, "policy_loss": -0.006246742125514937, "vf_loss": 2.195866207101907, "vf_explained_var": 0.3417071669266142, "kl": 0.016520860678705, "entropy": 1.2370490916399821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 141810.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 205000, "num_env_steps_trained": 205000, "num_agent_steps_sampled": 615000, "num_agent_steps_trained": 615000}, "sampler_results": {"episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -322.4569597571262, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 120.64, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6008577765427345, "mean_inference_ms": 8.736621568246415, "mean_action_processing_ms": 0.42137532131795913, "mean_env_wait_ms": 0.9853621687499502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7799999713897705, "StateBufferConnector_ms": 0.005742311477661133, "ViewRequirementAgentConnector_ms": 0.2560915946960449}}, "episode_reward_max": -180.69066376309297, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -322.4569597571262, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-271.3014329641386, -467.6095162256009, -180.69066376309297, -241.73053872812903, -245.22951254321802, -397.7968579017944, -264.74896951129926, -389.7732436337825, -252.4408902884648, -212.6604220862095, -557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6008577765427345, "mean_inference_ms": 8.736621568246415, "mean_action_processing_ms": 0.42137532131795913, "mean_env_wait_ms": 0.9853621687499502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7799999713897705, "StateBufferConnector_ms": 0.005742311477661133, "ViewRequirementAgentConnector_ms": 0.2560915946960449}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 615000, "num_agent_steps_trained": 615000, "num_env_steps_sampled": 205000, "num_env_steps_trained": 205000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5097600627499705, "num_agent_steps_trained_throughput_per_sec": 5.5097600627499705, "timesteps_total": 615000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 615000, "timers": {"training_iteration_time_ms": 1348239.373, "sample_time_ms": 28869.235, "load_time_ms": 0.853, "load_throughput": 2930866.199, "learn_time_ms": 1319367.706, "learn_throughput": 1.895, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 205000, "num_env_steps_trained": 205000, "num_agent_steps_sampled": 615000, "num_agent_steps_trained": 615000}, "done": false, "episodes_total": 820, "training_iteration": 82, "trial_id": "0b7ab_00052", "date": "2024-03-15_21-01-05", "timestamp": 1710532865, "time_this_iter_s": 1361.2228264808655, "time_total_s": 112770.87401247025, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 112770.87401247025, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 43.7166149068323, "ram_util_percent": 16.895445134575574}, "checkpoint_dir_name": "checkpoint_000081"}
{"custom_metrics": {"collisions_mean": 122.3, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.5683376527907884, "policy_loss": 0.013951166457999712, "vf_loss": 2.5451660520386423, "vf_explained_var": 0.45466670983139124, "kl": 0.012519043347480259, "entropy": 1.7730173806534095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 143550.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 207500, "num_env_steps_trained": 207500, "num_agent_steps_sampled": 622500, "num_agent_steps_trained": 622500}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -329.7555436842652, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 122.3, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6004737406418303, "mean_inference_ms": 8.734662414781074, "mean_action_processing_ms": 0.42128306981439506, "mean_env_wait_ms": 0.9851509804554854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7804114818572998, "StateBufferConnector_ms": 0.005692720413208008, "ViewRequirementAgentConnector_ms": 0.2570176124572754}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -329.7555436842652, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-557.657537934711, -194.23793334035588, -527.1518249386978, -411.71649664538, -223.26663925598896, -228.74431223164828, -537.8845018515462, -478.4770298459238, -306.057187401188, -328.519646310356, -227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6004737406418303, "mean_inference_ms": 8.734662414781074, "mean_action_processing_ms": 0.42128306981439506, "mean_env_wait_ms": 0.9851509804554854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7804114818572998, "StateBufferConnector_ms": 0.005692720413208008, "ViewRequirementAgentConnector_ms": 0.2570176124572754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 622500, "num_agent_steps_trained": 622500, "num_env_steps_sampled": 207500, "num_env_steps_trained": 207500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.472736784709481, "num_agent_steps_trained_throughput_per_sec": 5.472736784709481, "timesteps_total": 622500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 622500, "timers": {"training_iteration_time_ms": 1351714.166, "sample_time_ms": 28916.247, "load_time_ms": 0.897, "load_throughput": 2786172.446, "learn_time_ms": 1322795.403, "learn_throughput": 1.89, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 207500, "num_env_steps_trained": 207500, "num_agent_steps_sampled": 622500, "num_agent_steps_trained": 622500}, "done": false, "episodes_total": 830, "training_iteration": 83, "trial_id": "0b7ab_00052", "date": "2024-03-15_21-23-55", "timestamp": 1710534235, "time_this_iter_s": 1370.431500673294, "time_total_s": 114141.30551314354, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 114141.30551314354, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 43.72937242798354, "ram_util_percent": 16.913683127572018}, "checkpoint_dir_name": "checkpoint_000082"}
{"custom_metrics": {"collisions_mean": 120.18, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.4357190323818607, "policy_loss": 0.007006684959138176, "vf_loss": 2.33675620173072, "vf_explained_var": 0.38222608720434126, "kl": 0.01387339663718079, "entropy": 1.5513494712362152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 145290.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -326.6439974512397, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 120.18, "collisions_min": 16, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600171066640761, "mean_inference_ms": 8.733149615490031, "mean_action_processing_ms": 0.4212262980179095, "mean_env_wait_ms": 0.9849687264813884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7833411693572998, "StateBufferConnector_ms": 0.005716800689697266, "ViewRequirementAgentConnector_ms": 0.259566068649292}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -326.6439974512397, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-227.839056637182, -285.27806258923823, -367.7902012486765, -324.8218297377214, -195.31478053278232, -487.67535722325357, -210.8763127938821, -231.0874780190859, -244.10332494167753, -245.6559542346546, -261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600171066640761, "mean_inference_ms": 8.733149615490031, "mean_action_processing_ms": 0.4212262980179095, "mean_env_wait_ms": 0.9849687264813884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7833411693572998, "StateBufferConnector_ms": 0.005716800689697266, "ViewRequirementAgentConnector_ms": 0.259566068649292}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.447724459872392, "num_agent_steps_trained_throughput_per_sec": 5.447724459872392, "timesteps_total": 630000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 1355607.021, "sample_time_ms": 29025.769, "load_time_ms": 0.888, "load_throughput": 2816859.637, "learn_time_ms": 1326578.724, "learn_throughput": 1.885, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 840, "training_iteration": 84, "trial_id": "0b7ab_00052", "date": "2024-03-15_21-46-54", "timestamp": 1710535614, "time_this_iter_s": 1376.7237756252289, "time_total_s": 115518.02928876877, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 115518.02928876877, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 43.69964157706093, "ram_util_percent": 16.966615463389658}, "checkpoint_dir_name": "checkpoint_000083"}
{"custom_metrics": {"collisions_mean": 127.1, "collisions_min": 22, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.568824189251567, "policy_loss": -0.0052122904169747885, "vf_loss": 2.5773888778755034, "vf_explained_var": 0.3771499507386109, "kl": 0.012634330839801837, "entropy": 2.072528139453906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 147030.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 212500, "num_env_steps_trained": 212500, "num_agent_steps_sampled": 637500, "num_agent_steps_trained": 637500}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -336.193327741159, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 127.1, "collisions_min": 22, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999292481150145, "mean_inference_ms": 8.731871595884401, "mean_action_processing_ms": 0.42119034392061977, "mean_env_wait_ms": 0.9848050280536339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7841875553131104, "StateBufferConnector_ms": 0.005736351013183594, "ViewRequirementAgentConnector_ms": 0.260284423828125}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -336.193327741159, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-261.33519185392294, -395.5186877709953, -304.34050226465405, -266.5823681054443, -289.4442821130059, -320.97515776574113, -319.1182641808862, -388.30669470348033, -251.38037879375523, -531.1379693563416, -335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999292481150145, "mean_inference_ms": 8.731871595884401, "mean_action_processing_ms": 0.42119034392061977, "mean_env_wait_ms": 0.9848050280536339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7841875553131104, "StateBufferConnector_ms": 0.005736351013183594, "ViewRequirementAgentConnector_ms": 0.260284423828125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 637500, "num_agent_steps_trained": 637500, "num_env_steps_sampled": 212500, "num_env_steps_trained": 212500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.461734241694593, "num_agent_steps_trained_throughput_per_sec": 5.461734241694593, "timesteps_total": 637500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 637500, "timers": {"training_iteration_time_ms": 1358123.837, "sample_time_ms": 29085.102, "load_time_ms": 0.893, "load_throughput": 2798292.058, "learn_time_ms": 1329036.221, "learn_throughput": 1.881, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 212500, "num_env_steps_trained": 212500, "num_agent_steps_sampled": 637500, "num_agent_steps_trained": 637500}, "done": false, "episodes_total": 850, "training_iteration": 85, "trial_id": "0b7ab_00052", "date": "2024-03-15_22-09-49", "timestamp": 1710536989, "time_this_iter_s": 1373.1922054290771, "time_total_s": 116891.22149419785, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 116891.22149419785, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 43.734238851870835, "ram_util_percent": 16.965299846232703}, "checkpoint_dir_name": "checkpoint_000084"}
{"custom_metrics": {"collisions_mean": 122.96, "collisions_min": 22, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.1642010986200138, "policy_loss": -0.0013667982739353575, "vf_loss": 1.9022229584897388, "vf_explained_var": 0.38628251463517377, "kl": 0.015045889250018525, "entropy": 1.3108255787054077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 148770.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 215000, "num_env_steps_trained": 215000, "num_agent_steps_sampled": 645000, "num_agent_steps_trained": 645000}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -335.4230468893368, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 122.96, "collisions_min": 22, "collisions_max": 350, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599742338406212, "mean_inference_ms": 8.730880823734116, "mean_action_processing_ms": 0.4211749675229953, "mean_env_wait_ms": 0.984662610121991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7858049869537354, "StateBufferConnector_ms": 0.005778312683105469, "ViewRequirementAgentConnector_ms": 0.26310038566589355}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -644.5110662878163, "episode_reward_mean": -335.4230468893368, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-335.2069307799747, -537.4443600323148, -284.02785860689784, -429.80779279909814, -454.8242738739149, -449.9860237709624, -293.57033634207386, -277.51631602871606, -239.29509339757013, -644.5110662878163, -309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599742338406212, "mean_inference_ms": 8.730880823734116, "mean_action_processing_ms": 0.4211749675229953, "mean_env_wait_ms": 0.984662610121991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7858049869537354, "StateBufferConnector_ms": 0.005778312683105469, "ViewRequirementAgentConnector_ms": 0.26310038566589355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 645000, "num_agent_steps_trained": 645000, "num_env_steps_sampled": 215000, "num_env_steps_trained": 215000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.441592868772728, "num_agent_steps_trained_throughput_per_sec": 5.441592868772728, "timesteps_total": 645000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 645000, "timers": {"training_iteration_time_ms": 1360664.657, "sample_time_ms": 29152.542, "load_time_ms": 0.846, "load_throughput": 2956400.135, "learn_time_ms": 1331509.651, "learn_throughput": 1.878, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 215000, "num_env_steps_trained": 215000, "num_agent_steps_sampled": 645000, "num_agent_steps_trained": 645000}, "done": false, "episodes_total": 860, "training_iteration": 86, "trial_id": "0b7ab_00052", "date": "2024-03-15_22-32-48", "timestamp": 1710538368, "time_this_iter_s": 1378.27498793602, "time_total_s": 118269.49648213387, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 118269.49648213387, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 43.781850715746415, "ram_util_percent": 16.960173824130884}, "checkpoint_dir_name": "checkpoint_000085"}
{"custom_metrics": {"collisions_mean": 123.82, "collisions_min": 22, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.675, "cur_lr": 0.0019524851312189488, "total_loss": 1.3405268335875509, "policy_loss": 0.0024255586472264994, "vf_loss": 2.1752034251802956, "vf_explained_var": 0.47553687941754, "kl": 0.025008548763527122, "entropy": 1.3659535949739317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 150510.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 217500, "num_env_steps_trained": 217500, "num_agent_steps_sampled": 652500, "num_agent_steps_trained": 652500}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -571.767845708141, "episode_reward_mean": -331.0523022727807, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 123.82, "collisions_min": 22, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5995969352065602, "mean_inference_ms": 8.730128784515173, "mean_action_processing_ms": 0.4211731075661487, "mean_env_wait_ms": 0.984539871859709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7864046096801758, "StateBufferConnector_ms": 0.005781412124633789, "ViewRequirementAgentConnector_ms": 0.26360058784484863}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -571.767845708141, "episode_reward_mean": -331.0523022727807, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-309.3840013322578, -352.4658575010127, -398.76464914993426, -358.2494167570978, -264.4417175578278, -494.2641749400307, -329.6675808253271, -225.73429843868024, -545.4979617549557, -233.89990896107957, -268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5995969352065602, "mean_inference_ms": 8.730128784515173, "mean_action_processing_ms": 0.4211731075661487, "mean_env_wait_ms": 0.984539871859709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7864046096801758, "StateBufferConnector_ms": 0.005781412124633789, "ViewRequirementAgentConnector_ms": 0.26360058784484863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652500, "num_agent_steps_trained": 652500, "num_env_steps_sampled": 217500, "num_env_steps_trained": 217500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.387753699595138, "num_agent_steps_trained_throughput_per_sec": 5.387753699595138, "timesteps_total": 652500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 652500, "timers": {"training_iteration_time_ms": 1365557.822, "sample_time_ms": 29212.01, "load_time_ms": 0.845, "load_throughput": 2958318.522, "learn_time_ms": 1336343.316, "learn_throughput": 1.871, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 217500, "num_env_steps_trained": 217500, "num_agent_steps_sampled": 652500, "num_agent_steps_trained": 652500}, "done": false, "episodes_total": 870, "training_iteration": 87, "trial_id": "0b7ab_00052", "date": "2024-03-15_22-56-01", "timestamp": 1710539761, "time_this_iter_s": 1392.0478789806366, "time_total_s": 119661.5443611145, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 119661.5443611145, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 43.757518987341776, "ram_util_percent": 16.865113924050636}, "checkpoint_dir_name": "checkpoint_000086"}
{"custom_metrics": {"collisions_mean": 122.74, "collisions_min": 22, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.3678262648172677, "policy_loss": -0.0007790737448195959, "vf_loss": 2.2325204014264304, "vf_explained_var": 0.4880046284404294, "kl": 0.0124152594357536, "entropy": 1.4461596190800954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 152250.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -571.767845708141, "episode_reward_mean": -331.84934922559046, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 122.74, "collisions_min": 22, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5995193879115464, "mean_inference_ms": 8.729687837190752, "mean_action_processing_ms": 0.4211922293329238, "mean_env_wait_ms": 0.9844378292455152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7875461578369141, "StateBufferConnector_ms": 0.0058629512786865234, "ViewRequirementAgentConnector_ms": 0.2637665271759033}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -571.767845708141, "episode_reward_mean": -331.84934922559046, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-268.07928630517824, -386.85658635459885, -349.01839327980105, -249.51037054601895, -194.59082765983075, -236.10622226566397, -462.93138108305214, -239.84129521694027, -209.2473703449504, -274.4660630924301, -271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5995193879115464, "mean_inference_ms": 8.729687837190752, "mean_action_processing_ms": 0.4211922293329238, "mean_env_wait_ms": 0.9844378292455152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7875461578369141, "StateBufferConnector_ms": 0.0058629512786865234, "ViewRequirementAgentConnector_ms": 0.2637665271759033}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.320181651516462, "num_agent_steps_trained_throughput_per_sec": 5.320181651516462, "timesteps_total": 660000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 1371754.066, "sample_time_ms": 29295.228, "load_time_ms": 0.856, "load_throughput": 2921068.613, "learn_time_ms": 1342456.291, "learn_throughput": 1.862, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 880, "training_iteration": 88, "trial_id": "0b7ab_00052", "date": "2024-03-15_23-19-31", "timestamp": 1710541171, "time_this_iter_s": 1409.7284891605377, "time_total_s": 121071.27285027504, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 121071.27285027504, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 43.661980990495245, "ram_util_percent": 16.839769884942474}, "checkpoint_dir_name": "checkpoint_000087"}
{"custom_metrics": {"collisions_mean": 118.48, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.2174746435084756, "policy_loss": 0.008552376533612266, "vf_loss": 1.9694269421799429, "vf_explained_var": 0.5099154473378741, "kl": 0.012533909259578107, "entropy": 1.2043907834923473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 153990.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 222500, "num_env_steps_trained": 222500, "num_agent_steps_sampled": 667500, "num_agent_steps_trained": 667500}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -571.767845708141, "episode_reward_mean": -333.74257685147757, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 118.48, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599547937160417, "mean_inference_ms": 8.729724367326689, "mean_action_processing_ms": 0.42123745451407685, "mean_env_wait_ms": 0.9843733598279373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7965774536132812, "StateBufferConnector_ms": 0.005989789962768555, "ViewRequirementAgentConnector_ms": 0.2683379650115967}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -571.767845708141, "episode_reward_mean": -333.74257685147757, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-271.96454954713494, -268.7185347155657, -291.7211012179169, -403.7692365597418, -198.98641113889303, -278.9011411169482, -357.5725239145895, -215.27116857192178, -202.25724717743256, -339.98046452400985, -394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599547937160417, "mean_inference_ms": 8.729724367326689, "mean_action_processing_ms": 0.42123745451407685, "mean_env_wait_ms": 0.9843733598279373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7965774536132812, "StateBufferConnector_ms": 0.005989789962768555, "ViewRequirementAgentConnector_ms": 0.2683379650115967}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 667500, "num_agent_steps_trained": 667500, "num_env_steps_sampled": 222500, "num_env_steps_trained": 222500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.374396455264235, "num_agent_steps_trained_throughput_per_sec": 5.374396455264235, "timesteps_total": 667500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 667500, "timers": {"training_iteration_time_ms": 1376434.207, "sample_time_ms": 29431.131, "load_time_ms": 0.861, "load_throughput": 2904964.539, "learn_time_ms": 1347000.522, "learn_throughput": 1.856, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 222500, "num_env_steps_trained": 222500, "num_agent_steps_sampled": 667500, "num_agent_steps_trained": 667500}, "done": false, "episodes_total": 890, "training_iteration": 89, "trial_id": "0b7ab_00052", "date": "2024-03-15_23-42-47", "timestamp": 1710542567, "time_this_iter_s": 1395.5076229572296, "time_total_s": 122466.78047323227, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 122466.78047323227, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 43.71484848484848, "ram_util_percent": 16.877323232323235}, "checkpoint_dir_name": "checkpoint_000088"}
{"custom_metrics": {"collisions_mean": 115.72, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.389309594413833, "policy_loss": -0.0011910612288134536, "vf_loss": 2.269987688855878, "vf_explained_var": 0.4784259641992635, "kl": 0.011563555962476714, "entropy": 1.6953809277898493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 155730.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 675000, "num_agent_steps_trained": 675000}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -337.80055513299186, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 115.72, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599600008359003, "mean_inference_ms": 8.729856407651248, "mean_action_processing_ms": 0.4212839447706848, "mean_env_wait_ms": 0.9843234986406807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7972695827484131, "StateBufferConnector_ms": 0.0059888362884521484, "ViewRequirementAgentConnector_ms": 0.26865601539611816}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -337.80055513299186, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-394.0645245371918, -219.03180056398963, -378.55694290150205, -262.6524119509005, -293.400548282529, -431.4957077823571, -342.27639325435035, -301.5150196875337, -209.81931961807945, -416.3841685691446, -317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599600008359003, "mean_inference_ms": 8.729856407651248, "mean_action_processing_ms": 0.4212839447706848, "mean_env_wait_ms": 0.9843234986406807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7972695827484131, "StateBufferConnector_ms": 0.0059888362884521484, "ViewRequirementAgentConnector_ms": 0.26865601539611816}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 675000, "num_agent_steps_trained": 675000, "num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.386448043956458, "num_agent_steps_trained_throughput_per_sec": 5.386448043956458, "timesteps_total": 675000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 675000, "timers": {"training_iteration_time_ms": 1380341.476, "sample_time_ms": 29459.942, "load_time_ms": 0.886, "load_throughput": 2822090.645, "learn_time_ms": 1350878.947, "learn_throughput": 1.851, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 675000, "num_agent_steps_trained": 675000}, "done": false, "episodes_total": 900, "training_iteration": 90, "trial_id": "0b7ab_00052", "date": "2024-03-16_00-06-00", "timestamp": 1710543960, "time_this_iter_s": 1392.3853030204773, "time_total_s": 123859.16577625275, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 123859.16577625275, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 43.76872469635627, "ram_util_percent": 16.955566801619437}, "checkpoint_dir_name": "checkpoint_000089"}
{"custom_metrics": {"collisions_mean": 113.74, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.5753328984266082, "policy_loss": -0.0013673388939779037, "vf_loss": 2.5755058617812807, "vf_explained_var": 0.5017263216191324, "kl": 0.012183383580068255, "entropy": 1.632120486682859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 157470.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 227500, "num_env_steps_trained": 227500, "num_agent_steps_sampled": 682500, "num_agent_steps_trained": 682500}, "sampler_results": {"episode_reward_max": -189.22588404426187, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -339.23417398943894, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 113.74, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599763439676933, "mean_inference_ms": 8.730462255929233, "mean_action_processing_ms": 0.4213689959203826, "mean_env_wait_ms": 0.9843264549859458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.801424503326416, "StateBufferConnector_ms": 0.006059885025024414, "ViewRequirementAgentConnector_ms": 0.2719001770019531}}, "episode_reward_max": -189.22588404426187, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -339.23417398943894, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-317.35084977390096, -236.7207879247259, -477.3610002381819, -285.5778269143135, -203.7091698896202, -227.44419728515908, -189.22588404426187, -336.2606806090286, -259.01829414692946, -439.20364170084963, -415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.599763439676933, "mean_inference_ms": 8.730462255929233, "mean_action_processing_ms": 0.4213689959203826, "mean_env_wait_ms": 0.9843264549859458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.801424503326416, "StateBufferConnector_ms": 0.006059885025024414, "ViewRequirementAgentConnector_ms": 0.2719001770019531}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 682500, "num_agent_steps_trained": 682500, "num_env_steps_sampled": 227500, "num_env_steps_trained": 227500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.390000927843982, "num_agent_steps_trained_throughput_per_sec": 5.390000927843982, "timesteps_total": 682500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 682500, "timers": {"training_iteration_time_ms": 1384096.108, "sample_time_ms": 29604.244, "load_time_ms": 0.861, "load_throughput": 2904964.539, "learn_time_ms": 1354489.301, "learn_throughput": 1.846, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 227500, "num_env_steps_trained": 227500, "num_agent_steps_sampled": 682500, "num_agent_steps_trained": 682500}, "done": false, "episodes_total": 910, "training_iteration": 91, "trial_id": "0b7ab_00052", "date": "2024-03-16_00-29-13", "timestamp": 1710545353, "time_this_iter_s": 1391.467505455017, "time_total_s": 125250.63328170776, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 125250.63328170776, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 43.780952380952385, "ram_util_percent": 16.88632218844985}, "checkpoint_dir_name": "checkpoint_000090"}
{"custom_metrics": {"collisions_mean": 113.8, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.46432658551962, "policy_loss": 0.004957836962722499, "vf_loss": 2.3867248048149476, "vf_explained_var": 0.48970864593297586, "kl": 0.009550586280067995, "entropy": 1.4176407682939551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 159210.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 690000, "num_agent_steps_trained": 690000}, "sampler_results": {"episode_reward_max": -196.50992309181368, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -344.26346344569816, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 113.8, "collisions_min": 14, "collisions_max": 348, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999208929496609, "mean_inference_ms": 8.731071753007354, "mean_action_processing_ms": 0.42145140857230035, "mean_env_wait_ms": 0.984337514090754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8010697364807129, "StateBufferConnector_ms": 0.00603795051574707, "ViewRequirementAgentConnector_ms": 0.2712442874908447}}, "episode_reward_max": -196.50992309181368, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -344.26346344569816, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-415.95927631462735, -207.70342240909073, -218.5309449753647, -446.0749206794047, -483.9813237002297, -408.43208480329287, -348.1753004941489, -571.767845708141, -354.592159044769, -198.6231622305669, -373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999208929496609, "mean_inference_ms": 8.731071753007354, "mean_action_processing_ms": 0.42145140857230035, "mean_env_wait_ms": 0.984337514090754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8010697364807129, "StateBufferConnector_ms": 0.00603795051574707, "ViewRequirementAgentConnector_ms": 0.2712442874908447}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 690000, "num_agent_steps_trained": 690000, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.492537346748142, "num_agent_steps_trained_throughput_per_sec": 5.492537346748142, "timesteps_total": 690000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 690000, "timers": {"training_iteration_time_ms": 1384522.941, "sample_time_ms": 29607.23, "load_time_ms": 0.86, "load_throughput": 2908025.958, "learn_time_ms": 1354913.148, "learn_throughput": 1.845, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 690000, "num_agent_steps_trained": 690000}, "done": false, "episodes_total": 920, "training_iteration": 92, "trial_id": "0b7ab_00052", "date": "2024-03-16_00-51-59", "timestamp": 1710546719, "time_this_iter_s": 1365.4911015033722, "time_total_s": 126616.12438321114, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 126616.12438321114, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 43.79076367389061, "ram_util_percent": 16.821104231166156}, "checkpoint_dir_name": "checkpoint_000091"}
{"custom_metrics": {"collisions_mean": 111.84, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.4413919106827, "policy_loss": -0.005747556077027372, "vf_loss": 2.3649815872140314, "vf_explained_var": 0.5508531986981973, "kl": 0.010516087610900799, "entropy": 1.4436235275930436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 160950.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled": 697500, "num_agent_steps_trained": 697500}, "sampler_results": {"episode_reward_max": -196.50992309181368, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -340.67207507666257, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 111.84, "collisions_min": 14, "collisions_max": 344, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6000739476712837, "mean_inference_ms": 8.731707786981277, "mean_action_processing_ms": 0.4215283909166331, "mean_env_wait_ms": 0.9843406872704334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8001148700714111, "StateBufferConnector_ms": 0.006033897399902344, "ViewRequirementAgentConnector_ms": 0.2705826759338379}}, "episode_reward_max": -196.50992309181368, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -340.67207507666257, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-373.54627708504813, -544.5213630755711, -246.96038583277635, -377.76265496480846, -307.0857436512551, -465.47727062939714, -407.59062248476107, -251.84202254932146, -233.1567157756758, -274.615430404634, -355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6000739476712837, "mean_inference_ms": 8.731707786981277, "mean_action_processing_ms": 0.4215283909166331, "mean_env_wait_ms": 0.9843406872704334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8001148700714111, "StateBufferConnector_ms": 0.006033897399902344, "ViewRequirementAgentConnector_ms": 0.2705826759338379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 697500, "num_agent_steps_trained": 697500, "num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.49671445899663, "num_agent_steps_trained_throughput_per_sec": 5.49671445899663, "timesteps_total": 697500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 697500, "timers": {"training_iteration_time_ms": 1383925.134, "sample_time_ms": 29609.466, "load_time_ms": 0.869, "load_throughput": 2877778.083, "learn_time_ms": 1354313.109, "learn_throughput": 1.846, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled": 697500, "num_agent_steps_trained": 697500}, "done": false, "episodes_total": 930, "training_iteration": 93, "trial_id": "0b7ab_00052", "date": "2024-03-16_01-14-44", "timestamp": 1710548084, "time_this_iter_s": 1364.4538178443909, "time_total_s": 127980.57820105553, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 127980.57820105553, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 43.746050593701604, "ram_util_percent": 16.93649974186887}, "checkpoint_dir_name": "checkpoint_000092"}
{"custom_metrics": {"collisions_mean": 108.86, "collisions_min": 0, "collisions_max": 306, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.3049383709173725, "policy_loss": 0.0009166474997376402, "vf_loss": 2.1287906650432395, "vf_explained_var": 0.5218987519713654, "kl": 0.01085665979107848, "entropy": 1.095778944582582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 162690.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 235000, "num_env_steps_trained": 235000, "num_agent_steps_sampled": 705000, "num_agent_steps_trained": 705000}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -336.0699206181143, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 108.86, "collisions_min": 0, "collisions_max": 306, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600165194818681, "mean_inference_ms": 8.73198500069716, "mean_action_processing_ms": 0.42157064479909745, "mean_env_wait_ms": 0.984320870052835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7976903915405273, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.26842474937438965}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -336.0699206181143, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-355.7182275109019, -389.0318616973079, -486.39632462791155, -405.59525799058895, -262.26243473466303, -396.80876854314295, -349.47517887316974, -326.00462024916624, -358.39803230952975, -445.68468041369135, -279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600165194818681, "mean_inference_ms": 8.73198500069716, "mean_action_processing_ms": 0.42157064479909745, "mean_env_wait_ms": 0.984320870052835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7976903915405273, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.26842474937438965}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 705000, "num_agent_steps_trained": 705000, "num_env_steps_sampled": 235000, "num_env_steps_trained": 235000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.507980247840404, "num_agent_steps_trained_throughput_per_sec": 5.507980247840404, "timesteps_total": 705000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 705000, "timers": {"training_iteration_time_ms": 1382419.039, "sample_time_ms": 29503.368, "load_time_ms": 0.847, "load_throughput": 2950742.909, "learn_time_ms": 1352913.139, "learn_throughput": 1.848, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 235000, "num_env_steps_trained": 235000, "num_agent_steps_sampled": 705000, "num_agent_steps_trained": 705000}, "done": false, "episodes_total": 940, "training_iteration": 94, "trial_id": "0b7ab_00052", "date": "2024-03-16_01-37-26", "timestamp": 1710549446, "time_this_iter_s": 1361.6627411842346, "time_total_s": 129342.24094223976, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 129342.24094223976, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 43.7799481865285, "ram_util_percent": 16.974922279792747}, "checkpoint_dir_name": "checkpoint_000093"}
{"custom_metrics": {"collisions_mean": 104.48, "collisions_min": 0, "collisions_max": 306, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.399587580491521, "policy_loss": 0.007768398622082996, "vf_loss": 2.2757535934191324, "vf_explained_var": 0.4467590729052993, "kl": 0.009406829244475947, "entropy": 1.1894572989747527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 164430.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 237500, "num_env_steps_trained": 237500, "num_agent_steps_sampled": 712500, "num_agent_steps_trained": 712500}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -328.42725450842875, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 104.48, "collisions_min": 0, "collisions_max": 306, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600212401256545, "mean_inference_ms": 8.73206837580016, "mean_action_processing_ms": 0.4215961392136039, "mean_env_wait_ms": 0.9842891890566355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7959389686584473, "StateBufferConnector_ms": 0.0059735774993896484, "ViewRequirementAgentConnector_ms": 0.26702070236206055}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -328.42725450842875, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-279.5098266447417, -246.10956020537182, -380.7640514056677, -408.28516694261225, -371.3582681059843, -343.1340718700303, -301.7070666892472, -355.69623454935834, -254.61068975474075, -309.9364755582496, -399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600212401256545, "mean_inference_ms": 8.73206837580016, "mean_action_processing_ms": 0.4215961392136039, "mean_env_wait_ms": 0.9842891890566355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7959389686584473, "StateBufferConnector_ms": 0.0059735774993896484, "ViewRequirementAgentConnector_ms": 0.26702070236206055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712500, "num_agent_steps_trained": 712500, "num_env_steps_sampled": 237500, "num_env_steps_trained": 237500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.499751936418811, "num_agent_steps_trained_throughput_per_sec": 5.499751936418811, "timesteps_total": 712500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 712500, "timers": {"training_iteration_time_ms": 1381469.804, "sample_time_ms": 29441.475, "load_time_ms": 0.858, "load_throughput": 2912144.861, "learn_time_ms": 1352025.783, "learn_throughput": 1.849, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 237500, "num_env_steps_trained": 237500, "num_agent_steps_sampled": 712500, "num_agent_steps_trained": 712500}, "done": false, "episodes_total": 950, "training_iteration": 95, "trial_id": "0b7ab_00052", "date": "2024-03-16_02-00-11", "timestamp": 1710550811, "time_this_iter_s": 1363.6998903751373, "time_total_s": 130705.9408326149, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 130705.9408326149, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 43.811627906976746, "ram_util_percent": 16.954935400516796}, "checkpoint_dir_name": "checkpoint_000094"}
{"custom_metrics": {"collisions_mean": 112.32, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.7042760090096907, "policy_loss": -0.0038167921782085866, "vf_loss": 2.7953030791433378, "vf_explained_var": 0.4766300586790874, "kl": 0.010096997768523394, "entropy": 1.3405696418377218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 166170.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -332.7381266483229, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 112.32, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6002135340873562, "mean_inference_ms": 8.731972877161084, "mean_action_processing_ms": 0.42160500388854344, "mean_env_wait_ms": 0.9842456380350731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7944107055664062, "StateBufferConnector_ms": 0.005940675735473633, "ViewRequirementAgentConnector_ms": 0.26541686058044434}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -332.7381266483229, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-399.4557381254807, -344.5109917687065, -397.9922254984306, -429.2469562328379, -397.74040622629417, -335.63694818084616, -308.460434819361, -381.8736978893141, -217.47192005867583, -296.7262714637898, -339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6002135340873562, "mean_inference_ms": 8.731972877161084, "mean_action_processing_ms": 0.42160500388854344, "mean_env_wait_ms": 0.9842456380350731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7944107055664062, "StateBufferConnector_ms": 0.005940675735473633, "ViewRequirementAgentConnector_ms": 0.26541686058044434}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.4958618304686855, "num_agent_steps_trained_throughput_per_sec": 5.4958618304686855, "timesteps_total": 720000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 1380108.826, "sample_time_ms": 29378.028, "load_time_ms": 0.859, "load_throughput": 2908994.063, "learn_time_ms": 1350728.23, "learn_throughput": 1.851, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 960, "training_iteration": 96, "trial_id": "0b7ab_00052", "date": "2024-03-16_02-22-56", "timestamp": 1710552176, "time_this_iter_s": 1364.6652247905731, "time_total_s": 132070.60605740547, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 132070.60605740547, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 43.82487073422958, "ram_util_percent": 16.909048603929683}, "checkpoint_dir_name": "checkpoint_000095"}
{"custom_metrics": {"collisions_mean": 110.3, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.3277204498648643, "policy_loss": -0.0026379122682472413, "vf_loss": 2.172890308054014, "vf_explained_var": 0.3890596686766065, "kl": 0.010412685356980025, "entropy": 1.5348227281131428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 167910.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 242500, "num_env_steps_trained": 242500, "num_agent_steps_sampled": 727500, "num_agent_steps_trained": 727500}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -330.8461946666959, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 110.3, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6001666714472427, "mean_inference_ms": 8.731593179524346, "mean_action_processing_ms": 0.42159312307911906, "mean_env_wait_ms": 0.9841817897834082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7938525676727295, "StateBufferConnector_ms": 0.0059168338775634766, "ViewRequirementAgentConnector_ms": 0.2648334503173828}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -330.8461946666959, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-339.6517770072382, -337.5354528049851, -387.3110352048655, -392.1418007927493, -196.50992309181368, -461.50484820182055, -427.3766438258028, -391.2123311818204, -310.6571946272004, -348.1732557608865, -257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6001666714472427, "mean_inference_ms": 8.731593179524346, "mean_action_processing_ms": 0.42159312307911906, "mean_env_wait_ms": 0.9841817897834082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7938525676727295, "StateBufferConnector_ms": 0.0059168338775634766, "ViewRequirementAgentConnector_ms": 0.2648334503173828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 727500, "num_agent_steps_trained": 727500, "num_env_steps_sampled": 242500, "num_env_steps_trained": 242500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.51380246121408, "num_agent_steps_trained_throughput_per_sec": 5.51380246121408, "timesteps_total": 727500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 727500, "timers": {"training_iteration_time_ms": 1376926.528, "sample_time_ms": 29287.992, "load_time_ms": 0.893, "load_throughput": 2799636.888, "learn_time_ms": 1347635.971, "learn_throughput": 1.855, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 242500, "num_env_steps_trained": 242500, "num_agent_steps_sampled": 727500, "num_agent_steps_trained": 727500}, "done": false, "episodes_total": 970, "training_iteration": 97, "trial_id": "0b7ab_00052", "date": "2024-03-16_02-45-37", "timestamp": 1710553537, "time_this_iter_s": 1360.224829673767, "time_total_s": 133430.83088707924, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 133430.83088707924, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 43.75422061108234, "ram_util_percent": 16.83210771620922}, "checkpoint_dir_name": "checkpoint_000096"}
{"custom_metrics": {"collisions_mean": 109.12, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.3867826189594237, "policy_loss": 0.00551149452522654, "vf_loss": 2.2573762973385123, "vf_explained_var": 0.4435867709332499, "kl": 0.010013573144625495, "entropy": 1.7284123964489961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 169650.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 245000, "num_env_steps_trained": 245000, "num_agent_steps_sampled": 735000, "num_agent_steps_trained": 735000}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -330.1390602611562, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 109.12, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600093200554645, "mean_inference_ms": 8.731079220998726, "mean_action_processing_ms": 0.42157501732329694, "mean_env_wait_ms": 0.9841173506735543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7930290699005127, "StateBufferConnector_ms": 0.005837678909301758, "ViewRequirementAgentConnector_ms": 0.26459312438964844}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -330.1390602611562, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-257.11366403135264, -200.41613023587965, -456.6542867467695, -320.06096616798374, -221.5494319621415, -399.27214246209996, -348.9254226192548, -336.5516354948465, -301.0115737134474, -218.4153053033934, -224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.600093200554645, "mean_inference_ms": 8.731079220998726, "mean_action_processing_ms": 0.42157501732329694, "mean_env_wait_ms": 0.9841173506735543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7930290699005127, "StateBufferConnector_ms": 0.005837678909301758, "ViewRequirementAgentConnector_ms": 0.26459312438964844}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 735000, "num_agent_steps_trained": 735000, "num_env_steps_sampled": 245000, "num_env_steps_trained": 245000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.520385131729088, "num_agent_steps_trained_throughput_per_sec": 5.520385131729088, "timesteps_total": 735000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 735000, "timers": {"training_iteration_time_ms": 1371813.984, "sample_time_ms": 29247.797, "load_time_ms": 0.836, "load_throughput": 2990122.049, "learn_time_ms": 1342563.723, "learn_throughput": 1.862, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 245000, "num_env_steps_trained": 245000, "num_agent_steps_sampled": 735000, "num_agent_steps_trained": 735000}, "done": false, "episodes_total": 980, "training_iteration": 98, "trial_id": "0b7ab_00052", "date": "2024-03-16_03-08-17", "timestamp": 1710554897, "time_this_iter_s": 1358.6028547286987, "time_total_s": 134789.43374180794, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 134789.43374180794, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 43.91073651452282, "ram_util_percent": 16.73853734439834}, "checkpoint_dir_name": "checkpoint_000097"}
{"custom_metrics": {"collisions_mean": 115.54, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.446151934466967, "policy_loss": 0.0017821017634016515, "vf_loss": 2.3629428959440912, "vf_explained_var": 0.4957280982842391, "kl": 0.009003655393587865, "entropy": 1.3261926866762725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 171390.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 247500, "num_env_steps_trained": 247500, "num_agent_steps_sampled": 742500, "num_agent_steps_trained": 742500}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -333.05876252502424, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 115.54, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999505500498485, "mean_inference_ms": 8.730197520101665, "mean_action_processing_ms": 0.42154146026151734, "mean_env_wait_ms": 0.9840354622403251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7855894565582275, "StateBufferConnector_ms": 0.005734920501708984, "ViewRequirementAgentConnector_ms": 0.2616851329803467}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -717.4104327563886, "episode_reward_mean": -333.05876252502424, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-224.9889905845292, -366.3470507193021, -239.74374235233893, -717.4104327563886, -373.1974894695126, -308.4248096908125, -239.06454643018438, -252.70071825015512, -234.98353664034167, -278.07888974202217, -431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999505500498485, "mean_inference_ms": 8.730197520101665, "mean_action_processing_ms": 0.42154146026151734, "mean_env_wait_ms": 0.9840354622403251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7855894565582275, "StateBufferConnector_ms": 0.005734920501708984, "ViewRequirementAgentConnector_ms": 0.2616851329803467}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 742500, "num_agent_steps_trained": 742500, "num_env_steps_sampled": 247500, "num_env_steps_trained": 247500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.528351765224273, "num_agent_steps_trained_throughput_per_sec": 5.528351765224273, "timesteps_total": 742500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 742500, "timers": {"training_iteration_time_ms": 1367927.735, "sample_time_ms": 29137.017, "load_time_ms": 0.924, "load_throughput": 2704397.39, "learn_time_ms": 1338788.153, "learn_throughput": 1.867, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 247500, "num_env_steps_trained": 247500, "num_agent_steps_sampled": 742500, "num_agent_steps_trained": 742500}, "done": false, "episodes_total": 990, "training_iteration": 99, "trial_id": "0b7ab_00052", "date": "2024-03-16_03-30-54", "timestamp": 1710556254, "time_this_iter_s": 1356.6450951099396, "time_total_s": 136146.07883691788, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 136146.07883691788, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 43.931827622014545, "ram_util_percent": 16.748234683281414}, "checkpoint_dir_name": "checkpoint_000098"}
{"custom_metrics": {"collisions_mean": 118.18, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.6242759442609873, "policy_loss": 0.005909655051006154, "vf_loss": 2.646107581206437, "vf_explained_var": 0.48655977204613304, "kl": 0.010980914462829108, "entropy": 1.8139830798847365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 173130.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -335.3220567241164, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 118.18, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.59979949789842, "mean_inference_ms": 8.729282228263132, "mean_action_processing_ms": 0.4215064566906365, "mean_env_wait_ms": 0.9839495992752864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7856991291046143, "StateBufferConnector_ms": 0.005743741989135742, "ViewRequirementAgentConnector_ms": 0.2626008987426758}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -335.3220567241164, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-431.81521538643153, -267.13254602301726, -333.6060551830573, -352.4571981003201, -364.50215851612984, -393.73576698302315, -290.30444765589397, -456.6054985652361, -218.39688576963175, -284.00295060953556, -257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.59979949789842, "mean_inference_ms": 8.729282228263132, "mean_action_processing_ms": 0.4215064566906365, "mean_env_wait_ms": 0.9839495992752864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7856991291046143, "StateBufferConnector_ms": 0.005743741989135742, "ViewRequirementAgentConnector_ms": 0.2626008987426758}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000, "num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.536531850770509, "num_agent_steps_trained_throughput_per_sec": 5.536531850770509, "timesteps_total": 750000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 750000, "timers": {"training_iteration_time_ms": 1364153.276, "sample_time_ms": 29123.45, "load_time_ms": 0.897, "load_throughput": 2785728.328, "learn_time_ms": 1335027.272, "learn_throughput": 1.873, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000}, "done": false, "episodes_total": 1000, "training_iteration": 100, "trial_id": "0b7ab_00052", "date": "2024-03-16_03-53-30", "timestamp": 1710557610, "time_this_iter_s": 1354.640635251999, "time_total_s": 137500.71947216988, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 137500.71947216988, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 43.967325702393346, "ram_util_percent": 16.95744016649324}, "checkpoint_dir_name": "checkpoint_000099"}
{"custom_metrics": {"collisions_mean": 112.7, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9999746414436691, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.0052859236435407, "policy_loss": -0.006745178954697203, "vf_loss": 1.6482469135060394, "vf_explained_var": 0.47119286550187517, "kl": 0.010750074966140924, "entropy": 1.0183257845302658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 174870.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 252500, "num_env_steps_trained": 252500, "num_agent_steps_sampled": 757500, "num_agent_steps_trained": 757500}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -325.45855405532706, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 112.7, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5995953735131911, "mean_inference_ms": 8.728231668377244, "mean_action_processing_ms": 0.4214556478230383, "mean_env_wait_ms": 0.9838378064021053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7829198837280273, "StateBufferConnector_ms": 0.005689859390258789, "ViewRequirementAgentConnector_ms": 0.26025819778442383}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -325.45855405532706, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-257.27331435621505, -276.5267512683405, -359.0792304169877, -339.1215984791263, -404.0725577116111, -394.93068493738593, -251.4683860310702, -355.4851379150998, -451.0880223511008, -385.75559468596265, -276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5995953735131911, "mean_inference_ms": 8.728231668377244, "mean_action_processing_ms": 0.4214556478230383, "mean_env_wait_ms": 0.9838378064021053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7829198837280273, "StateBufferConnector_ms": 0.005689859390258789, "ViewRequirementAgentConnector_ms": 0.26025819778442383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 757500, "num_agent_steps_trained": 757500, "num_env_steps_sampled": 252500, "num_env_steps_trained": 252500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5531631374646615, "num_agent_steps_trained_throughput_per_sec": 5.5531631374646615, "timesteps_total": 757500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 757500, "timers": {"training_iteration_time_ms": 1360064.893, "sample_time_ms": 29066.857, "load_time_ms": 0.896, "load_throughput": 2791735.889, "learn_time_ms": 1330995.5, "learn_throughput": 1.878, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 252500, "num_env_steps_trained": 252500, "num_agent_steps_sampled": 757500, "num_agent_steps_trained": 757500}, "done": false, "episodes_total": 1010, "training_iteration": 101, "trial_id": "0b7ab_00052", "date": "2024-03-16_04-16-01", "timestamp": 1710558961, "time_this_iter_s": 1350.5835916996002, "time_total_s": 138851.30306386948, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 138851.30306386948, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 43.947080291970806, "ram_util_percent": 16.955526590198126}, "checkpoint_dir_name": "checkpoint_000100"}
{"custom_metrics": {"collisions_mean": 111.08, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.3783391009992116, "policy_loss": -0.0007525995475422035, "vf_loss": 2.250767709597431, "vf_explained_var": 0.47874752238564106, "kl": 0.011825558651934884, "entropy": 1.4889125232970148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 176610.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 765000, "num_agent_steps_trained": 765000}, "sampler_results": {"episode_reward_max": -176.18645718582113, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -322.4746185007509, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 111.08, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5993934180360287, "mean_inference_ms": 8.72722991274211, "mean_action_processing_ms": 0.4214098908091551, "mean_env_wait_ms": 0.9837297880834724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7834064960479736, "StateBufferConnector_ms": 0.005707740783691406, "ViewRequirementAgentConnector_ms": 0.2614297866821289}}, "episode_reward_max": -176.18645718582113, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -322.4746185007509, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-276.838287624299, -443.72422888844363, -242.85349808966316, -211.58478502933733, -402.49641593238744, -313.132135263165, -329.0828093120362, -273.8625429318888, -424.041940814339, -377.08495957052287, -222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5993934180360287, "mean_inference_ms": 8.72722991274211, "mean_action_processing_ms": 0.4214098908091551, "mean_env_wait_ms": 0.9837297880834724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7834064960479736, "StateBufferConnector_ms": 0.005707740783691406, "ViewRequirementAgentConnector_ms": 0.2614297866821289}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 765000, "num_agent_steps_trained": 765000, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.561103821611775, "num_agent_steps_trained_throughput_per_sec": 5.561103821611775, "timesteps_total": 765000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 765000, "timers": {"training_iteration_time_ms": 1358381.292, "sample_time_ms": 29078.703, "load_time_ms": 0.892, "load_throughput": 2803529.223, "learn_time_ms": 1329300.057, "learn_throughput": 1.881, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 765000, "num_agent_steps_trained": 765000}, "done": false, "episodes_total": 1020, "training_iteration": 102, "trial_id": "0b7ab_00052", "date": "2024-03-16_04-38-31", "timestamp": 1710560311, "time_this_iter_s": 1348.6551439762115, "time_total_s": 140199.9582078457, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 140199.9582078457, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 43.97078768909755, "ram_util_percent": 16.972509128847157}, "checkpoint_dir_name": "checkpoint_000101"}
{"custom_metrics": {"collisions_mean": 108.32, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.247208504782904, "policy_loss": -0.012620323923437846, "vf_loss": 2.058880194156677, "vf_explained_var": 0.4544366798866754, "kl": 0.009148797638642939, "entropy": 1.4068024561716372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 178350.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 257500, "num_env_steps_trained": 257500, "num_agent_steps_sampled": 772500, "num_agent_steps_trained": 772500}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -318.40809776684057, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 108.32, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5991934361171385, "mean_inference_ms": 8.726202263339488, "mean_action_processing_ms": 0.4213678319435326, "mean_env_wait_ms": 0.9836301617153096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7829923629760742, "StateBufferConnector_ms": 0.0056955814361572266, "ViewRequirementAgentConnector_ms": 0.26097607612609863}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -588.0981144777986, "episode_reward_mean": -318.40809776684057, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-222.78845694925036, -231.68290570763256, -176.18645718582113, -382.1401196550713, -381.68087568539454, -244.20647352935592, -369.7445660909024, -395.0499926343487, -390.1915953930615, -228.67159776757845, -237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5991934361171385, "mean_inference_ms": 8.726202263339488, "mean_action_processing_ms": 0.4213678319435326, "mean_env_wait_ms": 0.9836301617153096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7829923629760742, "StateBufferConnector_ms": 0.0056955814361572266, "ViewRequirementAgentConnector_ms": 0.26097607612609863}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772500, "num_agent_steps_trained": 772500, "num_env_steps_sampled": 257500, "num_env_steps_trained": 257500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.557087336391578, "num_agent_steps_trained_throughput_per_sec": 5.557087336391578, "timesteps_total": 772500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 772500, "timers": {"training_iteration_time_ms": 1356898.936, "sample_time_ms": 29070.773, "load_time_ms": 0.838, "load_throughput": 2983231.386, "learn_time_ms": 1327825.687, "learn_throughput": 1.883, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 257500, "num_env_steps_trained": 257500, "num_agent_steps_sampled": 772500, "num_agent_steps_trained": 772500}, "done": false, "episodes_total": 1030, "training_iteration": 103, "trial_id": "0b7ab_00052", "date": "2024-03-16_05-01-01", "timestamp": 1710561661, "time_this_iter_s": 1349.6300258636475, "time_total_s": 141549.58823370934, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 141549.58823370934, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 43.97960354720918, "ram_util_percent": 16.919718309859157}, "checkpoint_dir_name": "checkpoint_000102"}
{"custom_metrics": {"collisions_mean": 109.64, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.4855914263688992, "policy_loss": 0.004616048745008121, "vf_loss": 2.4261778166753123, "vf_explained_var": 0.3915976607251441, "kl": 0.0072225193463797185, "entropy": 1.746087767882808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180090.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -324.9121309489959, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 109.64, "collisions_min": 0, "collisions_max": 324, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598989063048822, "mean_inference_ms": 8.725181504132518, "mean_action_processing_ms": 0.4213267179723354, "mean_env_wait_ms": 0.9835306565777162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7840580940246582, "StateBufferConnector_ms": 0.005692958831787109, "ViewRequirementAgentConnector_ms": 0.26105165481567383}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -324.9121309489959, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-237.3510859819273, -337.9759127275359, -271.48639793913145, -193.94999594540351, -226.4965554342051, -239.0136484233401, -241.5169611616934, -484.13459972798717, -426.3963766005361, -352.78724203976054, -249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598989063048822, "mean_inference_ms": 8.725181504132518, "mean_action_processing_ms": 0.4213267179723354, "mean_env_wait_ms": 0.9835306565777162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7840580940246582, "StateBufferConnector_ms": 0.005692958831787109, "ViewRequirementAgentConnector_ms": 0.26105165481567383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5338570149461646, "num_agent_steps_trained_throughput_per_sec": 5.5338570149461646, "timesteps_total": 780000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 1356262.212, "sample_time_ms": 29061.433, "load_time_ms": 0.843, "load_throughput": 2966017.028, "learn_time_ms": 1327198.308, "learn_throughput": 1.884, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 1040, "training_iteration": 104, "trial_id": "0b7ab_00052", "date": "2024-03-16_05-23-38", "timestamp": 1710563018, "time_this_iter_s": 1355.295420408249, "time_total_s": 142904.88365411758, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 142904.88365411758, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 43.938909090909085, "ram_util_percent": 16.87179220779221}, "checkpoint_dir_name": "checkpoint_000103"}
{"custom_metrics": {"collisions_mean": 110.24, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.4523156150774066, "policy_loss": -0.0007978689816684044, "vf_loss": 2.375775376527474, "vf_explained_var": 0.41605339978618183, "kl": 0.009941132963578543, "entropy": 1.4239039105090217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 181830.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 262500, "num_env_steps_trained": 262500, "num_agent_steps_sampled": 787500, "num_agent_steps_trained": 787500}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -326.5779884393273, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 110.24, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5988186471885968, "mean_inference_ms": 8.72436585258676, "mean_action_processing_ms": 0.4212931571324586, "mean_env_wait_ms": 0.9834477593663565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7856457233428955, "StateBufferConnector_ms": 0.005703449249267578, "ViewRequirementAgentConnector_ms": 0.26224637031555176}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -326.5779884393273, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-249.46451446736262, -464.7220151564906, -347.0792675524352, -376.71119729369883, -460.85764449269146, -359.6860803903724, -219.0470271097712, -400.8621957605114, -425.7423926189004, -378.02629087318434, -211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5988186471885968, "mean_inference_ms": 8.72436585258676, "mean_action_processing_ms": 0.4212931571324586, "mean_env_wait_ms": 0.9834477593663565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7856457233428955, "StateBufferConnector_ms": 0.005703449249267578, "ViewRequirementAgentConnector_ms": 0.26224637031555176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 787500, "num_agent_steps_trained": 787500, "num_env_steps_sampled": 262500, "num_env_steps_trained": 262500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.486637705478459, "num_agent_steps_trained_throughput_per_sec": 5.486637705478459, "timesteps_total": 787500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 787500, "timers": {"training_iteration_time_ms": 1356588.165, "sample_time_ms": 29121.515, "load_time_ms": 0.844, "load_throughput": 2962748.644, "learn_time_ms": 1327464.154, "learn_throughput": 1.883, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 262500, "num_env_steps_trained": 262500, "num_agent_steps_sampled": 787500, "num_agent_steps_trained": 787500}, "done": false, "episodes_total": 1050, "training_iteration": 105, "trial_id": "0b7ab_00052", "date": "2024-03-16_05-46-26", "timestamp": 1710564386, "time_this_iter_s": 1366.959589958191, "time_total_s": 144271.84324407578, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 144271.84324407578, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 43.968041237113404, "ram_util_percent": 16.982164948453608}, "checkpoint_dir_name": "checkpoint_000104"}
{"custom_metrics": {"collisions_mean": 101.78, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.2737730174461894, "policy_loss": 0.0017895715675134768, "vf_loss": 2.0786728011208706, "vf_explained_var": 0.4967157834562762, "kl": 0.009279731631358609, "entropy": 1.6486421493973968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 183570.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 265000, "num_env_steps_trained": 265000, "num_agent_steps_sampled": 795000, "num_agent_steps_trained": 795000}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -319.7754200668818, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 101.78, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598700793518277, "mean_inference_ms": 8.723834551455647, "mean_action_processing_ms": 0.4212826650295144, "mean_env_wait_ms": 0.9833863440330411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7868788242340088, "StateBufferConnector_ms": 0.0057141780853271484, "ViewRequirementAgentConnector_ms": 0.2627081871032715}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -319.7754200668818, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-211.6477931625031, -383.9083376700689, -373.5020383797586, -502.88217876272813, -430.37346000225284, -371.8218388263106, -345.4584393490033, -180.35768880957534, -316.3924825479637, -203.5781345908672, -333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598700793518277, "mean_inference_ms": 8.723834551455647, "mean_action_processing_ms": 0.4212826650295144, "mean_env_wait_ms": 0.9833863440330411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7868788242340088, "StateBufferConnector_ms": 0.0057141780853271484, "ViewRequirementAgentConnector_ms": 0.2627081871032715}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 795000, "num_agent_steps_trained": 795000, "num_env_steps_sampled": 265000, "num_env_steps_trained": 265000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.4316437254377155, "num_agent_steps_trained_throughput_per_sec": 5.4316437254377155, "timesteps_total": 795000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 795000, "timers": {"training_iteration_time_ms": 1358201.599, "sample_time_ms": 29212.159, "load_time_ms": 0.853, "load_throughput": 2932505.523, "learn_time_ms": 1328986.947, "learn_throughput": 1.881, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 265000, "num_env_steps_trained": 265000, "num_agent_steps_sampled": 795000, "num_agent_steps_trained": 795000}, "done": false, "episodes_total": 1060, "training_iteration": 106, "trial_id": "0b7ab_00052", "date": "2024-03-16_06-09-27", "timestamp": 1710565767, "time_this_iter_s": 1380.7998216152191, "time_total_s": 145652.643065691, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 145652.643065691, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 43.94578866768759, "ram_util_percent": 17.08075548749362}, "checkpoint_dir_name": "checkpoint_000105"}
{"custom_metrics": {"collisions_mean": 97.56, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9998854615222449, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.2350774294933593, "policy_loss": -0.0018778516600529353, "vf_loss": 2.0200427834501213, "vf_explained_var": 0.48164354329821707, "kl": 0.009856284148872355, "entropy": 1.0946321442474387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 185310.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 267500, "num_env_steps_trained": 267500, "num_agent_steps_sampled": 802500, "num_agent_steps_trained": 802500}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -311.2748134293374, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 97.56, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5986401676337405, "mean_inference_ms": 8.723612655459467, "mean_action_processing_ms": 0.4212997159046521, "mean_env_wait_ms": 0.9833462572001598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7896158695220947, "StateBufferConnector_ms": 0.005766153335571289, "ViewRequirementAgentConnector_ms": 0.2660534381866455}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -311.2748134293374, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333.64678199323146, -322.70838545320174, -331.7960966615418, -467.55799453326154, -269.0720204875126, -317.15311501335793, -351.4152138160852, -385.0391952010647, -354.1817977963405, -388.79022098961934, -237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5986401676337405, "mean_inference_ms": 8.723612655459467, "mean_action_processing_ms": 0.4212997159046521, "mean_env_wait_ms": 0.9833462572001598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7896158695220947, "StateBufferConnector_ms": 0.005766153335571289, "ViewRequirementAgentConnector_ms": 0.2660534381866455}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 802500, "num_agent_steps_trained": 802500, "num_env_steps_sampled": 267500, "num_env_steps_trained": 267500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.426225680500037, "num_agent_steps_trained_throughput_per_sec": 5.426225680500037, "timesteps_total": 802500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 802500, "timers": {"training_iteration_time_ms": 1360396.936, "sample_time_ms": 29315.02, "load_time_ms": 0.855, "load_throughput": 2923919.469, "learn_time_ms": 1331079.382, "learn_throughput": 1.878, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 267500, "num_env_steps_trained": 267500, "num_agent_steps_sampled": 802500, "num_agent_steps_trained": 802500}, "done": false, "episodes_total": 1070, "training_iteration": 107, "trial_id": "0b7ab_00052", "date": "2024-03-16_06-32-31", "timestamp": 1710567151, "time_this_iter_s": 1382.1782410144806, "time_total_s": 147034.82130670547, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 147034.82130670547, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 43.91488277268094, "ram_util_percent": 17.041284403669724}, "checkpoint_dir_name": "checkpoint_000106"}
{"custom_metrics": {"collisions_mean": 95.92, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.368546430003326, "policy_loss": -0.0030275479210647703, "vf_loss": 2.242346131133622, "vf_explained_var": 0.44439612856541555, "kl": 0.009452769532130683, "entropy": 1.4056349295897987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 187050.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -303.2664964113342, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 95.92, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5985990784232893, "mean_inference_ms": 8.723449394278225, "mean_action_processing_ms": 0.42132095591409857, "mean_env_wait_ms": 0.983308060426599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7918961048126221, "StateBufferConnector_ms": 0.0058002471923828125, "ViewRequirementAgentConnector_ms": 0.2688899040222168}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -303.2664964113342, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-237.28990727786368, -431.49457579202965, -202.53981417756114, -308.6338531711622, -421.9449824406966, -401.94118117802316, -381.99017285116463, -376.7336832216781, -364.4443034357491, -224.92831157804378, -253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5985990784232893, "mean_inference_ms": 8.723449394278225, "mean_action_processing_ms": 0.42132095591409857, "mean_env_wait_ms": 0.983308060426599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7918961048126221, "StateBufferConnector_ms": 0.0058002471923828125, "ViewRequirementAgentConnector_ms": 0.2688899040222168}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.370033156749857, "num_agent_steps_trained_throughput_per_sec": 5.370033156749857, "timesteps_total": 810000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 1364200.792, "sample_time_ms": 29335.813, "load_time_ms": 0.863, "load_throughput": 2897499.24, "learn_time_ms": 1334862.345, "learn_throughput": 1.873, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 1080, "training_iteration": 108, "trial_id": "0b7ab_00052", "date": "2024-03-16_06-55-48", "timestamp": 1710568548, "time_this_iter_s": 1396.641560792923, "time_total_s": 148431.4628674984, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 148431.4628674984, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 43.91347804139323, "ram_util_percent": 16.97107521453811}, "checkpoint_dir_name": "checkpoint_000107"}
{"custom_metrics": {"collisions_mean": 93.64, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.4354940115502264, "policy_loss": 0.010160196702338585, "vf_loss": 2.328405681513678, "vf_explained_var": 0.4233424744386783, "kl": 0.010921607023075265, "entropy": 1.4560011330828735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 188790.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 272500, "num_env_steps_trained": 272500, "num_agent_steps_sampled": 817500, "num_agent_steps_trained": 817500}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -302.7711149690884, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 93.64, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5985802672178642, "mean_inference_ms": 8.723409498418551, "mean_action_processing_ms": 0.4213463277696323, "mean_env_wait_ms": 0.98327312378797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7934830188751221, "StateBufferConnector_ms": 0.00581812858581543, "ViewRequirementAgentConnector_ms": 0.26882123947143555}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -302.7711149690884, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-253.2204707584921, -218.80300298434503, -322.60783087201236, -447.2272158211694, -319.29865215175386, -313.9535850927048, -243.93097086622424, -588.0981144777986, -506.3697443752273, -247.76003914507427, -325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5985802672178642, "mean_inference_ms": 8.723409498418551, "mean_action_processing_ms": 0.4213463277696323, "mean_env_wait_ms": 0.98327312378797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7934830188751221, "StateBufferConnector_ms": 0.00581812858581543, "ViewRequirementAgentConnector_ms": 0.26882123947143555}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 817500, "num_agent_steps_trained": 817500, "num_env_steps_sampled": 272500, "num_env_steps_trained": 272500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.3651013006029595, "num_agent_steps_trained_throughput_per_sec": 5.3651013006029595, "timesteps_total": 817500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 817500, "timers": {"training_iteration_time_ms": 1368328.815, "sample_time_ms": 29374.107, "load_time_ms": 0.811, "load_throughput": 3084137.769, "learn_time_ms": 1338952.125, "learn_throughput": 1.867, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 272500, "num_env_steps_trained": 272500, "num_agent_steps_sampled": 817500, "num_agent_steps_trained": 817500}, "done": false, "episodes_total": 1090, "training_iteration": 109, "trial_id": "0b7ab_00052", "date": "2024-03-16_07-19-09", "timestamp": 1710569949, "time_this_iter_s": 1397.9254038333893, "time_total_s": 149829.3882713318, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 149829.3882713318, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 43.89632426988923, "ram_util_percent": 16.961883182275933}, "checkpoint_dir_name": "checkpoint_000108"}
{"custom_metrics": {"collisions_mean": 96.6, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.5781208074421504, "policy_loss": -0.006665605300737695, "vf_loss": 2.5888272741402703, "vf_explained_var": 0.4361540045203834, "kl": 0.012178189423013665, "entropy": 1.7589636102091286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 190530.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 275000, "num_env_steps_trained": 275000, "num_agent_steps_sampled": 825000, "num_agent_steps_trained": 825000}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -303.3546772526107, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 96.6, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5986028813301352, "mean_inference_ms": 8.723518653253093, "mean_action_processing_ms": 0.42138075549471177, "mean_env_wait_ms": 0.983245596841759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7941527366638184, "StateBufferConnector_ms": 0.005822658538818359, "ViewRequirementAgentConnector_ms": 0.26853466033935547}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -303.3546772526107, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-325.3151469124415, -217.443455001078, -264.10699733765085, -239.84940725658197, -217.80590933903085, -237.22486790041404, -199.43604463828254, -187.0169720408724, -252.53900388314904, -265.4706516038451, -352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5986028813301352, "mean_inference_ms": 8.723518653253093, "mean_action_processing_ms": 0.42138075549471177, "mean_env_wait_ms": 0.983245596841759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7941527366638184, "StateBufferConnector_ms": 0.005822658538818359, "ViewRequirementAgentConnector_ms": 0.26853466033935547}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 825000, "num_agent_steps_trained": 825000, "num_env_steps_sampled": 275000, "num_env_steps_trained": 275000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.3584197770618545, "num_agent_steps_trained_throughput_per_sec": 5.3584197770618545, "timesteps_total": 825000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 825000, "timers": {"training_iteration_time_ms": 1372831.588, "sample_time_ms": 29431.845, "load_time_ms": 0.816, "load_throughput": 3062698.25, "learn_time_ms": 1343397.132, "learn_throughput": 1.861, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 275000, "num_env_steps_trained": 275000, "num_agent_steps_sampled": 825000, "num_agent_steps_trained": 825000}, "done": false, "episodes_total": 1100, "training_iteration": 110, "trial_id": "0b7ab_00052", "date": "2024-03-16_07-42-29", "timestamp": 1710571349, "time_this_iter_s": 1399.6686127185822, "time_total_s": 151229.05688405037, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 151229.05688405037, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 43.89068479355488, "ram_util_percent": 16.959969788519636}, "checkpoint_dir_name": "checkpoint_000109"}
{"custom_metrics": {"collisions_mean": 100.4, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.2531133077371646, "policy_loss": 0.00887214258224864, "vf_loss": 2.0323799823892528, "vf_explained_var": 0.47192269457482744, "kl": 0.009651105404925095, "entropy": 1.264893995107676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 192270.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 277500, "num_env_steps_trained": 277500, "num_agent_steps_sampled": 832500, "num_agent_steps_trained": 832500}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -307.1072011711262, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 100.4, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598661564399178, "mean_inference_ms": 8.72377985226317, "mean_action_processing_ms": 0.42142249702823903, "mean_env_wait_ms": 0.9832296585153354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7961215972900391, "StateBufferConnector_ms": 0.005844831466674805, "ViewRequirementAgentConnector_ms": 0.269986629486084}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -307.1072011711262, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-352.25030817445554, -277.66752369702226, -241.06001596151336, -383.28443797267335, -343.7861870531011, -350.10592685386763, -313.324243862585, -425.96693023703074, -209.0221300878716, -279.9400187951687, -225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.598661564399178, "mean_inference_ms": 8.72377985226317, "mean_action_processing_ms": 0.42142249702823903, "mean_env_wait_ms": 0.9832296585153354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7961215972900391, "StateBufferConnector_ms": 0.005844831466674805, "ViewRequirementAgentConnector_ms": 0.269986629486084}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832500, "num_agent_steps_trained": 832500, "num_env_steps_sampled": 277500, "num_env_steps_trained": 277500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.389879330621593, "num_agent_steps_trained_throughput_per_sec": 5.389879330621593, "timesteps_total": 832500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 832500, "timers": {"training_iteration_time_ms": 1376923.11, "sample_time_ms": 29489.983, "load_time_ms": 0.859, "load_throughput": 2909155.477, "learn_time_ms": 1347430.42, "learn_throughput": 1.855, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 277500, "num_env_steps_trained": 277500, "num_agent_steps_sampled": 832500, "num_agent_steps_trained": 832500}, "done": false, "episodes_total": 1110, "training_iteration": 111, "trial_id": "0b7ab_00052", "date": "2024-03-16_08-05-41", "timestamp": 1710572741, "time_this_iter_s": 1391.4991042613983, "time_total_s": 152620.55598831177, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 152620.55598831177, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 43.90623100303951, "ram_util_percent": 16.97228976697062}, "checkpoint_dir_name": "checkpoint_000110"}
{"custom_metrics": {"collisions_mean": 101.7, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0019524851312189488, "total_loss": 1.529134268602945, "policy_loss": -0.0151438705612445, "vf_loss": 2.5094827383157168, "vf_explained_var": 0.5326948998645804, "kl": 0.01976896518977789, "entropy": 1.6471260928473939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 194010.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -306.7403389281755, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 101.7, "collisions_min": 0, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5987540651470062, "mean_inference_ms": 8.724155203028399, "mean_action_processing_ms": 0.4214721696400855, "mean_env_wait_ms": 0.9832221696985193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7989087104797363, "StateBufferConnector_ms": 0.005881786346435547, "ViewRequirementAgentConnector_ms": 0.27207422256469727}}, "episode_reward_max": -101.76566536711678, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -306.7403389281755, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-225.36287735519838, -285.4066283804764, -391.6552746916864, -232.56159320239018, -357.42388153065076, -255.6645582120138, -346.4947937852377, -101.76566536711678, -394.26310837737606, -297.4511491628988, -290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5987540651470062, "mean_inference_ms": 8.724155203028399, "mean_action_processing_ms": 0.4214721696400855, "mean_env_wait_ms": 0.9832221696985193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.7989087104797363, "StateBufferConnector_ms": 0.005881786346435547, "ViewRequirementAgentConnector_ms": 0.27207422256469727}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.39639964437005, "num_agent_steps_trained_throughput_per_sec": 5.39639964437005, "timesteps_total": 840000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 1381039.35, "sample_time_ms": 29539.594, "load_time_ms": 0.89, "load_throughput": 2809915.052, "learn_time_ms": 1351496.97, "learn_throughput": 1.85, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 1120, "training_iteration": 112, "trial_id": "0b7ab_00052", "date": "2024-03-16_08-28-52", "timestamp": 1710574132, "time_this_iter_s": 1389.8177359104156, "time_total_s": 154010.37372422218, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 154010.37372422218, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 43.91530663963507, "ram_util_percent": 17.009325899645212}, "checkpoint_dir_name": "checkpoint_000111"}
{"custom_metrics": {"collisions_mean": 107.14, "collisions_min": 32, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0019524851312189488, "total_loss": 1.7040970456742297, "policy_loss": 0.010612574601867075, "vf_loss": 2.7636315033524887, "vf_explained_var": 0.5343846502660334, "kl": 0.009779248339436521, "entropy": 1.9064231650068841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 195750.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 282500, "num_env_steps_trained": 282500, "num_agent_steps_sampled": 847500, "num_agent_steps_trained": 847500}, "sampler_results": {"episode_reward_max": -190.7167880624177, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -316.19080551656987, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 107.14, "collisions_min": 32, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389, -294.9006279907979, -366.0012616841497, -396.83827705999613, -408.04125237785024, -280.23312574711707, -456.8160859981274, -380.4736652105087, -404.3773412346283, -536.8112670227284, -308.60328457858424], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5988778648493223, "mean_inference_ms": 8.724632604949454, "mean_action_processing_ms": 0.42152549642156956, "mean_env_wait_ms": 0.9832247476236736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8005542755126953, "StateBufferConnector_ms": 0.005900859832763672, "ViewRequirementAgentConnector_ms": 0.2729504108428955}}, "episode_reward_max": -190.7167880624177, "episode_reward_min": -820.2233298868239, "episode_reward_mean": -316.19080551656987, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-290.7666734570253, -385.9866882609478, -820.2233298868239, -378.9131338141183, -431.4070835418926, -287.7260224192072, -240.83092863874876, -371.34392202542244, -226.83982316597474, -238.7087536037929, -290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389, -294.9006279907979, -366.0012616841497, -396.83827705999613, -408.04125237785024, -280.23312574711707, -456.8160859981274, -380.4736652105087, -404.3773412346283, -536.8112670227284, -308.60328457858424], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5988778648493223, "mean_inference_ms": 8.724632604949454, "mean_action_processing_ms": 0.42152549642156956, "mean_env_wait_ms": 0.9832247476236736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8005542755126953, "StateBufferConnector_ms": 0.005900859832763672, "ViewRequirementAgentConnector_ms": 0.2729504108428955}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 847500, "num_agent_steps_trained": 847500, "num_env_steps_sampled": 282500, "num_env_steps_trained": 282500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.428853087779842, "num_agent_steps_trained_throughput_per_sec": 5.428853087779842, "timesteps_total": 847500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 847500, "timers": {"training_iteration_time_ms": 1384227.289, "sample_time_ms": 29581.564, "load_time_ms": 0.898, "load_throughput": 2783805.453, "learn_time_ms": 1354642.934, "learn_throughput": 1.846, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 282500, "num_env_steps_trained": 282500, "num_agent_steps_sampled": 847500, "num_agent_steps_trained": 847500}, "done": false, "episodes_total": 1130, "training_iteration": 113, "trial_id": "0b7ab_00052", "date": "2024-03-16_08-51-54", "timestamp": 1710575514, "time_this_iter_s": 1381.5093591213226, "time_total_s": 155391.8830833435, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 155391.8830833435, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 43.984030612244894, "ram_util_percent": 16.98841836734694}, "checkpoint_dir_name": "checkpoint_000112"}
{"custom_metrics": {"collisions_mean": 107.44, "collisions_min": 32, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0019524851312189488, "total_loss": 1.492917153710264, "policy_loss": -0.0005751429160457404, "vf_loss": 2.436454714603465, "vf_explained_var": 0.4477714237125441, "kl": 0.008946515607628195, "entropy": 1.5483399679745151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 197490.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 285000, "num_env_steps_trained": 285000, "num_agent_steps_sampled": 855000, "num_agent_steps_trained": 855000}, "sampler_results": {"episode_reward_max": -190.7167880624177, "episode_reward_min": -560.5628133746103, "episode_reward_mean": -311.07103478766925, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 107.44, "collisions_min": 32, "collisions_max": 330, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389, -294.9006279907979, -366.0012616841497, -396.83827705999613, -408.04125237785024, -280.23312574711707, -456.8160859981274, -380.4736652105087, -404.3773412346283, -536.8112670227284, -308.60328457858424, -477.3082209659538, -238.36203580907852, -279.0130160183918, -389.6392048888979, -372.8473250946196, -341.06495681927925, -321.8293265400334, -247.75590901520022, -223.9085344597589, -269.0407563126809], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5990686835268826, "mean_inference_ms": 8.725500263522372, "mean_action_processing_ms": 0.42160794300986426, "mean_env_wait_ms": 0.983250919622203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8032338619232178, "StateBufferConnector_ms": 0.0059549808502197266, "ViewRequirementAgentConnector_ms": 0.2765800952911377}}, "episode_reward_max": -190.7167880624177, "episode_reward_min": -560.5628133746103, "episode_reward_mean": -311.07103478766925, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-290.76536661777794, -358.434975607233, -560.5628133746103, -235.0735338938648, -211.49297586118112, -441.75712688895203, -207.74557229425713, -455.89928410410914, -203.48939387964404, -212.47348249302348, -249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389, -294.9006279907979, -366.0012616841497, -396.83827705999613, -408.04125237785024, -280.23312574711707, -456.8160859981274, -380.4736652105087, -404.3773412346283, -536.8112670227284, -308.60328457858424, -477.3082209659538, -238.36203580907852, -279.0130160183918, -389.6392048888979, -372.8473250946196, -341.06495681927925, -321.8293265400334, -247.75590901520022, -223.9085344597589, -269.0407563126809], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5990686835268826, "mean_inference_ms": 8.725500263522372, "mean_action_processing_ms": 0.42160794300986426, "mean_env_wait_ms": 0.983250919622203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8032338619232178, "StateBufferConnector_ms": 0.0059549808502197266, "ViewRequirementAgentConnector_ms": 0.2765800952911377}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 855000, "num_agent_steps_trained": 855000, "num_env_steps_sampled": 285000, "num_env_steps_trained": 285000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.436957461370771, "num_agent_steps_trained_throughput_per_sec": 5.436957461370771, "timesteps_total": 855000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 855000, "timers": {"training_iteration_time_ms": 1386642.745, "sample_time_ms": 29723.413, "load_time_ms": 0.9, "load_throughput": 2778862.564, "learn_time_ms": 1356916.532, "learn_throughput": 1.842, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 285000, "num_env_steps_trained": 285000, "num_agent_steps_sampled": 855000, "num_agent_steps_trained": 855000}, "done": false, "episodes_total": 1140, "training_iteration": 114, "trial_id": "0b7ab_00052", "date": "2024-03-16_09-14-55", "timestamp": 1710576895, "time_this_iter_s": 1379.4500370025635, "time_total_s": 156771.33312034607, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 156771.33312034607, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 43.96475995914198, "ram_util_percent": 16.86675178753831}, "checkpoint_dir_name": "checkpoint_000113"}
{"custom_metrics": {"collisions_mean": 106.66, "collisions_min": 32, "collisions_max": 282, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0019524851312189488, "total_loss": 1.5089397242035845, "policy_loss": -0.008033580649322991, "vf_loss": 2.4739866318288204, "vf_explained_var": 0.4959457858540546, "kl": 0.009396949898028074, "entropy": 1.4137507367970144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 199230.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 287500, "num_env_steps_trained": 287500, "num_agent_steps_sampled": 862500, "num_agent_steps_trained": 862500}, "sampler_results": {"episode_reward_max": -163.06927669982858, "episode_reward_min": -729.4012768310929, "episode_reward_mean": -312.48152504258906, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 106.66, "collisions_min": 32, "collisions_max": 282, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389, -294.9006279907979, -366.0012616841497, -396.83827705999613, -408.04125237785024, -280.23312574711707, -456.8160859981274, -380.4736652105087, -404.3773412346283, -536.8112670227284, -308.60328457858424, -477.3082209659538, -238.36203580907852, -279.0130160183918, -389.6392048888979, -372.8473250946196, -341.06495681927925, -321.8293265400334, -247.75590901520022, -223.9085344597589, -269.0407563126809, -294.97408975248095, -248.04016669228452, -328.46216706579884, -729.4012768310929, -342.94407116561024, -163.06927669982858, -235.79891387995983, -209.50179796963883, -244.29838396108124, -522.253406488856], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5992383372051515, "mean_inference_ms": 8.726300483778896, "mean_action_processing_ms": 0.4216875616202613, "mean_env_wait_ms": 0.9832669051610772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.802344560623169, "StateBufferConnector_ms": 0.00597691535949707, "ViewRequirementAgentConnector_ms": 0.2751915454864502}}, "episode_reward_max": -163.06927669982858, "episode_reward_min": -729.4012768310929, "episode_reward_mean": -312.48152504258906, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-249.8084950959326, -339.4740089826412, -365.70190255556895, -368.17610518291525, -401.88943561070295, -237.92298944888694, -203.64973156916216, -237.08653310610447, -219.04956422234557, -379.18302269661007, -270.806296935104, -215.13189549594318, -232.0001328736451, -231.14534578890164, -253.54350471599528, -205.33054273417136, -357.936434931574, -263.03950253786, -239.1721677583059, -201.7559045750943, -209.51049119272184, -396.6927237442281, -252.33185236317067, -225.6150893299894, -190.7167880624177, -364.2526123816564, -298.6150186833971, -271.0405137407047, -250.74574258308778, -261.0082880635153, -218.95823888338583, -489.61964501638033, -422.8707018532406, -238.7899916832387, -440.8277848648216, -379.10249492758, -217.6180023595768, -407.214422326092, -253.65703500548224, -233.74432397959347, -300.96777898222655, -397.56022065455033, -340.07743592095744, -443.131906084475, -396.2262183867344, -316.4804360286164, -244.56523898112584, -376.0628802797614, -221.61113826425228, -482.9426013143356, -219.51531140181814, -268.3773340162489, -247.76384005803092, -226.9051917657877, -333.2889843124721, -273.68451995194664, -407.22641007124224, -255.89233810828995, -326.80464280424667, -222.00227527481428, -429.08041781526794, -256.3254528399065, -395.23173107330416, -219.46487311492507, -217.99855775340032, -217.35961452288072, -296.1433165533917, -356.26089626830424, -395.12844347144323, -356.728194987389, -294.9006279907979, -366.0012616841497, -396.83827705999613, -408.04125237785024, -280.23312574711707, -456.8160859981274, -380.4736652105087, -404.3773412346283, -536.8112670227284, -308.60328457858424, -477.3082209659538, -238.36203580907852, -279.0130160183918, -389.6392048888979, -372.8473250946196, -341.06495681927925, -321.8293265400334, -247.75590901520022, -223.9085344597589, -269.0407563126809, -294.97408975248095, -248.04016669228452, -328.46216706579884, -729.4012768310929, -342.94407116561024, -163.06927669982858, -235.79891387995983, -209.50179796963883, -244.29838396108124, -522.253406488856], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5992383372051515, "mean_inference_ms": 8.726300483778896, "mean_action_processing_ms": 0.4216875616202613, "mean_env_wait_ms": 0.9832669051610772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.802344560623169, "StateBufferConnector_ms": 0.00597691535949707, "ViewRequirementAgentConnector_ms": 0.2751915454864502}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 862500, "num_agent_steps_trained": 862500, "num_env_steps_sampled": 287500, "num_env_steps_trained": 287500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.465940949794407, "num_agent_steps_trained_throughput_per_sec": 5.465940949794407, "timesteps_total": 862500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 862500, "timers": {"training_iteration_time_ms": 1387160.343, "sample_time_ms": 29697.837, "load_time_ms": 0.857, "load_throughput": 2918791.928, "learn_time_ms": 1357459.761, "learn_throughput": 1.842, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 287500, "num_env_steps_trained": 287500, "num_agent_steps_sampled": 862500, "num_agent_steps_trained": 862500}, "done": false, "episodes_total": 1150, "training_iteration": 115, "trial_id": "0b7ab_00052", "date": "2024-03-16_09-37-48", "timestamp": 1710578268, "time_this_iter_s": 1372.1354441642761, "time_total_s": 158143.46856451035, "pid": 116648, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread_reduced", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 64, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0019524851312189486, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 5, "dropout": 0.029257682677848687}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_reduced.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7faf092d70a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.008762475314323958, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6074008770615831, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9031830609519972, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 158143.46856451035, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 43.90713552361397, "ram_util_percent": 16.91575975359343}, "checkpoint_dir_name": "checkpoint_000114"}
