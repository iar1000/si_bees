{"custom_metrics": {"episode_optimality_mean": -0.9734195212308108, "episode_optimality_min": -1.5714285714285714, "episode_optimality_max": -0.75, "episode_optimality_capped_mean": -0.9416632233081155, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.75, "episode_reward_normalized_mean": -54.359375, "episode_reward_normalized_min": -122.0, "episode_reward_normalized_max": -7.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.9416632233081155, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.75}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9346946732824047, "cur_kl_coeff": 0.2, "cur_lr": 0.00011210859819985454, "total_loss": 0.2444296444626161, "policy_loss": -0.053248105027984514, "vf_loss": 0.29439011103007945, "vf_explained_var": 0.12714107835044464, "kl": 0.016438192922120908, "entropy": 5.044079085191091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": -35.0, "episode_reward_min": -610.0, "episode_reward_mean": -271.796875, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.9734195212308108, "episode_optimality_min": -1.5714285714285714, "episode_optimality_max": -0.75, "episode_optimality_capped_mean": -0.9416632233081155, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.75, "episode_reward_normalized_mean": -54.359375, "episode_reward_normalized_min": -122.0, "episode_reward_normalized_max": -7.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.9416632233081155, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.75}, "hist_stats": {"episode_reward": [-175.0, -325.0, -180.0, -190.0, -345.0, -135.0, -295.0, -610.0, -135.0, -400.0, -185.0, -250.0, -260.0, -360.0, -235.0, -110.0, -180.0, -35.0, -260.0, -355.0, -110.0, -360.0, -265.0, -135.0, -300.0, -355.0, -185.0, -440.0, -285.0, -450.0, -310.0, -240.0, -265.0, -185.0, -150.0, -415.0, -320.0, -405.0, -260.0, -265.0, -125.0, -415.0, -115.0, -465.0, -360.0, -415.0, -255.0, -345.0, -460.0, -205.0, -250.0, -410.0, -375.0, -325.0, -380.0, -160.0, -105.0, -190.0, -225.0, -330.0, -95.0, -200.0, -180.0, -290.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.641782109318985, "mean_inference_ms": 2.3506807355668915, "mean_action_processing_ms": 0.7744844232735646, "mean_env_wait_ms": 0.28416710072154966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2108052372932434, "StateBufferConnector_ms": 0.008061528205871582, "ViewRequirementAgentConnector_ms": 0.5863886326551437}}, "episode_reward_max": -35.0, "episode_reward_min": -610.0, "episode_reward_mean": -271.796875, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-175.0, -325.0, -180.0, -190.0, -345.0, -135.0, -295.0, -610.0, -135.0, -400.0, -185.0, -250.0, -260.0, -360.0, -235.0, -110.0, -180.0, -35.0, -260.0, -355.0, -110.0, -360.0, -265.0, -135.0, -300.0, -355.0, -185.0, -440.0, -285.0, -450.0, -310.0, -240.0, -265.0, -185.0, -150.0, -415.0, -320.0, -405.0, -260.0, -265.0, -125.0, -415.0, -115.0, -465.0, -360.0, -415.0, -255.0, -345.0, -460.0, -205.0, -250.0, -410.0, -375.0, -325.0, -380.0, -160.0, -105.0, -190.0, -225.0, -330.0, -95.0, -200.0, -180.0, -290.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.641782109318985, "mean_inference_ms": 2.3506807355668915, "mean_action_processing_ms": 0.7744844232735646, "mean_env_wait_ms": 0.28416710072154966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2108052372932434, "StateBufferConnector_ms": 0.008061528205871582, "ViewRequirementAgentConnector_ms": 0.5863886326551437}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 74.66260696007818, "num_env_steps_trained_throughput_per_sec": 74.66260696007818, "timesteps_total": 8192, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 109720.211, "sample_time_ms": 22729.17, "load_time_ms": 0.543, "load_throughput": 15096545.856, "learn_time_ms": 86981.891, "learn_throughput": 94.181, "synch_weights_time_ms": 2.439}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 64, "training_iteration": 1, "trial_id": "9fade_00019", "date": "2023-11-09_19-58-07", "timestamp": 1699556287, "time_this_iter_s": 109.7345643043518, "time_total_s": 109.7345643043518, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 109.7345643043518, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.56114649681528, "ram_util_percent": 14.543312101910828}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"episode_optimality_mean": -0.925566327069659, "episode_optimality_min": -1.2666666666666666, "episode_optimality_max": -0.68, "episode_optimality_capped_mean": -0.9137086113741405, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.68, "episode_reward_normalized_mean": -57.24, "episode_reward_normalized_min": -103.0, "episode_reward_normalized_max": -16.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.9137086113741405, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.68}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9766853727772832, "cur_kl_coeff": 0.2, "cur_lr": 0.00011210859819985454, "total_loss": 0.25343271839339043, "policy_loss": -0.05912636848644373, "vf_loss": 0.30889774155647803, "vf_explained_var": 0.1504688321053982, "kl": 0.018306726551173446, "entropy": 5.035630570451419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "sampler_results": {"episode_reward_max": -80.0, "episode_reward_min": -515.0, "episode_reward_mean": -286.2, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.925566327069659, "episode_optimality_min": -1.2666666666666666, "episode_optimality_max": -0.68, "episode_optimality_capped_mean": -0.9137086113741405, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.68, "episode_reward_normalized_mean": -57.24, "episode_reward_normalized_min": -103.0, "episode_reward_normalized_max": -16.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.9137086113741405, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.68}, "hist_stats": {"episode_reward": [-285.0, -450.0, -310.0, -240.0, -265.0, -185.0, -150.0, -415.0, -320.0, -405.0, -260.0, -265.0, -125.0, -415.0, -115.0, -465.0, -360.0, -415.0, -255.0, -345.0, -460.0, -205.0, -250.0, -410.0, -375.0, -325.0, -380.0, -160.0, -105.0, -190.0, -225.0, -330.0, -95.0, -200.0, -180.0, -290.0, -385.0, -450.0, -295.0, -200.0, -265.0, -390.0, -260.0, -360.0, -175.0, -210.0, -245.0, -190.0, -205.0, -290.0, -345.0, -265.0, -320.0, -250.0, -220.0, -355.0, -150.0, -515.0, -215.0, -305.0, -345.0, -220.0, -355.0, -390.0, -260.0, -255.0, -210.0, -390.0, -215.0, -235.0, -245.0, -275.0, -160.0, -345.0, -350.0, -100.0, -165.0, -255.0, -265.0, -410.0, -330.0, -80.0, -355.0, -295.0, -95.0, -510.0, -230.0, -280.0, -440.0, -390.0, -325.0, -280.0, -390.0, -280.0, -375.0, -285.0, -390.0, -95.0, -330.0, -335.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.521025167939781, "mean_inference_ms": 2.1579342045684866, "mean_action_processing_ms": 0.7191371700091181, "mean_env_wait_ms": 0.2647428845845509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.17929482460021973, "StateBufferConnector_ms": 0.007137775421142578, "ViewRequirementAgentConnector_ms": 0.46547484397888184}}, "episode_reward_max": -80.0, "episode_reward_min": -515.0, "episode_reward_mean": -286.2, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-285.0, -450.0, -310.0, -240.0, -265.0, -185.0, -150.0, -415.0, -320.0, -405.0, -260.0, -265.0, -125.0, -415.0, -115.0, -465.0, -360.0, -415.0, -255.0, -345.0, -460.0, -205.0, -250.0, -410.0, -375.0, -325.0, -380.0, -160.0, -105.0, -190.0, -225.0, -330.0, -95.0, -200.0, -180.0, -290.0, -385.0, -450.0, -295.0, -200.0, -265.0, -390.0, -260.0, -360.0, -175.0, -210.0, -245.0, -190.0, -205.0, -290.0, -345.0, -265.0, -320.0, -250.0, -220.0, -355.0, -150.0, -515.0, -215.0, -305.0, -345.0, -220.0, -355.0, -390.0, -260.0, -255.0, -210.0, -390.0, -215.0, -235.0, -245.0, -275.0, -160.0, -345.0, -350.0, -100.0, -165.0, -255.0, -265.0, -410.0, -330.0, -80.0, -355.0, -295.0, -95.0, -510.0, -230.0, -280.0, -440.0, -390.0, -325.0, -280.0, -390.0, -280.0, -375.0, -285.0, -390.0, -95.0, -330.0, -335.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.521025167939781, "mean_inference_ms": 2.1579342045684866, "mean_action_processing_ms": 0.7191371700091181, "mean_env_wait_ms": 0.2647428845845509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.17929482460021973, "StateBufferConnector_ms": 0.007137775421142578, "ViewRequirementAgentConnector_ms": 0.46547484397888184}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 87.08040923785414, "num_env_steps_trained_throughput_per_sec": 87.08040923785414, "timesteps_total": 16384, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 101897.076, "sample_time_ms": 18650.6, "load_time_ms": 0.937, "load_throughput": 8742935.972, "learn_time_ms": 83237.351, "learn_throughput": 98.417, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "episodes_total": 128, "training_iteration": 2, "trial_id": "9fade_00019", "date": "2023-11-09_20-00-23", "timestamp": 1699556423, "time_this_iter_s": 94.08706450462341, "time_total_s": 203.82162880897522, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 203.82162880897522, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.74923076923077, "ram_util_percent": 16.84307692307692}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": -0.8899073631297689, "episode_optimality_min": -1.3333333333333333, "episode_optimality_max": -0.3958333333333333, "episode_optimality_capped_mean": -0.8779713084527023, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.3958333333333333, "episode_reward_normalized_mean": -57.14, "episode_reward_normalized_min": -102.0, "episode_reward_normalized_max": -5.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.8779713084527023, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.3958333333333333}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9971159374838074, "cur_kl_coeff": 0.2, "cur_lr": 0.00011210859819985454, "total_loss": 0.25680796215736335, "policy_loss": -0.06689810581500448, "vf_loss": 0.3195835961525639, "vf_explained_var": 0.1541327395600577, "kl": 0.02061235704553269, "entropy": 5.028048077871402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -510.0, "episode_reward_mean": -285.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.8899073631297689, "episode_optimality_min": -1.3333333333333333, "episode_optimality_max": -0.3958333333333333, "episode_optimality_capped_mean": -0.8779713084527023, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.3958333333333333, "episode_reward_normalized_mean": -57.14, "episode_reward_normalized_min": -102.0, "episode_reward_normalized_max": -5.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.8779713084527023, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.3958333333333333}, "hist_stats": {"episode_reward": [-260.0, -255.0, -210.0, -390.0, -215.0, -235.0, -245.0, -275.0, -160.0, -345.0, -350.0, -100.0, -165.0, -255.0, -265.0, -410.0, -330.0, -80.0, -355.0, -295.0, -95.0, -510.0, -230.0, -280.0, -440.0, -390.0, -325.0, -280.0, -390.0, -280.0, -375.0, -285.0, -390.0, -95.0, -330.0, -335.0, -265.0, -290.0, -375.0, -485.0, -175.0, -325.0, -215.0, -435.0, -295.0, -250.0, -220.0, -245.0, -345.0, -150.0, -360.0, -165.0, -135.0, -305.0, -145.0, -420.0, -245.0, -385.0, -310.0, -320.0, -300.0, -95.0, -300.0, -270.0, -270.0, -325.0, -205.0, -410.0, -500.0, -215.0, -165.0, -380.0, -200.0, -170.0, -355.0, -280.0, -260.0, -230.0, -430.0, -300.0, -380.0, -325.0, -225.0, -450.0, -155.0, -410.0, -340.0, -25.0, -185.0, -500.0, -165.0, -425.0, -385.0, -80.0, -300.0, -465.0, -350.0, -255.0, -195.0, -210.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3711235851672865, "mean_inference_ms": 1.9014563630492693, "mean_action_processing_ms": 0.6563084395376603, "mean_env_wait_ms": 0.23994191531307385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16494178771972656, "StateBufferConnector_ms": 0.0066492557525634766, "ViewRequirementAgentConnector_ms": 0.3433232307434082}}, "episode_reward_max": -25.0, "episode_reward_min": -510.0, "episode_reward_mean": -285.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-260.0, -255.0, -210.0, -390.0, -215.0, -235.0, -245.0, -275.0, -160.0, -345.0, -350.0, -100.0, -165.0, -255.0, -265.0, -410.0, -330.0, -80.0, -355.0, -295.0, -95.0, -510.0, -230.0, -280.0, -440.0, -390.0, -325.0, -280.0, -390.0, -280.0, -375.0, -285.0, -390.0, -95.0, -330.0, -335.0, -265.0, -290.0, -375.0, -485.0, -175.0, -325.0, -215.0, -435.0, -295.0, -250.0, -220.0, -245.0, -345.0, -150.0, -360.0, -165.0, -135.0, -305.0, -145.0, -420.0, -245.0, -385.0, -310.0, -320.0, -300.0, -95.0, -300.0, -270.0, -270.0, -325.0, -205.0, -410.0, -500.0, -215.0, -165.0, -380.0, -200.0, -170.0, -355.0, -280.0, -260.0, -230.0, -430.0, -300.0, -380.0, -325.0, -225.0, -450.0, -155.0, -410.0, -340.0, -25.0, -185.0, -500.0, -165.0, -425.0, -385.0, -80.0, -300.0, -465.0, -350.0, -255.0, -195.0, -210.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3711235851672865, "mean_inference_ms": 1.9014563630492693, "mean_action_processing_ms": 0.6563084395376603, "mean_env_wait_ms": 0.23994191531307385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16494178771972656, "StateBufferConnector_ms": 0.0066492557525634766, "ViewRequirementAgentConnector_ms": 0.3433232307434082}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 82.1220327737427, "num_env_steps_trained_throughput_per_sec": 82.1220327737427, "timesteps_total": 24576, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 122880, "timers": {"training_iteration_time_ms": 101182.701, "sample_time_ms": 17382.057, "load_time_ms": 1.145, "load_throughput": 7152318.561, "learn_time_ms": 83790.952, "learn_throughput": 97.767, "synch_weights_time_ms": 2.356}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "done": false, "episodes_total": 192, "training_iteration": 3, "trial_id": "9fade_00019", "date": "2023-11-09_20-02-04", "timestamp": 1699556524, "time_this_iter_s": 99.77295327186584, "time_total_s": 303.59458208084106, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 303.59458208084106, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.7979020979021, "ram_util_percent": 18.08881118881119}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": -0.8415394237724333, "episode_optimality_min": -1.3333333333333333, "episode_optimality_max": -0.4, "episode_optimality_capped_mean": -0.8241907917325443, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.4, "episode_reward_normalized_mean": -55.79, "episode_reward_normalized_min": -102.0, "episode_reward_normalized_max": -5.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.8241907917325443, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.4}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9985976862472793, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00011210859819985454, "total_loss": 0.28086270018056286, "policy_loss": -0.07448447918238041, "vf_loss": 0.34927426990742483, "vf_explained_var": 0.162191446715345, "kl": 0.020243030665435716, "entropy": 4.986391746997834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -510.0, "episode_reward_mean": -278.95, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.8415394237724333, "episode_optimality_min": -1.3333333333333333, "episode_optimality_max": -0.4, "episode_optimality_capped_mean": -0.8241907917325443, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.4, "episode_reward_normalized_mean": -55.79, "episode_reward_normalized_min": -102.0, "episode_reward_normalized_max": -5.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.8241907917325443, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.4}, "hist_stats": {"episode_reward": [-270.0, -325.0, -205.0, -410.0, -500.0, -215.0, -165.0, -380.0, -200.0, -170.0, -355.0, -280.0, -260.0, -230.0, -430.0, -300.0, -380.0, -325.0, -225.0, -450.0, -155.0, -410.0, -340.0, -25.0, -185.0, -500.0, -165.0, -425.0, -385.0, -80.0, -300.0, -465.0, -350.0, -255.0, -195.0, -210.0, -345.0, -170.0, -500.0, -110.0, -100.0, -200.0, -90.0, -220.0, -360.0, -165.0, -290.0, -470.0, -315.0, -245.0, -185.0, -290.0, -185.0, -230.0, -315.0, -205.0, -275.0, -430.0, -355.0, -395.0, -245.0, -230.0, -325.0, -345.0, -190.0, -200.0, -265.0, -250.0, -295.0, -355.0, -180.0, -55.0, -90.0, -495.0, -115.0, -265.0, -185.0, -180.0, -370.0, -95.0, -340.0, -510.0, -350.0, -320.0, -305.0, -235.0, -300.0, -245.0, -345.0, -440.0, -145.0, -250.0, -325.0, -220.0, -265.0, -205.0, -260.0, -300.0, -405.0, -435.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3166209871331398, "mean_inference_ms": 1.8204717097936842, "mean_action_processing_ms": 0.6338061955202727, "mean_env_wait_ms": 0.23185182821633896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16536164283752441, "StateBufferConnector_ms": 0.00674748420715332, "ViewRequirementAgentConnector_ms": 0.34929418563842773}}, "episode_reward_max": -25.0, "episode_reward_min": -510.0, "episode_reward_mean": -278.95, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-270.0, -325.0, -205.0, -410.0, -500.0, -215.0, -165.0, -380.0, -200.0, -170.0, -355.0, -280.0, -260.0, -230.0, -430.0, -300.0, -380.0, -325.0, -225.0, -450.0, -155.0, -410.0, -340.0, -25.0, -185.0, -500.0, -165.0, -425.0, -385.0, -80.0, -300.0, -465.0, -350.0, -255.0, -195.0, -210.0, -345.0, -170.0, -500.0, -110.0, -100.0, -200.0, -90.0, -220.0, -360.0, -165.0, -290.0, -470.0, -315.0, -245.0, -185.0, -290.0, -185.0, -230.0, -315.0, -205.0, -275.0, -430.0, -355.0, -395.0, -245.0, -230.0, -325.0, -345.0, -190.0, -200.0, -265.0, -250.0, -295.0, -355.0, -180.0, -55.0, -90.0, -495.0, -115.0, -265.0, -185.0, -180.0, -370.0, -95.0, -340.0, -510.0, -350.0, -320.0, -305.0, -235.0, -300.0, -245.0, -345.0, -440.0, -145.0, -250.0, -325.0, -220.0, -265.0, -205.0, -260.0, -300.0, -405.0, -435.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3166209871331398, "mean_inference_ms": 1.8204717097936842, "mean_action_processing_ms": 0.6338061955202727, "mean_env_wait_ms": 0.23185182821633896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16536164283752441, "StateBufferConnector_ms": 0.00674748420715332, "ViewRequirementAgentConnector_ms": 0.34929418563842773}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 82.08258375389829, "num_env_steps_trained_throughput_per_sec": 82.08258375389829, "timesteps_total": 32768, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 163840, "timers": {"training_iteration_time_ms": 100837.499, "sample_time_ms": 17013.301, "load_time_ms": 1.262, "load_throughput": 6493383.42, "learn_time_ms": 83814.2, "learn_throughput": 97.74, "synch_weights_time_ms": 2.35}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "done": false, "episodes_total": 256, "training_iteration": 4, "trial_id": "9fade_00019", "date": "2023-11-09_20-03-44", "timestamp": 1699556624, "time_this_iter_s": 99.8186628818512, "time_total_s": 403.41324496269226, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 403.41324496269226, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.141958041958034, "ram_util_percent": 18.34125874125874}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": -0.7829384603896288, "episode_optimality_min": -3.0, "episode_optimality_max": -0.16326530612244897, "episode_optimality_capped_mean": -0.7554732504460023, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.16326530612244897, "episode_reward_normalized_mean": -47.75, "episode_reward_normalized_min": -102.0, "episode_reward_normalized_max": -8.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.7554732504460023, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.16326530612244897}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9994063508075972, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.00011210859819985454, "total_loss": 0.2799494220585378, "policy_loss": -0.0820586441604731, "vf_loss": 0.35343598062715803, "vf_explained_var": 0.16403356082737447, "kl": 0.01904908009032776, "entropy": 4.9666016499698165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "sampler_results": {"episode_reward_max": -40.0, "episode_reward_min": -510.0, "episode_reward_mean": -238.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.7829384603896288, "episode_optimality_min": -3.0, "episode_optimality_max": -0.16326530612244897, "episode_optimality_capped_mean": -0.7554732504460023, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": -0.16326530612244897, "episode_reward_normalized_mean": -47.75, "episode_reward_normalized_min": -102.0, "episode_reward_normalized_max": -8.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.7554732504460023, "curr_learning_score_min": -1.0, "curr_learning_score_max": -0.16326530612244897}, "hist_stats": {"episode_reward": [-190.0, -200.0, -265.0, -250.0, -295.0, -355.0, -180.0, -55.0, -90.0, -495.0, -115.0, -265.0, -185.0, -180.0, -370.0, -95.0, -340.0, -510.0, -350.0, -320.0, -305.0, -235.0, -300.0, -245.0, -345.0, -440.0, -145.0, -250.0, -325.0, -220.0, -265.0, -205.0, -260.0, -300.0, -405.0, -435.0, -105.0, -235.0, -185.0, -210.0, -220.0, -105.0, -175.0, -275.0, -305.0, -285.0, -175.0, -85.0, -210.0, -325.0, -250.0, -250.0, -285.0, -175.0, -40.0, -275.0, -75.0, -245.0, -280.0, -155.0, -280.0, -250.0, -160.0, -215.0, -355.0, -80.0, -195.0, -295.0, -335.0, -340.0, -365.0, -135.0, -300.0, -290.0, -40.0, -275.0, -115.0, -340.0, -130.0, -295.0, -150.0, -130.0, -245.0, -50.0, -395.0, -145.0, -60.0, -290.0, -135.0, -350.0, -180.0, -105.0, -155.0, -340.0, -360.0, -255.0, -205.0, -240.0, -290.0, -295.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3000677442349329, "mean_inference_ms": 1.8112336255721255, "mean_action_processing_ms": 0.6276422229213381, "mean_env_wait_ms": 0.23244833357786013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.17272567749023438, "StateBufferConnector_ms": 0.007208585739135742, "ViewRequirementAgentConnector_ms": 0.372161865234375}}, "episode_reward_max": -40.0, "episode_reward_min": -510.0, "episode_reward_mean": -238.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-190.0, -200.0, -265.0, -250.0, -295.0, -355.0, -180.0, -55.0, -90.0, -495.0, -115.0, -265.0, -185.0, -180.0, -370.0, -95.0, -340.0, -510.0, -350.0, -320.0, -305.0, -235.0, -300.0, -245.0, -345.0, -440.0, -145.0, -250.0, -325.0, -220.0, -265.0, -205.0, -260.0, -300.0, -405.0, -435.0, -105.0, -235.0, -185.0, -210.0, -220.0, -105.0, -175.0, -275.0, -305.0, -285.0, -175.0, -85.0, -210.0, -325.0, -250.0, -250.0, -285.0, -175.0, -40.0, -275.0, -75.0, -245.0, -280.0, -155.0, -280.0, -250.0, -160.0, -215.0, -355.0, -80.0, -195.0, -295.0, -335.0, -340.0, -365.0, -135.0, -300.0, -290.0, -40.0, -275.0, -115.0, -340.0, -130.0, -295.0, -150.0, -130.0, -245.0, -50.0, -395.0, -145.0, -60.0, -290.0, -135.0, -350.0, -180.0, -105.0, -155.0, -340.0, -360.0, -255.0, -205.0, -240.0, -290.0, -295.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3000677442349329, "mean_inference_ms": 1.8112336255721255, "mean_action_processing_ms": 0.6276422229213381, "mean_env_wait_ms": 0.23244833357786013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.17272567749023438, "StateBufferConnector_ms": 0.007208585739135742, "ViewRequirementAgentConnector_ms": 0.372161865234375}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 82.16069870774513, "num_env_steps_trained_throughput_per_sec": 82.16069870774513, "timesteps_total": 40960, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 204800, "timers": {"training_iteration_time_ms": 100611.401, "sample_time_ms": 16950.175, "load_time_ms": 1.319, "load_throughput": 6208843.218, "learn_time_ms": 83651.119, "learn_throughput": 97.931, "synch_weights_time_ms": 2.363}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "done": false, "episodes_total": 320, "training_iteration": 5, "trial_id": "9fade_00019", "date": "2023-11-09_20-05-23", "timestamp": 1699556723, "time_this_iter_s": 99.72545576095581, "time_total_s": 503.13870072364807, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 503.13870072364807, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.505633802816895, "ram_util_percent": 18.414788732394367}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": -0.6797138857463574, "episode_optimality_min": -3.0, "episode_optimality_max": 0.2, "episode_optimality_capped_mean": -0.6550350186439609, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.2, "episode_reward_normalized_mean": -41.74, "episode_reward_normalized_min": -85.0, "episode_reward_normalized_max": 9.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.6550350186439609, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.2}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9996951006601255, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.00011210859819985454, "total_loss": 0.32429013037569043, "policy_loss": -0.08858886002989796, "vf_loss": 0.4033736108041679, "vf_explained_var": 0.18205354506770768, "kl": 0.021123066345840394, "entropy": 4.950447126974662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "sampler_results": {"episode_reward_max": 45.0, "episode_reward_min": -425.0, "episode_reward_mean": -208.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.6797138857463574, "episode_optimality_min": -3.0, "episode_optimality_max": 0.2, "episode_optimality_capped_mean": -0.6550350186439609, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.2, "episode_reward_normalized_mean": -41.74, "episode_reward_normalized_min": -85.0, "episode_reward_normalized_max": 9.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.6550350186439609, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.2}, "hist_stats": {"episode_reward": [-355.0, -80.0, -195.0, -295.0, -335.0, -340.0, -365.0, -135.0, -300.0, -290.0, -40.0, -275.0, -115.0, -340.0, -130.0, -295.0, -150.0, -130.0, -245.0, -50.0, -395.0, -145.0, -60.0, -290.0, -135.0, -350.0, -180.0, -105.0, -155.0, -340.0, -360.0, -255.0, -205.0, -240.0, -290.0, -295.0, -360.0, -170.0, -210.0, -410.0, -25.0, -170.0, -190.0, -110.0, -275.0, -185.0, -160.0, -80.0, -425.0, -230.0, -230.0, -120.0, -235.0, -140.0, -125.0, -240.0, -135.0, -165.0, -310.0, 10.0, -315.0, -265.0, -90.0, -260.0, -170.0, -380.0, -175.0, -210.0, -105.0, -130.0, -130.0, -225.0, -215.0, -190.0, -200.0, -215.0, -260.0, -215.0, -185.0, -235.0, -175.0, -275.0, -230.0, -210.0, -225.0, -215.0, -255.0, -185.0, -120.0, 45.0, -125.0, -150.0, -210.0, -125.0, -95.0, -315.0, -130.0, -270.0, -175.0, -310.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2899193354981484, "mean_inference_ms": 1.8062203040606213, "mean_action_processing_ms": 0.6238084180610589, "mean_env_wait_ms": 0.23355931240106514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1726093292236328, "StateBufferConnector_ms": 0.007200479507446289, "ViewRequirementAgentConnector_ms": 0.37218284606933594}}, "episode_reward_max": 45.0, "episode_reward_min": -425.0, "episode_reward_mean": -208.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-355.0, -80.0, -195.0, -295.0, -335.0, -340.0, -365.0, -135.0, -300.0, -290.0, -40.0, -275.0, -115.0, -340.0, -130.0, -295.0, -150.0, -130.0, -245.0, -50.0, -395.0, -145.0, -60.0, -290.0, -135.0, -350.0, -180.0, -105.0, -155.0, -340.0, -360.0, -255.0, -205.0, -240.0, -290.0, -295.0, -360.0, -170.0, -210.0, -410.0, -25.0, -170.0, -190.0, -110.0, -275.0, -185.0, -160.0, -80.0, -425.0, -230.0, -230.0, -120.0, -235.0, -140.0, -125.0, -240.0, -135.0, -165.0, -310.0, 10.0, -315.0, -265.0, -90.0, -260.0, -170.0, -380.0, -175.0, -210.0, -105.0, -130.0, -130.0, -225.0, -215.0, -190.0, -200.0, -215.0, -260.0, -215.0, -185.0, -235.0, -175.0, -275.0, -230.0, -210.0, -225.0, -215.0, -255.0, -185.0, -120.0, 45.0, -125.0, -150.0, -210.0, -125.0, -95.0, -315.0, -130.0, -270.0, -175.0, -310.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2899193354981484, "mean_inference_ms": 1.8062203040606213, "mean_action_processing_ms": 0.6238084180610589, "mean_env_wait_ms": 0.23355931240106514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1726093292236328, "StateBufferConnector_ms": 0.007200479507446289, "ViewRequirementAgentConnector_ms": 0.37218284606933594}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 81.77674295085117, "num_env_steps_trained_throughput_per_sec": 81.77674295085117, "timesteps_total": 49152, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 245760, "timers": {"training_iteration_time_ms": 100538.693, "sample_time_ms": 16802.838, "load_time_ms": 1.391, "load_throughput": 5889063.05, "learn_time_ms": 83725.622, "learn_throughput": 97.843, "synch_weights_time_ms": 2.379}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "done": false, "episodes_total": 384, "training_iteration": 6, "trial_id": "9fade_00019", "date": "2023-11-09_20-07-04", "timestamp": 1699556824, "time_this_iter_s": 100.19171047210693, "time_total_s": 603.330411195755, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 603.330411195755, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.502112676056335, "ram_util_percent": 18.53098591549296}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": -0.4852237792382962, "episode_optimality_min": -1.04, "episode_optimality_max": 0.3333333333333333, "episode_optimality_capped_mean": -0.48462377923829614, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.3333333333333333, "episode_reward_normalized_mean": -28.63, "episode_reward_normalized_min": -76.0, "episode_reward_normalized_max": 25.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.48462377923829614, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.3333333333333333}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9935495556083819, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.36360830923629694, "policy_loss": -0.08803506117076419, "vf_loss": 0.4396818028142055, "vf_explained_var": 0.18596319910138845, "kl": 0.017720841352660652, "entropy": 4.895505293657382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 286720, "num_agent_steps_trained": 286720}, "sampler_results": {"episode_reward_max": 125.0, "episode_reward_min": -380.0, "episode_reward_mean": -143.15, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.4852237792382962, "episode_optimality_min": -1.04, "episode_optimality_max": 0.3333333333333333, "episode_optimality_capped_mean": -0.48462377923829614, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.3333333333333333, "episode_reward_normalized_mean": -28.63, "episode_reward_normalized_min": -76.0, "episode_reward_normalized_max": 25.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.48462377923829614, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.3333333333333333}, "hist_stats": {"episode_reward": [-170.0, -380.0, -175.0, -210.0, -105.0, -130.0, -130.0, -225.0, -215.0, -190.0, -200.0, -215.0, -260.0, -215.0, -185.0, -235.0, -175.0, -275.0, -230.0, -210.0, -225.0, -215.0, -255.0, -185.0, -120.0, 45.0, -125.0, -150.0, -210.0, -125.0, -95.0, -315.0, -130.0, -270.0, -175.0, -310.0, -30.0, -105.0, -55.0, -345.0, -340.0, -55.0, -155.0, -310.0, -25.0, -40.0, -155.0, -35.0, -30.0, -260.0, -200.0, 0.0, -130.0, -110.0, -15.0, -120.0, -220.0, -95.0, -85.0, -120.0, -335.0, -195.0, -80.0, -75.0, -195.0, -105.0, -235.0, -175.0, 0.0, -230.0, 125.0, -160.0, -65.0, -135.0, -55.0, -235.0, 10.0, -45.0, -220.0, -115.0, -100.0, -40.0, -20.0, -70.0, -90.0, -255.0, -160.0, -165.0, -30.0, -175.0, -80.0, -65.0, -40.0, -140.0, -55.0, -150.0, -125.0, 0.0, -50.0, 40.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2806264687955489, "mean_inference_ms": 1.791782128479232, "mean_action_processing_ms": 0.6200705557345304, "mean_env_wait_ms": 0.23287593902777062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1710662841796875, "StateBufferConnector_ms": 0.0070648193359375, "ViewRequirementAgentConnector_ms": 0.36092543601989746}}, "episode_reward_max": 125.0, "episode_reward_min": -380.0, "episode_reward_mean": -143.15, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-170.0, -380.0, -175.0, -210.0, -105.0, -130.0, -130.0, -225.0, -215.0, -190.0, -200.0, -215.0, -260.0, -215.0, -185.0, -235.0, -175.0, -275.0, -230.0, -210.0, -225.0, -215.0, -255.0, -185.0, -120.0, 45.0, -125.0, -150.0, -210.0, -125.0, -95.0, -315.0, -130.0, -270.0, -175.0, -310.0, -30.0, -105.0, -55.0, -345.0, -340.0, -55.0, -155.0, -310.0, -25.0, -40.0, -155.0, -35.0, -30.0, -260.0, -200.0, 0.0, -130.0, -110.0, -15.0, -120.0, -220.0, -95.0, -85.0, -120.0, -335.0, -195.0, -80.0, -75.0, -195.0, -105.0, -235.0, -175.0, 0.0, -230.0, 125.0, -160.0, -65.0, -135.0, -55.0, -235.0, 10.0, -45.0, -220.0, -115.0, -100.0, -40.0, -20.0, -70.0, -90.0, -255.0, -160.0, -165.0, -30.0, -175.0, -80.0, -65.0, -40.0, -140.0, -55.0, -150.0, -125.0, 0.0, -50.0, 40.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2806264687955489, "mean_inference_ms": 1.791782128479232, "mean_action_processing_ms": 0.6200705557345304, "mean_env_wait_ms": 0.23287593902777062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1710662841796875, "StateBufferConnector_ms": 0.0070648193359375, "ViewRequirementAgentConnector_ms": 0.36092543601989746}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286720, "num_agent_steps_trained": 286720, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 84.69912647691066, "num_env_steps_trained_throughput_per_sec": 84.69912647691066, "timesteps_total": 57344, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 286720, "timers": {"training_iteration_time_ms": 99992.994, "sample_time_ms": 16636.217, "load_time_ms": 1.426, "load_throughput": 5744128.978, "learn_time_ms": 83346.594, "learn_throughput": 98.288, "synch_weights_time_ms": 2.36}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 286720, "num_agent_steps_trained": 286720}, "done": false, "episodes_total": 448, "training_iteration": 7, "trial_id": "9fade_00019", "date": "2023-11-09_20-08-40", "timestamp": 1699556920, "time_this_iter_s": 96.73331618309021, "time_total_s": 700.0637273788452, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 700.0637273788452, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.530434782608694, "ram_util_percent": 18.421014492753624}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": -0.2780079781716984, "episode_optimality_min": -1.0, "episode_optimality_max": 0.3333333333333333, "episode_optimality_capped_mean": -0.2780079781716984, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.3333333333333333, "episode_reward_normalized_mean": -15.86, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 25.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.2780079781716984, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.3333333333333333}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9980558384271959, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.40342888238291685, "policy_loss": -0.08931191352311241, "vf_loss": 0.4802814693225082, "vf_explained_var": 0.19112468464300036, "kl": 0.018458261781053125, "entropy": 4.8573210193713505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 327680, "num_agent_steps_trained": 327680}, "sampler_results": {"episode_reward_max": 125.0, "episode_reward_min": -255.0, "episode_reward_mean": -79.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.2780079781716984, "episode_optimality_min": -1.0, "episode_optimality_max": 0.3333333333333333, "episode_optimality_capped_mean": -0.2780079781716984, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.3333333333333333, "episode_reward_normalized_mean": -15.86, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 25.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.2780079781716984, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.3333333333333333}, "hist_stats": {"episode_reward": [-195.0, -105.0, -235.0, -175.0, 0.0, -230.0, 125.0, -160.0, -65.0, -135.0, -55.0, -235.0, 10.0, -45.0, -220.0, -115.0, -100.0, -40.0, -20.0, -70.0, -90.0, -255.0, -160.0, -165.0, -30.0, -175.0, -80.0, -65.0, -40.0, -140.0, -55.0, -150.0, -125.0, 0.0, -50.0, 40.0, 60.0, 15.0, -140.0, 30.0, -30.0, -50.0, -10.0, -25.0, -140.0, -30.0, -250.0, -135.0, -185.0, -70.0, -150.0, 45.0, -210.0, -95.0, -55.0, -55.0, -155.0, -150.0, -35.0, -75.0, -20.0, -20.0, -255.0, -200.0, -70.0, -135.0, -60.0, -15.0, 100.0, 5.0, -55.0, -30.0, 15.0, 20.0, 70.0, -130.0, -145.0, 0.0, -55.0, -30.0, -115.0, -115.0, -15.0, -110.0, -40.0, -50.0, -15.0, -40.0, -160.0, -145.0, -255.0, -70.0, 60.0, -80.0, 5.0, 70.0, 40.0, -220.0, -70.0, -95.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.26376999972815, "mean_inference_ms": 1.7567485938528162, "mean_action_processing_ms": 0.6128243256243957, "mean_env_wait_ms": 0.22872574244195681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.163649320602417, "StateBufferConnector_ms": 0.006503105163574219, "ViewRequirementAgentConnector_ms": 0.3349587917327881}}, "episode_reward_max": 125.0, "episode_reward_min": -255.0, "episode_reward_mean": -79.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-195.0, -105.0, -235.0, -175.0, 0.0, -230.0, 125.0, -160.0, -65.0, -135.0, -55.0, -235.0, 10.0, -45.0, -220.0, -115.0, -100.0, -40.0, -20.0, -70.0, -90.0, -255.0, -160.0, -165.0, -30.0, -175.0, -80.0, -65.0, -40.0, -140.0, -55.0, -150.0, -125.0, 0.0, -50.0, 40.0, 60.0, 15.0, -140.0, 30.0, -30.0, -50.0, -10.0, -25.0, -140.0, -30.0, -250.0, -135.0, -185.0, -70.0, -150.0, 45.0, -210.0, -95.0, -55.0, -55.0, -155.0, -150.0, -35.0, -75.0, -20.0, -20.0, -255.0, -200.0, -70.0, -135.0, -60.0, -15.0, 100.0, 5.0, -55.0, -30.0, 15.0, 20.0, 70.0, -130.0, -145.0, 0.0, -55.0, -30.0, -115.0, -115.0, -15.0, -110.0, -40.0, -50.0, -15.0, -40.0, -160.0, -145.0, -255.0, -70.0, 60.0, -80.0, 5.0, 70.0, 40.0, -220.0, -70.0, -95.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.26376999972815, "mean_inference_ms": 1.7567485938528162, "mean_action_processing_ms": 0.6128243256243957, "mean_env_wait_ms": 0.22872574244195681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.163649320602417, "StateBufferConnector_ms": 0.006503105163574219, "ViewRequirementAgentConnector_ms": 0.3349587917327881}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327680, "num_agent_steps_trained": 327680, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 85.80894490940376, "num_env_steps_trained_throughput_per_sec": 85.80894490940376, "timesteps_total": 65536, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 327680, "timers": {"training_iteration_time_ms": 99427.354, "sample_time_ms": 16284.233, "load_time_ms": 1.463, "load_throughput": 5600495.241, "learn_time_ms": 83132.841, "learn_throughput": 98.541, "synch_weights_time_ms": 2.357}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 327680, "num_agent_steps_trained": 327680}, "done": false, "episodes_total": 512, "training_iteration": 8, "trial_id": "9fade_00019", "date": "2023-11-09_20-10-16", "timestamp": 1699557016, "time_this_iter_s": 95.48298668861389, "time_total_s": 795.5467140674591, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 795.5467140674591, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 39.02919708029197, "ram_util_percent": 17.77226277372263}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": -0.12372247019888721, "episode_optimality_min": -2.4, "episode_optimality_max": 0.803921568627451, "episode_optimality_capped_mean": -0.10972247019888723, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.803921568627451, "episode_reward_normalized_mean": -4.64, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 70.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.10972247019888723, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.803921568627451}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9934442642672608, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.38530186178861187, "policy_loss": -0.0851913736842592, "vf_loss": 0.4583800479855078, "vf_explained_var": 0.2256776597475012, "kl": 0.01794546325393791, "entropy": 4.822134688148896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 368640, "num_agent_steps_trained": 368640}, "sampler_results": {"episode_reward_max": 350.0, "episode_reward_min": -255.0, "episode_reward_mean": -23.2, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": -0.12372247019888721, "episode_optimality_min": -2.4, "episode_optimality_max": 0.803921568627451, "episode_optimality_capped_mean": -0.10972247019888723, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.803921568627451, "episode_reward_normalized_mean": -4.64, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 70.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": -0.10972247019888723, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.803921568627451}, "hist_stats": {"episode_reward": [-70.0, -135.0, -60.0, -15.0, 100.0, 5.0, -55.0, -30.0, 15.0, 20.0, 70.0, -130.0, -145.0, 0.0, -55.0, -30.0, -115.0, -115.0, -15.0, -110.0, -40.0, -50.0, -15.0, -40.0, -160.0, -145.0, -255.0, -70.0, 60.0, -80.0, 5.0, 70.0, 40.0, -220.0, -70.0, -95.0, 95.0, -150.0, -25.0, -215.0, -175.0, -60.0, -175.0, 90.0, 5.0, -25.0, -120.0, -175.0, -60.0, -190.0, -150.0, 240.0, 50.0, -50.0, 35.0, 125.0, 5.0, -130.0, 25.0, 80.0, 10.0, 95.0, -40.0, -75.0, 5.0, 5.0, -10.0, 0.0, -15.0, -160.0, -25.0, -50.0, -5.0, 350.0, -45.0, 205.0, 60.0, -35.0, 190.0, 145.0, 125.0, -50.0, -20.0, 175.0, 15.0, -125.0, 55.0, -30.0, 125.0, 145.0, -60.0, 45.0, -35.0, -80.0, -55.0, -50.0, -125.0, 55.0, 0.0, -150.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2466672630333173, "mean_inference_ms": 1.7224091703259257, "mean_action_processing_ms": 0.6052339204711832, "mean_env_wait_ms": 0.2246426853173179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15825438499450684, "StateBufferConnector_ms": 0.0062868595123291016, "ViewRequirementAgentConnector_ms": 0.3256688117980957}}, "episode_reward_max": 350.0, "episode_reward_min": -255.0, "episode_reward_mean": -23.2, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-70.0, -135.0, -60.0, -15.0, 100.0, 5.0, -55.0, -30.0, 15.0, 20.0, 70.0, -130.0, -145.0, 0.0, -55.0, -30.0, -115.0, -115.0, -15.0, -110.0, -40.0, -50.0, -15.0, -40.0, -160.0, -145.0, -255.0, -70.0, 60.0, -80.0, 5.0, 70.0, 40.0, -220.0, -70.0, -95.0, 95.0, -150.0, -25.0, -215.0, -175.0, -60.0, -175.0, 90.0, 5.0, -25.0, -120.0, -175.0, -60.0, -190.0, -150.0, 240.0, 50.0, -50.0, 35.0, 125.0, 5.0, -130.0, 25.0, 80.0, 10.0, 95.0, -40.0, -75.0, 5.0, 5.0, -10.0, 0.0, -15.0, -160.0, -25.0, -50.0, -5.0, 350.0, -45.0, 205.0, 60.0, -35.0, 190.0, 145.0, 125.0, -50.0, -20.0, 175.0, 15.0, -125.0, 55.0, -30.0, 125.0, 145.0, -60.0, 45.0, -35.0, -80.0, -55.0, -50.0, -125.0, 55.0, 0.0, -150.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2466672630333173, "mean_inference_ms": 1.7224091703259257, "mean_action_processing_ms": 0.6052339204711832, "mean_env_wait_ms": 0.2246426853173179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15825438499450684, "StateBufferConnector_ms": 0.0062868595123291016, "ViewRequirementAgentConnector_ms": 0.3256688117980957}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368640, "num_agent_steps_trained": 368640, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 85.29680184827363, "num_env_steps_trained_throughput_per_sec": 85.29680184827363, "timesteps_total": 73728, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 368640, "timers": {"training_iteration_time_ms": 99051.102, "sample_time_ms": 16028.852, "load_time_ms": 1.506, "load_throughput": 5441163.502, "learn_time_ms": 83011.906, "learn_throughput": 98.685, "synch_weights_time_ms": 2.369}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 368640, "num_agent_steps_trained": 368640}, "done": false, "episodes_total": 576, "training_iteration": 9, "trial_id": "9fade_00019", "date": "2023-11-09_20-11-52", "timestamp": 1699557112, "time_this_iter_s": 96.05663704872131, "time_total_s": 891.6033511161804, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 891.6033511161804, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.63235294117647, "ram_util_percent": 17.928676470588233}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.08176492852218706, "episode_optimality_min": -1.2777777777777777, "episode_optimality_max": 0.831858407079646, "episode_optimality_capped_mean": 0.08454270629996483, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.831858407079646, "episode_reward_normalized_mean": 9.56, "episode_reward_normalized_min": -65.0, "episode_reward_normalized_max": 94.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.08454270629996483, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.831858407079646}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9989911613799631, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.40227768975009287, "policy_loss": -0.08389507814894993, "vf_loss": 0.4740274869184941, "vf_explained_var": 0.2445125772493581, "kl": 0.017993008251766016, "entropy": 4.763003857408961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 409600, "num_agent_steps_trained": 409600}, "sampler_results": {"episode_reward_max": 470.0, "episode_reward_min": -325.0, "episode_reward_mean": 47.8, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.08176492852218706, "episode_optimality_min": -1.2777777777777777, "episode_optimality_max": 0.831858407079646, "episode_optimality_capped_mean": 0.08454270629996483, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.831858407079646, "episode_reward_normalized_mean": 9.56, "episode_reward_normalized_min": -65.0, "episode_reward_normalized_max": 94.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.08454270629996483, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.831858407079646}, "hist_stats": {"episode_reward": [5.0, 5.0, -10.0, 0.0, -15.0, -160.0, -25.0, -50.0, -5.0, 350.0, -45.0, 205.0, 60.0, -35.0, 190.0, 145.0, 125.0, -50.0, -20.0, 175.0, 15.0, -125.0, 55.0, -30.0, 125.0, 145.0, -60.0, 45.0, -35.0, -80.0, -55.0, -50.0, -125.0, 55.0, 0.0, -150.0, 140.0, -325.0, -70.0, -110.0, -15.0, 85.0, 60.0, -55.0, 125.0, 0.0, 30.0, 330.0, -55.0, 180.0, 15.0, 115.0, 145.0, -80.0, 470.0, -135.0, -120.0, 200.0, 160.0, 55.0, 5.0, 130.0, 280.0, -65.0, 295.0, 290.0, -25.0, 20.0, 100.0, 10.0, 60.0, -170.0, 140.0, 330.0, 35.0, 200.0, 145.0, -200.0, 335.0, -95.0, 340.0, -115.0, 100.0, 40.0, -95.0, 150.0, 160.0, -65.0, -95.0, 45.0, 385.0, -100.0, 65.0, -30.0, 310.0, 130.0, 35.0, 30.0, 115.0, -165.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2397805097055044, "mean_inference_ms": 1.710511485707216, "mean_action_processing_ms": 0.6023684976728643, "mean_env_wait_ms": 0.22322045173554514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16496753692626953, "StateBufferConnector_ms": 0.0066144466400146484, "ViewRequirementAgentConnector_ms": 0.3450894355773926}}, "episode_reward_max": 470.0, "episode_reward_min": -325.0, "episode_reward_mean": 47.8, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.0, 5.0, -10.0, 0.0, -15.0, -160.0, -25.0, -50.0, -5.0, 350.0, -45.0, 205.0, 60.0, -35.0, 190.0, 145.0, 125.0, -50.0, -20.0, 175.0, 15.0, -125.0, 55.0, -30.0, 125.0, 145.0, -60.0, 45.0, -35.0, -80.0, -55.0, -50.0, -125.0, 55.0, 0.0, -150.0, 140.0, -325.0, -70.0, -110.0, -15.0, 85.0, 60.0, -55.0, 125.0, 0.0, 30.0, 330.0, -55.0, 180.0, 15.0, 115.0, 145.0, -80.0, 470.0, -135.0, -120.0, 200.0, 160.0, 55.0, 5.0, 130.0, 280.0, -65.0, 295.0, 290.0, -25.0, 20.0, 100.0, 10.0, 60.0, -170.0, 140.0, 330.0, 35.0, 200.0, 145.0, -200.0, 335.0, -95.0, 340.0, -115.0, 100.0, 40.0, -95.0, 150.0, 160.0, -65.0, -95.0, 45.0, 385.0, -100.0, 65.0, -30.0, 310.0, 130.0, 35.0, 30.0, 115.0, -165.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2397805097055044, "mean_inference_ms": 1.710511485707216, "mean_action_processing_ms": 0.6023684976728643, "mean_env_wait_ms": 0.22322045173554514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16496753692626953, "StateBufferConnector_ms": 0.0066144466400146484, "ViewRequirementAgentConnector_ms": 0.3450894355773926}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 409600, "num_agent_steps_trained": 409600, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 85.09790386044602, "num_env_steps_trained_throughput_per_sec": 85.09790386044602, "timesteps_total": 81920, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 409600, "timers": {"training_iteration_time_ms": 98772.549, "sample_time_ms": 15999.148, "load_time_ms": 1.551, "load_throughput": 5282943.829, "learn_time_ms": 82763.066, "learn_throughput": 98.981, "synch_weights_time_ms": 2.357}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 409600, "num_agent_steps_trained": 409600}, "done": false, "episodes_total": 640, "training_iteration": 10, "trial_id": "9fade_00019", "date": "2023-11-09_20-13-28", "timestamp": 1699557208, "time_this_iter_s": 96.28057408332825, "time_total_s": 987.8839251995087, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 987.8839251995087, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.28913043478261, "ram_util_percent": 18.145652173913042}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.2293871204994569, "episode_optimality_min": -1.2777777777777777, "episode_optimality_max": 0.956989247311828, "episode_optimality_capped_mean": 0.2321648982772347, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.956989247311828, "episode_reward_normalized_mean": 19.34, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 93.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.2321648982772347, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.956989247311828}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9945016899767022, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.33363554677028634, "policy_loss": -0.08092778956851059, "vf_loss": 0.40274295381774816, "vf_explained_var": 0.3043657351657748, "kl": 0.017511677281086407, "entropy": 4.710665819942951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 100800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 450560, "num_agent_steps_trained": 450560}, "sampler_results": {"episode_reward_max": 465.0, "episode_reward_min": -200.0, "episode_reward_mean": 96.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.2293871204994569, "episode_optimality_min": -1.2777777777777777, "episode_optimality_max": 0.956989247311828, "episode_optimality_capped_mean": 0.2321648982772347, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.956989247311828, "episode_reward_normalized_mean": 19.34, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 93.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.2321648982772347, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.956989247311828}, "hist_stats": {"episode_reward": [295.0, 290.0, -25.0, 20.0, 100.0, 10.0, 60.0, -170.0, 140.0, 330.0, 35.0, 200.0, 145.0, -200.0, 335.0, -95.0, 340.0, -115.0, 100.0, 40.0, -95.0, 150.0, 160.0, -65.0, -95.0, 45.0, 385.0, -100.0, 65.0, -30.0, 310.0, 130.0, 35.0, 30.0, 115.0, -165.0, 30.0, 90.0, -125.0, -150.0, 250.0, 155.0, 165.0, 185.0, -30.0, 15.0, 180.0, 95.0, 10.0, -35.0, 465.0, -40.0, 70.0, 40.0, 90.0, 195.0, 365.0, 330.0, 85.0, 280.0, 145.0, -85.0, 120.0, 10.0, 110.0, 95.0, 190.0, 120.0, -5.0, 40.0, 40.0, 45.0, 25.0, 290.0, 35.0, 10.0, 310.0, 240.0, 205.0, -105.0, 220.0, 235.0, -140.0, 170.0, 225.0, 40.0, 70.0, 20.0, 445.0, 250.0, 230.0, 95.0, 290.0, -35.0, -40.0, -45.0, 215.0, 115.0, 50.0, 0.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2321599922735598, "mean_inference_ms": 1.6968985288748055, "mean_action_processing_ms": 0.5991107777545747, "mean_env_wait_ms": 0.22156966140095666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16294431686401367, "StateBufferConnector_ms": 0.006453275680541992, "ViewRequirementAgentConnector_ms": 0.33669614791870117}}, "episode_reward_max": 465.0, "episode_reward_min": -200.0, "episode_reward_mean": 96.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.0, 290.0, -25.0, 20.0, 100.0, 10.0, 60.0, -170.0, 140.0, 330.0, 35.0, 200.0, 145.0, -200.0, 335.0, -95.0, 340.0, -115.0, 100.0, 40.0, -95.0, 150.0, 160.0, -65.0, -95.0, 45.0, 385.0, -100.0, 65.0, -30.0, 310.0, 130.0, 35.0, 30.0, 115.0, -165.0, 30.0, 90.0, -125.0, -150.0, 250.0, 155.0, 165.0, 185.0, -30.0, 15.0, 180.0, 95.0, 10.0, -35.0, 465.0, -40.0, 70.0, 40.0, 90.0, 195.0, 365.0, 330.0, 85.0, 280.0, 145.0, -85.0, 120.0, 10.0, 110.0, 95.0, 190.0, 120.0, -5.0, 40.0, 40.0, 45.0, 25.0, 290.0, 35.0, 10.0, 310.0, 240.0, 205.0, -105.0, 220.0, 235.0, -140.0, 170.0, 225.0, 40.0, 70.0, 20.0, 445.0, 250.0, 230.0, 95.0, 290.0, -35.0, -40.0, -45.0, 215.0, 115.0, 50.0, 0.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2321599922735598, "mean_inference_ms": 1.6968985288748055, "mean_action_processing_ms": 0.5991107777545747, "mean_env_wait_ms": 0.22156966140095666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16294431686401367, "StateBufferConnector_ms": 0.006453275680541992, "ViewRequirementAgentConnector_ms": 0.33669614791870117}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450560, "num_agent_steps_trained": 450560, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 86.41808625404062, "num_env_steps_trained_throughput_per_sec": 86.41808625404062, "timesteps_total": 90112, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 450560, "timers": {"training_iteration_time_ms": 97280.023, "sample_time_ms": 15142.645, "load_time_ms": 1.745, "load_throughput": 4693953.329, "learn_time_ms": 82126.732, "learn_throughput": 99.748, "synch_weights_time_ms": 2.356}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 450560, "num_agent_steps_trained": 450560}, "done": false, "episodes_total": 704, "training_iteration": 11, "trial_id": "9fade_00019", "date": "2023-11-09_20-15-03", "timestamp": 1699557303, "time_this_iter_s": 94.81157732009888, "time_total_s": 1082.6955025196075, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1082.6955025196075, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.77185185185184, "ram_util_percent": 18.379259259259257}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.30781210694161676, "episode_optimality_min": -0.6896551724137931, "episode_optimality_max": 0.956989247311828, "episode_optimality_capped_mean": 0.30781210694161676, "episode_optimality_capped_min": -0.6896551724137931, "episode_optimality_capped_max": 0.956989247311828, "episode_reward_normalized_mean": 23.05, "episode_reward_normalized_min": -30.0, "episode_reward_normalized_max": 89.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.30781210694161676, "curr_learning_score_min": -0.6896551724137931, "curr_learning_score_max": 0.956989247311828}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9907670119466881, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.33791103232239644, "policy_loss": -0.07638163319725814, "vf_loss": 0.4030227449152153, "vf_explained_var": 0.3082575569488108, "kl": 0.016696178250081743, "entropy": 4.694509245256583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 110400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 491520, "num_agent_steps_trained": 491520}, "sampler_results": {"episode_reward_max": 445.0, "episode_reward_min": -150.0, "episode_reward_mean": 115.25, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.30781210694161676, "episode_optimality_min": -0.6896551724137931, "episode_optimality_max": 0.956989247311828, "episode_optimality_capped_mean": 0.30781210694161676, "episode_optimality_capped_min": -0.6896551724137931, "episode_optimality_capped_max": 0.956989247311828, "episode_reward_normalized_mean": 23.05, "episode_reward_normalized_min": -30.0, "episode_reward_normalized_max": 89.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.30781210694161676, "curr_learning_score_min": -0.6896551724137931, "curr_learning_score_max": 0.956989247311828}, "hist_stats": {"episode_reward": [110.0, 95.0, 190.0, 120.0, -5.0, 40.0, 40.0, 45.0, 25.0, 290.0, 35.0, 10.0, 310.0, 240.0, 205.0, -105.0, 220.0, 235.0, -140.0, 170.0, 225.0, 40.0, 70.0, 20.0, 445.0, 250.0, 230.0, 95.0, 290.0, -35.0, -40.0, -45.0, 215.0, 115.0, 50.0, 0.0, 65.0, 15.0, 175.0, -30.0, 370.0, 180.0, 380.0, 360.0, -55.0, 125.0, -60.0, 20.0, 185.0, 0.0, 280.0, 35.0, 240.0, 100.0, -85.0, 270.0, 230.0, 150.0, -150.0, -115.0, 85.0, 245.0, -85.0, 150.0, -50.0, 290.0, 80.0, 50.0, 215.0, 40.0, 90.0, 320.0, 315.0, 65.0, 265.0, 365.0, 190.0, 135.0, -20.0, -90.0, 205.0, 225.0, -100.0, 40.0, 390.0, 230.0, -45.0, -10.0, 125.0, -80.0, 15.0, -95.0, 200.0, 60.0, 145.0, 200.0, 155.0, 170.0, 225.0, 75.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2253165957301677, "mean_inference_ms": 1.6824183528052463, "mean_action_processing_ms": 0.5961686540961285, "mean_env_wait_ms": 0.2198923123143803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16247034072875977, "StateBufferConnector_ms": 0.006434917449951172, "ViewRequirementAgentConnector_ms": 0.33574652671813965}}, "episode_reward_max": 445.0, "episode_reward_min": -150.0, "episode_reward_mean": 115.25, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [110.0, 95.0, 190.0, 120.0, -5.0, 40.0, 40.0, 45.0, 25.0, 290.0, 35.0, 10.0, 310.0, 240.0, 205.0, -105.0, 220.0, 235.0, -140.0, 170.0, 225.0, 40.0, 70.0, 20.0, 445.0, 250.0, 230.0, 95.0, 290.0, -35.0, -40.0, -45.0, 215.0, 115.0, 50.0, 0.0, 65.0, 15.0, 175.0, -30.0, 370.0, 180.0, 380.0, 360.0, -55.0, 125.0, -60.0, 20.0, 185.0, 0.0, 280.0, 35.0, 240.0, 100.0, -85.0, 270.0, 230.0, 150.0, -150.0, -115.0, 85.0, 245.0, -85.0, 150.0, -50.0, 290.0, 80.0, 50.0, 215.0, 40.0, 90.0, 320.0, 315.0, 65.0, 265.0, 365.0, 190.0, 135.0, -20.0, -90.0, 205.0, 225.0, -100.0, 40.0, 390.0, 230.0, -45.0, -10.0, 125.0, -80.0, 15.0, -95.0, 200.0, 60.0, 145.0, 200.0, 155.0, 170.0, 225.0, 75.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2253165957301677, "mean_inference_ms": 1.6824183528052463, "mean_action_processing_ms": 0.5961686540961285, "mean_env_wait_ms": 0.2198923123143803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16247034072875977, "StateBufferConnector_ms": 0.006434917449951172, "ViewRequirementAgentConnector_ms": 0.33574652671813965}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 491520, "num_agent_steps_trained": 491520, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 84.73274506231827, "num_env_steps_trained_throughput_per_sec": 84.73274506231827, "timesteps_total": 98304, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 491520, "timers": {"training_iteration_time_ms": 97540.672, "sample_time_ms": 15174.951, "load_time_ms": 1.776, "load_throughput": 4613098.072, "learn_time_ms": 82354.922, "learn_throughput": 99.472, "synch_weights_time_ms": 2.366}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 491520, "num_agent_steps_trained": 491520}, "done": false, "episodes_total": 768, "training_iteration": 12, "trial_id": "9fade_00019", "date": "2023-11-09_20-16-40", "timestamp": 1699557400, "time_this_iter_s": 96.69195938110352, "time_total_s": 1179.387461900711, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1179.387461900711, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 38.52554744525548, "ram_util_percent": 18.610218978102186}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.346237123049801, "episode_optimality_min": -4.0, "episode_optimality_max": 0.9385964912280702, "episode_optimality_capped_mean": 0.3762371230498009, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9385964912280702, "episode_reward_normalized_mean": 28.87, "episode_reward_normalized_min": -56.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.3762371230498009, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9385964912280702}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9855667751282453, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.32774269430738057, "policy_loss": -0.07570869632615844, "vf_loss": 0.3921843832440209, "vf_explained_var": 0.3156822762017449, "kl": 0.016691862009510602, "entropy": 4.6224305582543215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 532480, "num_agent_steps_trained": 532480}, "sampler_results": {"episode_reward_max": 535.0, "episode_reward_min": -280.0, "episode_reward_mean": 144.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.346237123049801, "episode_optimality_min": -4.0, "episode_optimality_max": 0.9385964912280702, "episode_optimality_capped_mean": 0.3762371230498009, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9385964912280702, "episode_reward_normalized_mean": 28.87, "episode_reward_normalized_min": -56.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.3762371230498009, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9385964912280702}, "hist_stats": {"episode_reward": [-50.0, 290.0, 80.0, 50.0, 215.0, 40.0, 90.0, 320.0, 315.0, 65.0, 265.0, 365.0, 190.0, 135.0, -20.0, -90.0, 205.0, 225.0, -100.0, 40.0, 390.0, 230.0, -45.0, -10.0, 125.0, -80.0, 15.0, -95.0, 200.0, 60.0, 145.0, 200.0, 155.0, 170.0, 225.0, 75.0, -280.0, 70.0, 415.0, 420.0, 275.0, 85.0, 195.0, 80.0, 40.0, 75.0, 280.0, 385.0, 180.0, 115.0, 310.0, 265.0, 125.0, 140.0, 95.0, 195.0, -140.0, 85.0, -25.0, 240.0, 295.0, 70.0, 30.0, 270.0, -40.0, 295.0, 200.0, 425.0, 315.0, 535.0, 405.0, 0.0, 220.0, 150.0, 160.0, 175.0, 220.0, 205.0, -115.0, -85.0, -20.0, 90.0, -55.0, 465.0, 30.0, 140.0, 220.0, -15.0, 310.0, 315.0, 40.0, 230.0, 135.0, 55.0, 195.0, -120.0, 200.0, 225.0, 220.0, 30.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2203202644229194, "mean_inference_ms": 1.6733027176166206, "mean_action_processing_ms": 0.5939858731576894, "mean_env_wait_ms": 0.21891033632921286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1634232997894287, "StateBufferConnector_ms": 0.0066416263580322266, "ViewRequirementAgentConnector_ms": 0.3412952423095703}}, "episode_reward_max": 535.0, "episode_reward_min": -280.0, "episode_reward_mean": 144.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, 290.0, 80.0, 50.0, 215.0, 40.0, 90.0, 320.0, 315.0, 65.0, 265.0, 365.0, 190.0, 135.0, -20.0, -90.0, 205.0, 225.0, -100.0, 40.0, 390.0, 230.0, -45.0, -10.0, 125.0, -80.0, 15.0, -95.0, 200.0, 60.0, 145.0, 200.0, 155.0, 170.0, 225.0, 75.0, -280.0, 70.0, 415.0, 420.0, 275.0, 85.0, 195.0, 80.0, 40.0, 75.0, 280.0, 385.0, 180.0, 115.0, 310.0, 265.0, 125.0, 140.0, 95.0, 195.0, -140.0, 85.0, -25.0, 240.0, 295.0, 70.0, 30.0, 270.0, -40.0, 295.0, 200.0, 425.0, 315.0, 535.0, 405.0, 0.0, 220.0, 150.0, 160.0, 175.0, 220.0, 205.0, -115.0, -85.0, -20.0, 90.0, -55.0, 465.0, 30.0, 140.0, 220.0, -15.0, 310.0, 315.0, 40.0, 230.0, 135.0, 55.0, 195.0, -120.0, 200.0, 225.0, 220.0, 30.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2203202644229194, "mean_inference_ms": 1.6733027176166206, "mean_action_processing_ms": 0.5939858731576894, "mean_env_wait_ms": 0.21891033632921286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1634232997894287, "StateBufferConnector_ms": 0.0066416263580322266, "ViewRequirementAgentConnector_ms": 0.3412952423095703}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532480, "num_agent_steps_trained": 532480, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 84.9494082938158, "num_env_steps_trained_throughput_per_sec": 84.9494082938158, "timesteps_total": 106496, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 532480, "timers": {"training_iteration_time_ms": 97208.661, "sample_time_ms": 15140.61, "load_time_ms": 1.807, "load_throughput": 4534502.384, "learn_time_ms": 82057.204, "learn_throughput": 99.833, "synch_weights_time_ms": 2.34}, "counters": {"num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 532480, "num_agent_steps_trained": 532480}, "done": false, "episodes_total": 832, "training_iteration": 13, "trial_id": "9fade_00019", "date": "2023-11-09_20-18-16", "timestamp": 1699557496, "time_this_iter_s": 96.45070219039917, "time_total_s": 1275.8381640911102, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1275.8381640911102, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.95766423357665, "ram_util_percent": 18.702919708029196}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.36713718982845167, "episode_optimality_min": -4.0, "episode_optimality_max": 0.9651162790697675, "episode_optimality_capped_mean": 0.39713718982845164, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9651162790697675, "episode_reward_normalized_mean": 31.72, "episode_reward_normalized_min": -74.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.39713718982845164, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9651162790697675}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9914416032657027, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.3383270083562335, "policy_loss": -0.07525649698608806, "vf_loss": 0.40229020761093126, "vf_explained_var": 0.32523696788897116, "kl": 0.016730811014223263, "entropy": 4.5869295933594305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 129600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 573440, "num_agent_steps_trained": 573440}, "sampler_results": {"episode_reward_max": 535.0, "episode_reward_min": -370.0, "episode_reward_mean": 158.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.36713718982845167, "episode_optimality_min": -4.0, "episode_optimality_max": 0.9651162790697675, "episode_optimality_capped_mean": 0.39713718982845164, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9651162790697675, "episode_reward_normalized_mean": 31.72, "episode_reward_normalized_min": -74.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.39713718982845164, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9651162790697675}, "hist_stats": {"episode_reward": [-40.0, 295.0, 200.0, 425.0, 315.0, 535.0, 405.0, 0.0, 220.0, 150.0, 160.0, 175.0, 220.0, 205.0, -115.0, -85.0, -20.0, 90.0, -55.0, 465.0, 30.0, 140.0, 220.0, -15.0, 310.0, 315.0, 40.0, 230.0, 135.0, 55.0, 195.0, -120.0, 200.0, 225.0, 220.0, 30.0, 440.0, -370.0, 230.0, 325.0, 210.0, 70.0, 100.0, 15.0, 260.0, 95.0, 35.0, -50.0, -130.0, 365.0, 225.0, 200.0, 50.0, 35.0, 395.0, 260.0, -120.0, 165.0, -15.0, 135.0, 490.0, 205.0, 210.0, -140.0, -15.0, 240.0, 95.0, -30.0, 170.0, 245.0, 260.0, -100.0, -205.0, 390.0, 385.0, 65.0, 90.0, 140.0, -25.0, 290.0, 235.0, 200.0, 250.0, 50.0, 390.0, 120.0, 195.0, -70.0, 310.0, 285.0, 55.0, 385.0, 310.0, -20.0, 425.0, 80.0, 245.0, 415.0, 310.0, 250.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2159412618108376, "mean_inference_ms": 1.664244372948297, "mean_action_processing_ms": 0.592162732300527, "mean_env_wait_ms": 0.21787429603271072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16251254081726074, "StateBufferConnector_ms": 0.006593942642211914, "ViewRequirementAgentConnector_ms": 0.33931708335876465}}, "episode_reward_max": 535.0, "episode_reward_min": -370.0, "episode_reward_mean": 158.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.0, 295.0, 200.0, 425.0, 315.0, 535.0, 405.0, 0.0, 220.0, 150.0, 160.0, 175.0, 220.0, 205.0, -115.0, -85.0, -20.0, 90.0, -55.0, 465.0, 30.0, 140.0, 220.0, -15.0, 310.0, 315.0, 40.0, 230.0, 135.0, 55.0, 195.0, -120.0, 200.0, 225.0, 220.0, 30.0, 440.0, -370.0, 230.0, 325.0, 210.0, 70.0, 100.0, 15.0, 260.0, 95.0, 35.0, -50.0, -130.0, 365.0, 225.0, 200.0, 50.0, 35.0, 395.0, 260.0, -120.0, 165.0, -15.0, 135.0, 490.0, 205.0, 210.0, -140.0, -15.0, 240.0, 95.0, -30.0, 170.0, 245.0, 260.0, -100.0, -205.0, 390.0, 385.0, 65.0, 90.0, 140.0, -25.0, 290.0, 235.0, 200.0, 250.0, 50.0, 390.0, 120.0, 195.0, -70.0, 310.0, 285.0, 55.0, 385.0, 310.0, -20.0, 425.0, 80.0, 245.0, 415.0, 310.0, 250.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2159412618108376, "mean_inference_ms": 1.664244372948297, "mean_action_processing_ms": 0.592162732300527, "mean_env_wait_ms": 0.21787429603271072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16251254081726074, "StateBufferConnector_ms": 0.006593942642211914, "ViewRequirementAgentConnector_ms": 0.33931708335876465}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 573440, "num_agent_steps_trained": 573440, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 86.50788629495098, "num_env_steps_trained_throughput_per_sec": 86.50788629495098, "timesteps_total": 114688, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 573440, "timers": {"training_iteration_time_ms": 96698.127, "sample_time_ms": 15036.892, "load_time_ms": 1.809, "load_throughput": 4528108.271, "learn_time_ms": 81650.469, "learn_throughput": 100.33, "synch_weights_time_ms": 2.334}, "counters": {"num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 573440, "num_agent_steps_trained": 573440}, "done": false, "episodes_total": 896, "training_iteration": 14, "trial_id": "9fade_00019", "date": "2023-11-09_20-19-51", "timestamp": 1699557591, "time_this_iter_s": 94.71367454528809, "time_total_s": 1370.5518386363983, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1370.5518386363983, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.85777777777778, "ram_util_percent": 18.631851851851852}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4284503664011697, "episode_optimality_min": -1.0185185185185186, "episode_optimality_max": 0.9916666666666667, "episode_optimality_capped_mean": 0.42863555158635486, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9916666666666667, "episode_reward_normalized_mean": 34.17, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.42863555158635486, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9916666666666667}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9910766910885771, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.3102354588004528, "policy_loss": -0.07622065574090811, "vf_loss": 0.3752661361852612, "vf_explained_var": 0.3466684397372107, "kl": 0.016577744464849123, "entropy": 4.528854262630145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 139200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 614400, "num_agent_steps_trained": 614400}, "sampler_results": {"episode_reward_max": 595.0, "episode_reward_min": -275.0, "episode_reward_mean": 170.85, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4284503664011697, "episode_optimality_min": -1.0185185185185186, "episode_optimality_max": 0.9916666666666667, "episode_optimality_capped_mean": 0.42863555158635486, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9916666666666667, "episode_reward_normalized_mean": 34.17, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.42863555158635486, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9916666666666667}, "hist_stats": {"episode_reward": [-15.0, 240.0, 95.0, -30.0, 170.0, 245.0, 260.0, -100.0, -205.0, 390.0, 385.0, 65.0, 90.0, 140.0, -25.0, 290.0, 235.0, 200.0, 250.0, 50.0, 390.0, 120.0, 195.0, -70.0, 310.0, 285.0, 55.0, 385.0, 310.0, -20.0, 425.0, 80.0, 245.0, 415.0, 310.0, 250.0, -180.0, 200.0, 45.0, 115.0, 220.0, 210.0, 235.0, 420.0, -5.0, 460.0, 315.0, 90.0, 285.0, 335.0, 220.0, 325.0, 40.0, 160.0, 425.0, 275.0, -90.0, 55.0, 60.0, 115.0, -105.0, 145.0, 110.0, 375.0, -180.0, 35.0, 110.0, 190.0, 185.0, -70.0, 45.0, 510.0, 320.0, -275.0, 465.0, 270.0, 225.0, 195.0, -40.0, 330.0, 595.0, 295.0, -155.0, 185.0, 135.0, 510.0, 20.0, 120.0, -135.0, 120.0, 175.0, 135.0, 340.0, 260.0, 335.0, 170.0, 10.0, 150.0, 100.0, 135.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2124319603465892, "mean_inference_ms": 1.6579063225700696, "mean_action_processing_ms": 0.5907207143349881, "mean_env_wait_ms": 0.2171762430832236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1627202033996582, "StateBufferConnector_ms": 0.00665283203125, "ViewRequirementAgentConnector_ms": 0.3411219120025635}}, "episode_reward_max": 595.0, "episode_reward_min": -275.0, "episode_reward_mean": 170.85, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-15.0, 240.0, 95.0, -30.0, 170.0, 245.0, 260.0, -100.0, -205.0, 390.0, 385.0, 65.0, 90.0, 140.0, -25.0, 290.0, 235.0, 200.0, 250.0, 50.0, 390.0, 120.0, 195.0, -70.0, 310.0, 285.0, 55.0, 385.0, 310.0, -20.0, 425.0, 80.0, 245.0, 415.0, 310.0, 250.0, -180.0, 200.0, 45.0, 115.0, 220.0, 210.0, 235.0, 420.0, -5.0, 460.0, 315.0, 90.0, 285.0, 335.0, 220.0, 325.0, 40.0, 160.0, 425.0, 275.0, -90.0, 55.0, 60.0, 115.0, -105.0, 145.0, 110.0, 375.0, -180.0, 35.0, 110.0, 190.0, 185.0, -70.0, 45.0, 510.0, 320.0, -275.0, 465.0, 270.0, 225.0, 195.0, -40.0, 330.0, 595.0, 295.0, -155.0, 185.0, 135.0, 510.0, 20.0, 120.0, -135.0, 120.0, 175.0, 135.0, 340.0, 260.0, 335.0, 170.0, 10.0, 150.0, 100.0, 135.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2124319603465892, "mean_inference_ms": 1.6579063225700696, "mean_action_processing_ms": 0.5907207143349881, "mean_env_wait_ms": 0.2171762430832236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1627202033996582, "StateBufferConnector_ms": 0.00665283203125, "ViewRequirementAgentConnector_ms": 0.3411219120025635}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 614400, "num_agent_steps_trained": 614400, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 85.98891304669084, "num_env_steps_trained_throughput_per_sec": 85.98891304669084, "timesteps_total": 122880, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 614400, "timers": {"training_iteration_time_ms": 96254.233, "sample_time_ms": 14846.748, "load_time_ms": 1.856, "load_throughput": 4413015.46, "learn_time_ms": 81396.736, "learn_throughput": 100.643, "synch_weights_time_ms": 2.314}, "counters": {"num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 614400, "num_agent_steps_trained": 614400}, "done": false, "episodes_total": 960, "training_iteration": 15, "trial_id": "9fade_00019", "date": "2023-11-09_20-21-26", "timestamp": 1699557686, "time_this_iter_s": 95.2872531414032, "time_total_s": 1465.8390917778015, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1465.8390917778015, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.409558823529416, "ram_util_percent": 18.5125}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.433035568263755, "episode_optimality_min": -1.0185185185185186, "episode_optimality_max": 0.9916666666666667, "episode_optimality_capped_mean": 0.4332207534489402, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9916666666666667, "episode_reward_normalized_mean": 32.3, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4332207534489402, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9916666666666667}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9936231687354545, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.3005705471027856, "policy_loss": -0.07267851971235359, "vf_loss": 0.36204783532186413, "vf_explained_var": 0.35256425878653924, "kl": 0.016594416910763434, "entropy": 4.548662109399835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 148800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 655360, "num_agent_steps_trained": 655360}, "sampler_results": {"episode_reward_max": 595.0, "episode_reward_min": -275.0, "episode_reward_mean": 161.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.433035568263755, "episode_optimality_min": -1.0185185185185186, "episode_optimality_max": 0.9916666666666667, "episode_optimality_capped_mean": 0.4332207534489402, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9916666666666667, "episode_reward_normalized_mean": 32.3, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4332207534489402, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9916666666666667}, "hist_stats": {"episode_reward": [-180.0, 35.0, 110.0, 190.0, 185.0, -70.0, 45.0, 510.0, 320.0, -275.0, 465.0, 270.0, 225.0, 195.0, -40.0, 330.0, 595.0, 295.0, -155.0, 185.0, 135.0, 510.0, 20.0, 120.0, -135.0, 120.0, 175.0, 135.0, 340.0, 260.0, 335.0, 170.0, 10.0, 150.0, 100.0, 135.0, 280.0, 355.0, 5.0, -5.0, -30.0, 180.0, 180.0, 290.0, 310.0, 145.0, 105.0, 290.0, 395.0, 170.0, 40.0, 165.0, -155.0, 130.0, 60.0, 270.0, 125.0, 120.0, 155.0, 350.0, 265.0, 60.0, 95.0, 195.0, 245.0, 180.0, 155.0, 340.0, 145.0, 110.0, 410.0, -50.0, 315.0, 65.0, -75.0, 205.0, -215.0, 320.0, 410.0, 200.0, 185.0, 190.0, 100.0, -120.0, -50.0, 85.0, 10.0, 155.0, 385.0, 290.0, 100.0, 200.0, 290.0, 25.0, 165.0, 205.0, 400.0, 70.0, -5.0, 350.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.208826624638077, "mean_inference_ms": 1.6528229531250684, "mean_action_processing_ms": 0.5891181976252857, "mean_env_wait_ms": 0.2173446426097945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16293811798095703, "StateBufferConnector_ms": 0.0066106319427490234, "ViewRequirementAgentConnector_ms": 0.34078311920166016}}, "episode_reward_max": 595.0, "episode_reward_min": -275.0, "episode_reward_mean": 161.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180.0, 35.0, 110.0, 190.0, 185.0, -70.0, 45.0, 510.0, 320.0, -275.0, 465.0, 270.0, 225.0, 195.0, -40.0, 330.0, 595.0, 295.0, -155.0, 185.0, 135.0, 510.0, 20.0, 120.0, -135.0, 120.0, 175.0, 135.0, 340.0, 260.0, 335.0, 170.0, 10.0, 150.0, 100.0, 135.0, 280.0, 355.0, 5.0, -5.0, -30.0, 180.0, 180.0, 290.0, 310.0, 145.0, 105.0, 290.0, 395.0, 170.0, 40.0, 165.0, -155.0, 130.0, 60.0, 270.0, 125.0, 120.0, 155.0, 350.0, 265.0, 60.0, 95.0, 195.0, 245.0, 180.0, 155.0, 340.0, 145.0, 110.0, 410.0, -50.0, 315.0, 65.0, -75.0, 205.0, -215.0, 320.0, 410.0, 200.0, 185.0, 190.0, 100.0, -120.0, -50.0, 85.0, 10.0, 155.0, 385.0, 290.0, 100.0, 200.0, 290.0, 25.0, 165.0, 205.0, 400.0, 70.0, -5.0, 350.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.208826624638077, "mean_inference_ms": 1.6528229531250684, "mean_action_processing_ms": 0.5891181976252857, "mean_env_wait_ms": 0.2173446426097945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16293811798095703, "StateBufferConnector_ms": 0.0066106319427490234, "ViewRequirementAgentConnector_ms": 0.34078311920166016}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 655360, "num_agent_steps_trained": 655360, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 87.96149903039117, "num_env_steps_trained_throughput_per_sec": 87.96149903039117, "timesteps_total": 131072, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 655360, "timers": {"training_iteration_time_ms": 95549.881, "sample_time_ms": 14754.587, "load_time_ms": 1.838, "load_throughput": 4457151.911, "learn_time_ms": 80784.602, "learn_throughput": 101.405, "synch_weights_time_ms": 2.294}, "counters": {"num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 655360, "num_agent_steps_trained": 655360}, "done": false, "episodes_total": 1024, "training_iteration": 16, "trial_id": "9fade_00019", "date": "2023-11-09_20-23-00", "timestamp": 1699557780, "time_this_iter_s": 93.14678597450256, "time_total_s": 1558.985877752304, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1558.985877752304, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.11428571428571, "ram_util_percent": 18.59699248120301}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.39245700534740463, "episode_optimality_min": -1.0714285714285714, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.3931712910616904, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 31.06, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 112.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.3931712910616904, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9867357787210495, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2850997694655962, "policy_loss": -0.07449879324466262, "vf_loss": 0.34838165430240525, "vf_explained_var": 0.3405050093804797, "kl": 0.016617641832469873, "entropy": 4.468006313045819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 158400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 696320, "num_agent_steps_trained": 696320}, "sampler_results": {"episode_reward_max": 560.0, "episode_reward_min": -340.0, "episode_reward_mean": 155.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.39245700534740463, "episode_optimality_min": -1.0714285714285714, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.3931712910616904, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 31.06, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 112.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.3931712910616904, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [245.0, 180.0, 155.0, 340.0, 145.0, 110.0, 410.0, -50.0, 315.0, 65.0, -75.0, 205.0, -215.0, 320.0, 410.0, 200.0, 185.0, 190.0, 100.0, -120.0, -50.0, 85.0, 10.0, 155.0, 385.0, 290.0, 100.0, 200.0, 290.0, 25.0, 165.0, 205.0, 400.0, 70.0, -5.0, 350.0, 20.0, 115.0, 120.0, 215.0, 70.0, 10.0, -115.0, 405.0, 485.0, 60.0, 215.0, -190.0, 325.0, 50.0, -325.0, 440.0, -150.0, 0.0, 305.0, 135.0, -25.0, 280.0, 235.0, 195.0, 145.0, 10.0, 275.0, -40.0, 80.0, 160.0, 25.0, 105.0, 380.0, 130.0, 430.0, 15.0, 200.0, 520.0, 165.0, 470.0, 245.0, 20.0, 220.0, 40.0, 520.0, 105.0, 340.0, -20.0, 195.0, 230.0, 560.0, 55.0, 360.0, -340.0, 125.0, 270.0, 15.0, -180.0, 120.0, 440.0, -45.0, 45.0, 265.0, 210.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2052323443161175, "mean_inference_ms": 1.6467643277160187, "mean_action_processing_ms": 0.5873855612261734, "mean_env_wait_ms": 0.21743703317121862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16110563278198242, "StateBufferConnector_ms": 0.006476879119873047, "ViewRequirementAgentConnector_ms": 0.3361365795135498}}, "episode_reward_max": 560.0, "episode_reward_min": -340.0, "episode_reward_mean": 155.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [245.0, 180.0, 155.0, 340.0, 145.0, 110.0, 410.0, -50.0, 315.0, 65.0, -75.0, 205.0, -215.0, 320.0, 410.0, 200.0, 185.0, 190.0, 100.0, -120.0, -50.0, 85.0, 10.0, 155.0, 385.0, 290.0, 100.0, 200.0, 290.0, 25.0, 165.0, 205.0, 400.0, 70.0, -5.0, 350.0, 20.0, 115.0, 120.0, 215.0, 70.0, 10.0, -115.0, 405.0, 485.0, 60.0, 215.0, -190.0, 325.0, 50.0, -325.0, 440.0, -150.0, 0.0, 305.0, 135.0, -25.0, 280.0, 235.0, 195.0, 145.0, 10.0, 275.0, -40.0, 80.0, 160.0, 25.0, 105.0, 380.0, 130.0, 430.0, 15.0, 200.0, 520.0, 165.0, 470.0, 245.0, 20.0, 220.0, 40.0, 520.0, 105.0, 340.0, -20.0, 195.0, 230.0, 560.0, 55.0, 360.0, -340.0, 125.0, 270.0, 15.0, -180.0, 120.0, 440.0, -45.0, 45.0, 265.0, 210.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2052323443161175, "mean_inference_ms": 1.6467643277160187, "mean_action_processing_ms": 0.5873855612261734, "mean_env_wait_ms": 0.21743703317121862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16110563278198242, "StateBufferConnector_ms": 0.006476879119873047, "ViewRequirementAgentConnector_ms": 0.3361365795135498}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696320, "num_agent_steps_trained": 696320, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 87.53155447531216, "num_env_steps_trained_throughput_per_sec": 87.53155447531216, "timesteps_total": 139264, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 696320, "timers": {"training_iteration_time_ms": 95236.91, "sample_time_ms": 14632.607, "load_time_ms": 1.849, "load_throughput": 4430313.369, "learn_time_ms": 80593.617, "learn_throughput": 101.646, "synch_weights_time_ms": 2.314}, "counters": {"num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 696320, "num_agent_steps_trained": 696320}, "done": false, "episodes_total": 1088, "training_iteration": 17, "trial_id": "9fade_00019", "date": "2023-11-09_20-24-33", "timestamp": 1699557873, "time_this_iter_s": 93.61060571670532, "time_total_s": 1652.5964834690094, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1652.5964834690094, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.53157894736842, "ram_util_percent": 18.373684210526317}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.534827194055811, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.534827194055811, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.27, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.534827194055811, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9769438443208734, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2546697169455001, "policy_loss": -0.06904036924980271, "vf_loss": 0.3132914191417027, "vf_explained_var": 0.3926866053727766, "kl": 0.015435061011778165, "entropy": 4.411111846988399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 168000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 737280, "num_agent_steps_trained": 737280}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -340.0, "episode_reward_mean": 206.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.534827194055811, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.534827194055811, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.27, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.534827194055811, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [80.0, 160.0, 25.0, 105.0, 380.0, 130.0, 430.0, 15.0, 200.0, 520.0, 165.0, 470.0, 245.0, 20.0, 220.0, 40.0, 520.0, 105.0, 340.0, -20.0, 195.0, 230.0, 560.0, 55.0, 360.0, -340.0, 125.0, 270.0, 15.0, -180.0, 120.0, 440.0, -45.0, 45.0, 265.0, 210.0, -5.0, 250.0, 335.0, 105.0, 10.0, 335.0, 400.0, 315.0, 115.0, 130.0, 125.0, 40.0, 145.0, 385.0, 210.0, 275.0, -5.0, 100.0, 295.0, 75.0, 205.0, -90.0, 580.0, 290.0, 140.0, 335.0, 405.0, 185.0, 110.0, 435.0, 105.0, 310.0, 100.0, 85.0, 60.0, 200.0, 455.0, 450.0, 450.0, 10.0, 295.0, 445.0, 255.0, 270.0, 360.0, 215.0, -35.0, 350.0, 145.0, 425.0, 105.0, 55.0, 340.0, 175.0, 375.0, 495.0, -160.0, 255.0, 350.0, 535.0, 135.0, -200.0, 315.0, 205.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2012828065582852, "mean_inference_ms": 1.6389224824861695, "mean_action_processing_ms": 0.5855739914102575, "mean_env_wait_ms": 0.2164390747764003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16030168533325195, "StateBufferConnector_ms": 0.0064203739166259766, "ViewRequirementAgentConnector_ms": 0.3316609859466553}}, "episode_reward_max": 580.0, "episode_reward_min": -340.0, "episode_reward_mean": 206.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0, 160.0, 25.0, 105.0, 380.0, 130.0, 430.0, 15.0, 200.0, 520.0, 165.0, 470.0, 245.0, 20.0, 220.0, 40.0, 520.0, 105.0, 340.0, -20.0, 195.0, 230.0, 560.0, 55.0, 360.0, -340.0, 125.0, 270.0, 15.0, -180.0, 120.0, 440.0, -45.0, 45.0, 265.0, 210.0, -5.0, 250.0, 335.0, 105.0, 10.0, 335.0, 400.0, 315.0, 115.0, 130.0, 125.0, 40.0, 145.0, 385.0, 210.0, 275.0, -5.0, 100.0, 295.0, 75.0, 205.0, -90.0, 580.0, 290.0, 140.0, 335.0, 405.0, 185.0, 110.0, 435.0, 105.0, 310.0, 100.0, 85.0, 60.0, 200.0, 455.0, 450.0, 450.0, 10.0, 295.0, 445.0, 255.0, 270.0, 360.0, 215.0, -35.0, 350.0, 145.0, 425.0, 105.0, 55.0, 340.0, 175.0, 375.0, 495.0, -160.0, 255.0, 350.0, 535.0, 135.0, -200.0, 315.0, 205.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2012828065582852, "mean_inference_ms": 1.6389224824861695, "mean_action_processing_ms": 0.5855739914102575, "mean_env_wait_ms": 0.2164390747764003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16030168533325195, "StateBufferConnector_ms": 0.0064203739166259766, "ViewRequirementAgentConnector_ms": 0.3316609859466553}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 737280, "num_agent_steps_trained": 737280, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 88.00376161061408, "num_env_steps_trained_throughput_per_sec": 88.00376161061408, "timesteps_total": 147456, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 737280, "timers": {"training_iteration_time_ms": 94998.814, "sample_time_ms": 14664.209, "load_time_ms": 1.823, "load_throughput": 4493348.638, "learn_time_ms": 80324.073, "learn_throughput": 101.987, "synch_weights_time_ms": 2.297}, "counters": {"num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 737280, "num_agent_steps_trained": 737280}, "done": false, "episodes_total": 1152, "training_iteration": 18, "trial_id": "9fade_00019", "date": "2023-11-09_20-26-06", "timestamp": 1699557966, "time_this_iter_s": 93.09820508956909, "time_total_s": 1745.6946885585785, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1745.6946885585785, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.712030075187975, "ram_util_percent": 18.48345864661654}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.531658178462185, "episode_optimality_min": -1.75, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5391581784621851, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.69, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5391581784621851, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9858991779293865, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2990885409157151, "policy_loss": -0.07113395053888477, "vf_loss": 0.35937106518783063, "vf_explained_var": 0.3572777086434265, "kl": 0.016076186864085382, "entropy": 4.4481298652788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 177600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 778240, "num_agent_steps_trained": 778240}, "sampler_results": {"episode_reward_max": 555.0, "episode_reward_min": -290.0, "episode_reward_mean": 213.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.531658178462185, "episode_optimality_min": -1.75, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5391581784621851, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.69, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5391581784621851, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [110.0, 435.0, 105.0, 310.0, 100.0, 85.0, 60.0, 200.0, 455.0, 450.0, 450.0, 10.0, 295.0, 445.0, 255.0, 270.0, 360.0, 215.0, -35.0, 350.0, 145.0, 425.0, 105.0, 55.0, 340.0, 175.0, 375.0, 495.0, -160.0, 255.0, 350.0, 535.0, 135.0, -200.0, 315.0, 205.0, 280.0, 330.0, -80.0, 395.0, -75.0, 225.0, 235.0, 395.0, 185.0, -50.0, 100.0, 210.0, 105.0, -35.0, 160.0, 60.0, 145.0, 395.0, 390.0, 250.0, -65.0, -15.0, 135.0, 365.0, 270.0, 145.0, 490.0, 340.0, 445.0, 290.0, 555.0, 455.0, 45.0, 320.0, 425.0, 250.0, 200.0, 65.0, 95.0, 405.0, 385.0, 140.0, 280.0, 345.0, -290.0, 135.0, 220.0, 220.0, 240.0, -135.0, 330.0, 230.0, 475.0, 180.0, 330.0, 355.0, 175.0, 340.0, -125.0, -20.0, 160.0, 20.0, -35.0, 80.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1978936326214968, "mean_inference_ms": 1.6326645575757077, "mean_action_processing_ms": 0.5841122757527174, "mean_env_wait_ms": 0.21558188473565018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15997838973999023, "StateBufferConnector_ms": 0.006448507308959961, "ViewRequirementAgentConnector_ms": 0.3339073657989502}}, "episode_reward_max": 555.0, "episode_reward_min": -290.0, "episode_reward_mean": 213.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [110.0, 435.0, 105.0, 310.0, 100.0, 85.0, 60.0, 200.0, 455.0, 450.0, 450.0, 10.0, 295.0, 445.0, 255.0, 270.0, 360.0, 215.0, -35.0, 350.0, 145.0, 425.0, 105.0, 55.0, 340.0, 175.0, 375.0, 495.0, -160.0, 255.0, 350.0, 535.0, 135.0, -200.0, 315.0, 205.0, 280.0, 330.0, -80.0, 395.0, -75.0, 225.0, 235.0, 395.0, 185.0, -50.0, 100.0, 210.0, 105.0, -35.0, 160.0, 60.0, 145.0, 395.0, 390.0, 250.0, -65.0, -15.0, 135.0, 365.0, 270.0, 145.0, 490.0, 340.0, 445.0, 290.0, 555.0, 455.0, 45.0, 320.0, 425.0, 250.0, 200.0, 65.0, 95.0, 405.0, 385.0, 140.0, 280.0, 345.0, -290.0, 135.0, 220.0, 220.0, 240.0, -135.0, 330.0, 230.0, 475.0, 180.0, 330.0, 355.0, 175.0, 340.0, -125.0, -20.0, 160.0, 20.0, -35.0, 80.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1978936326214968, "mean_inference_ms": 1.6326645575757077, "mean_action_processing_ms": 0.5841122757527174, "mean_env_wait_ms": 0.21558188473565018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15997838973999023, "StateBufferConnector_ms": 0.006448507308959961, "ViewRequirementAgentConnector_ms": 0.3339073657989502}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 778240, "num_agent_steps_trained": 778240, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 87.15473204957578, "num_env_steps_trained_throughput_per_sec": 87.15473204957578, "timesteps_total": 155648, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 778240, "timers": {"training_iteration_time_ms": 94794.077, "sample_time_ms": 14729.876, "load_time_ms": 1.81, "load_throughput": 4526497.651, "learn_time_ms": 80053.772, "learn_throughput": 102.331, "synch_weights_time_ms": 2.283}, "counters": {"num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 778240, "num_agent_steps_trained": 778240}, "done": false, "episodes_total": 1216, "training_iteration": 19, "trial_id": "9fade_00019", "date": "2023-11-09_20-27-41", "timestamp": 1699558061, "time_this_iter_s": 94.0137894153595, "time_total_s": 1839.708477973938, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1839.708477973938, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 37.752238805970144, "ram_util_percent": 18.510447761194026}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5414088071387628, "episode_optimality_min": -1.75, "episode_optimality_max": 0.9823008849557522, "episode_optimality_capped_mean": 0.5489088071387629, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9823008849557522, "episode_reward_normalized_mean": 40.5, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 122.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5489088071387629, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9823008849557522}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9862373990286142, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.26996612561216654, "policy_loss": -0.07321359648286792, "vf_loss": 0.33209035553552285, "vf_explained_var": 0.376217780970037, "kl": 0.016428691357944367, "entropy": 4.456900023793181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 187200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 819200, "num_agent_steps_trained": 819200}, "sampler_results": {"episode_reward_max": 610.0, "episode_reward_min": -290.0, "episode_reward_mean": 202.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5414088071387628, "episode_optimality_min": -1.75, "episode_optimality_max": 0.9823008849557522, "episode_optimality_capped_mean": 0.5489088071387629, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 0.9823008849557522, "episode_reward_normalized_mean": 40.5, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 122.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5489088071387629, "curr_learning_score_min": -1.0, "curr_learning_score_max": 0.9823008849557522}, "hist_stats": {"episode_reward": [445.0, 290.0, 555.0, 455.0, 45.0, 320.0, 425.0, 250.0, 200.0, 65.0, 95.0, 405.0, 385.0, 140.0, 280.0, 345.0, -290.0, 135.0, 220.0, 220.0, 240.0, -135.0, 330.0, 230.0, 475.0, 180.0, 330.0, 355.0, 175.0, 340.0, -125.0, -20.0, 160.0, 20.0, -35.0, 80.0, 275.0, 85.0, 230.0, 270.0, 200.0, 270.0, 125.0, 85.0, 70.0, 285.0, 295.0, 10.0, 205.0, 135.0, 95.0, 25.0, 5.0, 115.0, 30.0, 285.0, -165.0, 150.0, 270.0, 610.0, 5.0, -20.0, 75.0, 230.0, 155.0, 240.0, 65.0, 365.0, 505.0, 255.0, 220.0, 135.0, 280.0, 295.0, 270.0, 270.0, 135.0, 340.0, 195.0, 40.0, 150.0, 395.0, 210.0, 315.0, 305.0, 320.0, 365.0, 350.0, 0.0, 220.0, 30.0, 60.0, 260.0, 340.0, 35.0, 245.0, 220.0, 195.0, 535.0, 100.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1943228528050083, "mean_inference_ms": 1.6255053040340746, "mean_action_processing_ms": 0.5825487794578545, "mean_env_wait_ms": 0.21461430114452093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1581428050994873, "StateBufferConnector_ms": 0.0063092708587646484, "ViewRequirementAgentConnector_ms": 0.32915258407592773}}, "episode_reward_max": 610.0, "episode_reward_min": -290.0, "episode_reward_mean": 202.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [445.0, 290.0, 555.0, 455.0, 45.0, 320.0, 425.0, 250.0, 200.0, 65.0, 95.0, 405.0, 385.0, 140.0, 280.0, 345.0, -290.0, 135.0, 220.0, 220.0, 240.0, -135.0, 330.0, 230.0, 475.0, 180.0, 330.0, 355.0, 175.0, 340.0, -125.0, -20.0, 160.0, 20.0, -35.0, 80.0, 275.0, 85.0, 230.0, 270.0, 200.0, 270.0, 125.0, 85.0, 70.0, 285.0, 295.0, 10.0, 205.0, 135.0, 95.0, 25.0, 5.0, 115.0, 30.0, 285.0, -165.0, 150.0, 270.0, 610.0, 5.0, -20.0, 75.0, 230.0, 155.0, 240.0, 65.0, 365.0, 505.0, 255.0, 220.0, 135.0, 280.0, 295.0, 270.0, 270.0, 135.0, 340.0, 195.0, 40.0, 150.0, 395.0, 210.0, 315.0, 305.0, 320.0, 365.0, 350.0, 0.0, 220.0, 30.0, 60.0, 260.0, 340.0, 35.0, 245.0, 220.0, 195.0, 535.0, 100.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1943228528050083, "mean_inference_ms": 1.6255053040340746, "mean_action_processing_ms": 0.5825487794578545, "mean_env_wait_ms": 0.21461430114452093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1581428050994873, "StateBufferConnector_ms": 0.0063092708587646484, "ViewRequirementAgentConnector_ms": 0.32915258407592773}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 819200, "num_agent_steps_trained": 819200, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 86.39292316083247, "num_env_steps_trained_throughput_per_sec": 86.39292316083247, "timesteps_total": 163840, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 819200, "timers": {"training_iteration_time_ms": 94649.773, "sample_time_ms": 14567.722, "load_time_ms": 1.86, "load_throughput": 4404812.303, "learn_time_ms": 80071.494, "learn_throughput": 102.309, "synch_weights_time_ms": 2.286}, "counters": {"num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 819200, "num_agent_steps_trained": 819200}, "done": false, "episodes_total": 1280, "training_iteration": 20, "trial_id": "9fade_00019", "date": "2023-11-09_20-29-15", "timestamp": 1699558155, "time_this_iter_s": 94.83813905715942, "time_total_s": 1934.5466170310974, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1934.5466170310974, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.45407407407407, "ram_util_percent": 18.416296296296295}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5920858872950823, "episode_optimality_min": -0.3548387096774194, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5920858872950823, "episode_optimality_capped_min": -0.3548387096774194, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.01, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5920858872950823, "curr_learning_score_min": -0.3548387096774194, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9767899610071132, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.26401707226075816, "policy_loss": -0.06929519472426666, "vf_loss": 0.3226922210525178, "vf_explained_var": 0.406150192686667, "kl": 0.015733401315317034, "entropy": 4.427603739127517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 196800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 860160, "num_agent_steps_trained": 860160}, "sampler_results": {"episode_reward_max": 535.0, "episode_reward_min": -165.0, "episode_reward_mean": 205.05, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5920858872950823, "episode_optimality_min": -0.3548387096774194, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5920858872950823, "episode_optimality_capped_min": -0.3548387096774194, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.01, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5920858872950823, "curr_learning_score_min": -0.3548387096774194, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [155.0, 240.0, 65.0, 365.0, 505.0, 255.0, 220.0, 135.0, 280.0, 295.0, 270.0, 270.0, 135.0, 340.0, 195.0, 40.0, 150.0, 395.0, 210.0, 315.0, 305.0, 320.0, 365.0, 350.0, 0.0, 220.0, 30.0, 60.0, 260.0, 340.0, 35.0, 245.0, 220.0, 195.0, 535.0, 100.0, 340.0, -25.0, 355.0, 130.0, 105.0, 185.0, 5.0, 285.0, -50.0, -40.0, 20.0, 285.0, 45.0, 300.0, 25.0, 160.0, 50.0, 210.0, 215.0, 315.0, 355.0, 385.0, 110.0, 320.0, 20.0, 290.0, 235.0, 270.0, 35.0, 115.0, 215.0, 120.0, 270.0, 310.0, 85.0, 70.0, 170.0, 55.0, 155.0, 80.0, 285.0, -165.0, 245.0, 320.0, 415.0, 435.0, 440.0, 180.0, 70.0, -35.0, 130.0, 175.0, 240.0, 225.0, 380.0, 415.0, 275.0, 360.0, 425.0, 125.0, 215.0, 105.0, 220.0, 30.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1908235836580296, "mean_inference_ms": 1.6179157564080173, "mean_action_processing_ms": 0.581036751660066, "mean_env_wait_ms": 0.21360146236000851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15876007080078125, "StateBufferConnector_ms": 0.006276845932006836, "ViewRequirementAgentConnector_ms": 0.32663488388061523}}, "episode_reward_max": 535.0, "episode_reward_min": -165.0, "episode_reward_mean": 205.05, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [155.0, 240.0, 65.0, 365.0, 505.0, 255.0, 220.0, 135.0, 280.0, 295.0, 270.0, 270.0, 135.0, 340.0, 195.0, 40.0, 150.0, 395.0, 210.0, 315.0, 305.0, 320.0, 365.0, 350.0, 0.0, 220.0, 30.0, 60.0, 260.0, 340.0, 35.0, 245.0, 220.0, 195.0, 535.0, 100.0, 340.0, -25.0, 355.0, 130.0, 105.0, 185.0, 5.0, 285.0, -50.0, -40.0, 20.0, 285.0, 45.0, 300.0, 25.0, 160.0, 50.0, 210.0, 215.0, 315.0, 355.0, 385.0, 110.0, 320.0, 20.0, 290.0, 235.0, 270.0, 35.0, 115.0, 215.0, 120.0, 270.0, 310.0, 85.0, 70.0, 170.0, 55.0, 155.0, 80.0, 285.0, -165.0, 245.0, 320.0, 415.0, 435.0, 440.0, 180.0, 70.0, -35.0, 130.0, 175.0, 240.0, 225.0, 380.0, 415.0, 275.0, 360.0, 425.0, 125.0, 215.0, 105.0, 220.0, 30.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1908235836580296, "mean_inference_ms": 1.6179157564080173, "mean_action_processing_ms": 0.581036751660066, "mean_env_wait_ms": 0.21360146236000851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15876007080078125, "StateBufferConnector_ms": 0.006276845932006836, "ViewRequirementAgentConnector_ms": 0.32663488388061523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860160, "num_agent_steps_trained": 860160, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 87.51809192560799, "num_env_steps_trained_throughput_per_sec": 87.51809192560799, "timesteps_total": 172032, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 860160, "timers": {"training_iteration_time_ms": 94530.625, "sample_time_ms": 14552.94, "load_time_ms": 1.763, "load_throughput": 4645781.902, "learn_time_ms": 79967.179, "learn_throughput": 102.442, "synch_weights_time_ms": 2.449}, "counters": {"num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 860160, "num_agent_steps_trained": 860160}, "done": false, "episodes_total": 1344, "training_iteration": 21, "trial_id": "9fade_00019", "date": "2023-11-09_20-30-49", "timestamp": 1699558249, "time_this_iter_s": 93.62155628204346, "time_total_s": 2028.1681733131409, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2028.1681733131409, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.661654135338345, "ram_util_percent": 18.024060150375938}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5393269313131854, "episode_optimality_min": -0.7058823529411765, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5393269313131854, "episode_optimality_capped_min": -0.7058823529411765, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.7, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5393269313131854, "curr_learning_score_min": -0.7058823529411765, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9792263409929971, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2920279676732025, "policy_loss": -0.07088173910298792, "vf_loss": 0.3517587729420241, "vf_explained_var": 0.3574012306580941, "kl": 0.01651990183156016, "entropy": 4.37455538255473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 206400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 901120, "num_agent_steps_trained": 901120}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -180.0, "episode_reward_mean": 188.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5393269313131854, "episode_optimality_min": -0.7058823529411765, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5393269313131854, "episode_optimality_capped_min": -0.7058823529411765, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.7, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5393269313131854, "curr_learning_score_min": -0.7058823529411765, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [35.0, 115.0, 215.0, 120.0, 270.0, 310.0, 85.0, 70.0, 170.0, 55.0, 155.0, 80.0, 285.0, -165.0, 245.0, 320.0, 415.0, 435.0, 440.0, 180.0, 70.0, -35.0, 130.0, 175.0, 240.0, 225.0, 380.0, 415.0, 275.0, 360.0, 425.0, 125.0, 215.0, 105.0, 220.0, 30.0, 310.0, 365.0, 355.0, -85.0, 35.0, 225.0, 115.0, -15.0, 90.0, 280.0, -50.0, 260.0, 270.0, 210.0, 170.0, 335.0, 405.0, 120.0, 280.0, 105.0, -155.0, 325.0, 170.0, 210.0, 100.0, 35.0, 90.0, 175.0, -180.0, 150.0, -90.0, 335.0, 375.0, 345.0, 565.0, 80.0, -75.0, 495.0, 105.0, 90.0, 360.0, 600.0, 135.0, -30.0, 140.0, 0.0, 280.0, 80.0, -20.0, 140.0, 120.0, 430.0, 175.0, 355.0, 350.0, 50.0, 170.0, -50.0, 130.0, 105.0, 535.0, 215.0, 275.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.188924229173076, "mean_inference_ms": 1.6146507794326288, "mean_action_processing_ms": 0.5802831055928571, "mean_env_wait_ms": 0.21304564593324735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1614539623260498, "StateBufferConnector_ms": 0.006509065628051758, "ViewRequirementAgentConnector_ms": 0.33440232276916504}}, "episode_reward_max": 600.0, "episode_reward_min": -180.0, "episode_reward_mean": 188.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.0, 115.0, 215.0, 120.0, 270.0, 310.0, 85.0, 70.0, 170.0, 55.0, 155.0, 80.0, 285.0, -165.0, 245.0, 320.0, 415.0, 435.0, 440.0, 180.0, 70.0, -35.0, 130.0, 175.0, 240.0, 225.0, 380.0, 415.0, 275.0, 360.0, 425.0, 125.0, 215.0, 105.0, 220.0, 30.0, 310.0, 365.0, 355.0, -85.0, 35.0, 225.0, 115.0, -15.0, 90.0, 280.0, -50.0, 260.0, 270.0, 210.0, 170.0, 335.0, 405.0, 120.0, 280.0, 105.0, -155.0, 325.0, 170.0, 210.0, 100.0, 35.0, 90.0, 175.0, -180.0, 150.0, -90.0, 335.0, 375.0, 345.0, 565.0, 80.0, -75.0, 495.0, 105.0, 90.0, 360.0, 600.0, 135.0, -30.0, 140.0, 0.0, 280.0, 80.0, -20.0, 140.0, 120.0, 430.0, 175.0, 355.0, 350.0, 50.0, 170.0, -50.0, 130.0, 105.0, 535.0, 215.0, 275.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.188924229173076, "mean_inference_ms": 1.6146507794326288, "mean_action_processing_ms": 0.5802831055928571, "mean_env_wait_ms": 0.21304564593324735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1614539623260498, "StateBufferConnector_ms": 0.006509065628051758, "ViewRequirementAgentConnector_ms": 0.33440232276916504}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 901120, "num_agent_steps_trained": 901120, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 88.30034533407554, "num_env_steps_trained_throughput_per_sec": 88.30034533407554, "timesteps_total": 180224, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 901120, "timers": {"training_iteration_time_ms": 94140.006, "sample_time_ms": 14580.941, "load_time_ms": 1.764, "load_throughput": 4643647.151, "learn_time_ms": 79548.613, "learn_throughput": 102.981, "synch_weights_time_ms": 2.457}, "counters": {"num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 901120, "num_agent_steps_trained": 901120}, "done": false, "episodes_total": 1408, "training_iteration": 22, "trial_id": "9fade_00019", "date": "2023-11-09_20-32-22", "timestamp": 1699558342, "time_this_iter_s": 92.79037833213806, "time_total_s": 2120.958551645279, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2120.958551645279, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.203007518796994, "ram_util_percent": 18.257142857142856}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5135228720403384, "episode_optimality_min": -0.7619047619047619, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5135228720403384, "episode_optimality_capped_min": -0.7619047619047619, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.77, "episode_reward_normalized_min": -48.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5135228720403384, "curr_learning_score_min": -0.7619047619047619, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9747377617812405, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.27338577333438785, "policy_loss": -0.06961620367689951, "vf_loss": 0.33206825482210356, "vf_explained_var": 0.38977404879406097, "kl": 0.0161981071050972, "entropy": 4.343306025341153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 216000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 942080, "num_agent_steps_trained": 942080}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -240.0, "episode_reward_mean": 188.85, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5135228720403384, "episode_optimality_min": -0.7619047619047619, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5135228720403384, "episode_optimality_capped_min": -0.7619047619047619, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.77, "episode_reward_normalized_min": -48.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5135228720403384, "curr_learning_score_min": -0.7619047619047619, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-180.0, 150.0, -90.0, 335.0, 375.0, 345.0, 565.0, 80.0, -75.0, 495.0, 105.0, 90.0, 360.0, 600.0, 135.0, -30.0, 140.0, 0.0, 280.0, 80.0, -20.0, 140.0, 120.0, 430.0, 175.0, 355.0, 350.0, 50.0, 170.0, -50.0, 130.0, 105.0, 535.0, 215.0, 275.0, 190.0, 185.0, -50.0, 250.0, 275.0, 255.0, 410.0, 390.0, 15.0, 160.0, 425.0, 35.0, 180.0, 370.0, 45.0, 360.0, 265.0, 405.0, 5.0, 235.0, 210.0, 425.0, -55.0, 40.0, 95.0, 235.0, 10.0, 405.0, 285.0, -185.0, 335.0, 480.0, 195.0, 145.0, 330.0, 155.0, 25.0, 170.0, 60.0, 275.0, 205.0, -240.0, 75.0, 0.0, 240.0, 55.0, 125.0, 110.0, 350.0, 575.0, 155.0, 260.0, 195.0, -105.0, -60.0, 200.0, 355.0, 400.0, 235.0, 140.0, 285.0, 70.0, 10.0, 155.0, 315.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1872477031208186, "mean_inference_ms": 1.6116575020958124, "mean_action_processing_ms": 0.579666491812151, "mean_env_wait_ms": 0.212554958343432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16222548484802246, "StateBufferConnector_ms": 0.006483316421508789, "ViewRequirementAgentConnector_ms": 0.3352243900299072}}, "episode_reward_max": 600.0, "episode_reward_min": -240.0, "episode_reward_mean": 188.85, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-180.0, 150.0, -90.0, 335.0, 375.0, 345.0, 565.0, 80.0, -75.0, 495.0, 105.0, 90.0, 360.0, 600.0, 135.0, -30.0, 140.0, 0.0, 280.0, 80.0, -20.0, 140.0, 120.0, 430.0, 175.0, 355.0, 350.0, 50.0, 170.0, -50.0, 130.0, 105.0, 535.0, 215.0, 275.0, 190.0, 185.0, -50.0, 250.0, 275.0, 255.0, 410.0, 390.0, 15.0, 160.0, 425.0, 35.0, 180.0, 370.0, 45.0, 360.0, 265.0, 405.0, 5.0, 235.0, 210.0, 425.0, -55.0, 40.0, 95.0, 235.0, 10.0, 405.0, 285.0, -185.0, 335.0, 480.0, 195.0, 145.0, 330.0, 155.0, 25.0, 170.0, 60.0, 275.0, 205.0, -240.0, 75.0, 0.0, 240.0, 55.0, 125.0, 110.0, 350.0, 575.0, 155.0, 260.0, 195.0, -105.0, -60.0, 200.0, 355.0, 400.0, 235.0, 140.0, 285.0, 70.0, 10.0, 155.0, 315.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1872477031208186, "mean_inference_ms": 1.6116575020958124, "mean_action_processing_ms": 0.579666491812151, "mean_env_wait_ms": 0.212554958343432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16222548484802246, "StateBufferConnector_ms": 0.006483316421508789, "ViewRequirementAgentConnector_ms": 0.3352243900299072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 942080, "num_agent_steps_trained": 942080, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 89.06831876694913, "num_env_steps_trained_throughput_per_sec": 89.06831876694913, "timesteps_total": 188416, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 942080, "timers": {"training_iteration_time_ms": 93694.053, "sample_time_ms": 14566.612, "load_time_ms": 1.727, "load_throughput": 4742348.608, "learn_time_ms": 79117.158, "learn_throughput": 103.543, "synch_weights_time_ms": 2.467}, "counters": {"num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 942080, "num_agent_steps_trained": 942080}, "done": false, "episodes_total": 1472, "training_iteration": 23, "trial_id": "9fade_00019", "date": "2023-11-09_20-33-56", "timestamp": 1699558436, "time_this_iter_s": 91.99215817451477, "time_total_s": 2212.9507098197937, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2212.9507098197937, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.602985074626865, "ram_util_percent": 18.525373134328355}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5484101928583514, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5484101928583514, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.36, "episode_reward_normalized_min": -48.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5484101928583514, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.966853868253529, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.23796950534713687, "policy_loss": -0.06662220880726333, "vf_loss": 0.29399986734683203, "vf_explained_var": 0.384601045747598, "kl": 0.01569162474299939, "entropy": 4.28447439322869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 225600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 983040, "num_agent_steps_trained": 983040}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -240.0, "episode_reward_mean": 196.8, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5484101928583514, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5484101928583514, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.36, "episode_reward_normalized_min": -48.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5484101928583514, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-185.0, 335.0, 480.0, 195.0, 145.0, 330.0, 155.0, 25.0, 170.0, 60.0, 275.0, 205.0, -240.0, 75.0, 0.0, 240.0, 55.0, 125.0, 110.0, 350.0, 575.0, 155.0, 260.0, 195.0, -105.0, -60.0, 200.0, 355.0, 400.0, 235.0, 140.0, 285.0, 70.0, 10.0, 155.0, 315.0, 40.0, 445.0, 320.0, 265.0, 65.0, 460.0, 335.0, 575.0, 135.0, 265.0, 220.0, 175.0, 505.0, -25.0, 275.0, 260.0, 470.0, 165.0, 630.0, 100.0, 145.0, 15.0, 235.0, -25.0, 80.0, 60.0, 230.0, -20.0, 15.0, 560.0, 135.0, 10.0, 455.0, -70.0, 75.0, 375.0, -30.0, 5.0, 115.0, 410.0, 395.0, 175.0, 95.0, 220.0, 20.0, 160.0, 410.0, 160.0, 265.0, 410.0, 200.0, 270.0, 200.0, 230.0, -10.0, 235.0, 45.0, 310.0, 285.0, 20.0, 325.0, 255.0, 205.0, 255.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1858734808832794, "mean_inference_ms": 1.6089799153141933, "mean_action_processing_ms": 0.579100125885341, "mean_env_wait_ms": 0.21219524081798663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16186952590942383, "StateBufferConnector_ms": 0.006592988967895508, "ViewRequirementAgentConnector_ms": 0.3387274742126465}}, "episode_reward_max": 630.0, "episode_reward_min": -240.0, "episode_reward_mean": 196.8, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.0, 335.0, 480.0, 195.0, 145.0, 330.0, 155.0, 25.0, 170.0, 60.0, 275.0, 205.0, -240.0, 75.0, 0.0, 240.0, 55.0, 125.0, 110.0, 350.0, 575.0, 155.0, 260.0, 195.0, -105.0, -60.0, 200.0, 355.0, 400.0, 235.0, 140.0, 285.0, 70.0, 10.0, 155.0, 315.0, 40.0, 445.0, 320.0, 265.0, 65.0, 460.0, 335.0, 575.0, 135.0, 265.0, 220.0, 175.0, 505.0, -25.0, 275.0, 260.0, 470.0, 165.0, 630.0, 100.0, 145.0, 15.0, 235.0, -25.0, 80.0, 60.0, 230.0, -20.0, 15.0, 560.0, 135.0, 10.0, 455.0, -70.0, 75.0, 375.0, -30.0, 5.0, 115.0, 410.0, 395.0, 175.0, 95.0, 220.0, 20.0, 160.0, 410.0, 160.0, 265.0, 410.0, 200.0, 270.0, 200.0, 230.0, -10.0, 235.0, 45.0, 310.0, 285.0, 20.0, 325.0, 255.0, 205.0, 255.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1858734808832794, "mean_inference_ms": 1.6089799153141933, "mean_action_processing_ms": 0.579100125885341, "mean_env_wait_ms": 0.21219524081798663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16186952590942383, "StateBufferConnector_ms": 0.006592988967895508, "ViewRequirementAgentConnector_ms": 0.3387274742126465}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 983040, "num_agent_steps_trained": 983040, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 88.22331885064804, "num_env_steps_trained_throughput_per_sec": 88.22331885064804, "timesteps_total": 196608, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 983040, "timers": {"training_iteration_time_ms": 93509.923, "sample_time_ms": 14536.342, "load_time_ms": 1.735, "load_throughput": 4722468.783, "learn_time_ms": 78963.287, "learn_throughput": 103.744, "synch_weights_time_ms": 2.463}, "counters": {"num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 983040, "num_agent_steps_trained": 983040}, "done": false, "episodes_total": 1536, "training_iteration": 24, "trial_id": "9fade_00019", "date": "2023-11-09_20-35-29", "timestamp": 1699558529, "time_this_iter_s": 92.87200736999512, "time_total_s": 2305.822717189789, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2305.822717189789, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 37.37954545454546, "ram_util_percent": 18.673484848484854}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5249583855513996, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5249583855513996, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.67, "episode_reward_normalized_min": -14.0, "episode_reward_normalized_max": 112.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5249583855513996, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9777741647263368, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.29156385510798527, "policy_loss": -0.0674106362541958, "vf_loss": 0.34827535752117306, "vf_explained_var": 0.3534948426919679, "kl": 0.015850568150587493, "entropy": 4.282090453108152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 235200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "sampler_results": {"episode_reward_max": 560.0, "episode_reward_min": -70.0, "episode_reward_mean": 203.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5249583855513996, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5249583855513996, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.67, "episode_reward_normalized_min": -14.0, "episode_reward_normalized_max": 112.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5249583855513996, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [15.0, 560.0, 135.0, 10.0, 455.0, -70.0, 75.0, 375.0, -30.0, 5.0, 115.0, 410.0, 395.0, 175.0, 95.0, 220.0, 20.0, 160.0, 410.0, 160.0, 265.0, 410.0, 200.0, 270.0, 200.0, 230.0, -10.0, 235.0, 45.0, 310.0, 285.0, 20.0, 325.0, 255.0, 205.0, 255.0, 115.0, 25.0, 295.0, 490.0, 25.0, 505.0, 5.0, -40.0, -20.0, 260.0, 35.0, 345.0, 140.0, 285.0, 125.0, 245.0, 235.0, 10.0, 45.0, -60.0, 430.0, 430.0, 125.0, 200.0, 325.0, 360.0, 350.0, -15.0, 195.0, -70.0, 125.0, 250.0, 35.0, 485.0, 410.0, 425.0, 85.0, -70.0, 130.0, 510.0, 120.0, 425.0, 400.0, 375.0, 225.0, 100.0, 80.0, 180.0, 240.0, 95.0, 275.0, 0.0, 350.0, 95.0, 10.0, 195.0, 195.0, 390.0, 115.0, 415.0, 545.0, -25.0, 375.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.184368155370656, "mean_inference_ms": 1.6065986954285416, "mean_action_processing_ms": 0.5784918245145234, "mean_env_wait_ms": 0.21174279928363315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1607663631439209, "StateBufferConnector_ms": 0.006559610366821289, "ViewRequirementAgentConnector_ms": 0.3349173069000244}}, "episode_reward_max": 560.0, "episode_reward_min": -70.0, "episode_reward_mean": 203.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.0, 560.0, 135.0, 10.0, 455.0, -70.0, 75.0, 375.0, -30.0, 5.0, 115.0, 410.0, 395.0, 175.0, 95.0, 220.0, 20.0, 160.0, 410.0, 160.0, 265.0, 410.0, 200.0, 270.0, 200.0, 230.0, -10.0, 235.0, 45.0, 310.0, 285.0, 20.0, 325.0, 255.0, 205.0, 255.0, 115.0, 25.0, 295.0, 490.0, 25.0, 505.0, 5.0, -40.0, -20.0, 260.0, 35.0, 345.0, 140.0, 285.0, 125.0, 245.0, 235.0, 10.0, 45.0, -60.0, 430.0, 430.0, 125.0, 200.0, 325.0, 360.0, 350.0, -15.0, 195.0, -70.0, 125.0, 250.0, 35.0, 485.0, 410.0, 425.0, 85.0, -70.0, 130.0, 510.0, 120.0, 425.0, 400.0, 375.0, 225.0, 100.0, 80.0, 180.0, 240.0, 95.0, 275.0, 0.0, 350.0, 95.0, 10.0, 195.0, 195.0, 390.0, 115.0, 415.0, 545.0, -25.0, 375.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.184368155370656, "mean_inference_ms": 1.6065986954285416, "mean_action_processing_ms": 0.5784918245145234, "mean_env_wait_ms": 0.21174279928363315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1607663631439209, "StateBufferConnector_ms": 0.006559610366821289, "ViewRequirementAgentConnector_ms": 0.3349173069000244}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 88.40592530869212, "num_env_steps_trained_throughput_per_sec": 88.40592530869212, "timesteps_total": 204800, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 93249.46, "sample_time_ms": 14502.492, "load_time_ms": 1.68, "load_throughput": 4877457.679, "learn_time_ms": 78736.475, "learn_throughput": 104.043, "synch_weights_time_ms": 2.683}, "counters": {"num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "episodes_total": 1600, "training_iteration": 25, "trial_id": "9fade_00019", "date": "2023-11-09_20-37-02", "timestamp": 1699558622, "time_this_iter_s": 92.68088388442993, "time_total_s": 2398.5036010742188, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2398.5036010742188, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 37.234848484848484, "ram_util_percent": 18.730303030303034}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.49484942055406145, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.49484942055406145, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.54, "episode_reward_normalized_min": -65.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.49484942055406145, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9770151539923002, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.27241146322012355, "policy_loss": -0.06856440031025461, "vf_loss": 0.33000854878263153, "vf_explained_var": 0.3556801147324343, "kl": 0.01624787402344206, "entropy": 4.285651514579852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 244800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 1064960, "num_agent_steps_trained": 1064960}, "sampler_results": {"episode_reward_max": 620.0, "episode_reward_min": -325.0, "episode_reward_mean": 187.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.49484942055406145, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.49484942055406145, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.54, "episode_reward_normalized_min": -65.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.49484942055406145, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [195.0, -70.0, 125.0, 250.0, 35.0, 485.0, 410.0, 425.0, 85.0, -70.0, 130.0, 510.0, 120.0, 425.0, 400.0, 375.0, 225.0, 100.0, 80.0, 180.0, 240.0, 95.0, 275.0, 0.0, 350.0, 95.0, 10.0, 195.0, 195.0, 390.0, 115.0, 415.0, 545.0, -25.0, 375.0, 190.0, 225.0, 320.0, 280.0, 0.0, 465.0, 225.0, 280.0, 200.0, 185.0, 290.0, 100.0, 595.0, 540.0, 110.0, 190.0, 215.0, -155.0, 255.0, 45.0, 0.0, 440.0, 385.0, 155.0, 285.0, 115.0, 325.0, 70.0, 110.0, 190.0, 115.0, 205.0, 520.0, 415.0, -40.0, 285.0, 85.0, 50.0, 350.0, 220.0, 235.0, 185.0, 35.0, 275.0, 70.0, 355.0, -5.0, -325.0, 5.0, 20.0, 155.0, 0.0, 155.0, -115.0, 100.0, -20.0, 480.0, 620.0, 110.0, -110.0, 10.0, -155.0, 260.0, -145.0, 55.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1828561781874343, "mean_inference_ms": 1.603659912926154, "mean_action_processing_ms": 0.5777572411176956, "mean_env_wait_ms": 0.21126196905416023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1617734432220459, "StateBufferConnector_ms": 0.0064165592193603516, "ViewRequirementAgentConnector_ms": 0.33208775520324707}}, "episode_reward_max": 620.0, "episode_reward_min": -325.0, "episode_reward_mean": 187.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [195.0, -70.0, 125.0, 250.0, 35.0, 485.0, 410.0, 425.0, 85.0, -70.0, 130.0, 510.0, 120.0, 425.0, 400.0, 375.0, 225.0, 100.0, 80.0, 180.0, 240.0, 95.0, 275.0, 0.0, 350.0, 95.0, 10.0, 195.0, 195.0, 390.0, 115.0, 415.0, 545.0, -25.0, 375.0, 190.0, 225.0, 320.0, 280.0, 0.0, 465.0, 225.0, 280.0, 200.0, 185.0, 290.0, 100.0, 595.0, 540.0, 110.0, 190.0, 215.0, -155.0, 255.0, 45.0, 0.0, 440.0, 385.0, 155.0, 285.0, 115.0, 325.0, 70.0, 110.0, 190.0, 115.0, 205.0, 520.0, 415.0, -40.0, 285.0, 85.0, 50.0, 350.0, 220.0, 235.0, 185.0, 35.0, 275.0, 70.0, 355.0, -5.0, -325.0, 5.0, 20.0, 155.0, 0.0, 155.0, -115.0, 100.0, -20.0, 480.0, 620.0, 110.0, -110.0, 10.0, -155.0, 260.0, -145.0, 55.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1828561781874343, "mean_inference_ms": 1.603659912926154, "mean_action_processing_ms": 0.5777572411176956, "mean_env_wait_ms": 0.21126196905416023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1617734432220459, "StateBufferConnector_ms": 0.0064165592193603516, "ViewRequirementAgentConnector_ms": 0.33208775520324707}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064960, "num_agent_steps_trained": 1064960, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 85.95395805656061, "num_env_steps_trained_throughput_per_sec": 85.95395805656061, "timesteps_total": 212992, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1064960, "timers": {"training_iteration_time_ms": 93466.977, "sample_time_ms": 14406.155, "load_time_ms": 1.681, "load_throughput": 4872615.912, "learn_time_ms": 79050.258, "learn_throughput": 103.63, "synch_weights_time_ms": 2.792}, "counters": {"num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 1064960, "num_agent_steps_trained": 1064960}, "done": false, "episodes_total": 1664, "training_iteration": 26, "trial_id": "9fade_00019", "date": "2023-11-09_20-38-37", "timestamp": 1699558717, "time_this_iter_s": 95.32393193244934, "time_total_s": 2493.827533006668, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2493.827533006668, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 37.89191176470588, "ram_util_percent": 18.69264705882353}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4590396502374831, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 0.990909090909091, "episode_optimality_capped_mean": 0.4590396502374831, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 0.990909090909091, "episode_reward_normalized_mean": 32.75, "episode_reward_normalized_min": -65.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4590396502374831, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 0.990909090909091}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9798609904851765, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2671488697594517, "policy_loss": -0.06943110241001704, "vf_loss": 0.32546173149301466, "vf_explained_var": 0.37240451083829007, "kl": 0.01647146805797225, "entropy": 4.296759808113178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 254400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 1105920, "num_agent_steps_trained": 1105920}, "sampler_results": {"episode_reward_max": 620.0, "episode_reward_min": -325.0, "episode_reward_mean": 163.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4590396502374831, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 0.990909090909091, "episode_optimality_capped_mean": 0.4590396502374831, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 0.990909090909091, "episode_reward_normalized_mean": 32.75, "episode_reward_normalized_min": -65.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4590396502374831, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 0.990909090909091}, "hist_stats": {"episode_reward": [190.0, 115.0, 205.0, 520.0, 415.0, -40.0, 285.0, 85.0, 50.0, 350.0, 220.0, 235.0, 185.0, 35.0, 275.0, 70.0, 355.0, -5.0, -325.0, 5.0, 20.0, 155.0, 0.0, 155.0, -115.0, 100.0, -20.0, 480.0, 620.0, 110.0, -110.0, 10.0, -155.0, 260.0, -145.0, 55.0, 370.0, 250.0, 90.0, 40.0, 350.0, 310.0, 75.0, 145.0, 190.0, 255.0, 0.0, 390.0, 180.0, 280.0, 615.0, -25.0, -35.0, 245.0, 340.0, 335.0, 115.0, 65.0, 110.0, 50.0, 310.0, 45.0, 300.0, 115.0, 445.0, -55.0, 345.0, 105.0, 105.0, 485.0, 185.0, 195.0, 60.0, 285.0, 365.0, 175.0, 90.0, 60.0, 545.0, 115.0, -20.0, -55.0, 115.0, 45.0, 55.0, 115.0, 305.0, 345.0, 195.0, 125.0, 45.0, 265.0, 135.0, 305.0, 50.0, 315.0, 145.0, -65.0, 245.0, 50.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1813132469920482, "mean_inference_ms": 1.6000980713327555, "mean_action_processing_ms": 0.5770339771319197, "mean_env_wait_ms": 0.21075889097812645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16097593307495117, "StateBufferConnector_ms": 0.006361722946166992, "ViewRequirementAgentConnector_ms": 0.3318192958831787}}, "episode_reward_max": 620.0, "episode_reward_min": -325.0, "episode_reward_mean": 163.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [190.0, 115.0, 205.0, 520.0, 415.0, -40.0, 285.0, 85.0, 50.0, 350.0, 220.0, 235.0, 185.0, 35.0, 275.0, 70.0, 355.0, -5.0, -325.0, 5.0, 20.0, 155.0, 0.0, 155.0, -115.0, 100.0, -20.0, 480.0, 620.0, 110.0, -110.0, 10.0, -155.0, 260.0, -145.0, 55.0, 370.0, 250.0, 90.0, 40.0, 350.0, 310.0, 75.0, 145.0, 190.0, 255.0, 0.0, 390.0, 180.0, 280.0, 615.0, -25.0, -35.0, 245.0, 340.0, 335.0, 115.0, 65.0, 110.0, 50.0, 310.0, 45.0, 300.0, 115.0, 445.0, -55.0, 345.0, 105.0, 105.0, 485.0, 185.0, 195.0, 60.0, 285.0, 365.0, 175.0, 90.0, 60.0, 545.0, 115.0, -20.0, -55.0, 115.0, 45.0, 55.0, 115.0, 305.0, 345.0, 195.0, 125.0, 45.0, 265.0, 135.0, 305.0, 50.0, 315.0, 145.0, -65.0, 245.0, 50.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1813132469920482, "mean_inference_ms": 1.6000980713327555, "mean_action_processing_ms": 0.5770339771319197, "mean_env_wait_ms": 0.21075889097812645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16097593307495117, "StateBufferConnector_ms": 0.006361722946166992, "ViewRequirementAgentConnector_ms": 0.3318192958831787}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1105920, "num_agent_steps_trained": 1105920, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 86.67249687765376, "num_env_steps_trained_throughput_per_sec": 86.67249687765376, "timesteps_total": 221184, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1105920, "timers": {"training_iteration_time_ms": 93559.738, "sample_time_ms": 14398.397, "load_time_ms": 1.674, "load_throughput": 4892946.523, "learn_time_ms": 79150.814, "learn_throughput": 103.499, "synch_weights_time_ms": 2.746}, "counters": {"num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 1105920, "num_agent_steps_trained": 1105920}, "done": false, "episodes_total": 1728, "training_iteration": 27, "trial_id": "9fade_00019", "date": "2023-11-09_20-40-12", "timestamp": 1699558812, "time_this_iter_s": 94.52928638458252, "time_total_s": 2588.3568193912506, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2588.3568193912506, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 38.02962962962963, "ram_util_percent": 18.759999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5040084549710386, "episode_optimality_min": -0.673469387755102, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5040084549710386, "episode_optimality_capped_min": -0.673469387755102, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.66, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5040084549710386, "curr_learning_score_min": -0.673469387755102, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9797020618213962, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2403756601971933, "policy_loss": -0.0694728402668746, "vf_loss": 0.29880410471315066, "vf_explained_var": 0.40230798066283263, "kl": 0.016362067980584243, "entropy": 4.2640425411363445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 264000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 1146880, "num_agent_steps_trained": 1146880}, "sampler_results": {"episode_reward_max": 545.0, "episode_reward_min": -165.0, "episode_reward_mean": 168.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5040084549710386, "episode_optimality_min": -0.673469387755102, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5040084549710386, "episode_optimality_capped_min": -0.673469387755102, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.66, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5040084549710386, "curr_learning_score_min": -0.673469387755102, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [445.0, -55.0, 345.0, 105.0, 105.0, 485.0, 185.0, 195.0, 60.0, 285.0, 365.0, 175.0, 90.0, 60.0, 545.0, 115.0, -20.0, -55.0, 115.0, 45.0, 55.0, 115.0, 305.0, 345.0, 195.0, 125.0, 45.0, 265.0, 135.0, 305.0, 50.0, 315.0, 145.0, -65.0, 245.0, 50.0, -95.0, -165.0, 55.0, 160.0, 200.0, -40.0, 265.0, 20.0, 200.0, 320.0, 390.0, 5.0, 25.0, 280.0, 150.0, 200.0, 475.0, 250.0, 175.0, 185.0, 160.0, 205.0, 60.0, 95.0, 25.0, 100.0, 240.0, 15.0, 180.0, -75.0, 375.0, -55.0, 325.0, 115.0, 50.0, 290.0, 195.0, 90.0, 195.0, 385.0, 45.0, 100.0, 295.0, 320.0, 160.0, -150.0, 340.0, 135.0, -75.0, 225.0, 260.0, 335.0, 145.0, 50.0, 390.0, 160.0, 435.0, 245.0, 230.0, 115.0, 255.0, 385.0, 175.0, 10.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1797750815877006, "mean_inference_ms": 1.5970541723606708, "mean_action_processing_ms": 0.5762603926524048, "mean_env_wait_ms": 0.21040454241639245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16022300720214844, "StateBufferConnector_ms": 0.006712675094604492, "ViewRequirementAgentConnector_ms": 0.3307688236236572}}, "episode_reward_max": 545.0, "episode_reward_min": -165.0, "episode_reward_mean": 168.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [445.0, -55.0, 345.0, 105.0, 105.0, 485.0, 185.0, 195.0, 60.0, 285.0, 365.0, 175.0, 90.0, 60.0, 545.0, 115.0, -20.0, -55.0, 115.0, 45.0, 55.0, 115.0, 305.0, 345.0, 195.0, 125.0, 45.0, 265.0, 135.0, 305.0, 50.0, 315.0, 145.0, -65.0, 245.0, 50.0, -95.0, -165.0, 55.0, 160.0, 200.0, -40.0, 265.0, 20.0, 200.0, 320.0, 390.0, 5.0, 25.0, 280.0, 150.0, 200.0, 475.0, 250.0, 175.0, 185.0, 160.0, 205.0, 60.0, 95.0, 25.0, 100.0, 240.0, 15.0, 180.0, -75.0, 375.0, -55.0, 325.0, 115.0, 50.0, 290.0, 195.0, 90.0, 195.0, 385.0, 45.0, 100.0, 295.0, 320.0, 160.0, -150.0, 340.0, 135.0, -75.0, 225.0, 260.0, 335.0, 145.0, 50.0, 390.0, 160.0, 435.0, 245.0, 230.0, 115.0, 255.0, 385.0, 175.0, 10.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1797750815877006, "mean_inference_ms": 1.5970541723606708, "mean_action_processing_ms": 0.5762603926524048, "mean_env_wait_ms": 0.21040454241639245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16022300720214844, "StateBufferConnector_ms": 0.006712675094604492, "ViewRequirementAgentConnector_ms": 0.3307688236236572}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1146880, "num_agent_steps_trained": 1146880, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 85.22757345023894, "num_env_steps_trained_throughput_per_sec": 85.22757345023894, "timesteps_total": 229376, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1146880, "timers": {"training_iteration_time_ms": 93862.958, "sample_time_ms": 14443.59, "load_time_ms": 1.673, "load_throughput": 4897968.435, "learn_time_ms": 79408.799, "learn_throughput": 103.162, "synch_weights_time_ms": 2.75}, "counters": {"num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 1146880, "num_agent_steps_trained": 1146880}, "done": false, "episodes_total": 1792, "training_iteration": 28, "trial_id": "9fade_00019", "date": "2023-11-09_20-41-48", "timestamp": 1699558908, "time_this_iter_s": 96.1423773765564, "time_total_s": 2684.499196767807, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2684.499196767807, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.66204379562044, "ram_util_percent": 18.662043795620438}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5793322660680178, "episode_optimality_min": -0.5, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5793322660680178, "episode_optimality_capped_min": -0.5, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.47, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 104.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5793322660680178, "curr_learning_score_min": -0.5, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9747662506671623, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2530033624569963, "policy_loss": -0.06616479226942222, "vf_loss": 0.30853171327185314, "vf_explained_var": 0.3972938014442722, "kl": 0.015757690707136476, "entropy": 4.25757086229821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 273600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 1187840, "num_agent_steps_trained": 1187840}, "sampler_results": {"episode_reward_max": 520.0, "episode_reward_min": -165.0, "episode_reward_mean": 197.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5793322660680178, "episode_optimality_min": -0.5, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5793322660680178, "episode_optimality_capped_min": -0.5, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.47, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 104.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5793322660680178, "curr_learning_score_min": -0.5, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [180.0, -75.0, 375.0, -55.0, 325.0, 115.0, 50.0, 290.0, 195.0, 90.0, 195.0, 385.0, 45.0, 100.0, 295.0, 320.0, 160.0, -150.0, 340.0, 135.0, -75.0, 225.0, 260.0, 335.0, 145.0, 50.0, 390.0, 160.0, 435.0, 245.0, 230.0, 115.0, 255.0, 385.0, 175.0, 10.0, 65.0, 25.0, 190.0, 270.0, 255.0, 325.0, 60.0, 130.0, 240.0, 140.0, 20.0, 400.0, -165.0, -15.0, 250.0, 335.0, 295.0, 145.0, 75.0, 460.0, 0.0, -20.0, 280.0, 345.0, 105.0, 40.0, 350.0, 175.0, 345.0, 245.0, 325.0, 465.0, 325.0, 110.0, 390.0, 0.0, 165.0, 480.0, 520.0, 355.0, 25.0, 325.0, 205.0, 140.0, 300.0, 250.0, 10.0, 235.0, 305.0, 210.0, 250.0, 85.0, 30.0, 350.0, 305.0, 280.0, 50.0, -10.0, 195.0, 330.0, 285.0, 385.0, -80.0, 120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1777289198785528, "mean_inference_ms": 1.5932752014067364, "mean_action_processing_ms": 0.5752691705440743, "mean_env_wait_ms": 0.20983009298234193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15755796432495117, "StateBufferConnector_ms": 0.00664830207824707, "ViewRequirementAgentConnector_ms": 0.3236510753631592}}, "episode_reward_max": 520.0, "episode_reward_min": -165.0, "episode_reward_mean": 197.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.0, -75.0, 375.0, -55.0, 325.0, 115.0, 50.0, 290.0, 195.0, 90.0, 195.0, 385.0, 45.0, 100.0, 295.0, 320.0, 160.0, -150.0, 340.0, 135.0, -75.0, 225.0, 260.0, 335.0, 145.0, 50.0, 390.0, 160.0, 435.0, 245.0, 230.0, 115.0, 255.0, 385.0, 175.0, 10.0, 65.0, 25.0, 190.0, 270.0, 255.0, 325.0, 60.0, 130.0, 240.0, 140.0, 20.0, 400.0, -165.0, -15.0, 250.0, 335.0, 295.0, 145.0, 75.0, 460.0, 0.0, -20.0, 280.0, 345.0, 105.0, 40.0, 350.0, 175.0, 345.0, 245.0, 325.0, 465.0, 325.0, 110.0, 390.0, 0.0, 165.0, 480.0, 520.0, 355.0, 25.0, 325.0, 205.0, 140.0, 300.0, 250.0, 10.0, 235.0, 305.0, 210.0, 250.0, 85.0, 30.0, 350.0, 305.0, 280.0, 50.0, -10.0, 195.0, 330.0, 285.0, 385.0, -80.0, 120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1777289198785528, "mean_inference_ms": 1.5932752014067364, "mean_action_processing_ms": 0.5752691705440743, "mean_env_wait_ms": 0.20983009298234193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15755796432495117, "StateBufferConnector_ms": 0.00664830207824707, "ViewRequirementAgentConnector_ms": 0.3236510753631592}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1187840, "num_agent_steps_trained": 1187840, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 84.5707660367804, "num_env_steps_trained_throughput_per_sec": 84.5707660367804, "timesteps_total": 237568, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1187840, "timers": {"training_iteration_time_ms": 94150.143, "sample_time_ms": 14365.13, "load_time_ms": 1.776, "load_throughput": 4612354.973, "learn_time_ms": 79774.122, "learn_throughput": 102.69, "synch_weights_time_ms": 2.799}, "counters": {"num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 1187840, "num_agent_steps_trained": 1187840}, "done": false, "episodes_total": 1856, "training_iteration": 29, "trial_id": "9fade_00019", "date": "2023-11-09_20-43-25", "timestamp": 1699559005, "time_this_iter_s": 96.88698315620422, "time_total_s": 2781.3861799240112, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2781.3861799240112, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 37.7804347826087, "ram_util_percent": 18.323188405797104}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6336766747230308, "episode_optimality_min": -0.8333333333333334, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6336766747230308, "episode_optimality_capped_min": -0.8333333333333334, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.2, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6336766747230308, "curr_learning_score_min": -0.8333333333333334, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9682471175740163, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.23712075672573216, "policy_loss": -0.06874131055851952, "vf_loss": 0.29508546894571436, "vf_explained_var": 0.3976310196829339, "kl": 0.015965331008814396, "entropy": 4.166183157662551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 283200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 1228800, "num_agent_steps_trained": 1228800}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -275.0, "episode_reward_mean": 226.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6336766747230308, "episode_optimality_min": -0.8333333333333334, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6336766747230308, "episode_optimality_capped_min": -0.8333333333333334, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.2, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6336766747230308, "curr_learning_score_min": -0.8333333333333334, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [345.0, 245.0, 325.0, 465.0, 325.0, 110.0, 390.0, 0.0, 165.0, 480.0, 520.0, 355.0, 25.0, 325.0, 205.0, 140.0, 300.0, 250.0, 10.0, 235.0, 305.0, 210.0, 250.0, 85.0, 30.0, 350.0, 305.0, 280.0, 50.0, -10.0, 195.0, 330.0, 285.0, 385.0, -80.0, 120.0, 445.0, 200.0, 150.0, 460.0, 280.0, 255.0, -275.0, 435.0, 150.0, 225.0, 485.0, 400.0, 155.0, -10.0, 135.0, 90.0, -15.0, 335.0, 45.0, 85.0, 455.0, 20.0, 225.0, 305.0, 330.0, -20.0, 240.0, 400.0, 50.0, 510.0, 295.0, 165.0, 40.0, 465.0, 215.0, 155.0, 600.0, 70.0, 375.0, 245.0, 10.0, 225.0, 445.0, 55.0, 185.0, 20.0, 250.0, 200.0, 115.0, 200.0, 230.0, 335.0, -10.0, 10.0, 125.0, 360.0, 395.0, 395.0, 150.0, 115.0, 440.0, 175.0, 295.0, 405.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.176192797407707, "mean_inference_ms": 1.589711696795037, "mean_action_processing_ms": 0.5745980949429011, "mean_env_wait_ms": 0.20927397232797912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15957903861999512, "StateBufferConnector_ms": 0.00632786750793457, "ViewRequirementAgentConnector_ms": 0.3269493579864502}}, "episode_reward_max": 600.0, "episode_reward_min": -275.0, "episode_reward_mean": 226.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [345.0, 245.0, 325.0, 465.0, 325.0, 110.0, 390.0, 0.0, 165.0, 480.0, 520.0, 355.0, 25.0, 325.0, 205.0, 140.0, 300.0, 250.0, 10.0, 235.0, 305.0, 210.0, 250.0, 85.0, 30.0, 350.0, 305.0, 280.0, 50.0, -10.0, 195.0, 330.0, 285.0, 385.0, -80.0, 120.0, 445.0, 200.0, 150.0, 460.0, 280.0, 255.0, -275.0, 435.0, 150.0, 225.0, 485.0, 400.0, 155.0, -10.0, 135.0, 90.0, -15.0, 335.0, 45.0, 85.0, 455.0, 20.0, 225.0, 305.0, 330.0, -20.0, 240.0, 400.0, 50.0, 510.0, 295.0, 165.0, 40.0, 465.0, 215.0, 155.0, 600.0, 70.0, 375.0, 245.0, 10.0, 225.0, 445.0, 55.0, 185.0, 20.0, 250.0, 200.0, 115.0, 200.0, 230.0, 335.0, -10.0, 10.0, 125.0, 360.0, 395.0, 395.0, 150.0, 115.0, 440.0, 175.0, 295.0, 405.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.176192797407707, "mean_inference_ms": 1.589711696795037, "mean_action_processing_ms": 0.5745980949429011, "mean_env_wait_ms": 0.20927397232797912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15957903861999512, "StateBufferConnector_ms": 0.00632786750793457, "ViewRequirementAgentConnector_ms": 0.3269493579864502}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1228800, "num_agent_steps_trained": 1228800, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 82.53643280528607, "num_env_steps_trained_throughput_per_sec": 82.53643280528607, "timesteps_total": 245760, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1228800, "timers": {"training_iteration_time_ms": 94593.202, "sample_time_ms": 14356.716, "load_time_ms": 1.709, "load_throughput": 4794426.697, "learn_time_ms": 80225.745, "learn_throughput": 102.112, "synch_weights_time_ms": 2.791}, "counters": {"num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 1228800, "num_agent_steps_trained": 1228800}, "done": false, "episodes_total": 1920, "training_iteration": 30, "trial_id": "9fade_00019", "date": "2023-11-09_20-45-04", "timestamp": 1699559104, "time_this_iter_s": 99.27488970756531, "time_total_s": 2880.6610696315765, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2880.6610696315765, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 38.78439716312057, "ram_util_percent": 18.30851063829787}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5699367893206212, "episode_optimality_min": -0.6458333333333334, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5699367893206212, "episode_optimality_capped_min": -0.6458333333333334, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.62, "episode_reward_normalized_min": -31.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5699367893206212, "curr_learning_score_min": -0.6458333333333334, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9853233267708371, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.29954809530177345, "policy_loss": -0.07082221249162103, "vf_loss": 0.3589798491052837, "vf_explained_var": 0.3408597378184398, "kl": 0.016874753174911727, "entropy": 4.153267649685343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 292800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 253952, "num_env_steps_trained": 253952, "num_agent_steps_sampled": 1269760, "num_agent_steps_trained": 1269760}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -155.0, "episode_reward_mean": 208.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5699367893206212, "episode_optimality_min": -0.6458333333333334, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5699367893206212, "episode_optimality_capped_min": -0.6458333333333334, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.62, "episode_reward_normalized_min": -31.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5699367893206212, "curr_learning_score_min": -0.6458333333333334, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [50.0, 510.0, 295.0, 165.0, 40.0, 465.0, 215.0, 155.0, 600.0, 70.0, 375.0, 245.0, 10.0, 225.0, 445.0, 55.0, 185.0, 20.0, 250.0, 200.0, 115.0, 200.0, 230.0, 335.0, -10.0, 10.0, 125.0, 360.0, 395.0, 395.0, 150.0, 115.0, 440.0, 175.0, 295.0, 405.0, 205.0, -65.0, 365.0, 220.0, 35.0, 185.0, -20.0, 420.0, 265.0, 150.0, 195.0, 45.0, 130.0, 215.0, 170.0, 160.0, -150.0, 295.0, 270.0, 215.0, 150.0, 105.0, 155.0, 375.0, 35.0, 0.0, 435.0, 175.0, 55.0, 185.0, 270.0, 25.0, 40.0, 90.0, 25.0, 130.0, 500.0, 300.0, 100.0, 145.0, -10.0, 230.0, 240.0, 200.0, 175.0, 580.0, 280.0, 185.0, 505.0, 120.0, 490.0, 285.0, 145.0, -100.0, 285.0, 205.0, 420.0, 420.0, 95.0, 125.0, 355.0, -155.0, 320.0, 505.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.175048490042185, "mean_inference_ms": 1.5869735332553856, "mean_action_processing_ms": 0.5740687754166903, "mean_env_wait_ms": 0.20889888396107983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1608753204345703, "StateBufferConnector_ms": 0.006373882293701172, "ViewRequirementAgentConnector_ms": 0.33098721504211426}}, "episode_reward_max": 600.0, "episode_reward_min": -155.0, "episode_reward_mean": 208.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.0, 510.0, 295.0, 165.0, 40.0, 465.0, 215.0, 155.0, 600.0, 70.0, 375.0, 245.0, 10.0, 225.0, 445.0, 55.0, 185.0, 20.0, 250.0, 200.0, 115.0, 200.0, 230.0, 335.0, -10.0, 10.0, 125.0, 360.0, 395.0, 395.0, 150.0, 115.0, 440.0, 175.0, 295.0, 405.0, 205.0, -65.0, 365.0, 220.0, 35.0, 185.0, -20.0, 420.0, 265.0, 150.0, 195.0, 45.0, 130.0, 215.0, 170.0, 160.0, -150.0, 295.0, 270.0, 215.0, 150.0, 105.0, 155.0, 375.0, 35.0, 0.0, 435.0, 175.0, 55.0, 185.0, 270.0, 25.0, 40.0, 90.0, 25.0, 130.0, 500.0, 300.0, 100.0, 145.0, -10.0, 230.0, 240.0, 200.0, 175.0, 580.0, 280.0, 185.0, 505.0, 120.0, 490.0, 285.0, 145.0, -100.0, 285.0, 205.0, 420.0, 420.0, 95.0, 125.0, 355.0, -155.0, 320.0, 505.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.175048490042185, "mean_inference_ms": 1.5869735332553856, "mean_action_processing_ms": 0.5740687754166903, "mean_env_wait_ms": 0.20889888396107983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1608753204345703, "StateBufferConnector_ms": 0.006373882293701172, "ViewRequirementAgentConnector_ms": 0.33098721504211426}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1269760, "num_agent_steps_trained": 1269760, "num_env_steps_sampled": 253952, "num_env_steps_trained": 253952, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 82.05969307783651, "num_env_steps_trained_throughput_per_sec": 82.05969307783651, "timesteps_total": 253952, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1269760, "timers": {"training_iteration_time_ms": 95215.829, "sample_time_ms": 14420.053, "load_time_ms": 1.74, "load_throughput": 4706877.953, "learn_time_ms": 80785.124, "learn_throughput": 101.405, "synch_weights_time_ms": 2.609}, "counters": {"num_env_steps_sampled": 253952, "num_env_steps_trained": 253952, "num_agent_steps_sampled": 1269760, "num_agent_steps_trained": 1269760}, "done": false, "episodes_total": 1984, "training_iteration": 31, "trial_id": "9fade_00019", "date": "2023-11-09_20-46-44", "timestamp": 1699559204, "time_this_iter_s": 99.84667205810547, "time_total_s": 2980.507741689682, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2980.507741689682, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 38.099999999999994, "ram_util_percent": 18.083916083916083}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"episode_optimality_mean": 0.5124611543474408, "episode_optimality_min": -0.6724137931034483, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5124611543474408, "episode_optimality_capped_min": -0.6724137931034483, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.39, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5124611543474408, "curr_learning_score_min": -0.6724137931034483, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9699944885882239, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2882063151292095, "policy_loss": -0.06925071814694092, "vf_loss": 0.3464615037267898, "vf_explained_var": 0.39235726386929554, "kl": 0.016289673415971227, "entropy": 4.110377818991741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 302400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 262144, "num_env_steps_trained": 262144, "num_agent_steps_sampled": 1310720, "num_agent_steps_trained": 1310720}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -195.0, "episode_reward_mean": 196.95, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5124611543474408, "episode_optimality_min": -0.6724137931034483, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5124611543474408, "episode_optimality_capped_min": -0.6724137931034483, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.39, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5124611543474408, "curr_learning_score_min": -0.6724137931034483, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [55.0, 185.0, 270.0, 25.0, 40.0, 90.0, 25.0, 130.0, 500.0, 300.0, 100.0, 145.0, -10.0, 230.0, 240.0, 200.0, 175.0, 580.0, 280.0, 185.0, 505.0, 120.0, 490.0, 285.0, 145.0, -100.0, 285.0, 205.0, 420.0, 420.0, 95.0, 125.0, 355.0, -155.0, 320.0, 505.0, 190.0, 520.0, 265.0, -115.0, 265.0, 525.0, 110.0, 325.0, -55.0, 285.0, 140.0, 90.0, 355.0, -195.0, 155.0, 340.0, 80.0, 55.0, 275.0, 315.0, 340.0, 70.0, 200.0, 175.0, 405.0, 335.0, 385.0, 380.0, 195.0, -180.0, -35.0, 175.0, 280.0, 175.0, 165.0, 80.0, 150.0, 150.0, 440.0, 95.0, 45.0, -10.0, -20.0, 455.0, 295.0, 245.0, 250.0, 185.0, 25.0, 315.0, 90.0, 180.0, 75.0, 125.0, 630.0, 125.0, 435.0, 310.0, 265.0, -170.0, 60.0, 70.0, 25.0, 20.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1733782988729171, "mean_inference_ms": 1.582743490225826, "mean_action_processing_ms": 0.5733304988737526, "mean_env_wait_ms": 0.20830069143432448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1586606502532959, "StateBufferConnector_ms": 0.006214618682861328, "ViewRequirementAgentConnector_ms": 0.3250415325164795}}, "episode_reward_max": 630.0, "episode_reward_min": -195.0, "episode_reward_mean": 196.95, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [55.0, 185.0, 270.0, 25.0, 40.0, 90.0, 25.0, 130.0, 500.0, 300.0, 100.0, 145.0, -10.0, 230.0, 240.0, 200.0, 175.0, 580.0, 280.0, 185.0, 505.0, 120.0, 490.0, 285.0, 145.0, -100.0, 285.0, 205.0, 420.0, 420.0, 95.0, 125.0, 355.0, -155.0, 320.0, 505.0, 190.0, 520.0, 265.0, -115.0, 265.0, 525.0, 110.0, 325.0, -55.0, 285.0, 140.0, 90.0, 355.0, -195.0, 155.0, 340.0, 80.0, 55.0, 275.0, 315.0, 340.0, 70.0, 200.0, 175.0, 405.0, 335.0, 385.0, 380.0, 195.0, -180.0, -35.0, 175.0, 280.0, 175.0, 165.0, 80.0, 150.0, 150.0, 440.0, 95.0, 45.0, -10.0, -20.0, 455.0, 295.0, 245.0, 250.0, 185.0, 25.0, 315.0, 90.0, 180.0, 75.0, 125.0, 630.0, 125.0, 435.0, 310.0, 265.0, -170.0, 60.0, 70.0, 25.0, 20.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1733782988729171, "mean_inference_ms": 1.582743490225826, "mean_action_processing_ms": 0.5733304988737526, "mean_env_wait_ms": 0.20830069143432448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1586606502532959, "StateBufferConnector_ms": 0.006214618682861328, "ViewRequirementAgentConnector_ms": 0.3250415325164795}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1310720, "num_agent_steps_trained": 1310720, "num_env_steps_sampled": 262144, "num_env_steps_trained": 262144, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 81.22994642413975, "num_env_steps_trained_throughput_per_sec": 81.22994642413975, "timesteps_total": 262144, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1310720, "timers": {"training_iteration_time_ms": 96023.352, "sample_time_ms": 14289.344, "load_time_ms": 1.825, "load_throughput": 4488066.351, "learn_time_ms": 81722.937, "learn_throughput": 100.241, "synch_weights_time_ms": 2.72}, "counters": {"num_env_steps_sampled": 262144, "num_env_steps_trained": 262144, "num_agent_steps_sampled": 1310720, "num_agent_steps_trained": 1310720}, "done": false, "episodes_total": 2048, "training_iteration": 32, "trial_id": "9fade_00019", "date": "2023-11-09_20-48-25", "timestamp": 1699559305, "time_this_iter_s": 100.86719608306885, "time_total_s": 3081.374937772751, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3081.374937772751, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.649650349650344, "ram_util_percent": 18.44195804195804}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5177851579478153, "episode_optimality_min": -0.5151515151515151, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5177851579478153, "episode_optimality_capped_min": -0.5151515151515151, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.3, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5177851579478153, "curr_learning_score_min": -0.5151515151515151, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9805248950297634, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.285034835551002, "policy_loss": -0.06875255555802141, "vf_loss": 0.3426988321232299, "vf_explained_var": 0.3666582019192477, "kl": 0.016427493983296983, "entropy": 4.11860234990716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 312000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 270336, "num_env_steps_trained": 270336, "num_agent_steps_sampled": 1351680, "num_agent_steps_trained": 1351680}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -180.0, "episode_reward_mean": 181.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5177851579478153, "episode_optimality_min": -0.5151515151515151, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5177851579478153, "episode_optimality_capped_min": -0.5151515151515151, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.3, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5177851579478153, "curr_learning_score_min": -0.5151515151515151, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [195.0, -180.0, -35.0, 175.0, 280.0, 175.0, 165.0, 80.0, 150.0, 150.0, 440.0, 95.0, 45.0, -10.0, -20.0, 455.0, 295.0, 245.0, 250.0, 185.0, 25.0, 315.0, 90.0, 180.0, 75.0, 125.0, 630.0, 125.0, 435.0, 310.0, 265.0, -170.0, 60.0, 70.0, 25.0, 20.0, 410.0, 195.0, 185.0, 320.0, 495.0, 385.0, 105.0, 205.0, 200.0, -30.0, 200.0, 85.0, 10.0, 75.0, 125.0, 170.0, 175.0, 375.0, 15.0, 295.0, -160.0, 20.0, 150.0, 115.0, 320.0, 370.0, 170.0, 270.0, -60.0, 325.0, 235.0, 115.0, 60.0, 485.0, 200.0, 295.0, 80.0, 400.0, 315.0, 260.0, 295.0, 110.0, 220.0, -5.0, 210.0, 310.0, 280.0, 135.0, -20.0, 295.0, 145.0, 275.0, 165.0, 130.0, 360.0, 460.0, 80.0, 45.0, 170.0, 0.0, 140.0, 95.0, 205.0, 375.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1719281967275956, "mean_inference_ms": 1.5789472761346042, "mean_action_processing_ms": 0.5727297829072835, "mean_env_wait_ms": 0.20776620660314227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15961575508117676, "StateBufferConnector_ms": 0.0062448978424072266, "ViewRequirementAgentConnector_ms": 0.3261244297027588}}, "episode_reward_max": 630.0, "episode_reward_min": -180.0, "episode_reward_mean": 181.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [195.0, -180.0, -35.0, 175.0, 280.0, 175.0, 165.0, 80.0, 150.0, 150.0, 440.0, 95.0, 45.0, -10.0, -20.0, 455.0, 295.0, 245.0, 250.0, 185.0, 25.0, 315.0, 90.0, 180.0, 75.0, 125.0, 630.0, 125.0, 435.0, 310.0, 265.0, -170.0, 60.0, 70.0, 25.0, 20.0, 410.0, 195.0, 185.0, 320.0, 495.0, 385.0, 105.0, 205.0, 200.0, -30.0, 200.0, 85.0, 10.0, 75.0, 125.0, 170.0, 175.0, 375.0, 15.0, 295.0, -160.0, 20.0, 150.0, 115.0, 320.0, 370.0, 170.0, 270.0, -60.0, 325.0, 235.0, 115.0, 60.0, 485.0, 200.0, 295.0, 80.0, 400.0, 315.0, 260.0, 295.0, 110.0, 220.0, -5.0, 210.0, 310.0, 280.0, 135.0, -20.0, 295.0, 145.0, 275.0, 165.0, 130.0, 360.0, 460.0, 80.0, 45.0, 170.0, 0.0, 140.0, 95.0, 205.0, 375.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1719281967275956, "mean_inference_ms": 1.5789472761346042, "mean_action_processing_ms": 0.5727297829072835, "mean_env_wait_ms": 0.20776620660314227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15961575508117676, "StateBufferConnector_ms": 0.0062448978424072266, "ViewRequirementAgentConnector_ms": 0.3261244297027588}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1351680, "num_agent_steps_trained": 1351680, "num_env_steps_sampled": 270336, "num_env_steps_trained": 270336, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 80.23402820866372, "num_env_steps_trained_throughput_per_sec": 80.23402820866372, "timesteps_total": 270336, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1351680, "timers": {"training_iteration_time_ms": 97036.05, "sample_time_ms": 14262.16, "load_time_ms": 1.851, "load_throughput": 4424608.32, "learn_time_ms": 82762.452, "learn_throughput": 98.982, "synch_weights_time_ms": 2.871}, "counters": {"num_env_steps_sampled": 270336, "num_env_steps_trained": 270336, "num_agent_steps_sampled": 1351680, "num_agent_steps_trained": 1351680}, "done": false, "episodes_total": 2112, "training_iteration": 33, "trial_id": "9fade_00019", "date": "2023-11-09_20-50-08", "timestamp": 1699559408, "time_this_iter_s": 102.11861371994019, "time_total_s": 3183.493551492691, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3183.493551492691, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 37.96917808219178, "ram_util_percent": 18.46301369863014}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5870456004883948, "episode_optimality_min": -0.6222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5870456004883948, "episode_optimality_capped_min": -0.6222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.2, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 106.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5870456004883948, "curr_learning_score_min": -0.6222222222222222, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9801844207166384, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.24217891945396938, "policy_loss": -0.069553425300716, "vf_loss": 0.3006518071606115, "vf_explained_var": 0.3952466682344675, "kl": 0.016415611049769154, "entropy": 4.092123346403241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 321600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 278528, "num_env_steps_trained": 278528, "num_agent_steps_sampled": 1392640, "num_agent_steps_trained": 1392640}, "sampler_results": {"episode_reward_max": 530.0, "episode_reward_min": -140.0, "episode_reward_mean": 201.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5870456004883948, "episode_optimality_min": -0.6222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5870456004883948, "episode_optimality_capped_min": -0.6222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.2, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 106.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5870456004883948, "curr_learning_score_min": -0.6222222222222222, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-60.0, 325.0, 235.0, 115.0, 60.0, 485.0, 200.0, 295.0, 80.0, 400.0, 315.0, 260.0, 295.0, 110.0, 220.0, -5.0, 210.0, 310.0, 280.0, 135.0, -20.0, 295.0, 145.0, 275.0, 165.0, 130.0, 360.0, 460.0, 80.0, 45.0, 170.0, 0.0, 140.0, 95.0, 205.0, 375.0, 400.0, 160.0, 120.0, 260.0, 165.0, 325.0, 350.0, 395.0, 185.0, 185.0, -55.0, 415.0, 360.0, 95.0, 100.0, 270.0, 240.0, 115.0, 320.0, 215.0, 325.0, 530.0, 75.0, 230.0, 90.0, 5.0, 75.0, 365.0, 210.0, 85.0, 210.0, 25.0, 80.0, 240.0, 210.0, 375.0, 325.0, 190.0, 375.0, 355.0, 25.0, 35.0, 150.0, 280.0, 360.0, 190.0, 65.0, -55.0, 225.0, 205.0, 35.0, 20.0, 260.0, 100.0, 235.0, 365.0, 195.0, 255.0, 60.0, 190.0, -140.0, 120.0, 500.0, 245.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1713828594884348, "mean_inference_ms": 1.577001419139802, "mean_action_processing_ms": 0.5725741740011153, "mean_env_wait_ms": 0.20749231519465705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16183066368103027, "StateBufferConnector_ms": 0.006491184234619141, "ViewRequirementAgentConnector_ms": 0.33734583854675293}}, "episode_reward_max": 530.0, "episode_reward_min": -140.0, "episode_reward_mean": 201.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, 325.0, 235.0, 115.0, 60.0, 485.0, 200.0, 295.0, 80.0, 400.0, 315.0, 260.0, 295.0, 110.0, 220.0, -5.0, 210.0, 310.0, 280.0, 135.0, -20.0, 295.0, 145.0, 275.0, 165.0, 130.0, 360.0, 460.0, 80.0, 45.0, 170.0, 0.0, 140.0, 95.0, 205.0, 375.0, 400.0, 160.0, 120.0, 260.0, 165.0, 325.0, 350.0, 395.0, 185.0, 185.0, -55.0, 415.0, 360.0, 95.0, 100.0, 270.0, 240.0, 115.0, 320.0, 215.0, 325.0, 530.0, 75.0, 230.0, 90.0, 5.0, 75.0, 365.0, 210.0, 85.0, 210.0, 25.0, 80.0, 240.0, 210.0, 375.0, 325.0, 190.0, 375.0, 355.0, 25.0, 35.0, 150.0, 280.0, 360.0, 190.0, 65.0, -55.0, 225.0, 205.0, 35.0, 20.0, 260.0, 100.0, 235.0, 365.0, 195.0, 255.0, 60.0, 190.0, -140.0, 120.0, 500.0, 245.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1713828594884348, "mean_inference_ms": 1.577001419139802, "mean_action_processing_ms": 0.5725741740011153, "mean_env_wait_ms": 0.20749231519465705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16183066368103027, "StateBufferConnector_ms": 0.006491184234619141, "ViewRequirementAgentConnector_ms": 0.33734583854675293}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392640, "num_agent_steps_trained": 1392640, "num_env_steps_sampled": 278528, "num_env_steps_trained": 278528, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 79.37013957391521, "num_env_steps_trained_throughput_per_sec": 79.37013957391521, "timesteps_total": 278528, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1392640, "timers": {"training_iteration_time_ms": 98071.784, "sample_time_ms": 14292.761, "load_time_ms": 1.847, "load_throughput": 4435517.765, "learn_time_ms": 83767.317, "learn_throughput": 97.795, "synch_weights_time_ms": 3.05}, "counters": {"num_env_steps_sampled": 278528, "num_env_steps_trained": 278528, "num_agent_steps_sampled": 1392640, "num_agent_steps_trained": 1392640}, "done": false, "episodes_total": 2176, "training_iteration": 34, "trial_id": "9fade_00019", "date": "2023-11-09_20-51-51", "timestamp": 1699559511, "time_this_iter_s": 103.23120737075806, "time_total_s": 3286.724758863449, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3286.724758863449, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 37.910204081632656, "ram_util_percent": 18.695238095238093}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5846421880706402, "episode_optimality_min": -0.8085106382978723, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5846421880706402, "episode_optimality_capped_min": -0.8085106382978723, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.13, "episode_reward_normalized_min": -38.0, "episode_reward_normalized_max": 101.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5846421880706402, "curr_learning_score_min": -0.8085106382978723, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9770475352120896, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2525576819476555, "policy_loss": -0.06923510301135441, "vf_loss": 0.3108034542186336, "vf_explained_var": 0.3825846922459702, "kl": 0.016280490369429874, "entropy": 4.064353912075361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 331200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 286720, "num_env_steps_trained": 286720, "num_agent_steps_sampled": 1433600, "num_agent_steps_trained": 1433600}, "sampler_results": {"episode_reward_max": 505.0, "episode_reward_min": -190.0, "episode_reward_mean": 205.65, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5846421880706402, "episode_optimality_min": -0.8085106382978723, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5846421880706402, "episode_optimality_capped_min": -0.8085106382978723, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.13, "episode_reward_normalized_min": -38.0, "episode_reward_normalized_max": 101.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5846421880706402, "curr_learning_score_min": -0.8085106382978723, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [210.0, 85.0, 210.0, 25.0, 80.0, 240.0, 210.0, 375.0, 325.0, 190.0, 375.0, 355.0, 25.0, 35.0, 150.0, 280.0, 360.0, 190.0, 65.0, -55.0, 225.0, 205.0, 35.0, 20.0, 260.0, 100.0, 235.0, 365.0, 195.0, 255.0, 60.0, 190.0, -140.0, 120.0, 500.0, 245.0, 270.0, 450.0, 240.0, 290.0, 90.0, 205.0, 370.0, 205.0, 150.0, 50.0, 505.0, -55.0, 80.0, 375.0, 35.0, 80.0, 450.0, 285.0, 190.0, 465.0, 325.0, 350.0, 120.0, -190.0, 90.0, 295.0, 85.0, -70.0, 330.0, 15.0, 330.0, 320.0, 385.0, -190.0, 370.0, 280.0, 210.0, 245.0, 170.0, 0.0, 145.0, 300.0, 225.0, 375.0, 15.0, 120.0, 135.0, 320.0, 295.0, 185.0, 40.0, 190.0, 280.0, 280.0, 215.0, 400.0, 350.0, 485.0, 120.0, 280.0, 205.0, 420.0, 370.0, 15.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1714924383838416, "mean_inference_ms": 1.5775317251890941, "mean_action_processing_ms": 0.5730327951201649, "mean_env_wait_ms": 0.20754955951211385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.163834810256958, "StateBufferConnector_ms": 0.0066471099853515625, "ViewRequirementAgentConnector_ms": 0.34538912773132324}}, "episode_reward_max": 505.0, "episode_reward_min": -190.0, "episode_reward_mean": 205.65, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [210.0, 85.0, 210.0, 25.0, 80.0, 240.0, 210.0, 375.0, 325.0, 190.0, 375.0, 355.0, 25.0, 35.0, 150.0, 280.0, 360.0, 190.0, 65.0, -55.0, 225.0, 205.0, 35.0, 20.0, 260.0, 100.0, 235.0, 365.0, 195.0, 255.0, 60.0, 190.0, -140.0, 120.0, 500.0, 245.0, 270.0, 450.0, 240.0, 290.0, 90.0, 205.0, 370.0, 205.0, 150.0, 50.0, 505.0, -55.0, 80.0, 375.0, 35.0, 80.0, 450.0, 285.0, 190.0, 465.0, 325.0, 350.0, 120.0, -190.0, 90.0, 295.0, 85.0, -70.0, 330.0, 15.0, 330.0, 320.0, 385.0, -190.0, 370.0, 280.0, 210.0, 245.0, 170.0, 0.0, 145.0, 300.0, 225.0, 375.0, 15.0, 120.0, 135.0, 320.0, 295.0, 185.0, 40.0, 190.0, 280.0, 280.0, 215.0, 400.0, 350.0, 485.0, 120.0, 280.0, 205.0, 420.0, 370.0, 15.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1714924383838416, "mean_inference_ms": 1.5775317251890941, "mean_action_processing_ms": 0.5730327951201649, "mean_env_wait_ms": 0.20754955951211385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.163834810256958, "StateBufferConnector_ms": 0.0066471099853515625, "ViewRequirementAgentConnector_ms": 0.34538912773132324}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1433600, "num_agent_steps_trained": 1433600, "num_env_steps_sampled": 286720, "num_env_steps_trained": 286720, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 76.98478393121563, "num_env_steps_trained_throughput_per_sec": 76.98478393121563, "timesteps_total": 286720, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1433600, "timers": {"training_iteration_time_ms": 99446.501, "sample_time_ms": 14359.648, "load_time_ms": 1.865, "load_throughput": 4392255.761, "learn_time_ms": 85075.161, "learn_throughput": 96.291, "synch_weights_time_ms": 2.938}, "counters": {"num_env_steps_sampled": 286720, "num_env_steps_trained": 286720, "num_agent_steps_sampled": 1433600, "num_agent_steps_trained": 1433600}, "done": false, "episodes_total": 2240, "training_iteration": 35, "trial_id": "9fade_00019", "date": "2023-11-09_20-53-37", "timestamp": 1699559617, "time_this_iter_s": 106.42750000953674, "time_total_s": 3393.152258872986, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3393.152258872986, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 38.61052631578947, "ram_util_percent": 18.467105263157894}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5629630675317749, "episode_optimality_min": -0.8085106382978723, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5629630675317749, "episode_optimality_capped_min": -0.8085106382978723, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.73, "episode_reward_normalized_min": -38.0, "episode_reward_normalized_max": 102.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5629630675317749, "curr_learning_score_min": -0.8085106382978723, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9720996608864516, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.26573800334338255, "policy_loss": -0.06933866786993652, "vf_loss": 0.3238197135053148, "vf_explained_var": 0.4059675687241058, "kl": 0.016676974447033786, "entropy": 4.014349416097005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 340800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 294912, "num_env_steps_trained": 294912, "num_agent_steps_sampled": 1474560, "num_agent_steps_trained": 1474560}, "sampler_results": {"episode_reward_max": 510.0, "episode_reward_min": -190.0, "episode_reward_mean": 213.65, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5629630675317749, "episode_optimality_min": -0.8085106382978723, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5629630675317749, "episode_optimality_capped_min": -0.8085106382978723, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.73, "episode_reward_normalized_min": -38.0, "episode_reward_normalized_max": 102.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5629630675317749, "curr_learning_score_min": -0.8085106382978723, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [330.0, 15.0, 330.0, 320.0, 385.0, -190.0, 370.0, 280.0, 210.0, 245.0, 170.0, 0.0, 145.0, 300.0, 225.0, 375.0, 15.0, 120.0, 135.0, 320.0, 295.0, 185.0, 40.0, 190.0, 280.0, 280.0, 215.0, 400.0, 350.0, 485.0, 120.0, 280.0, 205.0, 420.0, 370.0, 15.0, 85.0, 300.0, 320.0, 100.0, -25.0, -75.0, 465.0, 65.0, 245.0, 340.0, 95.0, 115.0, 425.0, 65.0, -55.0, 430.0, -45.0, -135.0, 405.0, 330.0, 280.0, 60.0, 220.0, 175.0, 385.0, 195.0, 205.0, -140.0, 315.0, 180.0, -105.0, 390.0, 270.0, 440.0, 260.0, -65.0, 485.0, 205.0, 210.0, 190.0, 120.0, 140.0, 320.0, 70.0, 285.0, 80.0, -90.0, 510.0, 145.0, 335.0, 490.0, 280.0, 345.0, 120.0, 90.0, 330.0, 125.0, 305.0, 295.0, 480.0, 245.0, 300.0, 185.0, 25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1708802668465697, "mean_inference_ms": 1.5760892141009362, "mean_action_processing_ms": 0.5728067376713052, "mean_env_wait_ms": 0.20732208778954472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16239047050476074, "StateBufferConnector_ms": 0.006393909454345703, "ViewRequirementAgentConnector_ms": 0.3335585594177246}}, "episode_reward_max": 510.0, "episode_reward_min": -190.0, "episode_reward_mean": 213.65, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.0, 15.0, 330.0, 320.0, 385.0, -190.0, 370.0, 280.0, 210.0, 245.0, 170.0, 0.0, 145.0, 300.0, 225.0, 375.0, 15.0, 120.0, 135.0, 320.0, 295.0, 185.0, 40.0, 190.0, 280.0, 280.0, 215.0, 400.0, 350.0, 485.0, 120.0, 280.0, 205.0, 420.0, 370.0, 15.0, 85.0, 300.0, 320.0, 100.0, -25.0, -75.0, 465.0, 65.0, 245.0, 340.0, 95.0, 115.0, 425.0, 65.0, -55.0, 430.0, -45.0, -135.0, 405.0, 330.0, 280.0, 60.0, 220.0, 175.0, 385.0, 195.0, 205.0, -140.0, 315.0, 180.0, -105.0, 390.0, 270.0, 440.0, 260.0, -65.0, 485.0, 205.0, 210.0, 190.0, 120.0, 140.0, 320.0, 70.0, 285.0, 80.0, -90.0, 510.0, 145.0, 335.0, 490.0, 280.0, 345.0, 120.0, 90.0, 330.0, 125.0, 305.0, 295.0, 480.0, 245.0, 300.0, 185.0, 25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1708802668465697, "mean_inference_ms": 1.5760892141009362, "mean_action_processing_ms": 0.5728067376713052, "mean_env_wait_ms": 0.20732208778954472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16239047050476074, "StateBufferConnector_ms": 0.006393909454345703, "ViewRequirementAgentConnector_ms": 0.3335585594177246}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1474560, "num_agent_steps_trained": 1474560, "num_env_steps_sampled": 294912, "num_env_steps_trained": 294912, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 76.35303597171132, "num_env_steps_trained_throughput_per_sec": 76.35303597171132, "timesteps_total": 294912, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1474560, "timers": {"training_iteration_time_ms": 100644.925, "sample_time_ms": 14384.311, "load_time_ms": 1.856, "load_throughput": 4413582.321, "learn_time_ms": 86248.77, "learn_throughput": 94.981, "synch_weights_time_ms": 2.988}, "counters": {"num_env_steps_sampled": 294912, "num_env_steps_trained": 294912, "num_agent_steps_sampled": 1474560, "num_agent_steps_trained": 1474560}, "done": false, "episodes_total": 2304, "training_iteration": 36, "trial_id": "9fade_00019", "date": "2023-11-09_20-55-25", "timestamp": 1699559725, "time_this_iter_s": 107.30733680725098, "time_total_s": 3500.459595680237, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3500.459595680237, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 37.67581699346405, "ram_util_percent": 18.401960784313726}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5825415364275834, "episode_optimality_min": -0.7368421052631579, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5825415364275834, "episode_optimality_capped_min": -0.7368421052631579, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.57, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5825415364275834, "curr_learning_score_min": -0.7368421052631579, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.98338424650797, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2669505017993409, "policy_loss": -0.06779785213026722, "vf_loss": 0.323554367862677, "vf_explained_var": 0.35776946947599453, "kl": 0.016583682203662988, "entropy": 4.025682450557748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 350400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 303104, "num_env_steps_trained": 303104, "num_agent_steps_sampled": 1515520, "num_agent_steps_trained": 1515520}, "sampler_results": {"episode_reward_max": 605.0, "episode_reward_min": -140.0, "episode_reward_mean": 222.85, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5825415364275834, "episode_optimality_min": -0.7368421052631579, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5825415364275834, "episode_optimality_capped_min": -0.7368421052631579, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.57, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5825415364275834, "curr_learning_score_min": -0.7368421052631579, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [315.0, 180.0, -105.0, 390.0, 270.0, 440.0, 260.0, -65.0, 485.0, 205.0, 210.0, 190.0, 120.0, 140.0, 320.0, 70.0, 285.0, 80.0, -90.0, 510.0, 145.0, 335.0, 490.0, 280.0, 345.0, 120.0, 90.0, 330.0, 125.0, 305.0, 295.0, 480.0, 245.0, 300.0, 185.0, 25.0, 230.0, 290.0, 305.0, 450.0, 250.0, 260.0, 15.0, 290.0, 585.0, 25.0, 370.0, -25.0, 10.0, 75.0, -140.0, 135.0, 315.0, 205.0, 120.0, 110.0, 400.0, 355.0, 90.0, 145.0, 340.0, 250.0, 110.0, 605.0, 330.0, 310.0, 235.0, 415.0, 320.0, 260.0, 95.0, 350.0, 315.0, 70.0, 360.0, 310.0, 370.0, 215.0, 125.0, 135.0, 350.0, -25.0, 325.0, 205.0, 345.0, 160.0, 290.0, 100.0, 180.0, 165.0, 125.0, 60.0, 140.0, 185.0, 320.0, 345.0, -25.0, 50.0, 0.0, 300.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1699492952042854, "mean_inference_ms": 1.573233806795472, "mean_action_processing_ms": 0.572427633455731, "mean_env_wait_ms": 0.20692268412192405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16134905815124512, "StateBufferConnector_ms": 0.006362199783325195, "ViewRequirementAgentConnector_ms": 0.3303370475769043}}, "episode_reward_max": 605.0, "episode_reward_min": -140.0, "episode_reward_mean": 222.85, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [315.0, 180.0, -105.0, 390.0, 270.0, 440.0, 260.0, -65.0, 485.0, 205.0, 210.0, 190.0, 120.0, 140.0, 320.0, 70.0, 285.0, 80.0, -90.0, 510.0, 145.0, 335.0, 490.0, 280.0, 345.0, 120.0, 90.0, 330.0, 125.0, 305.0, 295.0, 480.0, 245.0, 300.0, 185.0, 25.0, 230.0, 290.0, 305.0, 450.0, 250.0, 260.0, 15.0, 290.0, 585.0, 25.0, 370.0, -25.0, 10.0, 75.0, -140.0, 135.0, 315.0, 205.0, 120.0, 110.0, 400.0, 355.0, 90.0, 145.0, 340.0, 250.0, 110.0, 605.0, 330.0, 310.0, 235.0, 415.0, 320.0, 260.0, 95.0, 350.0, 315.0, 70.0, 360.0, 310.0, 370.0, 215.0, 125.0, 135.0, 350.0, -25.0, 325.0, 205.0, 345.0, 160.0, 290.0, 100.0, 180.0, 165.0, 125.0, 60.0, 140.0, 185.0, 320.0, 345.0, -25.0, 50.0, 0.0, 300.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1699492952042854, "mean_inference_ms": 1.573233806795472, "mean_action_processing_ms": 0.572427633455731, "mean_env_wait_ms": 0.20692268412192405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16134905815124512, "StateBufferConnector_ms": 0.006362199783325195, "ViewRequirementAgentConnector_ms": 0.3303370475769043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1515520, "num_agent_steps_trained": 1515520, "num_env_steps_sampled": 303104, "num_env_steps_trained": 303104, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 76.53402840184273, "num_env_steps_trained_throughput_per_sec": 76.53402840184273, "timesteps_total": 303104, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1515520, "timers": {"training_iteration_time_ms": 101896.989, "sample_time_ms": 14359.547, "load_time_ms": 1.878, "load_throughput": 4363196.786, "learn_time_ms": 87525.493, "learn_throughput": 93.596, "synch_weights_time_ms": 3.019}, "counters": {"num_env_steps_sampled": 303104, "num_env_steps_trained": 303104, "num_agent_steps_sampled": 1515520, "num_agent_steps_trained": 1515520}, "done": false, "episodes_total": 2368, "training_iteration": 37, "trial_id": "9fade_00019", "date": "2023-11-09_20-57-12", "timestamp": 1699559832, "time_this_iter_s": 107.05365371704102, "time_total_s": 3607.513249397278, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3607.513249397278, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 38.38881578947369, "ram_util_percent": 18.56776315789473}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4833037100311505, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4833037100311505, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.86, "episode_reward_normalized_min": -83.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4833037100311505, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9773547034648558, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.27953475789271276, "policy_loss": -0.07465553392406339, "vf_loss": 0.34249423084649605, "vf_explained_var": 0.3643965184067686, "kl": 0.017327497517352033, "entropy": 4.04771705451111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 360000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 311296, "num_env_steps_trained": 311296, "num_agent_steps_sampled": 1556480, "num_agent_steps_trained": 1556480}, "sampler_results": {"episode_reward_max": 545.0, "episode_reward_min": -415.0, "episode_reward_mean": 169.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4833037100311505, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4833037100311505, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.86, "episode_reward_normalized_min": -83.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4833037100311505, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [330.0, 310.0, 235.0, 415.0, 320.0, 260.0, 95.0, 350.0, 315.0, 70.0, 360.0, 310.0, 370.0, 215.0, 125.0, 135.0, 350.0, -25.0, 325.0, 205.0, 345.0, 160.0, 290.0, 100.0, 180.0, 165.0, 125.0, 60.0, 140.0, 185.0, 320.0, 345.0, -25.0, 50.0, 0.0, 300.0, 110.0, 130.0, 260.0, 70.0, 50.0, 260.0, -45.0, 235.0, 310.0, -45.0, 260.0, 545.0, 315.0, 185.0, -415.0, -5.0, 95.0, -30.0, 185.0, 105.0, 215.0, -80.0, -30.0, 440.0, -65.0, -75.0, 130.0, 15.0, 145.0, 135.0, 340.0, 110.0, 240.0, 350.0, 180.0, 210.0, 290.0, 230.0, -85.0, 30.0, 90.0, 130.0, 25.0, -10.0, 335.0, 140.0, -40.0, 320.0, 10.0, 170.0, 280.0, 70.0, 0.0, -75.0, 345.0, 185.0, 250.0, 480.0, 240.0, 495.0, -220.0, 210.0, 45.0, 345.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1694204810395263, "mean_inference_ms": 1.5713841723249409, "mean_action_processing_ms": 0.5721964078291186, "mean_env_wait_ms": 0.2066710579323946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16301774978637695, "StateBufferConnector_ms": 0.006395578384399414, "ViewRequirementAgentConnector_ms": 0.33235859870910645}}, "episode_reward_max": 545.0, "episode_reward_min": -415.0, "episode_reward_mean": 169.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.0, 310.0, 235.0, 415.0, 320.0, 260.0, 95.0, 350.0, 315.0, 70.0, 360.0, 310.0, 370.0, 215.0, 125.0, 135.0, 350.0, -25.0, 325.0, 205.0, 345.0, 160.0, 290.0, 100.0, 180.0, 165.0, 125.0, 60.0, 140.0, 185.0, 320.0, 345.0, -25.0, 50.0, 0.0, 300.0, 110.0, 130.0, 260.0, 70.0, 50.0, 260.0, -45.0, 235.0, 310.0, -45.0, 260.0, 545.0, 315.0, 185.0, -415.0, -5.0, 95.0, -30.0, 185.0, 105.0, 215.0, -80.0, -30.0, 440.0, -65.0, -75.0, 130.0, 15.0, 145.0, 135.0, 340.0, 110.0, 240.0, 350.0, 180.0, 210.0, 290.0, 230.0, -85.0, 30.0, 90.0, 130.0, 25.0, -10.0, 335.0, 140.0, -40.0, 320.0, 10.0, 170.0, 280.0, 70.0, 0.0, -75.0, 345.0, 185.0, 250.0, 480.0, 240.0, 495.0, -220.0, 210.0, 45.0, 345.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1694204810395263, "mean_inference_ms": 1.5713841723249409, "mean_action_processing_ms": 0.5721964078291186, "mean_env_wait_ms": 0.2066710579323946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16301774978637695, "StateBufferConnector_ms": 0.006395578384399414, "ViewRequirementAgentConnector_ms": 0.33235859870910645}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1556480, "num_agent_steps_trained": 1556480, "num_env_steps_sampled": 311296, "num_env_steps_trained": 311296, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 77.77776294143831, "num_env_steps_trained_throughput_per_sec": 77.77776294143831, "timesteps_total": 311296, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1556480, "timers": {"training_iteration_time_ms": 102817.649, "sample_time_ms": 14333.249, "load_time_ms": 1.881, "load_throughput": 4355840.162, "learn_time_ms": 88472.42, "learn_throughput": 92.594, "synch_weights_time_ms": 3.036}, "counters": {"num_env_steps_sampled": 311296, "num_env_steps_trained": 311296, "num_agent_steps_sampled": 1556480, "num_agent_steps_trained": 1556480}, "done": false, "episodes_total": 2432, "training_iteration": 38, "trial_id": "9fade_00019", "date": "2023-11-09_20-58-57", "timestamp": 1699559937, "time_this_iter_s": 105.33897042274475, "time_total_s": 3712.8522198200226, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3712.8522198200226, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 37.82119205298013, "ram_util_percent": 18.429139072847676}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5380302648546487, "episode_optimality_min": -0.7857142857142857, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5380302648546487, "episode_optimality_capped_min": -0.7857142857142857, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.44, "episode_reward_normalized_min": -46.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5380302648546487, "curr_learning_score_min": -0.7857142857142857, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9725235532410443, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.24158751340694531, "policy_loss": -0.07031377417370095, "vf_loss": 0.3006035122368, "vf_explained_var": 0.39663472878436246, "kl": 0.016737445105704865, "entropy": 3.9819454734275737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 369600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 319488, "num_env_steps_trained": 319488, "num_agent_steps_sampled": 1597440, "num_agent_steps_trained": 1597440}, "sampler_results": {"episode_reward_max": 570.0, "episode_reward_min": -230.0, "episode_reward_mean": 182.2, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5380302648546487, "episode_optimality_min": -0.7857142857142857, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5380302648546487, "episode_optimality_capped_min": -0.7857142857142857, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.44, "episode_reward_normalized_min": -46.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5380302648546487, "curr_learning_score_min": -0.7857142857142857, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [145.0, 135.0, 340.0, 110.0, 240.0, 350.0, 180.0, 210.0, 290.0, 230.0, -85.0, 30.0, 90.0, 130.0, 25.0, -10.0, 335.0, 140.0, -40.0, 320.0, 10.0, 170.0, 280.0, 70.0, 0.0, -75.0, 345.0, 185.0, 250.0, 480.0, 240.0, 495.0, -220.0, 210.0, 45.0, 345.0, 45.0, 195.0, 390.0, -230.0, 185.0, 300.0, 120.0, 40.0, 370.0, 280.0, 260.0, 570.0, 20.0, 5.0, 180.0, 200.0, 195.0, 180.0, 390.0, 205.0, 545.0, 370.0, 40.0, -25.0, 100.0, -20.0, 165.0, -95.0, 460.0, 160.0, 275.0, -5.0, 175.0, 240.0, 90.0, 165.0, 215.0, 55.0, 120.0, 325.0, 140.0, 65.0, 400.0, 270.0, 25.0, 340.0, 390.0, 380.0, 60.0, 170.0, 250.0, 295.0, -120.0, 170.0, 320.0, 250.0, 35.0, 375.0, 175.0, 150.0, 165.0, 15.0, 220.0, 430.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1688933552716692, "mean_inference_ms": 1.5699325656040515, "mean_action_processing_ms": 0.5719657135684465, "mean_env_wait_ms": 0.2064635607502916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1613762378692627, "StateBufferConnector_ms": 0.006415367126464844, "ViewRequirementAgentConnector_ms": 0.33195924758911133}}, "episode_reward_max": 570.0, "episode_reward_min": -230.0, "episode_reward_mean": 182.2, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [145.0, 135.0, 340.0, 110.0, 240.0, 350.0, 180.0, 210.0, 290.0, 230.0, -85.0, 30.0, 90.0, 130.0, 25.0, -10.0, 335.0, 140.0, -40.0, 320.0, 10.0, 170.0, 280.0, 70.0, 0.0, -75.0, 345.0, 185.0, 250.0, 480.0, 240.0, 495.0, -220.0, 210.0, 45.0, 345.0, 45.0, 195.0, 390.0, -230.0, 185.0, 300.0, 120.0, 40.0, 370.0, 280.0, 260.0, 570.0, 20.0, 5.0, 180.0, 200.0, 195.0, 180.0, 390.0, 205.0, 545.0, 370.0, 40.0, -25.0, 100.0, -20.0, 165.0, -95.0, 460.0, 160.0, 275.0, -5.0, 175.0, 240.0, 90.0, 165.0, 215.0, 55.0, 120.0, 325.0, 140.0, 65.0, 400.0, 270.0, 25.0, 340.0, 390.0, 380.0, 60.0, 170.0, 250.0, 295.0, -120.0, 170.0, 320.0, 250.0, 35.0, 375.0, 175.0, 150.0, 165.0, 15.0, 220.0, 430.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1688933552716692, "mean_inference_ms": 1.5699325656040515, "mean_action_processing_ms": 0.5719657135684465, "mean_env_wait_ms": 0.2064635607502916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1613762378692627, "StateBufferConnector_ms": 0.006415367126464844, "ViewRequirementAgentConnector_ms": 0.33195924758911133}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1597440, "num_agent_steps_trained": 1597440, "num_env_steps_sampled": 319488, "num_env_steps_trained": 319488, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 75.77794664204785, "num_env_steps_trained_throughput_per_sec": 75.77794664204785, "timesteps_total": 319488, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1597440, "timers": {"training_iteration_time_ms": 103941.623, "sample_time_ms": 14433.796, "load_time_ms": 1.76, "load_throughput": 4655538.774, "learn_time_ms": 89496.111, "learn_throughput": 91.535, "synch_weights_time_ms": 2.984}, "counters": {"num_env_steps_sampled": 319488, "num_env_steps_trained": 319488, "num_agent_steps_sampled": 1597440, "num_agent_steps_trained": 1597440}, "done": false, "episodes_total": 2496, "training_iteration": 39, "trial_id": "9fade_00019", "date": "2023-11-09_21-00-45", "timestamp": 1699560045, "time_this_iter_s": 108.11844372749329, "time_total_s": 3820.970663547516, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3820.970663547516, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 37.598051948051946, "ram_util_percent": 18.457792207792206}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5577351829961905, "episode_optimality_min": -0.7922077922077922, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5577351829961905, "episode_optimality_capped_min": -0.7922077922077922, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.2, "episode_reward_normalized_min": -61.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5577351829961905, "curr_learning_score_min": -0.7922077922077922, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9742655946438511, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2861254790219876, "policy_loss": -0.06870697613022154, "vf_loss": 0.34376161310913933, "vf_explained_var": 0.37649178294464947, "kl": 0.01640124724836691, "entropy": 3.9660751032084227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 379200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 327680, "num_env_steps_trained": 327680, "num_agent_steps_sampled": 1638400, "num_agent_steps_trained": 1638400}, "sampler_results": {"episode_reward_max": 535.0, "episode_reward_min": -305.0, "episode_reward_mean": 191.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5577351829961905, "episode_optimality_min": -0.7922077922077922, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5577351829961905, "episode_optimality_capped_min": -0.7922077922077922, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.2, "episode_reward_normalized_min": -61.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5577351829961905, "curr_learning_score_min": -0.7922077922077922, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [460.0, 160.0, 275.0, -5.0, 175.0, 240.0, 90.0, 165.0, 215.0, 55.0, 120.0, 325.0, 140.0, 65.0, 400.0, 270.0, 25.0, 340.0, 390.0, 380.0, 60.0, 170.0, 250.0, 295.0, -120.0, 170.0, 320.0, 250.0, 35.0, 375.0, 175.0, 150.0, 165.0, 15.0, 220.0, 430.0, 130.0, 115.0, 535.0, 300.0, -200.0, 95.0, 480.0, 215.0, 5.0, 295.0, -35.0, 435.0, 50.0, 290.0, 180.0, 265.0, 0.0, 35.0, 315.0, 340.0, -45.0, 335.0, 260.0, 90.0, 240.0, -90.0, 310.0, -305.0, 250.0, 90.0, 310.0, 225.0, 150.0, 350.0, 375.0, 245.0, 285.0, 55.0, 55.0, 185.0, 25.0, 215.0, 160.0, 125.0, 340.0, 350.0, 280.0, 185.0, 485.0, 490.0, 45.0, -90.0, 80.0, 280.0, 370.0, 110.0, -245.0, 210.0, -45.0, 415.0, 315.0, 125.0, 285.0, 130.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1684164933964154, "mean_inference_ms": 1.5689766452177525, "mean_action_processing_ms": 0.571721171452728, "mean_env_wait_ms": 0.20633713566517892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16117215156555176, "StateBufferConnector_ms": 0.006430149078369141, "ViewRequirementAgentConnector_ms": 0.3334653377532959}}, "episode_reward_max": 535.0, "episode_reward_min": -305.0, "episode_reward_mean": 191.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [460.0, 160.0, 275.0, -5.0, 175.0, 240.0, 90.0, 165.0, 215.0, 55.0, 120.0, 325.0, 140.0, 65.0, 400.0, 270.0, 25.0, 340.0, 390.0, 380.0, 60.0, 170.0, 250.0, 295.0, -120.0, 170.0, 320.0, 250.0, 35.0, 375.0, 175.0, 150.0, 165.0, 15.0, 220.0, 430.0, 130.0, 115.0, 535.0, 300.0, -200.0, 95.0, 480.0, 215.0, 5.0, 295.0, -35.0, 435.0, 50.0, 290.0, 180.0, 265.0, 0.0, 35.0, 315.0, 340.0, -45.0, 335.0, 260.0, 90.0, 240.0, -90.0, 310.0, -305.0, 250.0, 90.0, 310.0, 225.0, 150.0, 350.0, 375.0, 245.0, 285.0, 55.0, 55.0, 185.0, 25.0, 215.0, 160.0, 125.0, 340.0, 350.0, 280.0, 185.0, 485.0, 490.0, 45.0, -90.0, 80.0, 280.0, 370.0, 110.0, -245.0, 210.0, -45.0, 415.0, 315.0, 125.0, 285.0, 130.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1684164933964154, "mean_inference_ms": 1.5689766452177525, "mean_action_processing_ms": 0.571721171452728, "mean_env_wait_ms": 0.20633713566517892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16117215156555176, "StateBufferConnector_ms": 0.006430149078369141, "ViewRequirementAgentConnector_ms": 0.3334653377532959}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1638400, "num_agent_steps_trained": 1638400, "num_env_steps_sampled": 327680, "num_env_steps_trained": 327680, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 76.55604298389851, "num_env_steps_trained_throughput_per_sec": 76.55604298389851, "timesteps_total": 327680, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1638400, "timers": {"training_iteration_time_ms": 104716.966, "sample_time_ms": 14456.628, "load_time_ms": 1.743, "load_throughput": 4699731.688, "learn_time_ms": 90248.548, "learn_throughput": 90.772, "synch_weights_time_ms": 3.078}, "counters": {"num_env_steps_sampled": 327680, "num_env_steps_trained": 327680, "num_agent_steps_sampled": 1638400, "num_agent_steps_trained": 1638400}, "done": false, "episodes_total": 2560, "training_iteration": 40, "trial_id": "9fade_00019", "date": "2023-11-09_21-02-32", "timestamp": 1699560152, "time_this_iter_s": 107.0287537574768, "time_total_s": 3927.9994173049927, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3927.9994173049927, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 36.69407894736842, "ram_util_percent": 18.65131578947368}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5846017720655814, "episode_optimality_min": -0.6, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5846017720655814, "episode_optimality_capped_min": -0.6, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.9, "episode_reward_normalized_min": -49.0, "episode_reward_normalized_max": 105.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5846017720655814, "curr_learning_score_min": -0.6, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9828355003676067, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.25099593953995886, "policy_loss": -0.07132159092234361, "vf_loss": 0.3108684120081792, "vf_explained_var": 0.3939568975940347, "kl": 0.01696165688896618, "entropy": 3.9586100243528684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 388800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 335872, "num_env_steps_trained": 335872, "num_agent_steps_sampled": 1679360, "num_agent_steps_trained": 1679360}, "sampler_results": {"episode_reward_max": 525.0, "episode_reward_min": -245.0, "episode_reward_mean": 204.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5846017720655814, "episode_optimality_min": -0.6, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5846017720655814, "episode_optimality_capped_min": -0.6, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.9, "episode_reward_normalized_min": -49.0, "episode_reward_normalized_max": 105.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5846017720655814, "curr_learning_score_min": -0.6, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [250.0, 90.0, 310.0, 225.0, 150.0, 350.0, 375.0, 245.0, 285.0, 55.0, 55.0, 185.0, 25.0, 215.0, 160.0, 125.0, 340.0, 350.0, 280.0, 185.0, 485.0, 490.0, 45.0, -90.0, 80.0, 280.0, 370.0, 110.0, -245.0, 210.0, -45.0, 415.0, 315.0, 125.0, 285.0, 130.0, 410.0, 135.0, 240.0, 130.0, 15.0, 230.0, 525.0, -75.0, 220.0, 400.0, 95.0, 420.0, 470.0, -90.0, 370.0, 225.0, 395.0, 205.0, 225.0, 330.0, 160.0, 145.0, 70.0, -45.0, 230.0, 85.0, -110.0, -185.0, 70.0, 235.0, 330.0, 250.0, 120.0, 350.0, 245.0, 35.0, 240.0, 200.0, 495.0, 145.0, -30.0, 395.0, 365.0, 330.0, 190.0, 120.0, 155.0, 255.0, 335.0, 75.0, 320.0, 300.0, 150.0, 205.0, -20.0, 160.0, 205.0, 230.0, 430.0, 205.0, 50.0, 370.0, 270.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1678077868228403, "mean_inference_ms": 1.568002601591827, "mean_action_processing_ms": 0.571468491804898, "mean_env_wait_ms": 0.2061063230099581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1615462303161621, "StateBufferConnector_ms": 0.00635528564453125, "ViewRequirementAgentConnector_ms": 0.3311905860900879}}, "episode_reward_max": 525.0, "episode_reward_min": -245.0, "episode_reward_mean": 204.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [250.0, 90.0, 310.0, 225.0, 150.0, 350.0, 375.0, 245.0, 285.0, 55.0, 55.0, 185.0, 25.0, 215.0, 160.0, 125.0, 340.0, 350.0, 280.0, 185.0, 485.0, 490.0, 45.0, -90.0, 80.0, 280.0, 370.0, 110.0, -245.0, 210.0, -45.0, 415.0, 315.0, 125.0, 285.0, 130.0, 410.0, 135.0, 240.0, 130.0, 15.0, 230.0, 525.0, -75.0, 220.0, 400.0, 95.0, 420.0, 470.0, -90.0, 370.0, 225.0, 395.0, 205.0, 225.0, 330.0, 160.0, 145.0, 70.0, -45.0, 230.0, 85.0, -110.0, -185.0, 70.0, 235.0, 330.0, 250.0, 120.0, 350.0, 245.0, 35.0, 240.0, 200.0, 495.0, 145.0, -30.0, 395.0, 365.0, 330.0, 190.0, 120.0, 155.0, 255.0, 335.0, 75.0, 320.0, 300.0, 150.0, 205.0, -20.0, 160.0, 205.0, 230.0, 430.0, 205.0, 50.0, 370.0, 270.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1678077868228403, "mean_inference_ms": 1.568002601591827, "mean_action_processing_ms": 0.571468491804898, "mean_env_wait_ms": 0.2061063230099581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1615462303161621, "StateBufferConnector_ms": 0.00635528564453125, "ViewRequirementAgentConnector_ms": 0.3311905860900879}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1679360, "num_agent_steps_trained": 1679360, "num_env_steps_sampled": 335872, "num_env_steps_trained": 335872, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 74.54349063178938, "num_env_steps_trained_throughput_per_sec": 74.54349063178938, "timesteps_total": 335872, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1679360, "timers": {"training_iteration_time_ms": 105723.547, "sample_time_ms": 14452.229, "load_time_ms": 1.717, "load_throughput": 4771854.506, "learn_time_ms": 91259.523, "learn_throughput": 89.766, "synch_weights_time_ms": 3.163}, "counters": {"num_env_steps_sampled": 335872, "num_env_steps_trained": 335872, "num_agent_steps_sampled": 1679360, "num_agent_steps_trained": 1679360}, "done": false, "episodes_total": 2624, "training_iteration": 41, "trial_id": "9fade_00019", "date": "2023-11-09_21-04-22", "timestamp": 1699560262, "time_this_iter_s": 109.91194772720337, "time_total_s": 4037.911365032196, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4037.911365032196, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 38.50445859872611, "ram_util_percent": 18.535668789808913}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5205031371440175, "episode_optimality_min": -0.96875, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5205031371440175, "episode_optimality_capped_min": -0.96875, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.48, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5205031371440175, "curr_learning_score_min": -0.96875, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9789026149796943, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2758526526695641, "policy_loss": -0.07376070815344671, "vf_loss": 0.3378550696451566, "vf_explained_var": 0.34061125680804255, "kl": 0.017419690288620587, "entropy": 3.991030519555012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 398400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 344064, "num_env_steps_trained": 344064, "num_agent_steps_sampled": 1720320, "num_agent_steps_trained": 1720320}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": -200.0, "episode_reward_mean": 172.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5205031371440175, "episode_optimality_min": -0.96875, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5205031371440175, "episode_optimality_capped_min": -0.96875, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.48, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5205031371440175, "curr_learning_score_min": -0.96875, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [70.0, 235.0, 330.0, 250.0, 120.0, 350.0, 245.0, 35.0, 240.0, 200.0, 495.0, 145.0, -30.0, 395.0, 365.0, 330.0, 190.0, 120.0, 155.0, 255.0, 335.0, 75.0, 320.0, 300.0, 150.0, 205.0, -20.0, 160.0, 205.0, 230.0, 430.0, 205.0, 50.0, 370.0, 270.0, 230.0, 310.0, 30.0, -20.0, 165.0, 235.0, 100.0, 100.0, 65.0, 500.0, 185.0, 285.0, 180.0, 165.0, 245.0, -40.0, -155.0, 375.0, 390.0, 135.0, 0.0, -15.0, 295.0, 265.0, 225.0, -15.0, 165.0, 45.0, 75.0, 260.0, 320.0, 140.0, 350.0, 80.0, 190.0, 425.0, 265.0, 330.0, 25.0, -200.0, -5.0, 380.0, 40.0, 120.0, 210.0, 5.0, 30.0, 350.0, -105.0, 245.0, 145.0, 50.0, -150.0, 90.0, 205.0, 255.0, 290.0, 110.0, -150.0, -180.0, 445.0, 145.0, -25.0, 140.0, 115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1673715957655788, "mean_inference_ms": 1.5672349018184142, "mean_action_processing_ms": 0.5712575524391516, "mean_env_wait_ms": 0.20593566892327408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16166901588439941, "StateBufferConnector_ms": 0.0065097808837890625, "ViewRequirementAgentConnector_ms": 0.3341825008392334}}, "episode_reward_max": 500.0, "episode_reward_min": -200.0, "episode_reward_mean": 172.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [70.0, 235.0, 330.0, 250.0, 120.0, 350.0, 245.0, 35.0, 240.0, 200.0, 495.0, 145.0, -30.0, 395.0, 365.0, 330.0, 190.0, 120.0, 155.0, 255.0, 335.0, 75.0, 320.0, 300.0, 150.0, 205.0, -20.0, 160.0, 205.0, 230.0, 430.0, 205.0, 50.0, 370.0, 270.0, 230.0, 310.0, 30.0, -20.0, 165.0, 235.0, 100.0, 100.0, 65.0, 500.0, 185.0, 285.0, 180.0, 165.0, 245.0, -40.0, -155.0, 375.0, 390.0, 135.0, 0.0, -15.0, 295.0, 265.0, 225.0, -15.0, 165.0, 45.0, 75.0, 260.0, 320.0, 140.0, 350.0, 80.0, 190.0, 425.0, 265.0, 330.0, 25.0, -200.0, -5.0, 380.0, 40.0, 120.0, 210.0, 5.0, 30.0, 350.0, -105.0, 245.0, 145.0, 50.0, -150.0, 90.0, 205.0, 255.0, 290.0, 110.0, -150.0, -180.0, 445.0, 145.0, -25.0, 140.0, 115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1673715957655788, "mean_inference_ms": 1.5672349018184142, "mean_action_processing_ms": 0.5712575524391516, "mean_env_wait_ms": 0.20593566892327408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16166901588439941, "StateBufferConnector_ms": 0.0065097808837890625, "ViewRequirementAgentConnector_ms": 0.3341825008392334}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720320, "num_agent_steps_trained": 1720320, "num_env_steps_sampled": 344064, "num_env_steps_trained": 344064, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 75.46138640555188, "num_env_steps_trained_throughput_per_sec": 75.46138640555188, "timesteps_total": 344064, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1720320, "timers": {"training_iteration_time_ms": 106494.478, "sample_time_ms": 14522.133, "load_time_ms": 1.657, "load_throughput": 4942638.257, "learn_time_ms": 91960.828, "learn_throughput": 89.081, "synch_weights_time_ms": 3.049}, "counters": {"num_env_steps_sampled": 344064, "num_env_steps_trained": 344064, "num_agent_steps_sampled": 1720320, "num_agent_steps_trained": 1720320}, "done": false, "episodes_total": 2688, "training_iteration": 42, "trial_id": "9fade_00019", "date": "2023-11-09_21-06-14", "timestamp": 1699560374, "time_this_iter_s": 108.57484602928162, "time_total_s": 4146.486211061478, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4146.486211061478, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 37.00691823899371, "ram_util_percent": 18.79496855345912}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4713783246893456, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4713783246893456, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 32.98, "episode_reward_normalized_min": -49.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4713783246893456, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.969937075470419, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2912659839662471, "policy_loss": -0.07663325619190194, "vf_loss": 0.35583735861401083, "vf_explained_var": 0.3628306410089135, "kl": 0.017869454121187688, "entropy": 3.925797395731012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 408000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 352256, "num_env_steps_trained": 352256, "num_agent_steps_sampled": 1761280, "num_agent_steps_trained": 1761280}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -245.0, "episode_reward_mean": 164.9, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4713783246893456, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4713783246893456, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 32.98, "episode_reward_normalized_min": -49.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4713783246893456, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [260.0, 320.0, 140.0, 350.0, 80.0, 190.0, 425.0, 265.0, 330.0, 25.0, -200.0, -5.0, 380.0, 40.0, 120.0, 210.0, 5.0, 30.0, 350.0, -105.0, 245.0, 145.0, 50.0, -150.0, 90.0, 205.0, 255.0, 290.0, 110.0, -150.0, -180.0, 445.0, 145.0, -25.0, 140.0, 115.0, -245.0, 150.0, -175.0, 215.0, -160.0, 230.0, 85.0, -15.0, 630.0, 280.0, 360.0, 375.0, 105.0, 295.0, -25.0, 315.0, 250.0, 205.0, -45.0, 305.0, 450.0, 160.0, 325.0, 445.0, 270.0, 70.0, 60.0, 330.0, 420.0, 45.0, 240.0, 320.0, 205.0, 270.0, -70.0, 175.0, 125.0, 300.0, 140.0, 185.0, 155.0, 230.0, 520.0, 200.0, 250.0, 15.0, 45.0, 310.0, 250.0, 380.0, 255.0, -85.0, -5.0, 255.0, 430.0, 275.0, 150.0, -225.0, -230.0, 415.0, 75.0, 170.0, -35.0, 150.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1670223927299699, "mean_inference_ms": 1.5666334207120352, "mean_action_processing_ms": 0.5710773330371594, "mean_env_wait_ms": 0.20583002260086938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1622178554534912, "StateBufferConnector_ms": 0.006503105163574219, "ViewRequirementAgentConnector_ms": 0.33614110946655273}}, "episode_reward_max": 630.0, "episode_reward_min": -245.0, "episode_reward_mean": 164.9, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [260.0, 320.0, 140.0, 350.0, 80.0, 190.0, 425.0, 265.0, 330.0, 25.0, -200.0, -5.0, 380.0, 40.0, 120.0, 210.0, 5.0, 30.0, 350.0, -105.0, 245.0, 145.0, 50.0, -150.0, 90.0, 205.0, 255.0, 290.0, 110.0, -150.0, -180.0, 445.0, 145.0, -25.0, 140.0, 115.0, -245.0, 150.0, -175.0, 215.0, -160.0, 230.0, 85.0, -15.0, 630.0, 280.0, 360.0, 375.0, 105.0, 295.0, -25.0, 315.0, 250.0, 205.0, -45.0, 305.0, 450.0, 160.0, 325.0, 445.0, 270.0, 70.0, 60.0, 330.0, 420.0, 45.0, 240.0, 320.0, 205.0, 270.0, -70.0, 175.0, 125.0, 300.0, 140.0, 185.0, 155.0, 230.0, 520.0, 200.0, 250.0, 15.0, 45.0, 310.0, 250.0, 380.0, 255.0, -85.0, -5.0, 255.0, 430.0, 275.0, 150.0, -225.0, -230.0, 415.0, 75.0, 170.0, -35.0, 150.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1670223927299699, "mean_inference_ms": 1.5666334207120352, "mean_action_processing_ms": 0.5710773330371594, "mean_env_wait_ms": 0.20583002260086938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1622178554534912, "StateBufferConnector_ms": 0.006503105163574219, "ViewRequirementAgentConnector_ms": 0.33614110946655273}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1761280, "num_agent_steps_trained": 1761280, "num_env_steps_sampled": 352256, "num_env_steps_trained": 352256, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 75.7452516387415, "num_env_steps_trained_throughput_per_sec": 75.7452516387415, "timesteps_total": 352256, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1761280, "timers": {"training_iteration_time_ms": 107099.546, "sample_time_ms": 14565.294, "load_time_ms": 1.673, "load_throughput": 4896432.868, "learn_time_ms": 92523.041, "learn_throughput": 88.54, "synch_weights_time_ms": 2.891}, "counters": {"num_env_steps_sampled": 352256, "num_env_steps_trained": 352256, "num_agent_steps_sampled": 1761280, "num_agent_steps_trained": 1761280}, "done": false, "episodes_total": 2752, "training_iteration": 43, "trial_id": "9fade_00019", "date": "2023-11-09_21-08-02", "timestamp": 1699560482, "time_this_iter_s": 108.16911911964417, "time_total_s": 4254.655330181122, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4254.655330181122, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 37.236363636363635, "ram_util_percent": 18.70259740259741}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5187195010504329, "episode_optimality_min": -0.8461538461538461, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5187195010504329, "episode_optimality_capped_min": -0.8461538461538461, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.02, "episode_reward_normalized_min": -46.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5187195010504329, "curr_learning_score_min": -0.8461538461538461, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9729569697628419, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.29151902109605243, "policy_loss": -0.07409542448094726, "vf_loss": 0.35390966496386683, "vf_explained_var": 0.3534935343824327, "kl": 0.01734041600878148, "entropy": 3.9166666725526254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 417600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 360448, "num_env_steps_trained": 360448, "num_agent_steps_sampled": 1802240, "num_agent_steps_trained": 1802240}, "sampler_results": {"episode_reward_max": 535.0, "episode_reward_min": -230.0, "episode_reward_mean": 185.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5187195010504329, "episode_optimality_min": -0.8461538461538461, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5187195010504329, "episode_optimality_capped_min": -0.8461538461538461, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.02, "episode_reward_normalized_min": -46.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5187195010504329, "curr_learning_score_min": -0.8461538461538461, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [420.0, 45.0, 240.0, 320.0, 205.0, 270.0, -70.0, 175.0, 125.0, 300.0, 140.0, 185.0, 155.0, 230.0, 520.0, 200.0, 250.0, 15.0, 45.0, 310.0, 250.0, 380.0, 255.0, -85.0, -5.0, 255.0, 430.0, 275.0, 150.0, -225.0, -230.0, 415.0, 75.0, 170.0, -35.0, 150.0, 125.0, 165.0, 70.0, 175.0, 325.0, 185.0, -45.0, 155.0, 45.0, 335.0, 70.0, -55.0, -125.0, 260.0, 90.0, 70.0, -20.0, 380.0, 155.0, 345.0, 30.0, 290.0, 20.0, 445.0, 330.0, 0.0, 235.0, 95.0, 320.0, 265.0, -30.0, 535.0, 525.0, 115.0, 220.0, 315.0, 185.0, 140.0, -40.0, 460.0, 420.0, 170.0, 440.0, -5.0, 80.0, 110.0, 210.0, 435.0, -100.0, 235.0, 255.0, 435.0, -35.0, 285.0, 90.0, 155.0, 135.0, 230.0, 260.0, 260.0, 345.0, 85.0, 135.0, 415.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1663864081249653, "mean_inference_ms": 1.5653111705708695, "mean_action_processing_ms": 0.5707527877504879, "mean_env_wait_ms": 0.20564947879360673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16014623641967773, "StateBufferConnector_ms": 0.006386756896972656, "ViewRequirementAgentConnector_ms": 0.3316025733947754}}, "episode_reward_max": 535.0, "episode_reward_min": -230.0, "episode_reward_mean": 185.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [420.0, 45.0, 240.0, 320.0, 205.0, 270.0, -70.0, 175.0, 125.0, 300.0, 140.0, 185.0, 155.0, 230.0, 520.0, 200.0, 250.0, 15.0, 45.0, 310.0, 250.0, 380.0, 255.0, -85.0, -5.0, 255.0, 430.0, 275.0, 150.0, -225.0, -230.0, 415.0, 75.0, 170.0, -35.0, 150.0, 125.0, 165.0, 70.0, 175.0, 325.0, 185.0, -45.0, 155.0, 45.0, 335.0, 70.0, -55.0, -125.0, 260.0, 90.0, 70.0, -20.0, 380.0, 155.0, 345.0, 30.0, 290.0, 20.0, 445.0, 330.0, 0.0, 235.0, 95.0, 320.0, 265.0, -30.0, 535.0, 525.0, 115.0, 220.0, 315.0, 185.0, 140.0, -40.0, 460.0, 420.0, 170.0, 440.0, -5.0, 80.0, 110.0, 210.0, 435.0, -100.0, 235.0, 255.0, 435.0, -35.0, 285.0, 90.0, 155.0, 135.0, 230.0, 260.0, 260.0, 345.0, 85.0, 135.0, 415.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1663864081249653, "mean_inference_ms": 1.5653111705708695, "mean_action_processing_ms": 0.5707527877504879, "mean_env_wait_ms": 0.20564947879360673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16014623641967773, "StateBufferConnector_ms": 0.006386756896972656, "ViewRequirementAgentConnector_ms": 0.3316025733947754}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1802240, "num_agent_steps_trained": 1802240, "num_env_steps_sampled": 360448, "num_env_steps_trained": 360448, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 74.19432606317764, "num_env_steps_trained_throughput_per_sec": 74.19432606317764, "timesteps_total": 360448, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1802240, "timers": {"training_iteration_time_ms": 107819.56, "sample_time_ms": 14520.132, "load_time_ms": 1.668, "load_throughput": 4912042.654, "learn_time_ms": 93288.272, "learn_throughput": 87.814, "synch_weights_time_ms": 2.92}, "counters": {"num_env_steps_sampled": 360448, "num_env_steps_trained": 360448, "num_agent_steps_sampled": 1802240, "num_agent_steps_trained": 1802240}, "done": false, "episodes_total": 2816, "training_iteration": 44, "trial_id": "9fade_00019", "date": "2023-11-09_21-09-53", "timestamp": 1699560593, "time_this_iter_s": 110.42876243591309, "time_total_s": 4365.084092617035, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4365.084092617035, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.02784810126582, "ram_util_percent": 18.47025316455696}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6289493719040119, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6289493719040119, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.15, "episode_reward_normalized_min": -71.0, "episode_reward_normalized_max": 125.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6289493719040119, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.978434080958056, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.24839467613695887, "policy_loss": -0.07242993706119402, "vf_loss": 0.3092538855823659, "vf_explained_var": 0.38520791065568727, "kl": 0.017141816909273567, "entropy": 3.871061563665668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 427200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 368640, "num_env_steps_trained": 368640, "num_agent_steps_sampled": 1843200, "num_agent_steps_trained": 1843200}, "sampler_results": {"episode_reward_max": 625.0, "episode_reward_min": -355.0, "episode_reward_mean": 230.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6289493719040119, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6289493719040119, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.15, "episode_reward_normalized_min": -71.0, "episode_reward_normalized_max": 125.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6289493719040119, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [320.0, 265.0, -30.0, 535.0, 525.0, 115.0, 220.0, 315.0, 185.0, 140.0, -40.0, 460.0, 420.0, 170.0, 440.0, -5.0, 80.0, 110.0, 210.0, 435.0, -100.0, 235.0, 255.0, 435.0, -35.0, 285.0, 90.0, 155.0, 135.0, 230.0, 260.0, 260.0, 345.0, 85.0, 135.0, 415.0, 410.0, 205.0, -65.0, 625.0, 145.0, 55.0, 320.0, 400.0, 330.0, 420.0, 315.0, 175.0, 335.0, 185.0, 235.0, 250.0, 20.0, 190.0, 525.0, 75.0, 330.0, 365.0, 280.0, 320.0, 245.0, 425.0, 190.0, 310.0, -5.0, 245.0, 330.0, 25.0, 335.0, -10.0, 225.0, 350.0, 230.0, 535.0, 110.0, -70.0, 180.0, 205.0, 220.0, 255.0, 175.0, 420.0, 395.0, 405.0, 250.0, 135.0, 15.0, 105.0, 190.0, 335.0, 205.0, 240.0, 130.0, 170.0, 270.0, 375.0, 380.0, 200.0, 205.0, -355.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1661649248488843, "mean_inference_ms": 1.5645645680426492, "mean_action_processing_ms": 0.5706360046141172, "mean_env_wait_ms": 0.20554717409915868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16229534149169922, "StateBufferConnector_ms": 0.006443977355957031, "ViewRequirementAgentConnector_ms": 0.33586716651916504}}, "episode_reward_max": 625.0, "episode_reward_min": -355.0, "episode_reward_mean": 230.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [320.0, 265.0, -30.0, 535.0, 525.0, 115.0, 220.0, 315.0, 185.0, 140.0, -40.0, 460.0, 420.0, 170.0, 440.0, -5.0, 80.0, 110.0, 210.0, 435.0, -100.0, 235.0, 255.0, 435.0, -35.0, 285.0, 90.0, 155.0, 135.0, 230.0, 260.0, 260.0, 345.0, 85.0, 135.0, 415.0, 410.0, 205.0, -65.0, 625.0, 145.0, 55.0, 320.0, 400.0, 330.0, 420.0, 315.0, 175.0, 335.0, 185.0, 235.0, 250.0, 20.0, 190.0, 525.0, 75.0, 330.0, 365.0, 280.0, 320.0, 245.0, 425.0, 190.0, 310.0, -5.0, 245.0, 330.0, 25.0, 335.0, -10.0, 225.0, 350.0, 230.0, 535.0, 110.0, -70.0, 180.0, 205.0, 220.0, 255.0, 175.0, 420.0, 395.0, 405.0, 250.0, 135.0, 15.0, 105.0, 190.0, 335.0, 205.0, 240.0, 130.0, 170.0, 270.0, 375.0, 380.0, 200.0, 205.0, -355.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1661649248488843, "mean_inference_ms": 1.5645645680426492, "mean_action_processing_ms": 0.5706360046141172, "mean_env_wait_ms": 0.20554717409915868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16229534149169922, "StateBufferConnector_ms": 0.006443977355957031, "ViewRequirementAgentConnector_ms": 0.33586716651916504}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1843200, "num_agent_steps_trained": 1843200, "num_env_steps_sampled": 368640, "num_env_steps_trained": 368640, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 75.12292972386625, "num_env_steps_trained_throughput_per_sec": 75.12292972386625, "timesteps_total": 368640, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1843200, "timers": {"training_iteration_time_ms": 108083.29, "sample_time_ms": 14439.322, "load_time_ms": 1.7, "load_throughput": 4819578.405, "learn_time_ms": 93632.981, "learn_throughput": 87.491, "synch_weights_time_ms": 2.82}, "counters": {"num_env_steps_sampled": 368640, "num_env_steps_trained": 368640, "num_agent_steps_sampled": 1843200, "num_agent_steps_trained": 1843200}, "done": false, "episodes_total": 2880, "training_iteration": 45, "trial_id": "9fade_00019", "date": "2023-11-09_21-11-42", "timestamp": 1699560702, "time_this_iter_s": 109.06272315979004, "time_total_s": 4474.146815776825, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4474.146815776825, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 38.692258064516125, "ram_util_percent": 18.15225806451613}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5621206648444018, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5621206648444018, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.68, "episode_reward_normalized_min": -71.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5621206648444018, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9705405386490747, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2793747139264209, "policy_loss": -0.07585376232998291, "vf_loss": 0.34322668573064824, "vf_explained_var": 0.35354113786791763, "kl": 0.017780429717120776, "entropy": 3.845033605520924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 436800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 376832, "num_env_steps_trained": 376832, "num_agent_steps_sampled": 1884160, "num_agent_steps_trained": 1884160}, "sampler_results": {"episode_reward_max": 595.0, "episode_reward_min": -355.0, "episode_reward_mean": 213.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5621206648444018, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5621206648444018, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.68, "episode_reward_normalized_min": -71.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5621206648444018, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-5.0, 245.0, 330.0, 25.0, 335.0, -10.0, 225.0, 350.0, 230.0, 535.0, 110.0, -70.0, 180.0, 205.0, 220.0, 255.0, 175.0, 420.0, 395.0, 405.0, 250.0, 135.0, 15.0, 105.0, 190.0, 335.0, 205.0, 240.0, 130.0, 170.0, 270.0, 375.0, 380.0, 200.0, 205.0, -355.0, -295.0, 50.0, 20.0, -170.0, 25.0, 445.0, 155.0, 370.0, 130.0, 315.0, 80.0, 565.0, 140.0, 355.0, 250.0, 265.0, -5.0, 120.0, 580.0, 120.0, 455.0, -10.0, 125.0, 80.0, 505.0, -170.0, 200.0, 170.0, 260.0, 75.0, 70.0, 490.0, 140.0, 130.0, 595.0, 280.0, 75.0, 195.0, 390.0, 110.0, 415.0, 360.0, 245.0, 325.0, -165.0, 530.0, 485.0, 275.0, 195.0, 75.0, 80.0, 355.0, 185.0, 390.0, 525.0, 85.0, 105.0, 315.0, 495.0, 245.0, 180.0, 125.0, 170.0, 260.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.165643223024071, "mean_inference_ms": 1.5632644850078847, "mean_action_processing_ms": 0.5706821820986521, "mean_env_wait_ms": 0.2053085271082049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16165590286254883, "StateBufferConnector_ms": 0.006334781646728516, "ViewRequirementAgentConnector_ms": 0.33120298385620117}}, "episode_reward_max": 595.0, "episode_reward_min": -355.0, "episode_reward_mean": 213.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.0, 245.0, 330.0, 25.0, 335.0, -10.0, 225.0, 350.0, 230.0, 535.0, 110.0, -70.0, 180.0, 205.0, 220.0, 255.0, 175.0, 420.0, 395.0, 405.0, 250.0, 135.0, 15.0, 105.0, 190.0, 335.0, 205.0, 240.0, 130.0, 170.0, 270.0, 375.0, 380.0, 200.0, 205.0, -355.0, -295.0, 50.0, 20.0, -170.0, 25.0, 445.0, 155.0, 370.0, 130.0, 315.0, 80.0, 565.0, 140.0, 355.0, 250.0, 265.0, -5.0, 120.0, 580.0, 120.0, 455.0, -10.0, 125.0, 80.0, 505.0, -170.0, 200.0, 170.0, 260.0, 75.0, 70.0, 490.0, 140.0, 130.0, 595.0, 280.0, 75.0, 195.0, 390.0, 110.0, 415.0, 360.0, 245.0, 325.0, -165.0, 530.0, 485.0, 275.0, 195.0, 75.0, 80.0, 355.0, 185.0, 390.0, 525.0, 85.0, 105.0, 315.0, 495.0, 245.0, 180.0, 125.0, 170.0, 260.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.165643223024071, "mean_inference_ms": 1.5632644850078847, "mean_action_processing_ms": 0.5706821820986521, "mean_env_wait_ms": 0.2053085271082049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16165590286254883, "StateBufferConnector_ms": 0.006334781646728516, "ViewRequirementAgentConnector_ms": 0.33120298385620117}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884160, "num_agent_steps_trained": 1884160, "num_env_steps_sampled": 376832, "num_env_steps_trained": 376832, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 75.56549175346146, "num_env_steps_trained_throughput_per_sec": 75.56549175346146, "timesteps_total": 376832, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1884160, "timers": {"training_iteration_time_ms": 108195.11, "sample_time_ms": 14424.78, "load_time_ms": 1.725, "load_throughput": 4749887.8, "learn_time_ms": 93759.63, "learn_throughput": 87.372, "synch_weights_time_ms": 2.647}, "counters": {"num_env_steps_sampled": 376832, "num_env_steps_trained": 376832, "num_agent_steps_sampled": 1884160, "num_agent_steps_trained": 1884160}, "done": false, "episodes_total": 2944, "training_iteration": 46, "trial_id": "9fade_00019", "date": "2023-11-09_21-13-30", "timestamp": 1699560810, "time_this_iter_s": 108.4276773929596, "time_total_s": 4582.574493169785, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4582.574493169785, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 37.05935483870967, "ram_util_percent": 18.364516129032257}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5633216835140556, "episode_optimality_min": -0.7380952380952381, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5633216835140556, "episode_optimality_capped_min": -0.7380952380952381, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.53, "episode_reward_normalized_min": -62.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5633216835140556, "curr_learning_score_min": -0.7380952380952381, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9790966046523923, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.29362418305502314, "policy_loss": -0.07927109876070365, "vf_loss": 0.36044991817014915, "vf_explained_var": 0.34961396038532255, "kl": 0.01843757477559033, "entropy": 3.8513800611098605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 446400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 385024, "num_env_steps_trained": 385024, "num_agent_steps_sampled": 1925120, "num_agent_steps_trained": 1925120}, "sampler_results": {"episode_reward_max": 595.0, "episode_reward_min": -310.0, "episode_reward_mean": 212.65, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5633216835140556, "episode_optimality_min": -0.7380952380952381, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5633216835140556, "episode_optimality_capped_min": -0.7380952380952381, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.53, "episode_reward_normalized_min": -62.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5633216835140556, "curr_learning_score_min": -0.7380952380952381, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [260.0, 75.0, 70.0, 490.0, 140.0, 130.0, 595.0, 280.0, 75.0, 195.0, 390.0, 110.0, 415.0, 360.0, 245.0, 325.0, -165.0, 530.0, 485.0, 275.0, 195.0, 75.0, 80.0, 355.0, 185.0, 390.0, 525.0, 85.0, 105.0, 315.0, 495.0, 245.0, 180.0, 125.0, 170.0, 260.0, 75.0, 245.0, 395.0, 290.0, 100.0, 55.0, 185.0, 80.0, 230.0, 135.0, 65.0, 100.0, 350.0, 10.0, 195.0, 190.0, 95.0, 545.0, -135.0, -50.0, 50.0, 85.0, 120.0, 325.0, 310.0, 195.0, 220.0, 315.0, 20.0, 240.0, 425.0, 330.0, 270.0, 365.0, 475.0, 365.0, 135.0, -310.0, 435.0, 275.0, 260.0, 405.0, 455.0, -115.0, 290.0, 175.0, 265.0, 160.0, 10.0, -35.0, 265.0, 370.0, 225.0, -50.0, 175.0, 100.0, -95.0, 15.0, 345.0, 75.0, 285.0, 345.0, 250.0, 225.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1648170000684162, "mean_inference_ms": 1.5617123312820838, "mean_action_processing_ms": 0.5705792157358083, "mean_env_wait_ms": 0.20504165051969284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.159409761428833, "StateBufferConnector_ms": 0.00631260871887207, "ViewRequirementAgentConnector_ms": 0.32708024978637695}}, "episode_reward_max": 595.0, "episode_reward_min": -310.0, "episode_reward_mean": 212.65, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [260.0, 75.0, 70.0, 490.0, 140.0, 130.0, 595.0, 280.0, 75.0, 195.0, 390.0, 110.0, 415.0, 360.0, 245.0, 325.0, -165.0, 530.0, 485.0, 275.0, 195.0, 75.0, 80.0, 355.0, 185.0, 390.0, 525.0, 85.0, 105.0, 315.0, 495.0, 245.0, 180.0, 125.0, 170.0, 260.0, 75.0, 245.0, 395.0, 290.0, 100.0, 55.0, 185.0, 80.0, 230.0, 135.0, 65.0, 100.0, 350.0, 10.0, 195.0, 190.0, 95.0, 545.0, -135.0, -50.0, 50.0, 85.0, 120.0, 325.0, 310.0, 195.0, 220.0, 315.0, 20.0, 240.0, 425.0, 330.0, 270.0, 365.0, 475.0, 365.0, 135.0, -310.0, 435.0, 275.0, 260.0, 405.0, 455.0, -115.0, 290.0, 175.0, 265.0, 160.0, 10.0, -35.0, 265.0, 370.0, 225.0, -50.0, 175.0, 100.0, -95.0, 15.0, 345.0, 75.0, 285.0, 345.0, 250.0, 225.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1648170000684162, "mean_inference_ms": 1.5617123312820838, "mean_action_processing_ms": 0.5705792157358083, "mean_env_wait_ms": 0.20504165051969284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.159409761428833, "StateBufferConnector_ms": 0.00631260871887207, "ViewRequirementAgentConnector_ms": 0.32708024978637695}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1925120, "num_agent_steps_trained": 1925120, "num_env_steps_sampled": 385024, "num_env_steps_trained": 385024, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 74.84449368167274, "num_env_steps_trained_throughput_per_sec": 74.84449368167274, "timesteps_total": 385024, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1925120, "timers": {"training_iteration_time_ms": 108436.735, "sample_time_ms": 14451.251, "load_time_ms": 1.684, "load_throughput": 4865095.698, "learn_time_ms": 93974.881, "learn_throughput": 87.172, "synch_weights_time_ms": 2.643}, "counters": {"num_env_steps_sampled": 385024, "num_env_steps_trained": 385024, "num_agent_steps_sampled": 1925120, "num_agent_steps_trained": 1925120}, "done": false, "episodes_total": 3008, "training_iteration": 47, "trial_id": "9fade_00019", "date": "2023-11-09_21-15-20", "timestamp": 1699560920, "time_this_iter_s": 109.46607398986816, "time_total_s": 4692.040567159653, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4692.040567159653, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 37.81217948717949, "ram_util_percent": 18.574358974358972}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6080765019447391, "episode_optimality_min": -0.7380952380952381, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6080765019447391, "episode_optimality_capped_min": -0.7380952380952381, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.62, "episode_reward_normalized_min": -62.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6080765019447391, "curr_learning_score_min": -0.7380952380952381, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9806499702266107, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.24143107451100757, "policy_loss": -0.07015836149650567, "vf_loss": 0.30013085862645916, "vf_explained_var": 0.40549216798196236, "kl": 0.01697567015230883, "entropy": 3.822784523268541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 456000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 393216, "num_env_steps_trained": 393216, "num_agent_steps_sampled": 1966080, "num_agent_steps_trained": 1966080}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": -310.0, "episode_reward_mean": 223.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6080765019447391, "episode_optimality_min": -0.7380952380952381, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6080765019447391, "episode_optimality_capped_min": -0.7380952380952381, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.62, "episode_reward_normalized_min": -62.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6080765019447391, "curr_learning_score_min": -0.7380952380952381, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [20.0, 240.0, 425.0, 330.0, 270.0, 365.0, 475.0, 365.0, 135.0, -310.0, 435.0, 275.0, 260.0, 405.0, 455.0, -115.0, 290.0, 175.0, 265.0, 160.0, 10.0, -35.0, 265.0, 370.0, 225.0, -50.0, 175.0, 100.0, -95.0, 15.0, 345.0, 75.0, 285.0, 345.0, 250.0, 225.0, 175.0, 310.0, 15.0, 90.0, 175.0, 235.0, 435.0, 380.0, 340.0, 365.0, 120.0, 160.0, 440.0, 160.0, 190.0, 145.0, 160.0, 330.0, 360.0, 10.0, 245.0, 110.0, 495.0, 195.0, 440.0, 110.0, 300.0, 255.0, 265.0, 80.0, 550.0, 195.0, 210.0, 275.0, -30.0, 105.0, 135.0, 115.0, 375.0, -55.0, 160.0, 265.0, 355.0, 240.0, -5.0, 405.0, 455.0, -60.0, 255.0, 85.0, 200.0, 340.0, 260.0, 325.0, 195.0, 440.0, 15.0, 535.0, 340.0, 260.0, 155.0, 135.0, 320.0, 245.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1638795953742829, "mean_inference_ms": 1.5601096655651077, "mean_action_processing_ms": 0.5701461966173631, "mean_env_wait_ms": 0.2047907838682431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15856480598449707, "StateBufferConnector_ms": 0.006232261657714844, "ViewRequirementAgentConnector_ms": 0.32508134841918945}}, "episode_reward_max": 550.0, "episode_reward_min": -310.0, "episode_reward_mean": 223.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.0, 240.0, 425.0, 330.0, 270.0, 365.0, 475.0, 365.0, 135.0, -310.0, 435.0, 275.0, 260.0, 405.0, 455.0, -115.0, 290.0, 175.0, 265.0, 160.0, 10.0, -35.0, 265.0, 370.0, 225.0, -50.0, 175.0, 100.0, -95.0, 15.0, 345.0, 75.0, 285.0, 345.0, 250.0, 225.0, 175.0, 310.0, 15.0, 90.0, 175.0, 235.0, 435.0, 380.0, 340.0, 365.0, 120.0, 160.0, 440.0, 160.0, 190.0, 145.0, 160.0, 330.0, 360.0, 10.0, 245.0, 110.0, 495.0, 195.0, 440.0, 110.0, 300.0, 255.0, 265.0, 80.0, 550.0, 195.0, 210.0, 275.0, -30.0, 105.0, 135.0, 115.0, 375.0, -55.0, 160.0, 265.0, 355.0, 240.0, -5.0, 405.0, 455.0, -60.0, 255.0, 85.0, 200.0, 340.0, 260.0, 325.0, 195.0, 440.0, 15.0, 535.0, 340.0, 260.0, 155.0, 135.0, 320.0, 245.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1638795953742829, "mean_inference_ms": 1.5601096655651077, "mean_action_processing_ms": 0.5701461966173631, "mean_env_wait_ms": 0.2047907838682431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15856480598449707, "StateBufferConnector_ms": 0.006232261657714844, "ViewRequirementAgentConnector_ms": 0.32508134841918945}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1966080, "num_agent_steps_trained": 1966080, "num_env_steps_sampled": 393216, "num_env_steps_trained": 393216, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 74.6155388646582, "num_env_steps_trained_throughput_per_sec": 74.6155388646582, "timesteps_total": 393216, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 1966080, "timers": {"training_iteration_time_ms": 108883.108, "sample_time_ms": 14406.726, "load_time_ms": 1.691, "load_throughput": 4844790.452, "learn_time_ms": 94465.812, "learn_throughput": 86.719, "synch_weights_time_ms": 2.623}, "counters": {"num_env_steps_sampled": 393216, "num_env_steps_trained": 393216, "num_agent_steps_sampled": 1966080, "num_agent_steps_trained": 1966080}, "done": false, "episodes_total": 3072, "training_iteration": 48, "trial_id": "9fade_00019", "date": "2023-11-09_21-17-10", "timestamp": 1699561030, "time_this_iter_s": 109.8106153011322, "time_total_s": 4801.851182460785, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4801.851182460785, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 37.083333333333336, "ram_util_percent": 18.58141025641026}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5686532781579774, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5686532781579774, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.47, "episode_reward_normalized_min": -72.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5686532781579774, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9772837818196665, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.288494703506755, "policy_loss": -0.07722122753531342, "vf_loss": 0.35340939852855324, "vf_explained_var": 0.364208853871872, "kl": 0.01823189937119461, "entropy": 3.833127927829822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 401408, "num_env_steps_trained": 401408, "num_agent_steps_sampled": 2007040, "num_agent_steps_trained": 2007040}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": -360.0, "episode_reward_mean": 197.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5686532781579774, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5686532781579774, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.47, "episode_reward_normalized_min": -72.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5686532781579774, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [265.0, 80.0, 550.0, 195.0, 210.0, 275.0, -30.0, 105.0, 135.0, 115.0, 375.0, -55.0, 160.0, 265.0, 355.0, 240.0, -5.0, 405.0, 455.0, -60.0, 255.0, 85.0, 200.0, 340.0, 260.0, 325.0, 195.0, 440.0, 15.0, 535.0, 340.0, 260.0, 155.0, 135.0, 320.0, 245.0, 385.0, 60.0, 220.0, -30.0, 435.0, 300.0, 260.0, 210.0, 35.0, 365.0, 60.0, -140.0, 195.0, 445.0, 40.0, -360.0, 370.0, 280.0, -285.0, 190.0, 10.0, 105.0, 140.0, 295.0, -85.0, 210.0, 455.0, 480.0, 215.0, 340.0, 310.0, 260.0, 210.0, 240.0, 125.0, 250.0, -140.0, 110.0, 130.0, 330.0, 140.0, 190.0, 135.0, 430.0, -60.0, 45.0, 195.0, 300.0, 305.0, 375.0, 105.0, 220.0, -135.0, 340.0, 365.0, 110.0, -50.0, 190.0, 420.0, 85.0, 115.0, 45.0, 330.0, 375.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1637220482014765, "mean_inference_ms": 1.5595596716556615, "mean_action_processing_ms": 0.5700522014184954, "mean_env_wait_ms": 0.20468987869598074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16207313537597656, "StateBufferConnector_ms": 0.006459951400756836, "ViewRequirementAgentConnector_ms": 0.33574438095092773}}, "episode_reward_max": 550.0, "episode_reward_min": -360.0, "episode_reward_mean": 197.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [265.0, 80.0, 550.0, 195.0, 210.0, 275.0, -30.0, 105.0, 135.0, 115.0, 375.0, -55.0, 160.0, 265.0, 355.0, 240.0, -5.0, 405.0, 455.0, -60.0, 255.0, 85.0, 200.0, 340.0, 260.0, 325.0, 195.0, 440.0, 15.0, 535.0, 340.0, 260.0, 155.0, 135.0, 320.0, 245.0, 385.0, 60.0, 220.0, -30.0, 435.0, 300.0, 260.0, 210.0, 35.0, 365.0, 60.0, -140.0, 195.0, 445.0, 40.0, -360.0, 370.0, 280.0, -285.0, 190.0, 10.0, 105.0, 140.0, 295.0, -85.0, 210.0, 455.0, 480.0, 215.0, 340.0, 310.0, 260.0, 210.0, 240.0, 125.0, 250.0, -140.0, 110.0, 130.0, 330.0, 140.0, 190.0, 135.0, 430.0, -60.0, 45.0, 195.0, 300.0, 305.0, 375.0, 105.0, 220.0, -135.0, 340.0, 365.0, 110.0, -50.0, 190.0, 420.0, 85.0, 115.0, 45.0, 330.0, 375.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1637220482014765, "mean_inference_ms": 1.5595596716556615, "mean_action_processing_ms": 0.5700522014184954, "mean_env_wait_ms": 0.20468987869598074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16207313537597656, "StateBufferConnector_ms": 0.006459951400756836, "ViewRequirementAgentConnector_ms": 0.33574438095092773}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2007040, "num_agent_steps_trained": 2007040, "num_env_steps_sampled": 401408, "num_env_steps_trained": 401408, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 74.39475646694281, "num_env_steps_trained_throughput_per_sec": 74.39475646694281, "timesteps_total": 401408, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2007040, "timers": {"training_iteration_time_ms": 109084.104, "sample_time_ms": 14410.29, "load_time_ms": 1.677, "load_throughput": 4886266.637, "learn_time_ms": 94663.128, "learn_throughput": 86.538, "synch_weights_time_ms": 2.788}, "counters": {"num_env_steps_sampled": 401408, "num_env_steps_trained": 401408, "num_agent_steps_sampled": 2007040, "num_agent_steps_trained": 2007040}, "done": false, "episodes_total": 3136, "training_iteration": 49, "trial_id": "9fade_00019", "date": "2023-11-09_21-19-00", "timestamp": 1699561140, "time_this_iter_s": 110.1313316822052, "time_total_s": 4911.98251414299, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 4911.98251414299, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 38.894267515923566, "ram_util_percent": 18.514649681528656}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.49824092139284376, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.49824092139284376, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.18, "episode_reward_normalized_min": -41.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.49824092139284376, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9815167675105234, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2630865747651357, "policy_loss": -0.07524036376061606, "vf_loss": 0.3261957947919533, "vf_explained_var": 0.34744869232798614, "kl": 0.017972065023645123, "entropy": 3.87308301585416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 475200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 409600, "num_env_steps_trained": 409600, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "sampler_results": {"episode_reward_max": 570.0, "episode_reward_min": -205.0, "episode_reward_mean": 170.9, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.49824092139284376, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.49824092139284376, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.18, "episode_reward_normalized_min": -41.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.49824092139284376, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [215.0, 340.0, 310.0, 260.0, 210.0, 240.0, 125.0, 250.0, -140.0, 110.0, 130.0, 330.0, 140.0, 190.0, 135.0, 430.0, -60.0, 45.0, 195.0, 300.0, 305.0, 375.0, 105.0, 220.0, -135.0, 340.0, 365.0, 110.0, -50.0, 190.0, 420.0, 85.0, 115.0, 45.0, 330.0, 375.0, 80.0, 50.0, 75.0, 405.0, -145.0, 235.0, 250.0, 0.0, 275.0, 110.0, 350.0, 475.0, 200.0, 100.0, 315.0, 420.0, -45.0, 385.0, 50.0, 160.0, 380.0, 400.0, 35.0, 255.0, -30.0, -205.0, 315.0, 145.0, 10.0, 20.0, -10.0, 215.0, 140.0, 95.0, 5.0, 570.0, 65.0, -40.0, 315.0, -100.0, 250.0, 415.0, 300.0, 335.0, 190.0, 10.0, 5.0, 0.0, 100.0, 105.0, 140.0, 235.0, -15.0, 125.0, -10.0, 285.0, 275.0, 330.0, 135.0, 410.0, 215.0, -200.0, 0.0, 180.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1633600793814431, "mean_inference_ms": 1.558877937600283, "mean_action_processing_ms": 0.5699058384469622, "mean_env_wait_ms": 0.20455273558300746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.160872220993042, "StateBufferConnector_ms": 0.006474018096923828, "ViewRequirementAgentConnector_ms": 0.3326413631439209}}, "episode_reward_max": 570.0, "episode_reward_min": -205.0, "episode_reward_mean": 170.9, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [215.0, 340.0, 310.0, 260.0, 210.0, 240.0, 125.0, 250.0, -140.0, 110.0, 130.0, 330.0, 140.0, 190.0, 135.0, 430.0, -60.0, 45.0, 195.0, 300.0, 305.0, 375.0, 105.0, 220.0, -135.0, 340.0, 365.0, 110.0, -50.0, 190.0, 420.0, 85.0, 115.0, 45.0, 330.0, 375.0, 80.0, 50.0, 75.0, 405.0, -145.0, 235.0, 250.0, 0.0, 275.0, 110.0, 350.0, 475.0, 200.0, 100.0, 315.0, 420.0, -45.0, 385.0, 50.0, 160.0, 380.0, 400.0, 35.0, 255.0, -30.0, -205.0, 315.0, 145.0, 10.0, 20.0, -10.0, 215.0, 140.0, 95.0, 5.0, 570.0, 65.0, -40.0, 315.0, -100.0, 250.0, 415.0, 300.0, 335.0, 190.0, 10.0, 5.0, 0.0, 100.0, 105.0, 140.0, 235.0, -15.0, 125.0, -10.0, 285.0, 275.0, 330.0, 135.0, 410.0, 215.0, -200.0, 0.0, 180.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1633600793814431, "mean_inference_ms": 1.558877937600283, "mean_action_processing_ms": 0.5699058384469622, "mean_env_wait_ms": 0.20455273558300746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.160872220993042, "StateBufferConnector_ms": 0.006474018096923828, "ViewRequirementAgentConnector_ms": 0.3326413631439209}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 409600, "num_env_steps_trained": 409600, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 74.3347817519598, "num_env_steps_trained_throughput_per_sec": 74.3347817519598, "timesteps_total": 409600, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 109403.86, "sample_time_ms": 14387.644, "load_time_ms": 1.711, "load_throughput": 4788480.018, "learn_time_ms": 95005.578, "learn_throughput": 86.227, "synch_weights_time_ms": 2.759}, "counters": {"num_env_steps_sampled": 409600, "num_env_steps_trained": 409600, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "episodes_total": 3200, "training_iteration": 50, "trial_id": "9fade_00019", "date": "2023-11-09_21-20-50", "timestamp": 1699561250, "time_this_iter_s": 110.22069716453552, "time_total_s": 5022.203211307526, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5022.203211307526, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 37.30509554140127, "ram_util_percent": 18.44267515923567}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5378305314437268, "episode_optimality_min": -0.7666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5378305314437268, "episode_optimality_capped_min": -0.7666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.3, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5378305314437268, "curr_learning_score_min": -0.7666666666666667, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9812691824324429, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.25673880529558424, "policy_loss": -0.07663648757826498, "vf_loss": 0.3210161722146828, "vf_explained_var": 0.3663729544853171, "kl": 0.01830980836602767, "entropy": 3.793609235212207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 484800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 417792, "num_env_steps_trained": 417792, "num_agent_steps_sampled": 2088960, "num_agent_steps_trained": 2088960}, "sampler_results": {"episode_reward_max": 570.0, "episode_reward_min": -200.0, "episode_reward_mean": 191.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5378305314437268, "episode_optimality_min": -0.7666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5378305314437268, "episode_optimality_capped_min": -0.7666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.3, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5378305314437268, "curr_learning_score_min": -0.7666666666666667, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [10.0, 20.0, -10.0, 215.0, 140.0, 95.0, 5.0, 570.0, 65.0, -40.0, 315.0, -100.0, 250.0, 415.0, 300.0, 335.0, 190.0, 10.0, 5.0, 0.0, 100.0, 105.0, 140.0, 235.0, -15.0, 125.0, -10.0, 285.0, 275.0, 330.0, 135.0, 410.0, 215.0, -200.0, 0.0, 180.0, 60.0, 330.0, 340.0, -195.0, 155.0, 130.0, 400.0, 335.0, 295.0, 60.0, 525.0, 190.0, -115.0, 145.0, 205.0, 460.0, 260.0, 165.0, -35.0, 245.0, 460.0, 410.0, 415.0, 100.0, 250.0, 225.0, 230.0, 10.0, 490.0, 150.0, 195.0, -20.0, 240.0, 195.0, 85.0, 285.0, -65.0, 175.0, 145.0, 25.0, 230.0, 275.0, 400.0, 380.0, 365.0, 425.0, 485.0, 10.0, 360.0, 40.0, 160.0, 150.0, 100.0, 165.0, 130.0, 470.0, 450.0, 190.0, 110.0, 265.0, 260.0, 245.0, 155.0, 275.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.16291193922798, "mean_inference_ms": 1.5582919390508079, "mean_action_processing_ms": 0.5696795223840992, "mean_env_wait_ms": 0.2044408955222295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.161024808883667, "StateBufferConnector_ms": 0.006477832794189453, "ViewRequirementAgentConnector_ms": 0.3334512710571289}}, "episode_reward_max": 570.0, "episode_reward_min": -200.0, "episode_reward_mean": 191.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.0, 20.0, -10.0, 215.0, 140.0, 95.0, 5.0, 570.0, 65.0, -40.0, 315.0, -100.0, 250.0, 415.0, 300.0, 335.0, 190.0, 10.0, 5.0, 0.0, 100.0, 105.0, 140.0, 235.0, -15.0, 125.0, -10.0, 285.0, 275.0, 330.0, 135.0, 410.0, 215.0, -200.0, 0.0, 180.0, 60.0, 330.0, 340.0, -195.0, 155.0, 130.0, 400.0, 335.0, 295.0, 60.0, 525.0, 190.0, -115.0, 145.0, 205.0, 460.0, 260.0, 165.0, -35.0, 245.0, 460.0, 410.0, 415.0, 100.0, 250.0, 225.0, 230.0, 10.0, 490.0, 150.0, 195.0, -20.0, 240.0, 195.0, 85.0, 285.0, -65.0, 175.0, 145.0, 25.0, 230.0, 275.0, 400.0, 380.0, 365.0, 425.0, 485.0, 10.0, 360.0, 40.0, 160.0, 150.0, 100.0, 165.0, 130.0, 470.0, 450.0, 190.0, 110.0, 265.0, 260.0, 245.0, 155.0, 275.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.16291193922798, "mean_inference_ms": 1.5582919390508079, "mean_action_processing_ms": 0.5696795223840992, "mean_env_wait_ms": 0.2044408955222295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.161024808883667, "StateBufferConnector_ms": 0.006477832794189453, "ViewRequirementAgentConnector_ms": 0.3334512710571289}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088960, "num_agent_steps_trained": 2088960, "num_env_steps_sampled": 417792, "num_env_steps_trained": 417792, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.67111589444103, "num_env_steps_trained_throughput_per_sec": 72.67111589444103, "timesteps_total": 417792, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2088960, "timers": {"training_iteration_time_ms": 109687.007, "sample_time_ms": 14403.141, "load_time_ms": 1.705, "load_throughput": 4804617.05, "learn_time_ms": 95273.297, "learn_throughput": 85.984, "synch_weights_time_ms": 2.675}, "counters": {"num_env_steps_sampled": 417792, "num_env_steps_trained": 417792, "num_agent_steps_sampled": 2088960, "num_agent_steps_trained": 2088960}, "done": false, "episodes_total": 3264, "training_iteration": 51, "trial_id": "9fade_00019", "date": "2023-11-09_21-22-43", "timestamp": 1699561363, "time_this_iter_s": 112.74298357963562, "time_total_s": 5134.946194887161, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5134.946194887161, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 38.504968944099375, "ram_util_percent": 18.339130434782607}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.632715346178284, "episode_optimality_min": -0.5, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.632715346178284, "episode_optimality_capped_min": -0.5, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.99, "episode_reward_normalized_min": -30.0, "episode_reward_normalized_max": 106.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.632715346178284, "curr_learning_score_min": -0.5, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9733788261779894, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2616778483566789, "policy_loss": -0.07087756942690855, "vf_loss": 0.3207727013969027, "vf_explained_var": 0.3831587734508018, "kl": 0.017455876508716606, "entropy": 3.783153556659818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 494400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 425984, "num_env_steps_trained": 425984, "num_agent_steps_sampled": 2129920, "num_agent_steps_trained": 2129920}, "sampler_results": {"episode_reward_max": 530.0, "episode_reward_min": -150.0, "episode_reward_mean": 209.95, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.632715346178284, "episode_optimality_min": -0.5, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.632715346178284, "episode_optimality_capped_min": -0.5, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.99, "episode_reward_normalized_min": -30.0, "episode_reward_normalized_max": 106.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.632715346178284, "curr_learning_score_min": -0.5, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [490.0, 150.0, 195.0, -20.0, 240.0, 195.0, 85.0, 285.0, -65.0, 175.0, 145.0, 25.0, 230.0, 275.0, 400.0, 380.0, 365.0, 425.0, 485.0, 10.0, 360.0, 40.0, 160.0, 150.0, 100.0, 165.0, 130.0, 470.0, 450.0, 190.0, 110.0, 265.0, 260.0, 245.0, 155.0, 275.0, 115.0, 475.0, 125.0, 530.0, 155.0, 515.0, 375.0, 135.0, 125.0, 25.0, 145.0, -150.0, 255.0, 225.0, 35.0, 170.0, -20.0, 310.0, 25.0, 65.0, -15.0, 255.0, 125.0, 435.0, -65.0, -15.0, 310.0, 460.0, 300.0, 225.0, 150.0, 510.0, 495.0, 275.0, 265.0, 115.0, 165.0, 465.0, 145.0, 50.0, 360.0, 170.0, 75.0, 330.0, 220.0, 305.0, 220.0, -45.0, 205.0, 280.0, 50.0, 95.0, 380.0, 200.0, 185.0, 190.0, 195.0, 145.0, 70.0, 400.0, 190.0, 130.0, 140.0, 225.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1626756616471547, "mean_inference_ms": 1.5580198518343855, "mean_action_processing_ms": 0.5700032612429972, "mean_env_wait_ms": 0.2043884813010633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1616981029510498, "StateBufferConnector_ms": 0.006478071212768555, "ViewRequirementAgentConnector_ms": 0.33596014976501465}}, "episode_reward_max": 530.0, "episode_reward_min": -150.0, "episode_reward_mean": 209.95, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [490.0, 150.0, 195.0, -20.0, 240.0, 195.0, 85.0, 285.0, -65.0, 175.0, 145.0, 25.0, 230.0, 275.0, 400.0, 380.0, 365.0, 425.0, 485.0, 10.0, 360.0, 40.0, 160.0, 150.0, 100.0, 165.0, 130.0, 470.0, 450.0, 190.0, 110.0, 265.0, 260.0, 245.0, 155.0, 275.0, 115.0, 475.0, 125.0, 530.0, 155.0, 515.0, 375.0, 135.0, 125.0, 25.0, 145.0, -150.0, 255.0, 225.0, 35.0, 170.0, -20.0, 310.0, 25.0, 65.0, -15.0, 255.0, 125.0, 435.0, -65.0, -15.0, 310.0, 460.0, 300.0, 225.0, 150.0, 510.0, 495.0, 275.0, 265.0, 115.0, 165.0, 465.0, 145.0, 50.0, 360.0, 170.0, 75.0, 330.0, 220.0, 305.0, 220.0, -45.0, 205.0, 280.0, 50.0, 95.0, 380.0, 200.0, 185.0, 190.0, 195.0, 145.0, 70.0, 400.0, 190.0, 130.0, 140.0, 225.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1626756616471547, "mean_inference_ms": 1.5580198518343855, "mean_action_processing_ms": 0.5700032612429972, "mean_env_wait_ms": 0.2043884813010633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1616981029510498, "StateBufferConnector_ms": 0.006478071212768555, "ViewRequirementAgentConnector_ms": 0.33596014976501465}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2129920, "num_agent_steps_trained": 2129920, "num_env_steps_sampled": 425984, "num_env_steps_trained": 425984, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.8724910792236, "num_env_steps_trained_throughput_per_sec": 72.8724910792236, "timesteps_total": 425984, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2129920, "timers": {"training_iteration_time_ms": 110072.679, "sample_time_ms": 14438.731, "load_time_ms": 1.717, "load_throughput": 4771920.778, "learn_time_ms": 95623.325, "learn_throughput": 85.669, "synch_weights_time_ms": 2.788}, "counters": {"num_env_steps_sampled": 425984, "num_env_steps_trained": 425984, "num_agent_steps_sampled": 2129920, "num_agent_steps_trained": 2129920}, "done": false, "episodes_total": 3328, "training_iteration": 52, "trial_id": "9fade_00019", "date": "2023-11-09_21-24-36", "timestamp": 1699561476, "time_this_iter_s": 112.43356490135193, "time_total_s": 5247.379759788513, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5247.379759788513, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 37.990625, "ram_util_percent": 18.44875}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.521513272287374, "episode_optimality_min": -0.7078651685393258, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.521513272287374, "episode_optimality_capped_min": -0.7078651685393258, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.12, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 102.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.521513272287374, "curr_learning_score_min": -0.7078651685393258, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9801548238905767, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.31148169703735523, "policy_loss": -0.077841913479618, "vf_loss": 0.3768148156583872, "vf_explained_var": 0.3578419680458804, "kl": 0.01853154779167558, "entropy": 3.7766669356574614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 504000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 434176, "num_env_steps_trained": 434176, "num_agent_steps_sampled": 2170880, "num_agent_steps_trained": 2170880}, "sampler_results": {"episode_reward_max": 510.0, "episode_reward_min": -315.0, "episode_reward_mean": 180.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.521513272287374, "episode_optimality_min": -0.7078651685393258, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.521513272287374, "episode_optimality_capped_min": -0.7078651685393258, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.12, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 102.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.521513272287374, "curr_learning_score_min": -0.7078651685393258, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [300.0, 225.0, 150.0, 510.0, 495.0, 275.0, 265.0, 115.0, 165.0, 465.0, 145.0, 50.0, 360.0, 170.0, 75.0, 330.0, 220.0, 305.0, 220.0, -45.0, 205.0, 280.0, 50.0, 95.0, 380.0, 200.0, 185.0, 190.0, 195.0, 145.0, 70.0, 400.0, 190.0, 130.0, 140.0, 225.0, 180.0, 215.0, 255.0, 100.0, 390.0, 120.0, 155.0, 225.0, 245.0, 185.0, 95.0, 35.0, 250.0, 425.0, 340.0, -25.0, -175.0, 20.0, 300.0, 105.0, 355.0, 290.0, -10.0, -40.0, 175.0, -20.0, 210.0, 180.0, 80.0, 45.0, -20.0, -5.0, 425.0, -165.0, -245.0, 250.0, 230.0, -135.0, 105.0, 425.0, 150.0, 255.0, 215.0, -65.0, 300.0, -130.0, 410.0, 300.0, 320.0, 370.0, -315.0, 345.0, 220.0, 390.0, 355.0, 415.0, 350.0, 265.0, 0.0, -65.0, 45.0, 175.0, 275.0, 35.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1624710713864241, "mean_inference_ms": 1.5575021806473552, "mean_action_processing_ms": 0.5701498131553598, "mean_env_wait_ms": 0.2042879486444354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16248703002929688, "StateBufferConnector_ms": 0.006446361541748047, "ViewRequirementAgentConnector_ms": 0.3333606719970703}}, "episode_reward_max": 510.0, "episode_reward_min": -315.0, "episode_reward_mean": 180.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [300.0, 225.0, 150.0, 510.0, 495.0, 275.0, 265.0, 115.0, 165.0, 465.0, 145.0, 50.0, 360.0, 170.0, 75.0, 330.0, 220.0, 305.0, 220.0, -45.0, 205.0, 280.0, 50.0, 95.0, 380.0, 200.0, 185.0, 190.0, 195.0, 145.0, 70.0, 400.0, 190.0, 130.0, 140.0, 225.0, 180.0, 215.0, 255.0, 100.0, 390.0, 120.0, 155.0, 225.0, 245.0, 185.0, 95.0, 35.0, 250.0, 425.0, 340.0, -25.0, -175.0, 20.0, 300.0, 105.0, 355.0, 290.0, -10.0, -40.0, 175.0, -20.0, 210.0, 180.0, 80.0, 45.0, -20.0, -5.0, 425.0, -165.0, -245.0, 250.0, 230.0, -135.0, 105.0, 425.0, 150.0, 255.0, 215.0, -65.0, 300.0, -130.0, 410.0, 300.0, 320.0, 370.0, -315.0, 345.0, 220.0, 390.0, 355.0, 415.0, 350.0, 265.0, 0.0, -65.0, 45.0, 175.0, 275.0, 35.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1624710713864241, "mean_inference_ms": 1.5575021806473552, "mean_action_processing_ms": 0.5701498131553598, "mean_env_wait_ms": 0.2042879486444354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16248703002929688, "StateBufferConnector_ms": 0.006446361541748047, "ViewRequirementAgentConnector_ms": 0.3333606719970703}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2170880, "num_agent_steps_trained": 2170880, "num_env_steps_sampled": 434176, "num_env_steps_trained": 434176, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.91896974829942, "num_env_steps_trained_throughput_per_sec": 72.91896974829942, "timesteps_total": 434176, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2170880, "timers": {"training_iteration_time_ms": 110491.868, "sample_time_ms": 14402.026, "load_time_ms": 1.703, "load_throughput": 4810940.684, "learn_time_ms": 96079.269, "learn_throughput": 85.263, "synch_weights_time_ms": 2.781}, "counters": {"num_env_steps_sampled": 434176, "num_env_steps_trained": 434176, "num_agent_steps_sampled": 2170880, "num_agent_steps_trained": 2170880}, "done": false, "episodes_total": 3392, "training_iteration": 53, "trial_id": "9fade_00019", "date": "2023-11-09_21-26-28", "timestamp": 1699561588, "time_this_iter_s": 112.3564031124115, "time_total_s": 5359.736162900925, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5359.736162900925, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 38.280625, "ram_util_percent": 18.346250000000005}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.512340438958977, "episode_optimality_min": -0.85, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.512340438958977, "episode_optimality_capped_min": -0.85, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.61, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.512340438958977, "curr_learning_score_min": -0.85, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.969281495360968, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2554264504202244, "policy_loss": -0.07340907680962118, "vf_loss": 0.31677757196107753, "vf_explained_var": 0.3802765950995187, "kl": 0.01786363712871207, "entropy": 3.7306820891052483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 513600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 442368, "num_env_steps_trained": 442368, "num_agent_steps_sampled": 2211840, "num_agent_steps_trained": 2211840}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -340.0, "episode_reward_mean": 188.05, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.512340438958977, "episode_optimality_min": -0.85, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.512340438958977, "episode_optimality_capped_min": -0.85, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.61, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.512340438958977, "curr_learning_score_min": -0.85, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [80.0, 45.0, -20.0, -5.0, 425.0, -165.0, -245.0, 250.0, 230.0, -135.0, 105.0, 425.0, 150.0, 255.0, 215.0, -65.0, 300.0, -130.0, 410.0, 300.0, 320.0, 370.0, -315.0, 345.0, 220.0, 390.0, 355.0, 415.0, 350.0, 265.0, 0.0, -65.0, 45.0, 175.0, 275.0, 35.0, 55.0, 145.0, 30.0, 380.0, 485.0, 510.0, 465.0, 30.0, 215.0, -20.0, 60.0, 60.0, 245.0, 220.0, 330.0, 215.0, 280.0, 525.0, 185.0, 235.0, -70.0, 380.0, 195.0, 0.0, 280.0, 525.0, 30.0, 210.0, 200.0, 460.0, 560.0, 160.0, 95.0, -340.0, 380.0, 255.0, 430.0, 55.0, 225.0, 50.0, 95.0, 405.0, 230.0, -20.0, 270.0, 185.0, 630.0, -160.0, -50.0, 170.0, 120.0, 140.0, 155.0, 220.0, -40.0, 230.0, 185.0, 130.0, 210.0, 290.0, 460.0, 125.0, 305.0, 185.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.162242697904359, "mean_inference_ms": 1.5566895760045236, "mean_action_processing_ms": 0.5700624539160211, "mean_env_wait_ms": 0.2041292871844742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16200637817382812, "StateBufferConnector_ms": 0.006445169448852539, "ViewRequirementAgentConnector_ms": 0.3336310386657715}}, "episode_reward_max": 630.0, "episode_reward_min": -340.0, "episode_reward_mean": 188.05, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0, 45.0, -20.0, -5.0, 425.0, -165.0, -245.0, 250.0, 230.0, -135.0, 105.0, 425.0, 150.0, 255.0, 215.0, -65.0, 300.0, -130.0, 410.0, 300.0, 320.0, 370.0, -315.0, 345.0, 220.0, 390.0, 355.0, 415.0, 350.0, 265.0, 0.0, -65.0, 45.0, 175.0, 275.0, 35.0, 55.0, 145.0, 30.0, 380.0, 485.0, 510.0, 465.0, 30.0, 215.0, -20.0, 60.0, 60.0, 245.0, 220.0, 330.0, 215.0, 280.0, 525.0, 185.0, 235.0, -70.0, 380.0, 195.0, 0.0, 280.0, 525.0, 30.0, 210.0, 200.0, 460.0, 560.0, 160.0, 95.0, -340.0, 380.0, 255.0, 430.0, 55.0, 225.0, 50.0, 95.0, 405.0, 230.0, -20.0, 270.0, 185.0, 630.0, -160.0, -50.0, 170.0, 120.0, 140.0, 155.0, 220.0, -40.0, 230.0, 185.0, 130.0, 210.0, 290.0, 460.0, 125.0, 305.0, 185.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.162242697904359, "mean_inference_ms": 1.5566895760045236, "mean_action_processing_ms": 0.5700624539160211, "mean_env_wait_ms": 0.2041292871844742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16200637817382812, "StateBufferConnector_ms": 0.006445169448852539, "ViewRequirementAgentConnector_ms": 0.3336310386657715}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2211840, "num_agent_steps_trained": 2211840, "num_env_steps_sampled": 442368, "num_env_steps_trained": 442368, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.74974448680834, "num_env_steps_trained_throughput_per_sec": 72.74974448680834, "timesteps_total": 442368, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2211840, "timers": {"training_iteration_time_ms": 110711.113, "sample_time_ms": 14433.447, "load_time_ms": 1.791, "load_throughput": 4574345.444, "learn_time_ms": 96267.108, "learn_throughput": 85.097, "synch_weights_time_ms": 2.668}, "counters": {"num_env_steps_sampled": 442368, "num_env_steps_trained": 442368, "num_agent_steps_sampled": 2211840, "num_agent_steps_trained": 2211840}, "done": false, "episodes_total": 3456, "training_iteration": 54, "trial_id": "9fade_00019", "date": "2023-11-09_21-28-22", "timestamp": 1699561702, "time_this_iter_s": 112.62415623664856, "time_total_s": 5472.360319137573, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5472.360319137573, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 38.44753086419753, "ram_util_percent": 18.554938271604936}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4896204641952215, "episode_optimality_min": -0.85, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4896204641952215, "episode_optimality_capped_min": -0.85, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 35.83, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4896204641952215, "curr_learning_score_min": -0.85, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.974436552155142, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2889067559502049, "policy_loss": -0.07547883825308721, "vf_loss": 0.35216058492621716, "vf_explained_var": 0.3500073433667421, "kl": 0.018111123747341935, "entropy": 3.731338962415854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 523200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 450560, "num_env_steps_trained": 450560, "num_agent_steps_sampled": 2252800, "num_agent_steps_trained": 2252800}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -340.0, "episode_reward_mean": 179.15, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4896204641952215, "episode_optimality_min": -0.85, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4896204641952215, "episode_optimality_capped_min": -0.85, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 35.83, "episode_reward_normalized_min": -68.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4896204641952215, "curr_learning_score_min": -0.85, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [200.0, 460.0, 560.0, 160.0, 95.0, -340.0, 380.0, 255.0, 430.0, 55.0, 225.0, 50.0, 95.0, 405.0, 230.0, -20.0, 270.0, 185.0, 630.0, -160.0, -50.0, 170.0, 120.0, 140.0, 155.0, 220.0, -40.0, 230.0, 185.0, 130.0, 210.0, 290.0, 460.0, 125.0, 305.0, 185.0, 480.0, 400.0, 170.0, 45.0, 450.0, -55.0, 505.0, 405.0, 125.0, -260.0, 225.0, -40.0, 270.0, 295.0, 135.0, 375.0, 250.0, 110.0, 245.0, 490.0, 185.0, -100.0, 365.0, 100.0, 430.0, 200.0, 170.0, -25.0, 265.0, -115.0, 120.0, -15.0, 115.0, 115.0, -80.0, 210.0, 240.0, 125.0, -15.0, -155.0, 500.0, -145.0, 80.0, -85.0, 310.0, 60.0, -25.0, 110.0, 210.0, 440.0, 290.0, 300.0, -85.0, -135.0, -20.0, 340.0, 210.0, 360.0, -20.0, 310.0, 110.0, 150.0, 405.0, 490.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1617725174905227, "mean_inference_ms": 1.5558636932423626, "mean_action_processing_ms": 0.5698729255785091, "mean_env_wait_ms": 0.20397265669891085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16016483306884766, "StateBufferConnector_ms": 0.006456613540649414, "ViewRequirementAgentConnector_ms": 0.3310685157775879}}, "episode_reward_max": 630.0, "episode_reward_min": -340.0, "episode_reward_mean": 179.15, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [200.0, 460.0, 560.0, 160.0, 95.0, -340.0, 380.0, 255.0, 430.0, 55.0, 225.0, 50.0, 95.0, 405.0, 230.0, -20.0, 270.0, 185.0, 630.0, -160.0, -50.0, 170.0, 120.0, 140.0, 155.0, 220.0, -40.0, 230.0, 185.0, 130.0, 210.0, 290.0, 460.0, 125.0, 305.0, 185.0, 480.0, 400.0, 170.0, 45.0, 450.0, -55.0, 505.0, 405.0, 125.0, -260.0, 225.0, -40.0, 270.0, 295.0, 135.0, 375.0, 250.0, 110.0, 245.0, 490.0, 185.0, -100.0, 365.0, 100.0, 430.0, 200.0, 170.0, -25.0, 265.0, -115.0, 120.0, -15.0, 115.0, 115.0, -80.0, 210.0, 240.0, 125.0, -15.0, -155.0, 500.0, -145.0, 80.0, -85.0, 310.0, 60.0, -25.0, 110.0, 210.0, 440.0, 290.0, 300.0, -85.0, -135.0, -20.0, 340.0, 210.0, 360.0, -20.0, 310.0, 110.0, 150.0, 405.0, 490.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1617725174905227, "mean_inference_ms": 1.5558636932423626, "mean_action_processing_ms": 0.5698729255785091, "mean_env_wait_ms": 0.20397265669891085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16016483306884766, "StateBufferConnector_ms": 0.006456613540649414, "ViewRequirementAgentConnector_ms": 0.3310685157775879}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2252800, "num_agent_steps_trained": 2252800, "num_env_steps_sampled": 450560, "num_env_steps_trained": 450560, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 73.50938753475907, "num_env_steps_trained_throughput_per_sec": 73.50938753475907, "timesteps_total": 450560, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2252800, "timers": {"training_iteration_time_ms": 110950.474, "sample_time_ms": 14420.295, "load_time_ms": 1.731, "load_throughput": 4732029.358, "learn_time_ms": 96519.583, "learn_throughput": 84.874, "synch_weights_time_ms": 2.782}, "counters": {"num_env_steps_sampled": 450560, "num_env_steps_trained": 450560, "num_agent_steps_sampled": 2252800, "num_agent_steps_trained": 2252800}, "done": false, "episodes_total": 3520, "training_iteration": 55, "trial_id": "9fade_00019", "date": "2023-11-09_21-30-13", "timestamp": 1699561813, "time_this_iter_s": 111.45862102508545, "time_total_s": 5583.818940162659, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5583.818940162659, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.26855345911949, "ram_util_percent": 18.657861635220126}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4091459056870861, "episode_optimality_min": -0.7435897435897436, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4091459056870861, "episode_optimality_capped_min": -0.7435897435897436, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 31.38, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 106.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4091459056870861, "curr_learning_score_min": -0.7435897435897436, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9845908452911923, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.31444610307194426, "policy_loss": -0.08044870811487878, "vf_loss": 0.3821345842312439, "vf_explained_var": 0.34860085908323524, "kl": 0.01890403841867396, "entropy": 3.7122372919817765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 532800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 458752, "num_env_steps_trained": 458752, "num_agent_steps_sampled": 2293760, "num_agent_steps_trained": 2293760}, "sampler_results": {"episode_reward_max": 530.0, "episode_reward_min": -275.0, "episode_reward_mean": 156.9, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4091459056870861, "episode_optimality_min": -0.7435897435897436, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4091459056870861, "episode_optimality_capped_min": -0.7435897435897436, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 31.38, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 106.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4091459056870861, "curr_learning_score_min": -0.7435897435897436, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [265.0, -115.0, 120.0, -15.0, 115.0, 115.0, -80.0, 210.0, 240.0, 125.0, -15.0, -155.0, 500.0, -145.0, 80.0, -85.0, 310.0, 60.0, -25.0, 110.0, 210.0, 440.0, 290.0, 300.0, -85.0, -135.0, -20.0, 340.0, 210.0, 360.0, -20.0, 310.0, 110.0, 150.0, 405.0, 490.0, -105.0, 420.0, 50.0, -85.0, -30.0, 315.0, -275.0, 295.0, 95.0, 250.0, 385.0, 205.0, 190.0, -15.0, 95.0, -120.0, 160.0, 435.0, 65.0, 210.0, 245.0, 35.0, 170.0, 325.0, 320.0, 530.0, 120.0, 15.0, 100.0, -45.0, 55.0, 115.0, -105.0, 140.0, 345.0, 210.0, -85.0, 155.0, 400.0, 315.0, 240.0, 355.0, 225.0, 90.0, 345.0, 300.0, 60.0, -95.0, 20.0, -95.0, 165.0, -20.0, 70.0, 445.0, 265.0, 160.0, 240.0, 220.0, 370.0, -15.0, 470.0, 145.0, 410.0, 450.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1614766678116564, "mean_inference_ms": 1.555680440172435, "mean_action_processing_ms": 0.5697044073741537, "mean_env_wait_ms": 0.20391442811904048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16128969192504883, "StateBufferConnector_ms": 0.006441831588745117, "ViewRequirementAgentConnector_ms": 0.33522534370422363}}, "episode_reward_max": 530.0, "episode_reward_min": -275.0, "episode_reward_mean": 156.9, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [265.0, -115.0, 120.0, -15.0, 115.0, 115.0, -80.0, 210.0, 240.0, 125.0, -15.0, -155.0, 500.0, -145.0, 80.0, -85.0, 310.0, 60.0, -25.0, 110.0, 210.0, 440.0, 290.0, 300.0, -85.0, -135.0, -20.0, 340.0, 210.0, 360.0, -20.0, 310.0, 110.0, 150.0, 405.0, 490.0, -105.0, 420.0, 50.0, -85.0, -30.0, 315.0, -275.0, 295.0, 95.0, 250.0, 385.0, 205.0, 190.0, -15.0, 95.0, -120.0, 160.0, 435.0, 65.0, 210.0, 245.0, 35.0, 170.0, 325.0, 320.0, 530.0, 120.0, 15.0, 100.0, -45.0, 55.0, 115.0, -105.0, 140.0, 345.0, 210.0, -85.0, 155.0, 400.0, 315.0, 240.0, 355.0, 225.0, 90.0, 345.0, 300.0, 60.0, -95.0, 20.0, -95.0, 165.0, -20.0, 70.0, 445.0, 265.0, 160.0, 240.0, 220.0, 370.0, -15.0, 470.0, 145.0, 410.0, 450.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1614766678116564, "mean_inference_ms": 1.555680440172435, "mean_action_processing_ms": 0.5697044073741537, "mean_env_wait_ms": 0.20391442811904048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16128969192504883, "StateBufferConnector_ms": 0.006441831588745117, "ViewRequirementAgentConnector_ms": 0.33522534370422363}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2293760, "num_agent_steps_trained": 2293760, "num_env_steps_sampled": 458752, "num_env_steps_trained": 458752, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.18316087981036, "num_env_steps_trained_throughput_per_sec": 72.18316087981036, "timesteps_total": 458752, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2293760, "timers": {"training_iteration_time_ms": 111458.454, "sample_time_ms": 14538.018, "load_time_ms": 1.697, "load_throughput": 4828654.314, "learn_time_ms": 96909.75, "learn_throughput": 84.532, "synch_weights_time_ms": 2.905}, "counters": {"num_env_steps_sampled": 458752, "num_env_steps_trained": 458752, "num_agent_steps_sampled": 2293760, "num_agent_steps_trained": 2293760}, "done": false, "episodes_total": 3584, "training_iteration": 56, "trial_id": "9fade_00019", "date": "2023-11-09_21-32-07", "timestamp": 1699561927, "time_this_iter_s": 113.50677156448364, "time_total_s": 5697.325711727142, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5697.325711727142, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 37.964197530864205, "ram_util_percent": 18.60308641975308}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5358355691886694, "episode_optimality_min": -0.4375, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5358355691886694, "episode_optimality_capped_min": -0.4375, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.02, "episode_reward_normalized_min": -21.0, "episode_reward_normalized_max": 99.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5358355691886694, "curr_learning_score_min": -0.4375, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9877817349135876, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.277862026738488, "policy_loss": -0.07998454183970656, "vf_loss": 0.3447760820288871, "vf_explained_var": 0.3580175854389866, "kl": 0.019363683589599532, "entropy": 3.6736020734657844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 542400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 466944, "num_env_steps_trained": 466944, "num_agent_steps_sampled": 2334720, "num_agent_steps_trained": 2334720}, "sampler_results": {"episode_reward_max": 495.0, "episode_reward_min": -105.0, "episode_reward_mean": 195.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5358355691886694, "episode_optimality_min": -0.4375, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5358355691886694, "episode_optimality_capped_min": -0.4375, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.02, "episode_reward_normalized_min": -21.0, "episode_reward_normalized_max": 99.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5358355691886694, "curr_learning_score_min": -0.4375, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [100.0, -45.0, 55.0, 115.0, -105.0, 140.0, 345.0, 210.0, -85.0, 155.0, 400.0, 315.0, 240.0, 355.0, 225.0, 90.0, 345.0, 300.0, 60.0, -95.0, 20.0, -95.0, 165.0, -20.0, 70.0, 445.0, 265.0, 160.0, 240.0, 220.0, 370.0, -15.0, 470.0, 145.0, 410.0, 450.0, 105.0, 305.0, 445.0, 215.0, -15.0, 280.0, 180.0, 70.0, 290.0, 260.0, 245.0, 125.0, 215.0, 270.0, 195.0, 305.0, 175.0, 350.0, 360.0, 105.0, 340.0, -55.0, -55.0, -20.0, 135.0, 150.0, 160.0, 380.0, 495.0, 165.0, 90.0, 75.0, 395.0, -90.0, 380.0, 215.0, 90.0, -100.0, 380.0, 235.0, 255.0, 395.0, 60.0, -5.0, 300.0, 310.0, 370.0, 240.0, 275.0, 235.0, 145.0, 355.0, 100.0, 130.0, 290.0, 260.0, 310.0, 105.0, 115.0, 50.0, 175.0, 495.0, 225.0, 55.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1610745419610833, "mean_inference_ms": 1.5554321590395122, "mean_action_processing_ms": 0.5697187974813176, "mean_env_wait_ms": 0.20385451244760497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16085004806518555, "StateBufferConnector_ms": 0.006395101547241211, "ViewRequirementAgentConnector_ms": 0.33344554901123047}}, "episode_reward_max": 495.0, "episode_reward_min": -105.0, "episode_reward_mean": 195.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [100.0, -45.0, 55.0, 115.0, -105.0, 140.0, 345.0, 210.0, -85.0, 155.0, 400.0, 315.0, 240.0, 355.0, 225.0, 90.0, 345.0, 300.0, 60.0, -95.0, 20.0, -95.0, 165.0, -20.0, 70.0, 445.0, 265.0, 160.0, 240.0, 220.0, 370.0, -15.0, 470.0, 145.0, 410.0, 450.0, 105.0, 305.0, 445.0, 215.0, -15.0, 280.0, 180.0, 70.0, 290.0, 260.0, 245.0, 125.0, 215.0, 270.0, 195.0, 305.0, 175.0, 350.0, 360.0, 105.0, 340.0, -55.0, -55.0, -20.0, 135.0, 150.0, 160.0, 380.0, 495.0, 165.0, 90.0, 75.0, 395.0, -90.0, 380.0, 215.0, 90.0, -100.0, 380.0, 235.0, 255.0, 395.0, 60.0, -5.0, 300.0, 310.0, 370.0, 240.0, 275.0, 235.0, 145.0, 355.0, 100.0, 130.0, 290.0, 260.0, 310.0, 105.0, 115.0, 50.0, 175.0, 495.0, 225.0, 55.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1610745419610833, "mean_inference_ms": 1.5554321590395122, "mean_action_processing_ms": 0.5697187974813176, "mean_env_wait_ms": 0.20385451244760497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16085004806518555, "StateBufferConnector_ms": 0.006395101547241211, "ViewRequirementAgentConnector_ms": 0.33344554901123047}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2334720, "num_agent_steps_trained": 2334720, "num_env_steps_sampled": 466944, "num_env_steps_trained": 466944, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.84802181556208, "num_env_steps_trained_throughput_per_sec": 72.84802181556208, "timesteps_total": 466944, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2334720, "timers": {"training_iteration_time_ms": 111758.422, "sample_time_ms": 14504.288, "load_time_ms": 1.81, "load_throughput": 4525662.966, "learn_time_ms": 97243.315, "learn_throughput": 84.242, "synch_weights_time_ms": 2.879}, "counters": {"num_env_steps_sampled": 466944, "num_env_steps_trained": 466944, "num_agent_steps_sampled": 2334720, "num_agent_steps_trained": 2334720}, "done": false, "episodes_total": 3648, "training_iteration": 57, "trial_id": "9fade_00019", "date": "2023-11-09_21-34-00", "timestamp": 1699562040, "time_this_iter_s": 112.4686541557312, "time_total_s": 5809.7943658828735, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5809.7943658828735, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 37.493125000000006, "ram_util_percent": 18.559375}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5303662815783323, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5303662815783323, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.77, "episode_reward_normalized_min": -25.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5303662815783323, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9817181847523898, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.254412139785054, "policy_loss": -0.07194173442106451, "vf_loss": 0.31413755559634104, "vf_explained_var": 0.3736285616581639, "kl": 0.018098250042125036, "entropy": 3.6544639167189596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 552000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 475136, "num_env_steps_trained": 475136, "num_agent_steps_sampled": 2375680, "num_agent_steps_trained": 2375680}, "sampler_results": {"episode_reward_max": 570.0, "episode_reward_min": -125.0, "episode_reward_mean": 193.85, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5303662815783323, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5303662815783323, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.77, "episode_reward_normalized_min": -25.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5303662815783323, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [495.0, 165.0, 90.0, 75.0, 395.0, -90.0, 380.0, 215.0, 90.0, -100.0, 380.0, 235.0, 255.0, 395.0, 60.0, -5.0, 300.0, 310.0, 370.0, 240.0, 275.0, 235.0, 145.0, 355.0, 100.0, 130.0, 290.0, 260.0, 310.0, 105.0, 115.0, 50.0, 175.0, 495.0, 225.0, 55.0, -5.0, 410.0, 430.0, 435.0, 85.0, 280.0, 350.0, 245.0, 60.0, 120.0, 375.0, 450.0, 330.0, 185.0, 265.0, -5.0, 215.0, 335.0, 455.0, 120.0, -65.0, -30.0, 385.0, -5.0, -85.0, 75.0, 200.0, 395.0, 100.0, 245.0, 240.0, -55.0, 335.0, 35.0, -20.0, 50.0, 290.0, 295.0, 285.0, 235.0, 135.0, 305.0, 10.0, 420.0, -25.0, 65.0, 130.0, -65.0, 85.0, -125.0, 410.0, -50.0, -70.0, 195.0, 195.0, 345.0, 270.0, 80.0, 265.0, 570.0, 155.0, 320.0, 90.0, 60.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1604341574617845, "mean_inference_ms": 1.554263140913625, "mean_action_processing_ms": 0.569608794466844, "mean_env_wait_ms": 0.20368089981434623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15970563888549805, "StateBufferConnector_ms": 0.0062520503997802734, "ViewRequirementAgentConnector_ms": 0.3224945068359375}}, "episode_reward_max": 570.0, "episode_reward_min": -125.0, "episode_reward_mean": 193.85, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [495.0, 165.0, 90.0, 75.0, 395.0, -90.0, 380.0, 215.0, 90.0, -100.0, 380.0, 235.0, 255.0, 395.0, 60.0, -5.0, 300.0, 310.0, 370.0, 240.0, 275.0, 235.0, 145.0, 355.0, 100.0, 130.0, 290.0, 260.0, 310.0, 105.0, 115.0, 50.0, 175.0, 495.0, 225.0, 55.0, -5.0, 410.0, 430.0, 435.0, 85.0, 280.0, 350.0, 245.0, 60.0, 120.0, 375.0, 450.0, 330.0, 185.0, 265.0, -5.0, 215.0, 335.0, 455.0, 120.0, -65.0, -30.0, 385.0, -5.0, -85.0, 75.0, 200.0, 395.0, 100.0, 245.0, 240.0, -55.0, 335.0, 35.0, -20.0, 50.0, 290.0, 295.0, 285.0, 235.0, 135.0, 305.0, 10.0, 420.0, -25.0, 65.0, 130.0, -65.0, 85.0, -125.0, 410.0, -50.0, -70.0, 195.0, 195.0, 345.0, 270.0, 80.0, 265.0, 570.0, 155.0, 320.0, 90.0, 60.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1604341574617845, "mean_inference_ms": 1.554263140913625, "mean_action_processing_ms": 0.569608794466844, "mean_env_wait_ms": 0.20368089981434623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15970563888549805, "StateBufferConnector_ms": 0.0062520503997802734, "ViewRequirementAgentConnector_ms": 0.3224945068359375}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2375680, "num_agent_steps_trained": 2375680, "num_env_steps_sampled": 475136, "num_env_steps_trained": 475136, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 73.3492824151546, "num_env_steps_trained_throughput_per_sec": 73.3492824151546, "timesteps_total": 475136, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2375680, "timers": {"training_iteration_time_ms": 111947.956, "sample_time_ms": 14519.483, "load_time_ms": 1.863, "load_throughput": 4397145.976, "learn_time_ms": 97417.436, "learn_throughput": 84.092, "synch_weights_time_ms": 2.989}, "counters": {"num_env_steps_sampled": 475136, "num_env_steps_trained": 475136, "num_agent_steps_sampled": 2375680, "num_agent_steps_trained": 2375680}, "done": false, "episodes_total": 3712, "training_iteration": 58, "trial_id": "9fade_00019", "date": "2023-11-09_21-35-51", "timestamp": 1699562151, "time_this_iter_s": 111.70103859901428, "time_total_s": 5921.495404481888, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 5921.495404481888, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.690625, "ram_util_percent": 18.658749999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.47525404559111784, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.47525404559111784, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.49, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.47525404559111784, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.988448915334108, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.26877768044735906, "policy_loss": -0.07679691364852867, "vf_loss": 0.3327618231987678, "vf_explained_var": 0.350593901394556, "kl": 0.01898188220643078, "entropy": 3.6483426229159037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 561600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 483328, "num_env_steps_trained": 483328, "num_agent_steps_sampled": 2416640, "num_agent_steps_trained": 2416640}, "sampler_results": {"episode_reward_max": 570.0, "episode_reward_min": -185.0, "episode_reward_mean": 167.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.47525404559111784, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.47525404559111784, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.49, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.47525404559111784, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [100.0, 245.0, 240.0, -55.0, 335.0, 35.0, -20.0, 50.0, 290.0, 295.0, 285.0, 235.0, 135.0, 305.0, 10.0, 420.0, -25.0, 65.0, 130.0, -65.0, 85.0, -125.0, 410.0, -50.0, -70.0, 195.0, 195.0, 345.0, 270.0, 80.0, 265.0, 570.0, 155.0, 320.0, 90.0, 60.0, -25.0, 245.0, 260.0, 120.0, 60.0, -15.0, 115.0, -15.0, 35.0, 355.0, 105.0, 55.0, 455.0, 40.0, -185.0, 315.0, 165.0, 200.0, 220.0, 435.0, 85.0, 345.0, 80.0, 70.0, 105.0, 20.0, 185.0, 405.0, 260.0, 115.0, 40.0, -85.0, 240.0, 190.0, -20.0, 200.0, 285.0, 435.0, 0.0, 240.0, 285.0, 225.0, 370.0, 265.0, 100.0, 90.0, 215.0, -5.0, 65.0, 270.0, 315.0, 250.0, 95.0, 250.0, 475.0, 35.0, 70.0, 205.0, 410.0, 230.0, 260.0, 300.0, 145.0, -115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1609485486688598, "mean_inference_ms": 1.5540058487351314, "mean_action_processing_ms": 0.5693657580904403, "mean_env_wait_ms": 0.20356192556456598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15887737274169922, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.32952189445495605}}, "episode_reward_max": 570.0, "episode_reward_min": -185.0, "episode_reward_mean": 167.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [100.0, 245.0, 240.0, -55.0, 335.0, 35.0, -20.0, 50.0, 290.0, 295.0, 285.0, 235.0, 135.0, 305.0, 10.0, 420.0, -25.0, 65.0, 130.0, -65.0, 85.0, -125.0, 410.0, -50.0, -70.0, 195.0, 195.0, 345.0, 270.0, 80.0, 265.0, 570.0, 155.0, 320.0, 90.0, 60.0, -25.0, 245.0, 260.0, 120.0, 60.0, -15.0, 115.0, -15.0, 35.0, 355.0, 105.0, 55.0, 455.0, 40.0, -185.0, 315.0, 165.0, 200.0, 220.0, 435.0, 85.0, 345.0, 80.0, 70.0, 105.0, 20.0, 185.0, 405.0, 260.0, 115.0, 40.0, -85.0, 240.0, 190.0, -20.0, 200.0, 285.0, 435.0, 0.0, 240.0, 285.0, 225.0, 370.0, 265.0, 100.0, 90.0, 215.0, -5.0, 65.0, 270.0, 315.0, 250.0, 95.0, 250.0, 475.0, 35.0, 70.0, 205.0, 410.0, 230.0, 260.0, 300.0, 145.0, -115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1609485486688598, "mean_inference_ms": 1.5540058487351314, "mean_action_processing_ms": 0.5693657580904403, "mean_env_wait_ms": 0.20356192556456598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15887737274169922, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.32952189445495605}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416640, "num_agent_steps_trained": 2416640, "num_env_steps_sampled": 483328, "num_env_steps_trained": 483328, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.19452375069997, "num_env_steps_trained_throughput_per_sec": 72.19452375069997, "timesteps_total": 483328, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2416640, "timers": {"training_iteration_time_ms": 112283.549, "sample_time_ms": 14537.79, "load_time_ms": 1.911, "load_throughput": 4287250.246, "learn_time_ms": 97734.794, "learn_throughput": 83.819, "synch_weights_time_ms": 2.813}, "counters": {"num_env_steps_sampled": 483328, "num_env_steps_trained": 483328, "num_agent_steps_sampled": 2416640, "num_agent_steps_trained": 2416640}, "done": false, "episodes_total": 3776, "training_iteration": 59, "trial_id": "9fade_00019", "date": "2023-11-09_21-37-45", "timestamp": 1699562265, "time_this_iter_s": 113.4843156337738, "time_total_s": 6034.979720115662, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6034.979720115662, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 37.81925465838509, "ram_util_percent": 18.603105590062107}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5276222375252999, "episode_optimality_min": -0.9545454545454546, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5276222375252999, "episode_optimality_capped_min": -0.9545454545454546, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.67, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5276222375252999, "curr_learning_score_min": -0.9545454545454546, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9730444781094169, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2556379816477177, "policy_loss": -0.07661964372075697, "vf_loss": 0.31987276779999474, "vf_explained_var": 0.37905963419626154, "kl": 0.018347936565950438, "entropy": 3.580241568982601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 571200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 491520, "num_env_steps_trained": 491520, "num_agent_steps_sampled": 2457600, "num_agent_steps_trained": 2457600}, "sampler_results": {"episode_reward_max": 555.0, "episode_reward_min": -315.0, "episode_reward_mean": 188.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5276222375252999, "episode_optimality_min": -0.9545454545454546, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5276222375252999, "episode_optimality_capped_min": -0.9545454545454546, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.67, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5276222375252999, "curr_learning_score_min": -0.9545454545454546, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [260.0, 115.0, 40.0, -85.0, 240.0, 190.0, -20.0, 200.0, 285.0, 435.0, 0.0, 240.0, 285.0, 225.0, 370.0, 265.0, 100.0, 90.0, 215.0, -5.0, 65.0, 270.0, 315.0, 250.0, 95.0, 250.0, 475.0, 35.0, 70.0, 205.0, 410.0, 230.0, 260.0, 300.0, 145.0, -115.0, 0.0, 70.0, 10.0, 85.0, -55.0, 285.0, 20.0, -40.0, -210.0, 185.0, 25.0, 165.0, -315.0, 180.0, 140.0, 335.0, -55.0, 400.0, 380.0, 305.0, -10.0, 395.0, 310.0, 295.0, 265.0, 235.0, -55.0, 70.0, 380.0, 435.0, -100.0, 325.0, 270.0, 20.0, 155.0, 185.0, 470.0, 285.0, 275.0, 170.0, 425.0, -20.0, 225.0, 180.0, 385.0, 300.0, 355.0, -10.0, 285.0, 185.0, 415.0, 50.0, -135.0, 310.0, 340.0, 150.0, 210.0, 375.0, 130.0, 10.0, 375.0, 530.0, 555.0, 220.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1611451798168906, "mean_inference_ms": 1.5541147468443353, "mean_action_processing_ms": 0.5692444634099753, "mean_env_wait_ms": 0.20350156479530312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16046762466430664, "StateBufferConnector_ms": 0.0063593387603759766, "ViewRequirementAgentConnector_ms": 0.3288078308105469}}, "episode_reward_max": 555.0, "episode_reward_min": -315.0, "episode_reward_mean": 188.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [260.0, 115.0, 40.0, -85.0, 240.0, 190.0, -20.0, 200.0, 285.0, 435.0, 0.0, 240.0, 285.0, 225.0, 370.0, 265.0, 100.0, 90.0, 215.0, -5.0, 65.0, 270.0, 315.0, 250.0, 95.0, 250.0, 475.0, 35.0, 70.0, 205.0, 410.0, 230.0, 260.0, 300.0, 145.0, -115.0, 0.0, 70.0, 10.0, 85.0, -55.0, 285.0, 20.0, -40.0, -210.0, 185.0, 25.0, 165.0, -315.0, 180.0, 140.0, 335.0, -55.0, 400.0, 380.0, 305.0, -10.0, 395.0, 310.0, 295.0, 265.0, 235.0, -55.0, 70.0, 380.0, 435.0, -100.0, 325.0, 270.0, 20.0, 155.0, 185.0, 470.0, 285.0, 275.0, 170.0, 425.0, -20.0, 225.0, 180.0, 385.0, 300.0, 355.0, -10.0, 285.0, 185.0, 415.0, 50.0, -135.0, 310.0, 340.0, 150.0, 210.0, 375.0, 130.0, 10.0, 375.0, 530.0, 555.0, 220.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1611451798168906, "mean_inference_ms": 1.5541147468443353, "mean_action_processing_ms": 0.5692444634099753, "mean_env_wait_ms": 0.20350156479530312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16046762466430664, "StateBufferConnector_ms": 0.0063593387603759766, "ViewRequirementAgentConnector_ms": 0.3288078308105469}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2457600, "num_agent_steps_trained": 2457600, "num_env_steps_sampled": 491520, "num_env_steps_trained": 491520, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.28902402093242, "num_env_steps_trained_throughput_per_sec": 71.28902402093242, "timesteps_total": 491520, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2457600, "timers": {"training_iteration_time_ms": 112754.385, "sample_time_ms": 14602.149, "load_time_ms": 1.93, "load_throughput": 4245244.866, "learn_time_ms": 98140.996, "learn_throughput": 83.472, "synch_weights_time_ms": 2.966}, "counters": {"num_env_steps_sampled": 491520, "num_env_steps_trained": 491520, "num_agent_steps_sampled": 2457600, "num_agent_steps_trained": 2457600}, "done": false, "episodes_total": 3840, "training_iteration": 60, "trial_id": "9fade_00019", "date": "2023-11-09_21-39-40", "timestamp": 1699562380, "time_this_iter_s": 114.92723298072815, "time_total_s": 6149.90695309639, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6149.90695309639, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 37.10182926829268, "ram_util_percent": 18.751829268292685}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5184254717581661, "episode_optimality_min": -0.7704918032786885, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5184254717581661, "episode_optimality_capped_min": -0.7704918032786885, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.08, "episode_reward_normalized_min": -47.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5184254717581661, "curr_learning_score_min": -0.7704918032786885, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9750275149336085, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.27101635966340837, "policy_loss": -0.0768243953817849, "vf_loss": 0.3351706945228883, "vf_explained_var": 0.38032463434462743, "kl": 0.01877046031584541, "entropy": 3.583333125784993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 580800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 499712, "num_env_steps_trained": 499712, "num_agent_steps_sampled": 2498560, "num_agent_steps_trained": 2498560}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -235.0, "episode_reward_mean": 190.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5184254717581661, "episode_optimality_min": -0.7704918032786885, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5184254717581661, "episode_optimality_capped_min": -0.7704918032786885, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.08, "episode_reward_normalized_min": -47.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5184254717581661, "curr_learning_score_min": -0.7704918032786885, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [380.0, 435.0, -100.0, 325.0, 270.0, 20.0, 155.0, 185.0, 470.0, 285.0, 275.0, 170.0, 425.0, -20.0, 225.0, 180.0, 385.0, 300.0, 355.0, -10.0, 285.0, 185.0, 415.0, 50.0, -135.0, 310.0, 340.0, 150.0, 210.0, 375.0, 130.0, 10.0, 375.0, 530.0, 555.0, 220.0, -70.0, -170.0, 365.0, 130.0, 410.0, 205.0, 585.0, 255.0, -55.0, 15.0, -85.0, 95.0, -235.0, 5.0, 125.0, -100.0, 140.0, 115.0, 115.0, 235.0, -145.0, 105.0, 165.0, 285.0, 30.0, 255.0, 450.0, 340.0, 400.0, 205.0, 260.0, 280.0, 150.0, -150.0, -35.0, 385.0, 80.0, 195.0, 265.0, 125.0, 415.0, 15.0, -165.0, 135.0, 390.0, 315.0, 380.0, 145.0, 30.0, 410.0, 150.0, 400.0, 210.0, 245.0, 260.0, 210.0, 235.0, 255.0, -115.0, 335.0, 255.0, 80.0, -15.0, 25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1607890906287035, "mean_inference_ms": 1.55411204371297, "mean_action_processing_ms": 0.5690419987541765, "mean_env_wait_ms": 0.20345104535277067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16091012954711914, "StateBufferConnector_ms": 0.006386756896972656, "ViewRequirementAgentConnector_ms": 0.3305835723876953}}, "episode_reward_max": 585.0, "episode_reward_min": -235.0, "episode_reward_mean": 190.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [380.0, 435.0, -100.0, 325.0, 270.0, 20.0, 155.0, 185.0, 470.0, 285.0, 275.0, 170.0, 425.0, -20.0, 225.0, 180.0, 385.0, 300.0, 355.0, -10.0, 285.0, 185.0, 415.0, 50.0, -135.0, 310.0, 340.0, 150.0, 210.0, 375.0, 130.0, 10.0, 375.0, 530.0, 555.0, 220.0, -70.0, -170.0, 365.0, 130.0, 410.0, 205.0, 585.0, 255.0, -55.0, 15.0, -85.0, 95.0, -235.0, 5.0, 125.0, -100.0, 140.0, 115.0, 115.0, 235.0, -145.0, 105.0, 165.0, 285.0, 30.0, 255.0, 450.0, 340.0, 400.0, 205.0, 260.0, 280.0, 150.0, -150.0, -35.0, 385.0, 80.0, 195.0, 265.0, 125.0, 415.0, 15.0, -165.0, 135.0, 390.0, 315.0, 380.0, 145.0, 30.0, 410.0, 150.0, 400.0, 210.0, 245.0, 260.0, 210.0, 235.0, 255.0, -115.0, 335.0, 255.0, 80.0, -15.0, 25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1607890906287035, "mean_inference_ms": 1.55411204371297, "mean_action_processing_ms": 0.5690419987541765, "mean_env_wait_ms": 0.20345104535277067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16091012954711914, "StateBufferConnector_ms": 0.006386756896972656, "ViewRequirementAgentConnector_ms": 0.3305835723876953}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2498560, "num_agent_steps_trained": 2498560, "num_env_steps_sampled": 499712, "num_env_steps_trained": 499712, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.36994658166, "num_env_steps_trained_throughput_per_sec": 71.36994658166, "timesteps_total": 499712, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2498560, "timers": {"training_iteration_time_ms": 112959.901, "sample_time_ms": 14555.264, "load_time_ms": 1.983, "load_throughput": 4130570.587, "learn_time_ms": 98393.282, "learn_throughput": 83.258, "synch_weights_time_ms": 3.072}, "counters": {"num_env_steps_sampled": 499712, "num_env_steps_trained": 499712, "num_agent_steps_sampled": 2498560, "num_agent_steps_trained": 2498560}, "done": false, "episodes_total": 3904, "training_iteration": 61, "trial_id": "9fade_00019", "date": "2023-11-09_21-41-35", "timestamp": 1699562495, "time_this_iter_s": 114.80116653442383, "time_total_s": 6264.708119630814, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6264.708119630814, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 38.27439024390244, "ram_util_percent": 18.80060975609757}, "checkpoint_dir_name": "checkpoint_000002"}
{"custom_metrics": {"episode_optimality_mean": 0.5493780823984694, "episode_optimality_min": -0.8055555555555556, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5493780823984694, "episode_optimality_capped_min": -0.8055555555555556, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.42, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 115.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5493780823984694, "curr_learning_score_min": -0.8055555555555556, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9657996872719378, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2644057785282833, "policy_loss": -0.07448912299130825, "vf_loss": 0.3265664084205734, "vf_explained_var": 0.35643629691873985, "kl": 0.01826443386291487, "entropy": 3.5615862475583953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 590400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 507904, "num_env_steps_trained": 507904, "num_agent_steps_sampled": 2539520, "num_agent_steps_trained": 2539520}, "sampler_results": {"episode_reward_max": 575.0, "episode_reward_min": -290.0, "episode_reward_mean": 197.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5493780823984694, "episode_optimality_min": -0.8055555555555556, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5493780823984694, "episode_optimality_capped_min": -0.8055555555555556, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.42, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 115.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5493780823984694, "curr_learning_score_min": -0.8055555555555556, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [400.0, 205.0, 260.0, 280.0, 150.0, -150.0, -35.0, 385.0, 80.0, 195.0, 265.0, 125.0, 415.0, 15.0, -165.0, 135.0, 390.0, 315.0, 380.0, 145.0, 30.0, 410.0, 150.0, 400.0, 210.0, 245.0, 260.0, 210.0, 235.0, 255.0, -115.0, 335.0, 255.0, 80.0, -15.0, 25.0, 80.0, 120.0, 365.0, 405.0, 125.0, 400.0, 175.0, 180.0, 90.0, 70.0, 55.0, 270.0, 75.0, 445.0, 200.0, 185.0, -140.0, 195.0, 510.0, 230.0, -290.0, 275.0, -35.0, -135.0, 440.0, 80.0, 190.0, 575.0, 225.0, 200.0, 205.0, 210.0, 550.0, 220.0, 5.0, 255.0, 180.0, 5.0, -5.0, 65.0, 375.0, 55.0, 395.0, 280.0, 45.0, 285.0, 215.0, 215.0, 115.0, 365.0, 175.0, 350.0, 300.0, 170.0, 5.0, 490.0, 410.0, 570.0, 160.0, 160.0, 125.0, 320.0, 15.0, 105.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.160058284428543, "mean_inference_ms": 1.5531183584786128, "mean_action_processing_ms": 0.5686863710447783, "mean_env_wait_ms": 0.20323307479199879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1586604118347168, "StateBufferConnector_ms": 0.006136417388916016, "ViewRequirementAgentConnector_ms": 0.3204681873321533}}, "episode_reward_max": 575.0, "episode_reward_min": -290.0, "episode_reward_mean": 197.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [400.0, 205.0, 260.0, 280.0, 150.0, -150.0, -35.0, 385.0, 80.0, 195.0, 265.0, 125.0, 415.0, 15.0, -165.0, 135.0, 390.0, 315.0, 380.0, 145.0, 30.0, 410.0, 150.0, 400.0, 210.0, 245.0, 260.0, 210.0, 235.0, 255.0, -115.0, 335.0, 255.0, 80.0, -15.0, 25.0, 80.0, 120.0, 365.0, 405.0, 125.0, 400.0, 175.0, 180.0, 90.0, 70.0, 55.0, 270.0, 75.0, 445.0, 200.0, 185.0, -140.0, 195.0, 510.0, 230.0, -290.0, 275.0, -35.0, -135.0, 440.0, 80.0, 190.0, 575.0, 225.0, 200.0, 205.0, 210.0, 550.0, 220.0, 5.0, 255.0, 180.0, 5.0, -5.0, 65.0, 375.0, 55.0, 395.0, 280.0, 45.0, 285.0, 215.0, 215.0, 115.0, 365.0, 175.0, 350.0, 300.0, 170.0, 5.0, 490.0, 410.0, 570.0, 160.0, 160.0, 125.0, 320.0, 15.0, 105.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.160058284428543, "mean_inference_ms": 1.5531183584786128, "mean_action_processing_ms": 0.5686863710447783, "mean_env_wait_ms": 0.20323307479199879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1586604118347168, "StateBufferConnector_ms": 0.006136417388916016, "ViewRequirementAgentConnector_ms": 0.3204681873321533}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2539520, "num_agent_steps_trained": 2539520, "num_env_steps_sampled": 507904, "num_env_steps_trained": 507904, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 73.18455608035937, "num_env_steps_trained_throughput_per_sec": 73.18455608035937, "timesteps_total": 507904, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2539520, "timers": {"training_iteration_time_ms": 112911.966, "sample_time_ms": 14455.275, "load_time_ms": 2.019, "load_throughput": 4057501.992, "learn_time_ms": 98445.387, "learn_throughput": 83.214, "synch_weights_time_ms": 3.031}, "counters": {"num_env_steps_sampled": 507904, "num_env_steps_trained": 507904, "num_agent_steps_sampled": 2539520, "num_agent_steps_trained": 2539520}, "done": false, "episodes_total": 3968, "training_iteration": 62, "trial_id": "9fade_00019", "date": "2023-11-09_21-43-27", "timestamp": 1699562607, "time_this_iter_s": 111.95471572875977, "time_total_s": 6376.662835359573, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6376.662835359573, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 36.556603773584904, "ram_util_percent": 18.878616352201263}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5851917393699698, "episode_optimality_min": -0.6326530612244898, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5851917393699698, "episode_optimality_capped_min": -0.6326530612244898, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.72, "episode_reward_normalized_min": -34.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5851917393699698, "curr_learning_score_min": -0.6326530612244898, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9727271371024351, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2598559958177066, "policy_loss": -0.07888014662683418, "vf_loss": 0.3259406618120071, "vf_explained_var": 0.3873443568187455, "kl": 0.018956267928301712, "entropy": 3.5260593955218793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 600000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 516096, "num_env_steps_trained": 516096, "num_agent_steps_sampled": 2580480, "num_agent_steps_trained": 2580480}, "sampler_results": {"episode_reward_max": 620.0, "episode_reward_min": -170.0, "episode_reward_mean": 223.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5851917393699698, "episode_optimality_min": -0.6326530612244898, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5851917393699698, "episode_optimality_capped_min": -0.6326530612244898, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.72, "episode_reward_normalized_min": -34.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5851917393699698, "curr_learning_score_min": -0.6326530612244898, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [225.0, 200.0, 205.0, 210.0, 550.0, 220.0, 5.0, 255.0, 180.0, 5.0, -5.0, 65.0, 375.0, 55.0, 395.0, 280.0, 45.0, 285.0, 215.0, 215.0, 115.0, 365.0, 175.0, 350.0, 300.0, 170.0, 5.0, 490.0, 410.0, 570.0, 160.0, 160.0, 125.0, 320.0, 15.0, 105.0, 150.0, 220.0, 195.0, 245.0, 245.0, 5.0, -165.0, -75.0, 65.0, 265.0, 320.0, 505.0, 325.0, 320.0, 430.0, 25.0, 160.0, 85.0, 195.0, 350.0, 275.0, 470.0, -30.0, 220.0, 275.0, 350.0, 70.0, 175.0, 400.0, 185.0, 270.0, 190.0, 335.0, -170.0, 265.0, 405.0, 385.0, 620.0, 305.0, 440.0, 115.0, 425.0, 245.0, 550.0, 445.0, 440.0, 300.0, 405.0, 95.0, -155.0, 180.0, 480.0, 40.0, 205.0, 45.0, 135.0, 270.0, 200.0, -135.0, -90.0, 115.0, 365.0, 305.0, 265.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1592175653049508, "mean_inference_ms": 1.5516574457630141, "mean_action_processing_ms": 0.56827347921678, "mean_env_wait_ms": 0.2029755591848682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15762114524841309, "StateBufferConnector_ms": 0.00614166259765625, "ViewRequirementAgentConnector_ms": 0.3170764446258545}}, "episode_reward_max": 620.0, "episode_reward_min": -170.0, "episode_reward_mean": 223.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [225.0, 200.0, 205.0, 210.0, 550.0, 220.0, 5.0, 255.0, 180.0, 5.0, -5.0, 65.0, 375.0, 55.0, 395.0, 280.0, 45.0, 285.0, 215.0, 215.0, 115.0, 365.0, 175.0, 350.0, 300.0, 170.0, 5.0, 490.0, 410.0, 570.0, 160.0, 160.0, 125.0, 320.0, 15.0, 105.0, 150.0, 220.0, 195.0, 245.0, 245.0, 5.0, -165.0, -75.0, 65.0, 265.0, 320.0, 505.0, 325.0, 320.0, 430.0, 25.0, 160.0, 85.0, 195.0, 350.0, 275.0, 470.0, -30.0, 220.0, 275.0, 350.0, 70.0, 175.0, 400.0, 185.0, 270.0, 190.0, 335.0, -170.0, 265.0, 405.0, 385.0, 620.0, 305.0, 440.0, 115.0, 425.0, 245.0, 550.0, 445.0, 440.0, 300.0, 405.0, 95.0, -155.0, 180.0, 480.0, 40.0, 205.0, 45.0, 135.0, 270.0, 200.0, -135.0, -90.0, 115.0, 365.0, 305.0, 265.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1592175653049508, "mean_inference_ms": 1.5516574457630141, "mean_action_processing_ms": 0.56827347921678, "mean_env_wait_ms": 0.2029755591848682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15762114524841309, "StateBufferConnector_ms": 0.00614166259765625, "ViewRequirementAgentConnector_ms": 0.3170764446258545}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2580480, "num_agent_steps_trained": 2580480, "num_env_steps_sampled": 516096, "num_env_steps_trained": 516096, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.8475899781442, "num_env_steps_trained_throughput_per_sec": 72.8475899781442, "timesteps_total": 516096, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2580480, "timers": {"training_iteration_time_ms": 112922.974, "sample_time_ms": 14443.157, "load_time_ms": 2.109, "load_throughput": 3883772.846, "learn_time_ms": 98468.395, "learn_throughput": 83.194, "synch_weights_time_ms": 3.027}, "counters": {"num_env_steps_sampled": 516096, "num_env_steps_trained": 516096, "num_agent_steps_sampled": 2580480, "num_agent_steps_trained": 2580480}, "done": false, "episodes_total": 4032, "training_iteration": 63, "trial_id": "9fade_00019", "date": "2023-11-09_21-45-19", "timestamp": 1699562719, "time_this_iter_s": 112.47050333023071, "time_total_s": 6489.133338689804, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6489.133338689804, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.64099378881988, "ram_util_percent": 18.73913043478261}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5763631693093871, "episode_optimality_min": -0.86, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5763631693093871, "episode_optimality_capped_min": -0.86, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.71, "episode_reward_normalized_min": -43.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5763631693093871, "curr_learning_score_min": -0.86, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9781362513483812, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.26077893468827823, "policy_loss": -0.07743515423077042, "vf_loss": 0.32545647143379935, "vf_explained_var": 0.3858439713033537, "kl": 0.018900173491150175, "entropy": 3.552343490868807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 609600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 524288, "num_env_steps_trained": 524288, "num_agent_steps_sampled": 2621440, "num_agent_steps_trained": 2621440}, "sampler_results": {"episode_reward_max": 620.0, "episode_reward_min": -215.0, "episode_reward_mean": 223.55, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5763631693093871, "episode_optimality_min": -0.86, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5763631693093871, "episode_optimality_capped_min": -0.86, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.71, "episode_reward_normalized_min": -43.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5763631693093871, "curr_learning_score_min": -0.86, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [400.0, 185.0, 270.0, 190.0, 335.0, -170.0, 265.0, 405.0, 385.0, 620.0, 305.0, 440.0, 115.0, 425.0, 245.0, 550.0, 445.0, 440.0, 300.0, 405.0, 95.0, -155.0, 180.0, 480.0, 40.0, 205.0, 45.0, 135.0, 270.0, 200.0, -135.0, -90.0, 115.0, 365.0, 305.0, 265.0, 135.0, 210.0, 150.0, 0.0, 265.0, 200.0, 310.0, 120.0, 380.0, 45.0, 15.0, 415.0, 495.0, -70.0, 605.0, 430.0, 145.0, 250.0, 540.0, 365.0, -105.0, 200.0, -90.0, 330.0, 345.0, 155.0, 140.0, 355.0, 360.0, 365.0, 305.0, 235.0, 165.0, -30.0, 375.0, 105.0, 260.0, -215.0, 90.0, 150.0, 140.0, 10.0, 300.0, 250.0, 170.0, 385.0, 180.0, 260.0, -70.0, 130.0, 365.0, 390.0, 290.0, 145.0, 370.0, -80.0, 365.0, 110.0, 60.0, 285.0, 100.0, 245.0, 300.0, 280.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1583719268623134, "mean_inference_ms": 1.550132962658717, "mean_action_processing_ms": 0.5678746747379165, "mean_env_wait_ms": 0.20273293170305287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15629243850708008, "StateBufferConnector_ms": 0.006144523620605469, "ViewRequirementAgentConnector_ms": 0.31844162940979004}}, "episode_reward_max": 620.0, "episode_reward_min": -215.0, "episode_reward_mean": 223.55, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [400.0, 185.0, 270.0, 190.0, 335.0, -170.0, 265.0, 405.0, 385.0, 620.0, 305.0, 440.0, 115.0, 425.0, 245.0, 550.0, 445.0, 440.0, 300.0, 405.0, 95.0, -155.0, 180.0, 480.0, 40.0, 205.0, 45.0, 135.0, 270.0, 200.0, -135.0, -90.0, 115.0, 365.0, 305.0, 265.0, 135.0, 210.0, 150.0, 0.0, 265.0, 200.0, 310.0, 120.0, 380.0, 45.0, 15.0, 415.0, 495.0, -70.0, 605.0, 430.0, 145.0, 250.0, 540.0, 365.0, -105.0, 200.0, -90.0, 330.0, 345.0, 155.0, 140.0, 355.0, 360.0, 365.0, 305.0, 235.0, 165.0, -30.0, 375.0, 105.0, 260.0, -215.0, 90.0, 150.0, 140.0, 10.0, 300.0, 250.0, 170.0, 385.0, 180.0, 260.0, -70.0, 130.0, 365.0, 390.0, 290.0, 145.0, 370.0, -80.0, 365.0, 110.0, 60.0, 285.0, 100.0, 245.0, 300.0, 280.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1583719268623134, "mean_inference_ms": 1.550132962658717, "mean_action_processing_ms": 0.5678746747379165, "mean_env_wait_ms": 0.20273293170305287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15629243850708008, "StateBufferConnector_ms": 0.006144523620605469, "ViewRequirementAgentConnector_ms": 0.31844162940979004}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2621440, "num_agent_steps_trained": 2621440, "num_env_steps_sampled": 524288, "num_env_steps_trained": 524288, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 73.26534304922197, "num_env_steps_trained_throughput_per_sec": 73.26534304922197, "timesteps_total": 524288, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2621440, "timers": {"training_iteration_time_ms": 112843.73, "sample_time_ms": 14330.548, "load_time_ms": 2.037, "load_throughput": 4021599.097, "learn_time_ms": 98501.911, "learn_throughput": 83.166, "synch_weights_time_ms": 3.046}, "counters": {"num_env_steps_sampled": 524288, "num_env_steps_trained": 524288, "num_agent_steps_sampled": 2621440, "num_agent_steps_trained": 2621440}, "done": false, "episodes_total": 4096, "training_iteration": 64, "trial_id": "9fade_00019", "date": "2023-11-09_21-47-11", "timestamp": 1699562831, "time_this_iter_s": 111.83226656913757, "time_total_s": 6600.965605258942, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6600.965605258942, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.76666666666667, "ram_util_percent": 18.667924528301885}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.560862238164525, "episode_optimality_min": -0.86, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.560862238164525, "episode_optimality_capped_min": -0.86, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.91, "episode_reward_normalized_min": -43.0, "episode_reward_normalized_max": 104.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.560862238164525, "curr_learning_score_min": -0.86, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9764066255496194, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2771084923653689, "policy_loss": -0.08015281681856626, "vf_loss": 0.34436985876028, "vf_explained_var": 0.36027733754366636, "kl": 0.019098444918940534, "entropy": 3.5358558723082143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 619200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 532480, "num_env_steps_trained": 532480, "num_agent_steps_sampled": 2662400, "num_agent_steps_trained": 2662400}, "sampler_results": {"episode_reward_max": 520.0, "episode_reward_min": -215.0, "episode_reward_mean": 199.55, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.560862238164525, "episode_optimality_min": -0.86, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.560862238164525, "episode_optimality_capped_min": -0.86, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.91, "episode_reward_normalized_min": -43.0, "episode_reward_normalized_max": 104.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.560862238164525, "curr_learning_score_min": -0.86, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [360.0, 365.0, 305.0, 235.0, 165.0, -30.0, 375.0, 105.0, 260.0, -215.0, 90.0, 150.0, 140.0, 10.0, 300.0, 250.0, 170.0, 385.0, 180.0, 260.0, -70.0, 130.0, 365.0, 390.0, 290.0, 145.0, 370.0, -80.0, 365.0, 110.0, 60.0, 285.0, 100.0, 245.0, 300.0, 280.0, 200.0, 50.0, 520.0, 425.0, 180.0, 165.0, -190.0, 65.0, 65.0, 5.0, 345.0, -170.0, 245.0, 180.0, 185.0, 225.0, 255.0, 365.0, -95.0, 245.0, 385.0, 335.0, -75.0, 60.0, 150.0, 185.0, 165.0, 60.0, 330.0, 195.0, 140.0, 135.0, 305.0, 340.0, 455.0, 490.0, 0.0, 50.0, 130.0, 155.0, 105.0, -215.0, 260.0, 265.0, 410.0, 145.0, 350.0, 260.0, 125.0, 285.0, 235.0, 115.0, 405.0, 495.0, 340.0, 485.0, 135.0, -150.0, 345.0, 290.0, 290.0, 125.0, 180.0, 275.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1575793343493281, "mean_inference_ms": 1.5484835680871267, "mean_action_processing_ms": 0.5674841456153047, "mean_env_wait_ms": 0.20247435225889285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15724515914916992, "StateBufferConnector_ms": 0.006104469299316406, "ViewRequirementAgentConnector_ms": 0.3167901039123535}}, "episode_reward_max": 520.0, "episode_reward_min": -215.0, "episode_reward_mean": 199.55, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.0, 365.0, 305.0, 235.0, 165.0, -30.0, 375.0, 105.0, 260.0, -215.0, 90.0, 150.0, 140.0, 10.0, 300.0, 250.0, 170.0, 385.0, 180.0, 260.0, -70.0, 130.0, 365.0, 390.0, 290.0, 145.0, 370.0, -80.0, 365.0, 110.0, 60.0, 285.0, 100.0, 245.0, 300.0, 280.0, 200.0, 50.0, 520.0, 425.0, 180.0, 165.0, -190.0, 65.0, 65.0, 5.0, 345.0, -170.0, 245.0, 180.0, 185.0, 225.0, 255.0, 365.0, -95.0, 245.0, 385.0, 335.0, -75.0, 60.0, 150.0, 185.0, 165.0, 60.0, 330.0, 195.0, 140.0, 135.0, 305.0, 340.0, 455.0, 490.0, 0.0, 50.0, 130.0, 155.0, 105.0, -215.0, 260.0, 265.0, 410.0, 145.0, 350.0, 260.0, 125.0, 285.0, 235.0, 115.0, 405.0, 495.0, 340.0, 485.0, 135.0, -150.0, 345.0, 290.0, 290.0, 125.0, 180.0, 275.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1575793343493281, "mean_inference_ms": 1.5484835680871267, "mean_action_processing_ms": 0.5674841456153047, "mean_env_wait_ms": 0.20247435225889285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15724515914916992, "StateBufferConnector_ms": 0.006104469299316406, "ViewRequirementAgentConnector_ms": 0.3167901039123535}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2662400, "num_agent_steps_trained": 2662400, "num_env_steps_sampled": 532480, "num_env_steps_trained": 532480, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.84727620186662, "num_env_steps_trained_throughput_per_sec": 71.84727620186662, "timesteps_total": 532480, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2662400, "timers": {"training_iteration_time_ms": 113101.538, "sample_time_ms": 14282.814, "load_time_ms": 2.112, "load_throughput": 3878074.308, "learn_time_ms": 98807.433, "learn_throughput": 82.909, "synch_weights_time_ms": 3.042}, "counters": {"num_env_steps_sampled": 532480, "num_env_steps_trained": 532480, "num_agent_steps_sampled": 2662400, "num_agent_steps_trained": 2662400}, "done": false, "episodes_total": 4160, "training_iteration": 65, "trial_id": "9fade_00019", "date": "2023-11-09_21-49-05", "timestamp": 1699562945, "time_this_iter_s": 114.03661036491394, "time_total_s": 6715.002215623856, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6715.002215623856, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 38.964814814814815, "ram_util_percent": 18.492592592592594}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5702651726797833, "episode_optimality_min": -0.8113207547169812, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5702651726797833, "episode_optimality_capped_min": -0.8113207547169812, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.96, "episode_reward_normalized_min": -43.0, "episode_reward_normalized_max": 99.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5702651726797833, "curr_learning_score_min": -0.8113207547169812, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9785432297798494, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.27120000127669, "policy_loss": -0.07988442042433841, "vf_loss": 0.33806766841594554, "vf_explained_var": 0.3649548794515431, "kl": 0.01928407797414233, "entropy": 3.533497814213236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 628800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 540672, "num_env_steps_trained": 540672, "num_agent_steps_sampled": 2703360, "num_agent_steps_trained": 2703360}, "sampler_results": {"episode_reward_max": 495.0, "episode_reward_min": -215.0, "episode_reward_mean": 199.8, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5702651726797833, "episode_optimality_min": -0.8113207547169812, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5702651726797833, "episode_optimality_capped_min": -0.8113207547169812, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.96, "episode_reward_normalized_min": -43.0, "episode_reward_normalized_max": 99.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5702651726797833, "curr_learning_score_min": -0.8113207547169812, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [330.0, 195.0, 140.0, 135.0, 305.0, 340.0, 455.0, 490.0, 0.0, 50.0, 130.0, 155.0, 105.0, -215.0, 260.0, 265.0, 410.0, 145.0, 350.0, 260.0, 125.0, 285.0, 235.0, 115.0, 405.0, 495.0, 340.0, 485.0, 135.0, -150.0, 345.0, 290.0, 290.0, 125.0, 180.0, 275.0, 20.0, 90.0, 495.0, 40.0, 345.0, 310.0, 410.0, 190.0, 200.0, 230.0, 120.0, -160.0, 365.0, 290.0, 420.0, 240.0, 180.0, 260.0, 210.0, 240.0, 60.0, -90.0, 460.0, 100.0, 255.0, 255.0, 225.0, 170.0, 110.0, 200.0, 425.0, 235.0, -165.0, 75.0, 10.0, 185.0, -105.0, 245.0, 105.0, 30.0, 60.0, 125.0, 295.0, 255.0, 190.0, 415.0, 370.0, 60.0, 250.0, 120.0, -185.0, 235.0, 150.0, 280.0, 15.0, 165.0, 10.0, 380.0, 180.0, 155.0, 340.0, 165.0, 220.0, 170.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1567739208655345, "mean_inference_ms": 1.5467707360776222, "mean_action_processing_ms": 0.5670896846153244, "mean_env_wait_ms": 0.20221214624674477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15872716903686523, "StateBufferConnector_ms": 0.00603795051574707, "ViewRequirementAgentConnector_ms": 0.3150815963745117}}, "episode_reward_max": 495.0, "episode_reward_min": -215.0, "episode_reward_mean": 199.8, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [330.0, 195.0, 140.0, 135.0, 305.0, 340.0, 455.0, 490.0, 0.0, 50.0, 130.0, 155.0, 105.0, -215.0, 260.0, 265.0, 410.0, 145.0, 350.0, 260.0, 125.0, 285.0, 235.0, 115.0, 405.0, 495.0, 340.0, 485.0, 135.0, -150.0, 345.0, 290.0, 290.0, 125.0, 180.0, 275.0, 20.0, 90.0, 495.0, 40.0, 345.0, 310.0, 410.0, 190.0, 200.0, 230.0, 120.0, -160.0, 365.0, 290.0, 420.0, 240.0, 180.0, 260.0, 210.0, 240.0, 60.0, -90.0, 460.0, 100.0, 255.0, 255.0, 225.0, 170.0, 110.0, 200.0, 425.0, 235.0, -165.0, 75.0, 10.0, 185.0, -105.0, 245.0, 105.0, 30.0, 60.0, 125.0, 295.0, 255.0, 190.0, 415.0, 370.0, 60.0, 250.0, 120.0, -185.0, 235.0, 150.0, 280.0, 15.0, 165.0, 10.0, 380.0, 180.0, 155.0, 340.0, 165.0, 220.0, 170.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1567739208655345, "mean_inference_ms": 1.5467707360776222, "mean_action_processing_ms": 0.5670896846153244, "mean_env_wait_ms": 0.20221214624674477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15872716903686523, "StateBufferConnector_ms": 0.00603795051574707, "ViewRequirementAgentConnector_ms": 0.3150815963745117}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2703360, "num_agent_steps_trained": 2703360, "num_env_steps_sampled": 540672, "num_env_steps_trained": 540672, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 72.08973635900793, "num_env_steps_trained_throughput_per_sec": 72.08973635900793, "timesteps_total": 540672, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2703360, "timers": {"training_iteration_time_ms": 113116.246, "sample_time_ms": 14109.257, "load_time_ms": 2.105, "load_throughput": 3892308.03, "learn_time_ms": 98995.771, "learn_throughput": 82.751, "synch_weights_time_ms": 2.921}, "counters": {"num_env_steps_sampled": 540672, "num_env_steps_trained": 540672, "num_agent_steps_sampled": 2703360, "num_agent_steps_trained": 2703360}, "done": false, "episodes_total": 4224, "training_iteration": 66, "trial_id": "9fade_00019", "date": "2023-11-09_21-50-59", "timestamp": 1699563059, "time_this_iter_s": 113.64871501922607, "time_total_s": 6828.650930643082, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6828.650930643082, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 37.08888888888889, "ram_util_percent": 18.453703703703702}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4856590306103415, "episode_optimality_min": -0.7777777777777778, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4856590306103415, "episode_optimality_capped_min": -0.7777777777777778, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 35.13, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4856590306103415, "curr_learning_score_min": -0.7777777777777778, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9695104885473848, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.29283937427445683, "policy_loss": -0.07962796466303795, "vf_loss": 0.3593397992457661, "vf_explained_var": 0.334765313770622, "kl": 0.0194482063672649, "entropy": 3.4879645290474097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 638400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 548864, "num_env_steps_trained": 548864, "num_agent_steps_sampled": 2744320, "num_agent_steps_trained": 2744320}, "sampler_results": {"episode_reward_max": 605.0, "episode_reward_min": -185.0, "episode_reward_mean": 175.65, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4856590306103415, "episode_optimality_min": -0.7777777777777778, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4856590306103415, "episode_optimality_capped_min": -0.7777777777777778, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 35.13, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4856590306103415, "curr_learning_score_min": -0.7777777777777778, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [110.0, 200.0, 425.0, 235.0, -165.0, 75.0, 10.0, 185.0, -105.0, 245.0, 105.0, 30.0, 60.0, 125.0, 295.0, 255.0, 190.0, 415.0, 370.0, 60.0, 250.0, 120.0, -185.0, 235.0, 150.0, 280.0, 15.0, 165.0, 10.0, 380.0, 180.0, 155.0, 340.0, 165.0, 220.0, 170.0, 215.0, 20.0, 95.0, -70.0, 195.0, 310.0, 90.0, 195.0, 605.0, 405.0, 505.0, 165.0, 405.0, 105.0, 445.0, 280.0, 280.0, -100.0, 10.0, 175.0, 320.0, 145.0, 190.0, 285.0, 365.0, 200.0, 460.0, 75.0, 230.0, 195.0, 265.0, 50.0, -5.0, -175.0, 25.0, 25.0, 25.0, -60.0, 265.0, 510.0, -120.0, 345.0, 380.0, 235.0, 370.0, 430.0, 365.0, -20.0, -80.0, 20.0, 135.0, 25.0, 35.0, 285.0, 475.0, 250.0, 185.0, -115.0, 425.0, 25.0, 90.0, -5.0, 410.0, -70.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1562146788998526, "mean_inference_ms": 1.545667544948487, "mean_action_processing_ms": 0.5668278144696817, "mean_env_wait_ms": 0.20201832861759272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15935659408569336, "StateBufferConnector_ms": 0.006181955337524414, "ViewRequirementAgentConnector_ms": 0.32056307792663574}}, "episode_reward_max": 605.0, "episode_reward_min": -185.0, "episode_reward_mean": 175.65, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [110.0, 200.0, 425.0, 235.0, -165.0, 75.0, 10.0, 185.0, -105.0, 245.0, 105.0, 30.0, 60.0, 125.0, 295.0, 255.0, 190.0, 415.0, 370.0, 60.0, 250.0, 120.0, -185.0, 235.0, 150.0, 280.0, 15.0, 165.0, 10.0, 380.0, 180.0, 155.0, 340.0, 165.0, 220.0, 170.0, 215.0, 20.0, 95.0, -70.0, 195.0, 310.0, 90.0, 195.0, 605.0, 405.0, 505.0, 165.0, 405.0, 105.0, 445.0, 280.0, 280.0, -100.0, 10.0, 175.0, 320.0, 145.0, 190.0, 285.0, 365.0, 200.0, 460.0, 75.0, 230.0, 195.0, 265.0, 50.0, -5.0, -175.0, 25.0, 25.0, 25.0, -60.0, 265.0, 510.0, -120.0, 345.0, 380.0, 235.0, 370.0, 430.0, 365.0, -20.0, -80.0, 20.0, 135.0, 25.0, 35.0, 285.0, 475.0, 250.0, 185.0, -115.0, 425.0, 25.0, 90.0, -5.0, 410.0, -70.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1562146788998526, "mean_inference_ms": 1.545667544948487, "mean_action_processing_ms": 0.5668278144696817, "mean_env_wait_ms": 0.20201832861759272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15935659408569336, "StateBufferConnector_ms": 0.006181955337524414, "ViewRequirementAgentConnector_ms": 0.32056307792663574}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2744320, "num_agent_steps_trained": 2744320, "num_env_steps_sampled": 548864, "num_env_steps_trained": 548864, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.71604594335201, "num_env_steps_trained_throughput_per_sec": 71.71604594335201, "timesteps_total": 548864, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2744320, "timers": {"training_iteration_time_ms": 113293.743, "sample_time_ms": 14097.406, "load_time_ms": 2.055, "load_throughput": 3986464.755, "learn_time_ms": 99185.055, "learn_throughput": 82.593, "synch_weights_time_ms": 3.089}, "counters": {"num_env_steps_sampled": 548864, "num_env_steps_trained": 548864, "num_agent_steps_sampled": 2744320, "num_agent_steps_trained": 2744320}, "done": false, "episodes_total": 4288, "training_iteration": 67, "trial_id": "9fade_00019", "date": "2023-11-09_21-52-54", "timestamp": 1699563174, "time_this_iter_s": 114.24510884284973, "time_total_s": 6942.896039485931, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 6942.896039485931, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 37.94512195121951, "ram_util_percent": 18.567073170731707}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4439512017308975, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4439512017308975, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 31.0, "episode_reward_normalized_min": -54.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4439512017308975, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9733059898531065, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.28132533387271297, "policy_loss": -0.07883665651375243, "vf_loss": 0.34720319119723475, "vf_explained_var": 0.335176932203273, "kl": 0.019198220886309323, "entropy": 3.523928834249576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 648000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 557056, "num_env_steps_trained": 557056, "num_agent_steps_sampled": 2785280, "num_agent_steps_trained": 2785280}, "sampler_results": {"episode_reward_max": 615.0, "episode_reward_min": -270.0, "episode_reward_mean": 155.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4439512017308975, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4439512017308975, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 31.0, "episode_reward_normalized_min": -54.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4439512017308975, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [230.0, 195.0, 265.0, 50.0, -5.0, -175.0, 25.0, 25.0, 25.0, -60.0, 265.0, 510.0, -120.0, 345.0, 380.0, 235.0, 370.0, 430.0, 365.0, -20.0, -80.0, 20.0, 135.0, 25.0, 35.0, 285.0, 475.0, 250.0, 185.0, -115.0, 425.0, 25.0, 90.0, -5.0, 410.0, -70.0, 205.0, -55.0, 240.0, 290.0, 40.0, -30.0, 350.0, -70.0, 285.0, -20.0, 90.0, 290.0, 285.0, 55.0, 330.0, 440.0, 160.0, 260.0, 35.0, 445.0, 50.0, -120.0, 200.0, 85.0, 615.0, 290.0, 65.0, 5.0, 250.0, 110.0, 425.0, 110.0, -50.0, 300.0, 555.0, -260.0, 100.0, 230.0, 170.0, 325.0, 445.0, 50.0, 20.0, -25.0, 290.0, -270.0, -5.0, 80.0, 170.0, 145.0, 135.0, 320.0, 85.0, 65.0, 70.0, 60.0, 235.0, 240.0, 220.0, 270.0, -5.0, 0.0, 370.0, 30.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1557265171459665, "mean_inference_ms": 1.54479390205654, "mean_action_processing_ms": 0.566775136070867, "mean_env_wait_ms": 0.20183402484930252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15980243682861328, "StateBufferConnector_ms": 0.0061833858489990234, "ViewRequirementAgentConnector_ms": 0.323012113571167}}, "episode_reward_max": 615.0, "episode_reward_min": -270.0, "episode_reward_mean": 155.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.0, 195.0, 265.0, 50.0, -5.0, -175.0, 25.0, 25.0, 25.0, -60.0, 265.0, 510.0, -120.0, 345.0, 380.0, 235.0, 370.0, 430.0, 365.0, -20.0, -80.0, 20.0, 135.0, 25.0, 35.0, 285.0, 475.0, 250.0, 185.0, -115.0, 425.0, 25.0, 90.0, -5.0, 410.0, -70.0, 205.0, -55.0, 240.0, 290.0, 40.0, -30.0, 350.0, -70.0, 285.0, -20.0, 90.0, 290.0, 285.0, 55.0, 330.0, 440.0, 160.0, 260.0, 35.0, 445.0, 50.0, -120.0, 200.0, 85.0, 615.0, 290.0, 65.0, 5.0, 250.0, 110.0, 425.0, 110.0, -50.0, 300.0, 555.0, -260.0, 100.0, 230.0, 170.0, 325.0, 445.0, 50.0, 20.0, -25.0, 290.0, -270.0, -5.0, 80.0, 170.0, 145.0, 135.0, 320.0, 85.0, 65.0, 70.0, 60.0, 235.0, 240.0, 220.0, 270.0, -5.0, 0.0, 370.0, 30.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1557265171459665, "mean_inference_ms": 1.54479390205654, "mean_action_processing_ms": 0.566775136070867, "mean_env_wait_ms": 0.20183402484930252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15980243682861328, "StateBufferConnector_ms": 0.0061833858489990234, "ViewRequirementAgentConnector_ms": 0.323012113571167}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2785280, "num_agent_steps_trained": 2785280, "num_env_steps_sampled": 557056, "num_env_steps_trained": 557056, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.58972491705443, "num_env_steps_trained_throughput_per_sec": 69.58972491705443, "timesteps_total": 557056, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2785280, "timers": {"training_iteration_time_ms": 113897.116, "sample_time_ms": 14095.281, "load_time_ms": 1.983, "load_throughput": 4130769.22, "learn_time_ms": 99790.749, "learn_throughput": 82.092, "synch_weights_time_ms": 3.054}, "counters": {"num_env_steps_sampled": 557056, "num_env_steps_trained": 557056, "num_agent_steps_sampled": 2785280, "num_agent_steps_trained": 2785280}, "done": false, "episodes_total": 4352, "training_iteration": 68, "trial_id": "9fade_00019", "date": "2023-11-09_21-54-52", "timestamp": 1699563292, "time_this_iter_s": 117.73511099815369, "time_total_s": 7060.631150484085, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7060.631150484085, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 38.76130952380952, "ram_util_percent": 18.674404761904764}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4939044772766431, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4939044772766431, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.3, "episode_reward_normalized_min": -54.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4939044772766431, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9777889730532964, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.301532957249486, "policy_loss": -0.08001962484197672, "vf_loss": 0.36807812957770997, "vf_explained_var": 0.34226212423294783, "kl": 0.01996215078669877, "entropy": 3.4931706717362005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 657600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 565248, "num_env_steps_trained": 565248, "num_agent_steps_sampled": 2826240, "num_agent_steps_trained": 2826240}, "sampler_results": {"episode_reward_max": 555.0, "episode_reward_min": -270.0, "episode_reward_mean": 166.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4939044772766431, "episode_optimality_min": -0.8666666666666667, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4939044772766431, "episode_optimality_capped_min": -0.8666666666666667, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.3, "episode_reward_normalized_min": -54.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4939044772766431, "curr_learning_score_min": -0.8666666666666667, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [250.0, 110.0, 425.0, 110.0, -50.0, 300.0, 555.0, -260.0, 100.0, 230.0, 170.0, 325.0, 445.0, 50.0, 20.0, -25.0, 290.0, -270.0, -5.0, 80.0, 170.0, 145.0, 135.0, 320.0, 85.0, 65.0, 70.0, 60.0, 235.0, 240.0, 220.0, 270.0, -5.0, 0.0, 370.0, 30.0, 155.0, 375.0, 120.0, -15.0, 100.0, 5.0, -195.0, 220.0, -85.0, 305.0, 235.0, 215.0, 0.0, 175.0, 145.0, -40.0, 130.0, -130.0, 110.0, 530.0, 20.0, 225.0, 225.0, 385.0, 445.0, 280.0, 195.0, 460.0, 285.0, 285.0, 60.0, 340.0, 500.0, 185.0, 20.0, -195.0, 345.0, 130.0, 65.0, 270.0, 395.0, 425.0, 25.0, 310.0, 65.0, 135.0, 280.0, -40.0, 245.0, -30.0, 380.0, 325.0, 215.0, 175.0, 195.0, 185.0, 195.0, 160.0, -145.0, -30.0, 345.0, 485.0, 190.0, 25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1552898285036277, "mean_inference_ms": 1.5441203631434082, "mean_action_processing_ms": 0.5665968635521489, "mean_env_wait_ms": 0.2016804217651621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15920090675354004, "StateBufferConnector_ms": 0.006296873092651367, "ViewRequirementAgentConnector_ms": 0.3254234790802002}}, "episode_reward_max": 555.0, "episode_reward_min": -270.0, "episode_reward_mean": 166.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [250.0, 110.0, 425.0, 110.0, -50.0, 300.0, 555.0, -260.0, 100.0, 230.0, 170.0, 325.0, 445.0, 50.0, 20.0, -25.0, 290.0, -270.0, -5.0, 80.0, 170.0, 145.0, 135.0, 320.0, 85.0, 65.0, 70.0, 60.0, 235.0, 240.0, 220.0, 270.0, -5.0, 0.0, 370.0, 30.0, 155.0, 375.0, 120.0, -15.0, 100.0, 5.0, -195.0, 220.0, -85.0, 305.0, 235.0, 215.0, 0.0, 175.0, 145.0, -40.0, 130.0, -130.0, 110.0, 530.0, 20.0, 225.0, 225.0, 385.0, 445.0, 280.0, 195.0, 460.0, 285.0, 285.0, 60.0, 340.0, 500.0, 185.0, 20.0, -195.0, 345.0, 130.0, 65.0, 270.0, 395.0, 425.0, 25.0, 310.0, 65.0, 135.0, 280.0, -40.0, 245.0, -30.0, 380.0, 325.0, 215.0, 175.0, 195.0, 185.0, 195.0, 160.0, -145.0, -30.0, 345.0, 485.0, 190.0, 25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1552898285036277, "mean_inference_ms": 1.5441203631434082, "mean_action_processing_ms": 0.5665968635521489, "mean_env_wait_ms": 0.2016804217651621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15920090675354004, "StateBufferConnector_ms": 0.006296873092651367, "ViewRequirementAgentConnector_ms": 0.3254234790802002}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2826240, "num_agent_steps_trained": 2826240, "num_env_steps_sampled": 565248, "num_env_steps_trained": 565248, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.25849471704453, "num_env_steps_trained_throughput_per_sec": 71.25849471704453, "timesteps_total": 565248, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2826240, "timers": {"training_iteration_time_ms": 114046.168, "sample_time_ms": 14009.948, "load_time_ms": 1.93, "load_throughput": 4245454.681, "learn_time_ms": 100025.235, "learn_throughput": 81.899, "synch_weights_time_ms": 3.074}, "counters": {"num_env_steps_sampled": 565248, "num_env_steps_trained": 565248, "num_agent_steps_sampled": 2826240, "num_agent_steps_trained": 2826240}, "done": false, "episodes_total": 4416, "training_iteration": 69, "trial_id": "9fade_00019", "date": "2023-11-09_21-56-47", "timestamp": 1699563407, "time_this_iter_s": 114.97386598587036, "time_total_s": 7175.605016469955, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7175.605016469955, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 36.552439024390246, "ram_util_percent": 18.820121951219512}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5732434571526516, "episode_optimality_min": -0.7222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5732434571526516, "episode_optimality_capped_min": -0.7222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.22, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5732434571526516, "curr_learning_score_min": -0.7222222222222222, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9789787372946739, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.27476015558170425, "policy_loss": -0.08052778870278417, "vf_loss": 0.3418039416751223, "vf_explained_var": 0.3594501078811785, "kl": 0.019976301456635686, "entropy": 3.4388984184960525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 667200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 573440, "num_env_steps_trained": 573440, "num_agent_steps_sampled": 2867200, "num_agent_steps_trained": 2867200}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": -195.0, "episode_reward_mean": 201.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5732434571526516, "episode_optimality_min": -0.7222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5732434571526516, "episode_optimality_capped_min": -0.7222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.22, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5732434571526516, "curr_learning_score_min": -0.7222222222222222, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [285.0, 285.0, 60.0, 340.0, 500.0, 185.0, 20.0, -195.0, 345.0, 130.0, 65.0, 270.0, 395.0, 425.0, 25.0, 310.0, 65.0, 135.0, 280.0, -40.0, 245.0, -30.0, 380.0, 325.0, 215.0, 175.0, 195.0, 185.0, 195.0, 160.0, -145.0, -30.0, 345.0, 485.0, 190.0, 25.0, 475.0, 220.0, 60.0, 295.0, 400.0, 190.0, 90.0, 465.0, 195.0, -50.0, 285.0, -35.0, 470.0, 450.0, 225.0, 425.0, 130.0, 25.0, 265.0, 95.0, 335.0, 275.0, 160.0, 230.0, 15.0, 90.0, 180.0, 75.0, 310.0, 230.0, 305.0, 195.0, 130.0, 275.0, 335.0, 500.0, 265.0, 455.0, 5.0, 50.0, 145.0, 110.0, 130.0, 150.0, 60.0, 340.0, -145.0, 325.0, 95.0, 85.0, 285.0, 175.0, -15.0, 310.0, 280.0, 425.0, 70.0, 375.0, 215.0, 420.0, 280.0, 45.0, -100.0, 160.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1545369318163847, "mean_inference_ms": 1.5423906142966701, "mean_action_processing_ms": 0.5662637439918602, "mean_env_wait_ms": 0.20139513216996566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1567096710205078, "StateBufferConnector_ms": 0.006055116653442383, "ViewRequirementAgentConnector_ms": 0.3156697750091553}}, "episode_reward_max": 500.0, "episode_reward_min": -195.0, "episode_reward_mean": 201.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.0, 285.0, 60.0, 340.0, 500.0, 185.0, 20.0, -195.0, 345.0, 130.0, 65.0, 270.0, 395.0, 425.0, 25.0, 310.0, 65.0, 135.0, 280.0, -40.0, 245.0, -30.0, 380.0, 325.0, 215.0, 175.0, 195.0, 185.0, 195.0, 160.0, -145.0, -30.0, 345.0, 485.0, 190.0, 25.0, 475.0, 220.0, 60.0, 295.0, 400.0, 190.0, 90.0, 465.0, 195.0, -50.0, 285.0, -35.0, 470.0, 450.0, 225.0, 425.0, 130.0, 25.0, 265.0, 95.0, 335.0, 275.0, 160.0, 230.0, 15.0, 90.0, 180.0, 75.0, 310.0, 230.0, 305.0, 195.0, 130.0, 275.0, 335.0, 500.0, 265.0, 455.0, 5.0, 50.0, 145.0, 110.0, 130.0, 150.0, 60.0, 340.0, -145.0, 325.0, 95.0, 85.0, 285.0, 175.0, -15.0, 310.0, 280.0, 425.0, 70.0, 375.0, 215.0, 420.0, 280.0, 45.0, -100.0, 160.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1545369318163847, "mean_inference_ms": 1.5423906142966701, "mean_action_processing_ms": 0.5662637439918602, "mean_env_wait_ms": 0.20139513216996566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1567096710205078, "StateBufferConnector_ms": 0.006055116653442383, "ViewRequirementAgentConnector_ms": 0.3156697750091553}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2867200, "num_agent_steps_trained": 2867200, "num_env_steps_sampled": 573440, "num_env_steps_trained": 573440, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.2769012176878, "num_env_steps_trained_throughput_per_sec": 71.2769012176878, "timesteps_total": 573440, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2867200, "timers": {"training_iteration_time_ms": 114048.123, "sample_time_ms": 13878.853, "load_time_ms": 1.873, "load_throughput": 4372803.193, "learn_time_ms": 100158.707, "learn_throughput": 81.79, "synch_weights_time_ms": 2.842}, "counters": {"num_env_steps_sampled": 573440, "num_env_steps_trained": 573440, "num_agent_steps_sampled": 2867200, "num_agent_steps_trained": 2867200}, "done": false, "episodes_total": 4480, "training_iteration": 70, "trial_id": "9fade_00019", "date": "2023-11-09_21-58-42", "timestamp": 1699563522, "time_this_iter_s": 114.94418239593506, "time_total_s": 7290.5491988658905, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7290.5491988658905, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 38.38536585365854, "ram_util_percent": 18.571341463414633}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5569855779520936, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5569855779520936, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.32, "episode_reward_normalized_min": -56.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5569855779520936, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9760901938658207, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2693087493155569, "policy_loss": -0.07748616932723962, "vf_loss": 0.33368728883740306, "vf_explained_var": 0.341212884200116, "kl": 0.019418710222487715, "entropy": 3.4489566925664743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 676800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 581632, "num_env_steps_trained": 581632, "num_agent_steps_sampled": 2908160, "num_agent_steps_trained": 2908160}, "sampler_results": {"episode_reward_max": 615.0, "episode_reward_min": -280.0, "episode_reward_mean": 191.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5569855779520936, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5569855779520936, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.32, "episode_reward_normalized_min": -56.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5569855779520936, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [310.0, 230.0, 305.0, 195.0, 130.0, 275.0, 335.0, 500.0, 265.0, 455.0, 5.0, 50.0, 145.0, 110.0, 130.0, 150.0, 60.0, 340.0, -145.0, 325.0, 95.0, 85.0, 285.0, 175.0, -15.0, 310.0, 280.0, 425.0, 70.0, 375.0, 215.0, 420.0, 280.0, 45.0, -100.0, 160.0, 265.0, 150.0, 215.0, 555.0, 235.0, 55.0, 55.0, -140.0, 100.0, 55.0, 475.0, 480.0, 585.0, 310.0, -125.0, 520.0, 330.0, 120.0, 160.0, 120.0, 35.0, 200.0, 160.0, 220.0, 290.0, 55.0, 415.0, -85.0, 150.0, 185.0, 145.0, 235.0, -10.0, 155.0, -55.0, 75.0, 240.0, 15.0, 55.0, 65.0, 175.0, 110.0, 305.0, 225.0, 260.0, 410.0, 410.0, 160.0, -40.0, 155.0, 110.0, 335.0, 150.0, 295.0, 130.0, 210.0, 225.0, -280.0, 615.0, -35.0, 325.0, 240.0, 245.0, 85.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1539040947149095, "mean_inference_ms": 1.5410236553054921, "mean_action_processing_ms": 0.5659838160854649, "mean_env_wait_ms": 0.20115901881519668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15877032279968262, "StateBufferConnector_ms": 0.0061473846435546875, "ViewRequirementAgentConnector_ms": 0.31763458251953125}}, "episode_reward_max": 615.0, "episode_reward_min": -280.0, "episode_reward_mean": 191.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [310.0, 230.0, 305.0, 195.0, 130.0, 275.0, 335.0, 500.0, 265.0, 455.0, 5.0, 50.0, 145.0, 110.0, 130.0, 150.0, 60.0, 340.0, -145.0, 325.0, 95.0, 85.0, 285.0, 175.0, -15.0, 310.0, 280.0, 425.0, 70.0, 375.0, 215.0, 420.0, 280.0, 45.0, -100.0, 160.0, 265.0, 150.0, 215.0, 555.0, 235.0, 55.0, 55.0, -140.0, 100.0, 55.0, 475.0, 480.0, 585.0, 310.0, -125.0, 520.0, 330.0, 120.0, 160.0, 120.0, 35.0, 200.0, 160.0, 220.0, 290.0, 55.0, 415.0, -85.0, 150.0, 185.0, 145.0, 235.0, -10.0, 155.0, -55.0, 75.0, 240.0, 15.0, 55.0, 65.0, 175.0, 110.0, 305.0, 225.0, 260.0, 410.0, 410.0, 160.0, -40.0, 155.0, 110.0, 335.0, 150.0, 295.0, 130.0, 210.0, 225.0, -280.0, 615.0, -35.0, 325.0, 240.0, 245.0, 85.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1539040947149095, "mean_inference_ms": 1.5410236553054921, "mean_action_processing_ms": 0.5659838160854649, "mean_env_wait_ms": 0.20115901881519668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15877032279968262, "StateBufferConnector_ms": 0.0061473846435546875, "ViewRequirementAgentConnector_ms": 0.31763458251953125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2908160, "num_agent_steps_trained": 2908160, "num_env_steps_sampled": 581632, "num_env_steps_trained": 581632, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.35562332873074, "num_env_steps_trained_throughput_per_sec": 71.35562332873074, "timesteps_total": 581632, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2908160, "timers": {"training_iteration_time_ms": 114050.428, "sample_time_ms": 13865.986, "load_time_ms": 1.838, "load_throughput": 4457556.676, "learn_time_ms": 100174.028, "learn_throughput": 81.778, "synch_weights_time_ms": 2.723}, "counters": {"num_env_steps_sampled": 581632, "num_env_steps_trained": 581632, "num_agent_steps_sampled": 2908160, "num_agent_steps_trained": 2908160}, "done": false, "episodes_total": 4544, "training_iteration": 71, "trial_id": "9fade_00019", "date": "2023-11-09_22-00-37", "timestamp": 1699563637, "time_this_iter_s": 114.81790494918823, "time_total_s": 7405.367103815079, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7405.367103815079, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 37.7469512195122, "ram_util_percent": 18.745731707317074}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5355646928451698, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5355646928451698, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.89, "episode_reward_normalized_min": -56.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5355646928451698, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9752470389939845, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2583496130059939, "policy_loss": -0.07635201049187647, "vf_loss": 0.32168219345010585, "vf_explained_var": 0.38610404684518773, "kl": 0.019288044145676697, "entropy": 3.4083689312885204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 686400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 589824, "num_env_steps_trained": 589824, "num_agent_steps_sampled": 2949120, "num_agent_steps_trained": 2949120}, "sampler_results": {"episode_reward_max": 615.0, "episode_reward_min": -280.0, "episode_reward_mean": 189.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5355646928451698, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5355646928451698, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.89, "episode_reward_normalized_min": -56.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5355646928451698, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [150.0, 185.0, 145.0, 235.0, -10.0, 155.0, -55.0, 75.0, 240.0, 15.0, 55.0, 65.0, 175.0, 110.0, 305.0, 225.0, 260.0, 410.0, 410.0, 160.0, -40.0, 155.0, 110.0, 335.0, 150.0, 295.0, 130.0, 210.0, 225.0, -280.0, 615.0, -35.0, 325.0, 240.0, 245.0, 85.0, 335.0, -75.0, 280.0, 260.0, 145.0, 390.0, 490.0, 340.0, 165.0, 260.0, -70.0, -75.0, 375.0, 440.0, 15.0, 40.0, 225.0, 115.0, -50.0, 345.0, 165.0, 250.0, 65.0, 185.0, 15.0, 330.0, 155.0, 265.0, 190.0, 110.0, 215.0, 350.0, 245.0, -10.0, 330.0, 270.0, 110.0, 10.0, 160.0, 140.0, 300.0, 300.0, 475.0, 135.0, 115.0, 125.0, 100.0, 165.0, 355.0, 390.0, -5.0, 470.0, 135.0, 375.0, -205.0, 265.0, 45.0, 445.0, 175.0, 315.0, -45.0, 85.0, 345.0, 510.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.153404734407391, "mean_inference_ms": 1.54020407265845, "mean_action_processing_ms": 0.5657473821160882, "mean_env_wait_ms": 0.2009931741280389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15891695022583008, "StateBufferConnector_ms": 0.006265163421630859, "ViewRequirementAgentConnector_ms": 0.32283496856689453}}, "episode_reward_max": 615.0, "episode_reward_min": -280.0, "episode_reward_mean": 189.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [150.0, 185.0, 145.0, 235.0, -10.0, 155.0, -55.0, 75.0, 240.0, 15.0, 55.0, 65.0, 175.0, 110.0, 305.0, 225.0, 260.0, 410.0, 410.0, 160.0, -40.0, 155.0, 110.0, 335.0, 150.0, 295.0, 130.0, 210.0, 225.0, -280.0, 615.0, -35.0, 325.0, 240.0, 245.0, 85.0, 335.0, -75.0, 280.0, 260.0, 145.0, 390.0, 490.0, 340.0, 165.0, 260.0, -70.0, -75.0, 375.0, 440.0, 15.0, 40.0, 225.0, 115.0, -50.0, 345.0, 165.0, 250.0, 65.0, 185.0, 15.0, 330.0, 155.0, 265.0, 190.0, 110.0, 215.0, 350.0, 245.0, -10.0, 330.0, 270.0, 110.0, 10.0, 160.0, 140.0, 300.0, 300.0, 475.0, 135.0, 115.0, 125.0, 100.0, 165.0, 355.0, 390.0, -5.0, 470.0, 135.0, 375.0, -205.0, 265.0, 45.0, 445.0, 175.0, 315.0, -45.0, 85.0, 345.0, 510.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.153404734407391, "mean_inference_ms": 1.54020407265845, "mean_action_processing_ms": 0.5657473821160882, "mean_env_wait_ms": 0.2009931741280389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15891695022583008, "StateBufferConnector_ms": 0.006265163421630859, "ViewRequirementAgentConnector_ms": 0.32283496856689453}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2949120, "num_agent_steps_trained": 2949120, "num_env_steps_sampled": 589824, "num_env_steps_trained": 589824, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.33654002934367, "num_env_steps_trained_throughput_per_sec": 71.33654002934367, "timesteps_total": 589824, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2949120, "timers": {"training_iteration_time_ms": 114340.406, "sample_time_ms": 13857.097, "load_time_ms": 1.744, "load_throughput": 4697932.452, "learn_time_ms": 100473.04, "learn_throughput": 81.534, "synch_weights_time_ms": 2.731}, "counters": {"num_env_steps_sampled": 589824, "num_env_steps_trained": 589824, "num_agent_steps_sampled": 2949120, "num_agent_steps_trained": 2949120}, "done": false, "episodes_total": 4608, "training_iteration": 72, "trial_id": "9fade_00019", "date": "2023-11-09_22-02-32", "timestamp": 1699563752, "time_this_iter_s": 114.85070514678955, "time_total_s": 7520.217808961868, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7520.217808961868, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 36.993292682926835, "ram_util_percent": 18.843902439024394}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5063286383871497, "episode_optimality_min": -0.8431372549019608, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5063286383871497, "episode_optimality_capped_min": -0.8431372549019608, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.88, "episode_reward_normalized_min": -52.0, "episode_reward_normalized_max": 102.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5063286383871497, "curr_learning_score_min": -0.8431372549019608, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.987721296272551, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.2933400724005332, "policy_loss": -0.07816310744397924, "vf_loss": 0.3582169004655346, "vf_explained_var": 0.3490995631180704, "kl": 0.019683376803068312, "entropy": 3.4295603188375634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 696000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 598016, "num_env_steps_trained": 598016, "num_agent_steps_sampled": 2990080, "num_agent_steps_trained": 2990080}, "sampler_results": {"episode_reward_max": 510.0, "episode_reward_min": -260.0, "episode_reward_mean": 169.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5063286383871497, "episode_optimality_min": -0.8431372549019608, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5063286383871497, "episode_optimality_capped_min": -0.8431372549019608, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 33.88, "episode_reward_normalized_min": -52.0, "episode_reward_normalized_max": 102.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5063286383871497, "curr_learning_score_min": -0.8431372549019608, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [190.0, 110.0, 215.0, 350.0, 245.0, -10.0, 330.0, 270.0, 110.0, 10.0, 160.0, 140.0, 300.0, 300.0, 475.0, 135.0, 115.0, 125.0, 100.0, 165.0, 355.0, 390.0, -5.0, 470.0, 135.0, 375.0, -205.0, 265.0, 45.0, 445.0, 175.0, 315.0, -45.0, 85.0, 345.0, 510.0, -10.0, 315.0, 15.0, 45.0, 75.0, 70.0, 285.0, 85.0, 255.0, 235.0, 35.0, -95.0, 190.0, 245.0, 210.0, -10.0, 315.0, 265.0, 15.0, -10.0, 165.0, -5.0, 435.0, 70.0, 250.0, 340.0, 80.0, -40.0, 170.0, -125.0, -260.0, 210.0, 110.0, 185.0, 190.0, 285.0, 305.0, 315.0, 150.0, 40.0, 140.0, 470.0, 175.0, 150.0, 195.0, 195.0, 425.0, 60.0, 375.0, -35.0, 160.0, 85.0, 85.0, -215.0, 80.0, 170.0, 245.0, 445.0, 140.0, 55.0, 130.0, 265.0, 140.0, 115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1526703449855478, "mean_inference_ms": 1.5389761116383502, "mean_action_processing_ms": 0.5654210842567547, "mean_env_wait_ms": 0.20074523498131286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15687799453735352, "StateBufferConnector_ms": 0.006014585494995117, "ViewRequirementAgentConnector_ms": 0.3154487609863281}}, "episode_reward_max": 510.0, "episode_reward_min": -260.0, "episode_reward_mean": 169.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [190.0, 110.0, 215.0, 350.0, 245.0, -10.0, 330.0, 270.0, 110.0, 10.0, 160.0, 140.0, 300.0, 300.0, 475.0, 135.0, 115.0, 125.0, 100.0, 165.0, 355.0, 390.0, -5.0, 470.0, 135.0, 375.0, -205.0, 265.0, 45.0, 445.0, 175.0, 315.0, -45.0, 85.0, 345.0, 510.0, -10.0, 315.0, 15.0, 45.0, 75.0, 70.0, 285.0, 85.0, 255.0, 235.0, 35.0, -95.0, 190.0, 245.0, 210.0, -10.0, 315.0, 265.0, 15.0, -10.0, 165.0, -5.0, 435.0, 70.0, 250.0, 340.0, 80.0, -40.0, 170.0, -125.0, -260.0, 210.0, 110.0, 185.0, 190.0, 285.0, 305.0, 315.0, 150.0, 40.0, 140.0, 470.0, 175.0, 150.0, 195.0, 195.0, 425.0, 60.0, 375.0, -35.0, 160.0, 85.0, 85.0, -215.0, 80.0, 170.0, 245.0, 445.0, 140.0, 55.0, 130.0, 265.0, 140.0, 115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1526703449855478, "mean_inference_ms": 1.5389761116383502, "mean_action_processing_ms": 0.5654210842567547, "mean_env_wait_ms": 0.20074523498131286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15687799453735352, "StateBufferConnector_ms": 0.006014585494995117, "ViewRequirementAgentConnector_ms": 0.3154487609863281}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2990080, "num_agent_steps_trained": 2990080, "num_env_steps_sampled": 598016, "num_env_steps_trained": 598016, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.50975565117743, "num_env_steps_trained_throughput_per_sec": 71.50975565117743, "timesteps_total": 598016, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 2990080, "timers": {"training_iteration_time_ms": 114550.79, "sample_time_ms": 13794.071, "load_time_ms": 1.649, "load_throughput": 4968511.079, "learn_time_ms": 100746.462, "learn_throughput": 81.313, "synch_weights_time_ms": 2.729}, "counters": {"num_env_steps_sampled": 598016, "num_env_steps_trained": 598016, "num_agent_steps_sampled": 2990080, "num_agent_steps_trained": 2990080}, "done": false, "episodes_total": 4672, "training_iteration": 73, "trial_id": "9fade_00019", "date": "2023-11-09_22-04-27", "timestamp": 1699563867, "time_this_iter_s": 114.569650888443, "time_total_s": 7634.787459850311, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7634.787459850311, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 37.461349693251535, "ram_util_percent": 18.72760736196319}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5860097703977337, "episode_optimality_min": -0.8431372549019608, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5860097703977337, "episode_optimality_capped_min": -0.8431372549019608, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.18, "episode_reward_normalized_min": -52.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5860097703977337, "curr_learning_score_min": -0.8431372549019608, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9859202976773183, "cur_kl_coeff": 0.675, "cur_lr": 0.00011210859819985454, "total_loss": 0.26735072463971543, "policy_loss": -0.07979844998466433, "vf_loss": 0.3336161960205209, "vf_explained_var": 0.356649922610571, "kl": 0.020048855291201637, "entropy": 3.334856979052226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 705600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 606208, "num_env_steps_trained": 606208, "num_agent_steps_sampled": 3031040, "num_agent_steps_trained": 3031040}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -260.0, "episode_reward_mean": 200.9, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5860097703977337, "episode_optimality_min": -0.8431372549019608, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5860097703977337, "episode_optimality_capped_min": -0.8431372549019608, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.18, "episode_reward_normalized_min": -52.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5860097703977337, "curr_learning_score_min": -0.8431372549019608, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [170.0, -125.0, -260.0, 210.0, 110.0, 185.0, 190.0, 285.0, 305.0, 315.0, 150.0, 40.0, 140.0, 470.0, 175.0, 150.0, 195.0, 195.0, 425.0, 60.0, 375.0, -35.0, 160.0, 85.0, 85.0, -215.0, 80.0, 170.0, 245.0, 445.0, 140.0, 55.0, 130.0, 265.0, 140.0, 115.0, 165.0, -5.0, 260.0, 295.0, 390.0, 145.0, 240.0, 245.0, 200.0, 105.0, 5.0, 440.0, 200.0, 90.0, 350.0, 155.0, 35.0, 165.0, 230.0, 175.0, 210.0, 270.0, 130.0, 535.0, 385.0, 380.0, 180.0, 350.0, 445.0, 225.0, 85.0, 400.0, 100.0, 185.0, 185.0, 110.0, 265.0, 80.0, 150.0, 430.0, 250.0, 265.0, 45.0, 180.0, 180.0, -130.0, 345.0, 345.0, 300.0, 270.0, 50.0, 175.0, 330.0, 115.0, 555.0, 390.0, 330.0, 90.0, 95.0, 75.0, 585.0, 160.0, 65.0, 415.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1519447178856788, "mean_inference_ms": 1.5375341481854394, "mean_action_processing_ms": 0.5650865324291874, "mean_env_wait_ms": 0.20048007320522945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15604782104492188, "StateBufferConnector_ms": 0.006040811538696289, "ViewRequirementAgentConnector_ms": 0.31415367126464844}}, "episode_reward_max": 585.0, "episode_reward_min": -260.0, "episode_reward_mean": 200.9, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [170.0, -125.0, -260.0, 210.0, 110.0, 185.0, 190.0, 285.0, 305.0, 315.0, 150.0, 40.0, 140.0, 470.0, 175.0, 150.0, 195.0, 195.0, 425.0, 60.0, 375.0, -35.0, 160.0, 85.0, 85.0, -215.0, 80.0, 170.0, 245.0, 445.0, 140.0, 55.0, 130.0, 265.0, 140.0, 115.0, 165.0, -5.0, 260.0, 295.0, 390.0, 145.0, 240.0, 245.0, 200.0, 105.0, 5.0, 440.0, 200.0, 90.0, 350.0, 155.0, 35.0, 165.0, 230.0, 175.0, 210.0, 270.0, 130.0, 535.0, 385.0, 380.0, 180.0, 350.0, 445.0, 225.0, 85.0, 400.0, 100.0, 185.0, 185.0, 110.0, 265.0, 80.0, 150.0, 430.0, 250.0, 265.0, 45.0, 180.0, 180.0, -130.0, 345.0, 345.0, 300.0, 270.0, 50.0, 175.0, 330.0, 115.0, 555.0, 390.0, 330.0, 90.0, 95.0, 75.0, 585.0, 160.0, 65.0, 415.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1519447178856788, "mean_inference_ms": 1.5375341481854394, "mean_action_processing_ms": 0.5650865324291874, "mean_env_wait_ms": 0.20048007320522945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15604782104492188, "StateBufferConnector_ms": 0.006040811538696289, "ViewRequirementAgentConnector_ms": 0.31415367126464844}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3031040, "num_agent_steps_trained": 3031040, "num_env_steps_sampled": 606208, "num_env_steps_trained": 606208, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.11026500013234, "num_env_steps_trained_throughput_per_sec": 71.11026500013234, "timesteps_total": 606208, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3031040, "timers": {"training_iteration_time_ms": 114889.652, "sample_time_ms": 13791.633, "load_time_ms": 1.62, "load_throughput": 5056248.748, "learn_time_ms": 101087.925, "learn_throughput": 81.038, "synch_weights_time_ms": 2.607}, "counters": {"num_env_steps_sampled": 606208, "num_env_steps_trained": 606208, "num_agent_steps_sampled": 3031040, "num_agent_steps_trained": 3031040}, "done": false, "episodes_total": 4736, "training_iteration": 74, "trial_id": "9fade_00019", "date": "2023-11-09_22-06-22", "timestamp": 1699563982, "time_this_iter_s": 115.21904993057251, "time_total_s": 7750.006509780884, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7750.006509780884, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 38.29512195121951, "ram_util_percent": 18.61829268292682}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5540637495791907, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5540637495791907, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.71, "episode_reward_normalized_min": -80.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5540637495791907, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.98587228580378, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.27449708372407866, "policy_loss": -0.07504548448153098, "vf_loss": 0.33393892387738255, "vf_explained_var": 0.3734813244330386, "kl": 0.015411005120115154, "entropy": 3.3906940881162884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 715200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 614400, "num_env_steps_trained": 614400, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -400.0, "episode_reward_mean": 198.55, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5540637495791907, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5540637495791907, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.71, "episode_reward_normalized_min": -80.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5540637495791907, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [445.0, 225.0, 85.0, 400.0, 100.0, 185.0, 185.0, 110.0, 265.0, 80.0, 150.0, 430.0, 250.0, 265.0, 45.0, 180.0, 180.0, -130.0, 345.0, 345.0, 300.0, 270.0, 50.0, 175.0, 330.0, 115.0, 555.0, 390.0, 330.0, 90.0, 95.0, 75.0, 585.0, 160.0, 65.0, 415.0, -140.0, 375.0, -30.0, 395.0, 40.0, 185.0, -50.0, 245.0, 35.0, 265.0, 300.0, 375.0, -205.0, 320.0, 85.0, 225.0, 310.0, 150.0, 465.0, 420.0, 160.0, 440.0, 500.0, -90.0, 195.0, 300.0, 95.0, 155.0, 45.0, 355.0, 100.0, -130.0, 460.0, 250.0, 230.0, 380.0, 145.0, 80.0, -50.0, 35.0, 125.0, 200.0, 0.0, 145.0, 430.0, -400.0, 360.0, 160.0, 405.0, 160.0, 325.0, 365.0, 310.0, 60.0, 10.0, 325.0, 95.0, 180.0, 250.0, 90.0, 150.0, 30.0, 345.0, 175.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1509314821426582, "mean_inference_ms": 1.535504305280334, "mean_action_processing_ms": 0.5646017644437016, "mean_env_wait_ms": 0.20015853470427175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15392160415649414, "StateBufferConnector_ms": 0.0059702396392822266, "ViewRequirementAgentConnector_ms": 0.30812573432922363}}, "episode_reward_max": 585.0, "episode_reward_min": -400.0, "episode_reward_mean": 198.55, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [445.0, 225.0, 85.0, 400.0, 100.0, 185.0, 185.0, 110.0, 265.0, 80.0, 150.0, 430.0, 250.0, 265.0, 45.0, 180.0, 180.0, -130.0, 345.0, 345.0, 300.0, 270.0, 50.0, 175.0, 330.0, 115.0, 555.0, 390.0, 330.0, 90.0, 95.0, 75.0, 585.0, 160.0, 65.0, 415.0, -140.0, 375.0, -30.0, 395.0, 40.0, 185.0, -50.0, 245.0, 35.0, 265.0, 300.0, 375.0, -205.0, 320.0, 85.0, 225.0, 310.0, 150.0, 465.0, 420.0, 160.0, 440.0, 500.0, -90.0, 195.0, 300.0, 95.0, 155.0, 45.0, 355.0, 100.0, -130.0, 460.0, 250.0, 230.0, 380.0, 145.0, 80.0, -50.0, 35.0, 125.0, 200.0, 0.0, 145.0, 430.0, -400.0, 360.0, 160.0, 405.0, 160.0, 325.0, 365.0, 310.0, 60.0, 10.0, 325.0, 95.0, 180.0, 250.0, 90.0, 150.0, 30.0, 345.0, 175.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1509314821426582, "mean_inference_ms": 1.535504305280334, "mean_action_processing_ms": 0.5646017644437016, "mean_env_wait_ms": 0.20015853470427175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15392160415649414, "StateBufferConnector_ms": 0.0059702396392822266, "ViewRequirementAgentConnector_ms": 0.30812573432922363}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 614400, "num_env_steps_trained": 614400, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.90963884850126, "num_env_steps_trained_throughput_per_sec": 71.90963884850126, "timesteps_total": 614400, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 114879.763, "sample_time_ms": 13732.643, "load_time_ms": 1.595, "load_throughput": 5134833.5, "learn_time_ms": 101137.013, "learn_throughput": 80.999, "synch_weights_time_ms": 2.61}, "counters": {"num_env_steps_sampled": 614400, "num_env_steps_trained": 614400, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "episodes_total": 4800, "training_iteration": 75, "trial_id": "9fade_00019", "date": "2023-11-09_22-08-16", "timestamp": 1699564096, "time_this_iter_s": 113.93576192855835, "time_total_s": 7863.942271709442, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7863.942271709442, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 36.93888888888889, "ram_util_percent": 18.883333333333336}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5144309821040242, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5144309821040242, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.85, "episode_reward_normalized_min": -80.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5144309821040242, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9866922702593729, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2830620509300206, "policy_loss": -0.07509944541513201, "vf_loss": 0.34256329623624576, "vf_explained_var": 0.3529880363680422, "kl": 0.015405628694312933, "entropy": 3.425199675410986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 724800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 622592, "num_env_steps_trained": 622592, "num_agent_steps_sampled": 3112960, "num_agent_steps_trained": 3112960}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -400.0, "episode_reward_mean": 174.25, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5144309821040242, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5144309821040242, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.85, "episode_reward_normalized_min": -80.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5144309821040242, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [45.0, 355.0, 100.0, -130.0, 460.0, 250.0, 230.0, 380.0, 145.0, 80.0, -50.0, 35.0, 125.0, 200.0, 0.0, 145.0, 430.0, -400.0, 360.0, 160.0, 405.0, 160.0, 325.0, 365.0, 310.0, 60.0, 10.0, 325.0, 95.0, 180.0, 250.0, 90.0, 150.0, 30.0, 345.0, 175.0, -45.0, 290.0, 240.0, 275.0, -165.0, 160.0, 340.0, 185.0, 20.0, 400.0, -200.0, 355.0, 195.0, 155.0, 430.0, 330.0, -60.0, 75.0, 150.0, 195.0, 145.0, 255.0, -110.0, 310.0, 170.0, 135.0, -25.0, 195.0, 50.0, 110.0, 195.0, -20.0, 345.0, 180.0, 315.0, 330.0, 580.0, 135.0, 70.0, 210.0, 415.0, -20.0, 155.0, 220.0, 160.0, 95.0, 235.0, 250.0, 585.0, 175.0, 300.0, 155.0, 460.0, 225.0, 205.0, -85.0, 95.0, 80.0, 90.0, -75.0, 330.0, 105.0, 105.0, 70.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1499789239537903, "mean_inference_ms": 1.5336233602350675, "mean_action_processing_ms": 0.5641356003868135, "mean_env_wait_ms": 0.1998737421008972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1544947624206543, "StateBufferConnector_ms": 0.005919694900512695, "ViewRequirementAgentConnector_ms": 0.30812883377075195}}, "episode_reward_max": 585.0, "episode_reward_min": -400.0, "episode_reward_mean": 174.25, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.0, 355.0, 100.0, -130.0, 460.0, 250.0, 230.0, 380.0, 145.0, 80.0, -50.0, 35.0, 125.0, 200.0, 0.0, 145.0, 430.0, -400.0, 360.0, 160.0, 405.0, 160.0, 325.0, 365.0, 310.0, 60.0, 10.0, 325.0, 95.0, 180.0, 250.0, 90.0, 150.0, 30.0, 345.0, 175.0, -45.0, 290.0, 240.0, 275.0, -165.0, 160.0, 340.0, 185.0, 20.0, 400.0, -200.0, 355.0, 195.0, 155.0, 430.0, 330.0, -60.0, 75.0, 150.0, 195.0, 145.0, 255.0, -110.0, 310.0, 170.0, 135.0, -25.0, 195.0, 50.0, 110.0, 195.0, -20.0, 345.0, 180.0, 315.0, 330.0, 580.0, 135.0, 70.0, 210.0, 415.0, -20.0, 155.0, 220.0, 160.0, 95.0, 235.0, 250.0, 585.0, 175.0, 300.0, 155.0, 460.0, 225.0, 205.0, -85.0, 95.0, 80.0, 90.0, -75.0, 330.0, 105.0, 105.0, 70.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1499789239537903, "mean_inference_ms": 1.5336233602350675, "mean_action_processing_ms": 0.5641356003868135, "mean_env_wait_ms": 0.1998737421008972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1544947624206543, "StateBufferConnector_ms": 0.005919694900512695, "ViewRequirementAgentConnector_ms": 0.30812883377075195}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3112960, "num_agent_steps_trained": 3112960, "num_env_steps_sampled": 622592, "num_env_steps_trained": 622592, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.44919687507196, "num_env_steps_trained_throughput_per_sec": 71.44919687507196, "timesteps_total": 622592, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3112960, "timers": {"training_iteration_time_ms": 114981.637, "sample_time_ms": 13687.125, "load_time_ms": 1.596, "load_throughput": 5132532.432, "learn_time_ms": 101284.443, "learn_throughput": 80.881, "synch_weights_time_ms": 2.607}, "counters": {"num_env_steps_sampled": 622592, "num_env_steps_trained": 622592, "num_agent_steps_sampled": 3112960, "num_agent_steps_trained": 3112960}, "done": false, "episodes_total": 4864, "training_iteration": 76, "trial_id": "9fade_00019", "date": "2023-11-09_22-10-11", "timestamp": 1699564211, "time_this_iter_s": 114.67130708694458, "time_total_s": 7978.613578796387, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 7978.613578796387, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 37.068902439024384, "ram_util_percent": 18.923170731707316}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.46226293437613025, "episode_optimality_min": -0.7391304347826086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.46226293437613025, "episode_optimality_capped_min": -0.7391304347826086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.11, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.46226293437613025, "curr_learning_score_min": -0.7391304347826086, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9814709530894955, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.31501740746619666, "policy_loss": -0.07418233153418745, "vf_loss": 0.37394937488483265, "vf_explained_var": 0.3281176170830925, "kl": 0.015062087746446953, "entropy": 3.3941161096841097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 734400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 630784, "num_env_steps_trained": 630784, "num_agent_steps_sampled": 3153920, "num_agent_steps_trained": 3153920}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -250.0, "episode_reward_mean": 170.55, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.46226293437613025, "episode_optimality_min": -0.7391304347826086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.46226293437613025, "episode_optimality_capped_min": -0.7391304347826086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 34.11, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.46226293437613025, "curr_learning_score_min": -0.7391304347826086, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [50.0, 110.0, 195.0, -20.0, 345.0, 180.0, 315.0, 330.0, 580.0, 135.0, 70.0, 210.0, 415.0, -20.0, 155.0, 220.0, 160.0, 95.0, 235.0, 250.0, 585.0, 175.0, 300.0, 155.0, 460.0, 225.0, 205.0, -85.0, 95.0, 80.0, 90.0, -75.0, 330.0, 105.0, 105.0, 70.0, 285.0, 225.0, 115.0, 300.0, 325.0, -90.0, 125.0, 285.0, 275.0, -15.0, 475.0, 405.0, 45.0, 95.0, 395.0, 560.0, -50.0, 515.0, 225.0, 550.0, 475.0, 40.0, 210.0, -125.0, 215.0, 70.0, 435.0, -200.0, 470.0, 220.0, -130.0, 10.0, 55.0, 125.0, 130.0, 190.0, 150.0, -45.0, 70.0, 255.0, 85.0, -55.0, -20.0, -45.0, 30.0, 255.0, -150.0, 140.0, 230.0, 345.0, 65.0, 170.0, 355.0, 100.0, 380.0, 150.0, 115.0, 220.0, -250.0, 165.0, 250.0, 5.0, 15.0, 5.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1494109715902647, "mean_inference_ms": 1.5329447753293197, "mean_action_processing_ms": 0.5638465966103294, "mean_env_wait_ms": 0.1997442859045675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1562025547027588, "StateBufferConnector_ms": 0.0060710906982421875, "ViewRequirementAgentConnector_ms": 0.3184988498687744}}, "episode_reward_max": 585.0, "episode_reward_min": -250.0, "episode_reward_mean": 170.55, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.0, 110.0, 195.0, -20.0, 345.0, 180.0, 315.0, 330.0, 580.0, 135.0, 70.0, 210.0, 415.0, -20.0, 155.0, 220.0, 160.0, 95.0, 235.0, 250.0, 585.0, 175.0, 300.0, 155.0, 460.0, 225.0, 205.0, -85.0, 95.0, 80.0, 90.0, -75.0, 330.0, 105.0, 105.0, 70.0, 285.0, 225.0, 115.0, 300.0, 325.0, -90.0, 125.0, 285.0, 275.0, -15.0, 475.0, 405.0, 45.0, 95.0, 395.0, 560.0, -50.0, 515.0, 225.0, 550.0, 475.0, 40.0, 210.0, -125.0, 215.0, 70.0, 435.0, -200.0, 470.0, 220.0, -130.0, 10.0, 55.0, 125.0, 130.0, 190.0, 150.0, -45.0, 70.0, 255.0, 85.0, -55.0, -20.0, -45.0, 30.0, 255.0, -150.0, 140.0, 230.0, 345.0, 65.0, 170.0, 355.0, 100.0, 380.0, 150.0, 115.0, 220.0, -250.0, 165.0, 250.0, 5.0, 15.0, 5.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1494109715902647, "mean_inference_ms": 1.5329447753293197, "mean_action_processing_ms": 0.5638465966103294, "mean_env_wait_ms": 0.1997442859045675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1562025547027588, "StateBufferConnector_ms": 0.0060710906982421875, "ViewRequirementAgentConnector_ms": 0.3184988498687744}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3153920, "num_agent_steps_trained": 3153920, "num_env_steps_sampled": 630784, "num_env_steps_trained": 630784, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.8036499956417, "num_env_steps_trained_throughput_per_sec": 69.8036499956417, "timesteps_total": 630784, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3153920, "timers": {"training_iteration_time_ms": 115294.587, "sample_time_ms": 13729.103, "load_time_ms": 1.602, "load_throughput": 5113208.484, "learn_time_ms": 101555.438, "learn_throughput": 80.665, "synch_weights_time_ms": 2.536}, "counters": {"num_env_steps_sampled": 630784, "num_env_steps_trained": 630784, "num_agent_steps_sampled": 3153920, "num_agent_steps_trained": 3153920}, "done": false, "episodes_total": 4928, "training_iteration": 77, "trial_id": "9fade_00019", "date": "2023-11-09_22-12-08", "timestamp": 1699564328, "time_this_iter_s": 117.37321782112122, "time_total_s": 8095.986796617508, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8095.986796617508, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 38.02335329341317, "ram_util_percent": 18.75449101796407}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4985631373130191, "episode_optimality_min": -0.6756756756756757, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4985631373130191, "episode_optimality_capped_min": -0.6756756756756757, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.65, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 122.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4985631373130191, "curr_learning_score_min": -0.6756756756756757, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9771299166651443, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2730682494515592, "policy_loss": -0.07350115992657569, "vf_loss": 0.33136098702008593, "vf_explained_var": 0.33677118323743344, "kl": 0.015020663262777513, "entropy": 3.338393515273929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 744000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 638976, "num_env_steps_trained": 638976, "num_agent_steps_sampled": 3194880, "num_agent_steps_trained": 3194880}, "sampler_results": {"episode_reward_max": 610.0, "episode_reward_min": -250.0, "episode_reward_mean": 188.25, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4985631373130191, "episode_optimality_min": -0.6756756756756757, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4985631373130191, "episode_optimality_capped_min": -0.6756756756756757, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.65, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 122.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4985631373130191, "curr_learning_score_min": -0.6756756756756757, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [470.0, 220.0, -130.0, 10.0, 55.0, 125.0, 130.0, 190.0, 150.0, -45.0, 70.0, 255.0, 85.0, -55.0, -20.0, -45.0, 30.0, 255.0, -150.0, 140.0, 230.0, 345.0, 65.0, 170.0, 355.0, 100.0, 380.0, 150.0, 115.0, 220.0, -250.0, 165.0, 250.0, 5.0, 15.0, 5.0, 190.0, 610.0, 470.0, 165.0, 405.0, 540.0, 270.0, 75.0, 425.0, -20.0, 270.0, 250.0, 120.0, 60.0, -100.0, 460.0, 250.0, 590.0, 390.0, 70.0, -75.0, 145.0, 495.0, 295.0, 430.0, 460.0, 30.0, 280.0, 80.0, 220.0, 15.0, 45.0, 265.0, 40.0, 0.0, 450.0, 280.0, 385.0, 365.0, 550.0, 565.0, 90.0, 220.0, 105.0, -140.0, 150.0, -55.0, 170.0, -30.0, 245.0, 185.0, 50.0, 290.0, 60.0, 160.0, 460.0, 50.0, 275.0, 500.0, 445.0, 220.0, 285.0, 260.0, -40.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.148899221461368, "mean_inference_ms": 1.5320083414932975, "mean_action_processing_ms": 0.5637499461518988, "mean_env_wait_ms": 0.19956288748016554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15787005424499512, "StateBufferConnector_ms": 0.006078243255615234, "ViewRequirementAgentConnector_ms": 0.31807923316955566}}, "episode_reward_max": 610.0, "episode_reward_min": -250.0, "episode_reward_mean": 188.25, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [470.0, 220.0, -130.0, 10.0, 55.0, 125.0, 130.0, 190.0, 150.0, -45.0, 70.0, 255.0, 85.0, -55.0, -20.0, -45.0, 30.0, 255.0, -150.0, 140.0, 230.0, 345.0, 65.0, 170.0, 355.0, 100.0, 380.0, 150.0, 115.0, 220.0, -250.0, 165.0, 250.0, 5.0, 15.0, 5.0, 190.0, 610.0, 470.0, 165.0, 405.0, 540.0, 270.0, 75.0, 425.0, -20.0, 270.0, 250.0, 120.0, 60.0, -100.0, 460.0, 250.0, 590.0, 390.0, 70.0, -75.0, 145.0, 495.0, 295.0, 430.0, 460.0, 30.0, 280.0, 80.0, 220.0, 15.0, 45.0, 265.0, 40.0, 0.0, 450.0, 280.0, 385.0, 365.0, 550.0, 565.0, 90.0, 220.0, 105.0, -140.0, 150.0, -55.0, 170.0, -30.0, 245.0, 185.0, 50.0, 290.0, 60.0, 160.0, 460.0, 50.0, 275.0, 500.0, 445.0, 220.0, 285.0, 260.0, -40.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.148899221461368, "mean_inference_ms": 1.5320083414932975, "mean_action_processing_ms": 0.5637499461518988, "mean_env_wait_ms": 0.19956288748016554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15787005424499512, "StateBufferConnector_ms": 0.006078243255615234, "ViewRequirementAgentConnector_ms": 0.31807923316955566}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3194880, "num_agent_steps_trained": 3194880, "num_env_steps_sampled": 638976, "num_env_steps_trained": 638976, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 71.59507204199588, "num_env_steps_trained_throughput_per_sec": 71.59507204199588, "timesteps_total": 638976, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3194880, "timers": {"training_iteration_time_ms": 114964.862, "sample_time_ms": 13692.265, "load_time_ms": 1.653, "load_throughput": 4955683.845, "learn_time_ms": 101262.399, "learn_throughput": 80.899, "synch_weights_time_ms": 2.603}, "counters": {"num_env_steps_sampled": 638976, "num_env_steps_trained": 638976, "num_agent_steps_sampled": 3194880, "num_agent_steps_trained": 3194880}, "done": false, "episodes_total": 4992, "training_iteration": 78, "trial_id": "9fade_00019", "date": "2023-11-09_22-14-05", "timestamp": 1699564445, "time_this_iter_s": 114.43789625167847, "time_total_s": 8210.424692869186, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8210.424692869186, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 37.75, "ram_util_percent": 18.781927710843373}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.4884177352093522, "episode_optimality_min": -0.8918918918918919, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4884177352093522, "episode_optimality_capped_min": -0.8918918918918919, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.42, "episode_reward_normalized_min": -34.0, "episode_reward_normalized_max": 113.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4884177352093522, "curr_learning_score_min": -0.8918918918918919, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9870004832278937, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.29391328844035647, "policy_loss": -0.07363597894916893, "vf_loss": 0.35186726520652883, "vf_explained_var": 0.3499851768215497, "kl": 0.015488396911209368, "entropy": 3.3822935337821645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 753600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 647168, "num_env_steps_trained": 647168, "num_agent_steps_sampled": 3235840, "num_agent_steps_trained": 3235840}, "sampler_results": {"episode_reward_max": 565.0, "episode_reward_min": -170.0, "episode_reward_mean": 182.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.4884177352093522, "episode_optimality_min": -0.8918918918918919, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.4884177352093522, "episode_optimality_capped_min": -0.8918918918918919, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.42, "episode_reward_normalized_min": -34.0, "episode_reward_normalized_max": 113.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.4884177352093522, "curr_learning_score_min": -0.8918918918918919, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [80.0, 220.0, 15.0, 45.0, 265.0, 40.0, 0.0, 450.0, 280.0, 385.0, 365.0, 550.0, 565.0, 90.0, 220.0, 105.0, -140.0, 150.0, -55.0, 170.0, -30.0, 245.0, 185.0, 50.0, 290.0, 60.0, 160.0, 460.0, 50.0, 275.0, 500.0, 445.0, 220.0, 285.0, 260.0, -40.0, 305.0, 305.0, 455.0, 445.0, 130.0, 225.0, 160.0, 40.0, 40.0, -115.0, -165.0, 0.0, 90.0, 380.0, 75.0, 235.0, 340.0, 425.0, 120.0, 210.0, 40.0, 215.0, -20.0, -25.0, 180.0, 310.0, 180.0, -100.0, 115.0, 215.0, 250.0, 65.0, -95.0, -40.0, -130.0, 25.0, 465.0, 205.0, 40.0, 375.0, 190.0, 370.0, 360.0, 450.0, -50.0, 285.0, 350.0, 495.0, 140.0, 130.0, 190.0, 400.0, 385.0, 95.0, 200.0, 200.0, 345.0, 285.0, 225.0, -125.0, 235.0, -170.0, 40.0, 0.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1484082115786194, "mean_inference_ms": 1.5310154466290782, "mean_action_processing_ms": 0.5636587159792243, "mean_env_wait_ms": 0.1993928921114707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1572108268737793, "StateBufferConnector_ms": 0.0061190128326416016, "ViewRequirementAgentConnector_ms": 0.3171055316925049}}, "episode_reward_max": 565.0, "episode_reward_min": -170.0, "episode_reward_mean": 182.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0, 220.0, 15.0, 45.0, 265.0, 40.0, 0.0, 450.0, 280.0, 385.0, 365.0, 550.0, 565.0, 90.0, 220.0, 105.0, -140.0, 150.0, -55.0, 170.0, -30.0, 245.0, 185.0, 50.0, 290.0, 60.0, 160.0, 460.0, 50.0, 275.0, 500.0, 445.0, 220.0, 285.0, 260.0, -40.0, 305.0, 305.0, 455.0, 445.0, 130.0, 225.0, 160.0, 40.0, 40.0, -115.0, -165.0, 0.0, 90.0, 380.0, 75.0, 235.0, 340.0, 425.0, 120.0, 210.0, 40.0, 215.0, -20.0, -25.0, 180.0, 310.0, 180.0, -100.0, 115.0, 215.0, 250.0, 65.0, -95.0, -40.0, -130.0, 25.0, 465.0, 205.0, 40.0, 375.0, 190.0, 370.0, 360.0, 450.0, -50.0, 285.0, 350.0, 495.0, 140.0, 130.0, 190.0, 400.0, 385.0, 95.0, 200.0, 200.0, 345.0, 285.0, 225.0, -125.0, 235.0, -170.0, 40.0, 0.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1484082115786194, "mean_inference_ms": 1.5310154466290782, "mean_action_processing_ms": 0.5636587159792243, "mean_env_wait_ms": 0.1993928921114707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1572108268737793, "StateBufferConnector_ms": 0.0061190128326416016, "ViewRequirementAgentConnector_ms": 0.3171055316925049}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3235840, "num_agent_steps_trained": 3235840, "num_env_steps_sampled": 647168, "num_env_steps_trained": 647168, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.46423778171575, "num_env_steps_trained_throughput_per_sec": 70.46423778171575, "timesteps_total": 647168, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3235840, "timers": {"training_iteration_time_ms": 115094.443, "sample_time_ms": 13653.562, "load_time_ms": 1.668, "load_throughput": 4910638.612, "learn_time_ms": 101430.49, "learn_throughput": 80.765, "synch_weights_time_ms": 2.73}, "counters": {"num_env_steps_sampled": 647168, "num_env_steps_trained": 647168, "num_agent_steps_sampled": 3235840, "num_agent_steps_trained": 3235840}, "done": false, "episodes_total": 5056, "training_iteration": 79, "trial_id": "9fade_00019", "date": "2023-11-09_22-16-01", "timestamp": 1699564561, "time_this_iter_s": 116.27615118026733, "time_total_s": 8326.700844049454, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8326.700844049454, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 37.98373493975904, "ram_util_percent": 18.843373493975903}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5387889804306782, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5387889804306782, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.77, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5387889804306782, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9823617729110022, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.26705383896041895, "policy_loss": -0.06937952619691108, "vf_loss": 0.32139594133198746, "vf_explained_var": 0.3623403911292553, "kl": 0.014851775926899033, "entropy": 3.359691407283147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 763200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 655360, "num_env_steps_trained": 655360, "num_agent_steps_sampled": 3276800, "num_agent_steps_trained": 3276800}, "sampler_results": {"episode_reward_max": 540.0, "episode_reward_min": -195.0, "episode_reward_mean": 188.85, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5387889804306782, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5387889804306782, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.77, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5387889804306782, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [115.0, 215.0, 250.0, 65.0, -95.0, -40.0, -130.0, 25.0, 465.0, 205.0, 40.0, 375.0, 190.0, 370.0, 360.0, 450.0, -50.0, 285.0, 350.0, 495.0, 140.0, 130.0, 190.0, 400.0, 385.0, 95.0, 200.0, 200.0, 345.0, 285.0, 225.0, -125.0, 235.0, -170.0, 40.0, 0.0, 440.0, 520.0, -35.0, 310.0, 155.0, 140.0, 150.0, 285.0, 140.0, 320.0, 245.0, 450.0, 435.0, 70.0, -195.0, 0.0, 90.0, 415.0, 135.0, 105.0, 120.0, 10.0, 395.0, 295.0, -85.0, 260.0, 190.0, 180.0, -80.0, 170.0, 305.0, 210.0, 85.0, 100.0, 230.0, 185.0, 200.0, 365.0, -105.0, 290.0, -90.0, 115.0, 40.0, 420.0, 430.0, 170.0, 100.0, 215.0, -75.0, 50.0, 50.0, 125.0, 105.0, 45.0, 400.0, 80.0, 110.0, 515.0, 275.0, 410.0, 165.0, 320.0, 360.0, 540.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1478992329607838, "mean_inference_ms": 1.5301148264081683, "mean_action_processing_ms": 0.5634092762872901, "mean_env_wait_ms": 0.1992527229550368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15806007385253906, "StateBufferConnector_ms": 0.006155967712402344, "ViewRequirementAgentConnector_ms": 0.31801724433898926}}, "episode_reward_max": 540.0, "episode_reward_min": -195.0, "episode_reward_mean": 188.85, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [115.0, 215.0, 250.0, 65.0, -95.0, -40.0, -130.0, 25.0, 465.0, 205.0, 40.0, 375.0, 190.0, 370.0, 360.0, 450.0, -50.0, 285.0, 350.0, 495.0, 140.0, 130.0, 190.0, 400.0, 385.0, 95.0, 200.0, 200.0, 345.0, 285.0, 225.0, -125.0, 235.0, -170.0, 40.0, 0.0, 440.0, 520.0, -35.0, 310.0, 155.0, 140.0, 150.0, 285.0, 140.0, 320.0, 245.0, 450.0, 435.0, 70.0, -195.0, 0.0, 90.0, 415.0, 135.0, 105.0, 120.0, 10.0, 395.0, 295.0, -85.0, 260.0, 190.0, 180.0, -80.0, 170.0, 305.0, 210.0, 85.0, 100.0, 230.0, 185.0, 200.0, 365.0, -105.0, 290.0, -90.0, 115.0, 40.0, 420.0, 430.0, 170.0, 100.0, 215.0, -75.0, 50.0, 50.0, 125.0, 105.0, 45.0, 400.0, 80.0, 110.0, 515.0, 275.0, 410.0, 165.0, 320.0, 360.0, 540.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1478992329607838, "mean_inference_ms": 1.5301148264081683, "mean_action_processing_ms": 0.5634092762872901, "mean_env_wait_ms": 0.1992527229550368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15806007385253906, "StateBufferConnector_ms": 0.006155967712402344, "ViewRequirementAgentConnector_ms": 0.31801724433898926}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3276800, "num_agent_steps_trained": 3276800, "num_env_steps_sampled": 655360, "num_env_steps_trained": 655360, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.27242049137624, "num_env_steps_trained_throughput_per_sec": 70.27242049137624, "timesteps_total": 655360, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3276800, "timers": {"training_iteration_time_ms": 115258.727, "sample_time_ms": 13673.591, "load_time_ms": 1.672, "load_throughput": 4900832.744, "learn_time_ms": 101574.577, "learn_throughput": 80.65, "synch_weights_time_ms": 2.862}, "counters": {"num_env_steps_sampled": 655360, "num_env_steps_trained": 655360, "num_agent_steps_sampled": 3276800, "num_agent_steps_trained": 3276800}, "done": false, "episodes_total": 5120, "training_iteration": 80, "trial_id": "9fade_00019", "date": "2023-11-09_22-17-58", "timestamp": 1699564678, "time_this_iter_s": 116.59047031402588, "time_total_s": 8443.29131436348, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8443.29131436348, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 37.46746987951808, "ram_util_percent": 18.659638554216873}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5077373618892052, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5077373618892052, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.82, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5077373618892052, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9874077011086047, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.26346409931769205, "policy_loss": -0.07538012055329697, "vf_loss": 0.3230699973652372, "vf_explained_var": 0.3490160759227971, "kl": 0.015579478198045156, "entropy": 3.358924577559034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 772800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 663552, "num_env_steps_trained": 663552, "num_agent_steps_sampled": 3317760, "num_agent_steps_trained": 3317760}, "sampler_results": {"episode_reward_max": 540.0, "episode_reward_min": -185.0, "episode_reward_mean": 184.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5077373618892052, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5077373618892052, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.82, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5077373618892052, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-80.0, 170.0, 305.0, 210.0, 85.0, 100.0, 230.0, 185.0, 200.0, 365.0, -105.0, 290.0, -90.0, 115.0, 40.0, 420.0, 430.0, 170.0, 100.0, 215.0, -75.0, 50.0, 50.0, 125.0, 105.0, 45.0, 400.0, 80.0, 110.0, 515.0, 275.0, 410.0, 165.0, 320.0, 360.0, 540.0, 230.0, 110.0, 55.0, 50.0, 240.0, 170.0, 365.0, 320.0, 115.0, 295.0, 25.0, 120.0, 90.0, 270.0, -15.0, 395.0, 140.0, 245.0, 55.0, 85.0, -95.0, 405.0, 170.0, -85.0, 275.0, 235.0, 200.0, 360.0, 155.0, 340.0, 475.0, 515.0, 145.0, 245.0, 340.0, 345.0, 480.0, 115.0, 495.0, 240.0, 345.0, 235.0, -10.0, 370.0, 180.0, 120.0, -100.0, 195.0, 110.0, -185.0, 150.0, 60.0, 380.0, 115.0, -20.0, 165.0, 130.0, 70.0, 145.0, 55.0, -50.0, 0.0, 330.0, 75.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1472924299325045, "mean_inference_ms": 1.5291040228091795, "mean_action_processing_ms": 0.5630978528091424, "mean_env_wait_ms": 0.19910605181816973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15677380561828613, "StateBufferConnector_ms": 0.006096601486206055, "ViewRequirementAgentConnector_ms": 0.31664252281188965}}, "episode_reward_max": 540.0, "episode_reward_min": -185.0, "episode_reward_mean": 184.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.0, 170.0, 305.0, 210.0, 85.0, 100.0, 230.0, 185.0, 200.0, 365.0, -105.0, 290.0, -90.0, 115.0, 40.0, 420.0, 430.0, 170.0, 100.0, 215.0, -75.0, 50.0, 50.0, 125.0, 105.0, 45.0, 400.0, 80.0, 110.0, 515.0, 275.0, 410.0, 165.0, 320.0, 360.0, 540.0, 230.0, 110.0, 55.0, 50.0, 240.0, 170.0, 365.0, 320.0, 115.0, 295.0, 25.0, 120.0, 90.0, 270.0, -15.0, 395.0, 140.0, 245.0, 55.0, 85.0, -95.0, 405.0, 170.0, -85.0, 275.0, 235.0, 200.0, 360.0, 155.0, 340.0, 475.0, 515.0, 145.0, 245.0, 340.0, 345.0, 480.0, 115.0, 495.0, 240.0, 345.0, 235.0, -10.0, 370.0, 180.0, 120.0, -100.0, 195.0, 110.0, -185.0, 150.0, 60.0, 380.0, 115.0, -20.0, 165.0, 130.0, 70.0, 145.0, 55.0, -50.0, 0.0, 330.0, 75.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1472924299325045, "mean_inference_ms": 1.5291040228091795, "mean_action_processing_ms": 0.5630978528091424, "mean_env_wait_ms": 0.19910605181816973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15677380561828613, "StateBufferConnector_ms": 0.006096601486206055, "ViewRequirementAgentConnector_ms": 0.31664252281188965}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3317760, "num_agent_steps_trained": 3317760, "num_env_steps_sampled": 663552, "num_env_steps_trained": 663552, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.71099840720206, "num_env_steps_trained_throughput_per_sec": 70.71099840720206, "timesteps_total": 663552, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3317760, "timers": {"training_iteration_time_ms": 115363.387, "sample_time_ms": 13614.352, "load_time_ms": 1.635, "load_throughput": 5010022.8, "learn_time_ms": 101738.414, "learn_throughput": 80.52, "synch_weights_time_ms": 3.052}, "counters": {"num_env_steps_sampled": 663552, "num_env_steps_trained": 663552, "num_agent_steps_sampled": 3317760, "num_agent_steps_trained": 3317760}, "done": false, "episodes_total": 5184, "training_iteration": 81, "trial_id": "9fade_00019", "date": "2023-11-09_22-19-53", "timestamp": 1699564793, "time_this_iter_s": 115.8671178817749, "time_total_s": 8559.158432245255, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8559.158432245255, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 37.5369696969697, "ram_util_percent": 18.764848484848482}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5526615895440855, "episode_optimality_min": -0.8333333333333334, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5526615895440855, "episode_optimality_capped_min": -0.8333333333333334, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.53, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 103.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5526615895440855, "curr_learning_score_min": -0.8333333333333334, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9786292078640932, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2584402882635671, "policy_loss": -0.07777056473181194, "vf_loss": 0.3201579737204823, "vf_explained_var": 0.3902322033171852, "kl": 0.01585469476183808, "entropy": 3.301104868426919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 782400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 671744, "num_env_steps_trained": 671744, "num_agent_steps_sampled": 3358720, "num_agent_steps_trained": 3358720}, "sampler_results": {"episode_reward_max": 515.0, "episode_reward_min": -185.0, "episode_reward_mean": 202.65, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5526615895440855, "episode_optimality_min": -0.8333333333333334, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5526615895440855, "episode_optimality_capped_min": -0.8333333333333334, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.53, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 103.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5526615895440855, "curr_learning_score_min": -0.8333333333333334, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [155.0, 340.0, 475.0, 515.0, 145.0, 245.0, 340.0, 345.0, 480.0, 115.0, 495.0, 240.0, 345.0, 235.0, -10.0, 370.0, 180.0, 120.0, -100.0, 195.0, 110.0, -185.0, 150.0, 60.0, 380.0, 115.0, -20.0, 165.0, 130.0, 70.0, 145.0, 55.0, -50.0, 0.0, 330.0, 75.0, 360.0, 130.0, 10.0, 35.0, 265.0, 280.0, 270.0, 350.0, 195.0, 280.0, 440.0, 190.0, 300.0, -75.0, 290.0, 390.0, 315.0, 105.0, 0.0, 380.0, 50.0, 240.0, 65.0, 235.0, -10.0, 205.0, -5.0, 315.0, 95.0, 345.0, 380.0, 25.0, -105.0, 395.0, 70.0, -5.0, 305.0, 135.0, 195.0, 110.0, 235.0, 185.0, 215.0, 110.0, 275.0, 155.0, 60.0, 220.0, 435.0, 195.0, 305.0, 445.0, 200.0, 395.0, -80.0, 510.0, 185.0, 280.0, 335.0, 165.0, 515.0, 160.0, 295.0, 165.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1468633103674646, "mean_inference_ms": 1.5285450158218805, "mean_action_processing_ms": 0.562878831870981, "mean_env_wait_ms": 0.19901785411429415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15812039375305176, "StateBufferConnector_ms": 0.006265878677368164, "ViewRequirementAgentConnector_ms": 0.32233476638793945}}, "episode_reward_max": 515.0, "episode_reward_min": -185.0, "episode_reward_mean": 202.65, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [155.0, 340.0, 475.0, 515.0, 145.0, 245.0, 340.0, 345.0, 480.0, 115.0, 495.0, 240.0, 345.0, 235.0, -10.0, 370.0, 180.0, 120.0, -100.0, 195.0, 110.0, -185.0, 150.0, 60.0, 380.0, 115.0, -20.0, 165.0, 130.0, 70.0, 145.0, 55.0, -50.0, 0.0, 330.0, 75.0, 360.0, 130.0, 10.0, 35.0, 265.0, 280.0, 270.0, 350.0, 195.0, 280.0, 440.0, 190.0, 300.0, -75.0, 290.0, 390.0, 315.0, 105.0, 0.0, 380.0, 50.0, 240.0, 65.0, 235.0, -10.0, 205.0, -5.0, 315.0, 95.0, 345.0, 380.0, 25.0, -105.0, 395.0, 70.0, -5.0, 305.0, 135.0, 195.0, 110.0, 235.0, 185.0, 215.0, 110.0, 275.0, 155.0, 60.0, 220.0, 435.0, 195.0, 305.0, 445.0, 200.0, 395.0, -80.0, 510.0, 185.0, 280.0, 335.0, 165.0, 515.0, 160.0, 295.0, 165.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1468633103674646, "mean_inference_ms": 1.5285450158218805, "mean_action_processing_ms": 0.562878831870981, "mean_env_wait_ms": 0.19901785411429415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15812039375305176, "StateBufferConnector_ms": 0.006265878677368164, "ViewRequirementAgentConnector_ms": 0.32233476638793945}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3358720, "num_agent_steps_trained": 3358720, "num_env_steps_sampled": 671744, "num_env_steps_trained": 671744, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.1719302948644, "num_env_steps_trained_throughput_per_sec": 70.1719302948644, "timesteps_total": 671744, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3358720, "timers": {"training_iteration_time_ms": 115553.975, "sample_time_ms": 13656.222, "load_time_ms": 1.672, "load_throughput": 4898666.738, "learn_time_ms": 101887.153, "learn_throughput": 80.403, "synch_weights_time_ms": 2.974}, "counters": {"num_env_steps_sampled": 671744, "num_env_steps_trained": 671744, "num_agent_steps_sampled": 3358720, "num_agent_steps_trained": 3358720}, "done": false, "episodes_total": 5248, "training_iteration": 82, "trial_id": "9fade_00019", "date": "2023-11-09_22-21-53", "timestamp": 1699564913, "time_this_iter_s": 116.7602276802063, "time_total_s": 8675.91865992546, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8675.91865992546, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 38.158479532163746, "ram_util_percent": 18.721637426900582}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5552670729535242, "episode_optimality_min": -0.7391304347826086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5552670729535242, "episode_optimality_capped_min": -0.7391304347826086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.82, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 115.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5552670729535242, "curr_learning_score_min": -0.7391304347826086, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9776135832909495, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2893696021191378, "policy_loss": -0.07735688497365724, "vf_loss": 0.35084068170700144, "vf_explained_var": 0.34438206993664305, "kl": 0.015689684401343697, "entropy": 3.2712964157760145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 792000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 679936, "num_env_steps_trained": 679936, "num_agent_steps_sampled": 3399680, "num_agent_steps_trained": 3399680}, "sampler_results": {"episode_reward_max": 575.0, "episode_reward_min": -180.0, "episode_reward_mean": 219.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5552670729535242, "episode_optimality_min": -0.7391304347826086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5552670729535242, "episode_optimality_capped_min": -0.7391304347826086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.82, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 115.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5552670729535242, "curr_learning_score_min": -0.7391304347826086, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [95.0, 345.0, 380.0, 25.0, -105.0, 395.0, 70.0, -5.0, 305.0, 135.0, 195.0, 110.0, 235.0, 185.0, 215.0, 110.0, 275.0, 155.0, 60.0, 220.0, 435.0, 195.0, 305.0, 445.0, 200.0, 395.0, -80.0, 510.0, 185.0, 280.0, 335.0, 165.0, 515.0, 160.0, 295.0, 165.0, 5.0, 275.0, 190.0, 10.0, 275.0, -45.0, -65.0, 295.0, -140.0, 95.0, 185.0, 320.0, -105.0, 130.0, 170.0, 420.0, 95.0, 220.0, 380.0, -95.0, 235.0, 445.0, 135.0, 275.0, -130.0, -85.0, 225.0, 60.0, 145.0, 160.0, 345.0, 535.0, 300.0, 365.0, 135.0, 550.0, 280.0, 375.0, 225.0, 405.0, 205.0, 345.0, 295.0, 515.0, 175.0, 385.0, 430.0, -90.0, 40.0, 130.0, 410.0, 70.0, 500.0, -180.0, 70.0, 115.0, 375.0, 410.0, 540.0, 385.0, 155.0, 140.0, 415.0, 575.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1466918670679116, "mean_inference_ms": 1.5280655812225108, "mean_action_processing_ms": 0.5627131339945283, "mean_env_wait_ms": 0.19892689659786933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15993833541870117, "StateBufferConnector_ms": 0.006309986114501953, "ViewRequirementAgentConnector_ms": 0.3219172954559326}}, "episode_reward_max": 575.0, "episode_reward_min": -180.0, "episode_reward_mean": 219.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [95.0, 345.0, 380.0, 25.0, -105.0, 395.0, 70.0, -5.0, 305.0, 135.0, 195.0, 110.0, 235.0, 185.0, 215.0, 110.0, 275.0, 155.0, 60.0, 220.0, 435.0, 195.0, 305.0, 445.0, 200.0, 395.0, -80.0, 510.0, 185.0, 280.0, 335.0, 165.0, 515.0, 160.0, 295.0, 165.0, 5.0, 275.0, 190.0, 10.0, 275.0, -45.0, -65.0, 295.0, -140.0, 95.0, 185.0, 320.0, -105.0, 130.0, 170.0, 420.0, 95.0, 220.0, 380.0, -95.0, 235.0, 445.0, 135.0, 275.0, -130.0, -85.0, 225.0, 60.0, 145.0, 160.0, 345.0, 535.0, 300.0, 365.0, 135.0, 550.0, 280.0, 375.0, 225.0, 405.0, 205.0, 345.0, 295.0, 515.0, 175.0, 385.0, 430.0, -90.0, 40.0, 130.0, 410.0, 70.0, 500.0, -180.0, 70.0, 115.0, 375.0, 410.0, 540.0, 385.0, 155.0, 140.0, 415.0, 575.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1466918670679116, "mean_inference_ms": 1.5280655812225108, "mean_action_processing_ms": 0.5627131339945283, "mean_env_wait_ms": 0.19892689659786933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15993833541870117, "StateBufferConnector_ms": 0.006309986114501953, "ViewRequirementAgentConnector_ms": 0.3219172954559326}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3399680, "num_agent_steps_trained": 3399680, "num_env_steps_sampled": 679936, "num_env_steps_trained": 679936, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.88377551778154, "num_env_steps_trained_throughput_per_sec": 69.88377551778154, "timesteps_total": 679936, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3399680, "timers": {"training_iteration_time_ms": 115820.515, "sample_time_ms": 13717.536, "load_time_ms": 1.646, "load_throughput": 4976570.886, "learn_time_ms": 102092.516, "learn_throughput": 80.241, "synch_weights_time_ms": 2.974}, "counters": {"num_env_steps_sampled": 679936, "num_env_steps_trained": 679936, "num_agent_steps_sampled": 3399680, "num_agent_steps_trained": 3399680}, "done": false, "episodes_total": 5312, "training_iteration": 83, "trial_id": "9fade_00019", "date": "2023-11-09_22-23-50", "timestamp": 1699565030, "time_this_iter_s": 117.23517751693726, "time_total_s": 8793.153837442398, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8793.153837442398, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 37.15029940119761, "ram_util_percent": 18.8377245508982}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5805002395519717, "episode_optimality_min": -0.9672131147540983, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5805002395519717, "episode_optimality_capped_min": -0.9672131147540983, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.66, "episode_reward_normalized_min": -59.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5805002395519717, "curr_learning_score_min": -0.9672131147540983, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9735812781945181, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2587288849846906, "policy_loss": -0.07525836002843182, "vf_loss": 0.3183888970677492, "vf_explained_var": 0.38106268635640544, "kl": 0.015405774914950711, "entropy": 3.3066491824636857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 801600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 688128, "num_env_steps_trained": 688128, "num_agent_steps_sampled": 3440640, "num_agent_steps_trained": 3440640}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -295.0, "episode_reward_mean": 218.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5805002395519717, "episode_optimality_min": -0.9672131147540983, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5805002395519717, "episode_optimality_capped_min": -0.9672131147540983, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.66, "episode_reward_normalized_min": -59.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5805002395519717, "curr_learning_score_min": -0.9672131147540983, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [145.0, 160.0, 345.0, 535.0, 300.0, 365.0, 135.0, 550.0, 280.0, 375.0, 225.0, 405.0, 205.0, 345.0, 295.0, 515.0, 175.0, 385.0, 430.0, -90.0, 40.0, 130.0, 410.0, 70.0, 500.0, -180.0, 70.0, 115.0, 375.0, 410.0, 540.0, 385.0, 155.0, 140.0, 415.0, 575.0, 90.0, 320.0, -70.0, 345.0, 220.0, 95.0, 215.0, 465.0, -105.0, 270.0, -145.0, 85.0, 235.0, 210.0, 240.0, 315.0, 55.0, 405.0, 340.0, 190.0, 75.0, 150.0, -60.0, 200.0, 95.0, 210.0, 160.0, 125.0, 125.0, 185.0, 330.0, 395.0, 260.0, 205.0, 305.0, 170.0, 110.0, -10.0, 10.0, 275.0, 150.0, 310.0, 95.0, 80.0, 370.0, 215.0, 360.0, 310.0, 85.0, 290.0, 80.0, -55.0, 80.0, 180.0, -50.0, 285.0, 145.0, 370.0, -295.0, 55.0, 630.0, 550.0, 325.0, -55.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1462316011406068, "mean_inference_ms": 1.527183903217049, "mean_action_processing_ms": 0.5624813865584077, "mean_env_wait_ms": 0.19876980467100075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1577448844909668, "StateBufferConnector_ms": 0.006158351898193359, "ViewRequirementAgentConnector_ms": 0.31652379035949707}}, "episode_reward_max": 630.0, "episode_reward_min": -295.0, "episode_reward_mean": 218.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [145.0, 160.0, 345.0, 535.0, 300.0, 365.0, 135.0, 550.0, 280.0, 375.0, 225.0, 405.0, 205.0, 345.0, 295.0, 515.0, 175.0, 385.0, 430.0, -90.0, 40.0, 130.0, 410.0, 70.0, 500.0, -180.0, 70.0, 115.0, 375.0, 410.0, 540.0, 385.0, 155.0, 140.0, 415.0, 575.0, 90.0, 320.0, -70.0, 345.0, 220.0, 95.0, 215.0, 465.0, -105.0, 270.0, -145.0, 85.0, 235.0, 210.0, 240.0, 315.0, 55.0, 405.0, 340.0, 190.0, 75.0, 150.0, -60.0, 200.0, 95.0, 210.0, 160.0, 125.0, 125.0, 185.0, 330.0, 395.0, 260.0, 205.0, 305.0, 170.0, 110.0, -10.0, 10.0, 275.0, 150.0, 310.0, 95.0, 80.0, 370.0, 215.0, 360.0, 310.0, 85.0, 290.0, 80.0, -55.0, 80.0, 180.0, -50.0, 285.0, 145.0, 370.0, -295.0, 55.0, 630.0, 550.0, 325.0, -55.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1462316011406068, "mean_inference_ms": 1.527183903217049, "mean_action_processing_ms": 0.5624813865584077, "mean_env_wait_ms": 0.19876980467100075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1577448844909668, "StateBufferConnector_ms": 0.006158351898193359, "ViewRequirementAgentConnector_ms": 0.31652379035949707}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440640, "num_agent_steps_trained": 3440640, "num_env_steps_sampled": 688128, "num_env_steps_trained": 688128, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.98426298985994, "num_env_steps_trained_throughput_per_sec": 69.98426298985994, "timesteps_total": 688128, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3440640, "timers": {"training_iteration_time_ms": 116005.862, "sample_time_ms": 13728.716, "load_time_ms": 1.699, "load_throughput": 4822148.703, "learn_time_ms": 102266.401, "learn_throughput": 80.105, "synch_weights_time_ms": 3.118}, "counters": {"num_env_steps_sampled": 688128, "num_env_steps_trained": 688128, "num_agent_steps_sampled": 3440640, "num_agent_steps_trained": 3440640}, "done": false, "episodes_total": 5376, "training_iteration": 84, "trial_id": "9fade_00019", "date": "2023-11-09_22-25-47", "timestamp": 1699565147, "time_this_iter_s": 117.07112431526184, "time_total_s": 8910.22496175766, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 8910.22496175766, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 37.66167664670659, "ram_util_percent": 18.917365269461076}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5557228091503155, "episode_optimality_min": -0.9672131147540983, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5557228091503155, "episode_optimality_capped_min": -0.9672131147540983, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.2, "episode_reward_normalized_min": -59.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5557228091503155, "curr_learning_score_min": -0.9672131147540983, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9890624826556692, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25710721447244095, "policy_loss": -0.07519357979418904, "vf_loss": 0.31642190078860344, "vf_explained_var": 0.37828868014117084, "kl": 0.01568285659643891, "entropy": 3.2927849238117535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 811200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 696320, "num_env_steps_trained": 696320, "num_agent_steps_sampled": 3481600, "num_agent_steps_trained": 3481600}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -295.0, "episode_reward_mean": 191.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5557228091503155, "episode_optimality_min": -0.9672131147540983, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5557228091503155, "episode_optimality_capped_min": -0.9672131147540983, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.2, "episode_reward_normalized_min": -59.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5557228091503155, "curr_learning_score_min": -0.9672131147540983, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [125.0, 185.0, 330.0, 395.0, 260.0, 205.0, 305.0, 170.0, 110.0, -10.0, 10.0, 275.0, 150.0, 310.0, 95.0, 80.0, 370.0, 215.0, 360.0, 310.0, 85.0, 290.0, 80.0, -55.0, 80.0, 180.0, -50.0, 285.0, 145.0, 370.0, -295.0, 55.0, 630.0, 550.0, 325.0, -55.0, 115.0, -60.0, 475.0, 25.0, 255.0, 125.0, 110.0, 85.0, 200.0, 205.0, 315.0, 225.0, 100.0, 105.0, 330.0, -115.0, 45.0, 215.0, 75.0, 150.0, 270.0, -90.0, 155.0, 255.0, 445.0, 75.0, 400.0, 30.0, 195.0, 125.0, 365.0, -30.0, 150.0, 275.0, 95.0, 275.0, 260.0, 405.0, 210.0, 115.0, 395.0, -15.0, 45.0, 115.0, 405.0, 130.0, 125.0, 405.0, -65.0, 245.0, 350.0, 115.0, 90.0, 310.0, 140.0, 385.0, 105.0, 375.0, 385.0, 400.0, 310.0, -140.0, 430.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1462317289418344, "mean_inference_ms": 1.5267865113496475, "mean_action_processing_ms": 0.5622425005285019, "mean_env_wait_ms": 0.19864518259840494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15637755393981934, "StateBufferConnector_ms": 0.006126880645751953, "ViewRequirementAgentConnector_ms": 0.31859755516052246}}, "episode_reward_max": 630.0, "episode_reward_min": -295.0, "episode_reward_mean": 191.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.0, 185.0, 330.0, 395.0, 260.0, 205.0, 305.0, 170.0, 110.0, -10.0, 10.0, 275.0, 150.0, 310.0, 95.0, 80.0, 370.0, 215.0, 360.0, 310.0, 85.0, 290.0, 80.0, -55.0, 80.0, 180.0, -50.0, 285.0, 145.0, 370.0, -295.0, 55.0, 630.0, 550.0, 325.0, -55.0, 115.0, -60.0, 475.0, 25.0, 255.0, 125.0, 110.0, 85.0, 200.0, 205.0, 315.0, 225.0, 100.0, 105.0, 330.0, -115.0, 45.0, 215.0, 75.0, 150.0, 270.0, -90.0, 155.0, 255.0, 445.0, 75.0, 400.0, 30.0, 195.0, 125.0, 365.0, -30.0, 150.0, 275.0, 95.0, 275.0, 260.0, 405.0, 210.0, 115.0, 395.0, -15.0, 45.0, 115.0, 405.0, 130.0, 125.0, 405.0, -65.0, 245.0, 350.0, 115.0, 90.0, 310.0, 140.0, 385.0, 105.0, 375.0, 385.0, 400.0, 310.0, -140.0, 430.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1462317289418344, "mean_inference_ms": 1.5267865113496475, "mean_action_processing_ms": 0.5622425005285019, "mean_env_wait_ms": 0.19864518259840494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15637755393981934, "StateBufferConnector_ms": 0.006126880645751953, "ViewRequirementAgentConnector_ms": 0.31859755516052246}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3481600, "num_agent_steps_trained": 3481600, "num_env_steps_sampled": 696320, "num_env_steps_trained": 696320, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.41211580656899, "num_env_steps_trained_throughput_per_sec": 69.41211580656899, "timesteps_total": 696320, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3481600, "timers": {"training_iteration_time_ms": 116415.761, "sample_time_ms": 13830.059, "load_time_ms": 1.659, "load_throughput": 4937524.374, "learn_time_ms": 102574.987, "learn_throughput": 79.864, "synch_weights_time_ms": 3.107}, "counters": {"num_env_steps_sampled": 696320, "num_env_steps_trained": 696320, "num_agent_steps_sampled": 3481600, "num_agent_steps_trained": 3481600}, "done": false, "episodes_total": 5440, "training_iteration": 85, "trial_id": "9fade_00019", "date": "2023-11-09_22-27-45", "timestamp": 1699565265, "time_this_iter_s": 118.0362617969513, "time_total_s": 9028.261223554611, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9028.261223554611, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 38.42619047619048, "ram_util_percent": 18.901190476190475}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5602889693136696, "episode_optimality_min": -0.7560975609756098, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5602889693136696, "episode_optimality_capped_min": -0.7560975609756098, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.35, "episode_reward_normalized_min": -31.0, "episode_reward_normalized_max": 101.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5602889693136696, "curr_learning_score_min": -0.7560975609756098, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.984952019220218, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2889216423791125, "policy_loss": -0.07547365389963186, "vf_loss": 0.3482296085788403, "vf_explained_var": 0.3687586514775952, "kl": 0.015966110433497722, "entropy": 3.2783094210426014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 820800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 704512, "num_env_steps_trained": 704512, "num_agent_steps_sampled": 3522560, "num_agent_steps_trained": 3522560}, "sampler_results": {"episode_reward_max": 505.0, "episode_reward_min": -155.0, "episode_reward_mean": 196.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5602889693136696, "episode_optimality_min": -0.7560975609756098, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5602889693136696, "episode_optimality_capped_min": -0.7560975609756098, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.35, "episode_reward_normalized_min": -31.0, "episode_reward_normalized_max": 101.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5602889693136696, "curr_learning_score_min": -0.7560975609756098, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [195.0, 125.0, 365.0, -30.0, 150.0, 275.0, 95.0, 275.0, 260.0, 405.0, 210.0, 115.0, 395.0, -15.0, 45.0, 115.0, 405.0, 130.0, 125.0, 405.0, -65.0, 245.0, 350.0, 115.0, 90.0, 310.0, 140.0, 385.0, 105.0, 375.0, 385.0, 400.0, 310.0, -140.0, 430.0, 230.0, 100.0, 45.0, 95.0, 450.0, 440.0, 170.0, 270.0, 345.0, 200.0, -50.0, 195.0, 315.0, 270.0, 170.0, 0.0, 150.0, 385.0, 25.0, 130.0, 20.0, 440.0, -100.0, 505.0, 135.0, 190.0, 260.0, 320.0, 130.0, -120.0, 285.0, 235.0, 465.0, 465.0, -50.0, 135.0, -35.0, 95.0, 340.0, 205.0, 65.0, 55.0, 195.0, 255.0, 80.0, 135.0, 385.0, 200.0, 100.0, 265.0, 200.0, 210.0, 445.0, 260.0, 335.0, 100.0, 255.0, 190.0, -40.0, -155.0, -50.0, 290.0, 260.0, 160.0, 145.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.145730699737005, "mean_inference_ms": 1.5260299431733777, "mean_action_processing_ms": 0.5619713203513865, "mean_env_wait_ms": 0.198463369428316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15686297416687012, "StateBufferConnector_ms": 0.006025075912475586, "ViewRequirementAgentConnector_ms": 0.31641340255737305}}, "episode_reward_max": 505.0, "episode_reward_min": -155.0, "episode_reward_mean": 196.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [195.0, 125.0, 365.0, -30.0, 150.0, 275.0, 95.0, 275.0, 260.0, 405.0, 210.0, 115.0, 395.0, -15.0, 45.0, 115.0, 405.0, 130.0, 125.0, 405.0, -65.0, 245.0, 350.0, 115.0, 90.0, 310.0, 140.0, 385.0, 105.0, 375.0, 385.0, 400.0, 310.0, -140.0, 430.0, 230.0, 100.0, 45.0, 95.0, 450.0, 440.0, 170.0, 270.0, 345.0, 200.0, -50.0, 195.0, 315.0, 270.0, 170.0, 0.0, 150.0, 385.0, 25.0, 130.0, 20.0, 440.0, -100.0, 505.0, 135.0, 190.0, 260.0, 320.0, 130.0, -120.0, 285.0, 235.0, 465.0, 465.0, -50.0, 135.0, -35.0, 95.0, 340.0, 205.0, 65.0, 55.0, 195.0, 255.0, 80.0, 135.0, 385.0, 200.0, 100.0, 265.0, 200.0, 210.0, 445.0, 260.0, 335.0, 100.0, 255.0, 190.0, -40.0, -155.0, -50.0, 290.0, 260.0, 160.0, 145.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.145730699737005, "mean_inference_ms": 1.5260299431733777, "mean_action_processing_ms": 0.5619713203513865, "mean_env_wait_ms": 0.198463369428316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15686297416687012, "StateBufferConnector_ms": 0.006025075912475586, "ViewRequirementAgentConnector_ms": 0.31641340255737305}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3522560, "num_agent_steps_trained": 3522560, "num_env_steps_sampled": 704512, "num_env_steps_trained": 704512, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.13147352720009, "num_env_steps_trained_throughput_per_sec": 70.13147352720009, "timesteps_total": 704512, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3522560, "timers": {"training_iteration_time_ms": 116631.19, "sample_time_ms": 13851.726, "load_time_ms": 1.75, "load_throughput": 4681545.953, "learn_time_ms": 102768.634, "learn_throughput": 79.713, "synch_weights_time_ms": 3.12}, "counters": {"num_env_steps_sampled": 704512, "num_env_steps_trained": 704512, "num_agent_steps_sampled": 3522560, "num_agent_steps_trained": 3522560}, "done": false, "episodes_total": 5504, "training_iteration": 86, "trial_id": "9fade_00019", "date": "2023-11-09_22-29-42", "timestamp": 1699565382, "time_this_iter_s": 116.82473492622375, "time_total_s": 9145.085958480835, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9145.085958480835, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 37.25149700598802, "ram_util_percent": 18.918562874251496}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5903531661026912, "episode_optimality_min": -0.7560975609756098, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5903531661026912, "episode_optimality_capped_min": -0.7560975609756098, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.36, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5903531661026912, "curr_learning_score_min": -0.7560975609756098, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9860977340831111, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25261852462708095, "policy_loss": -0.07520621661070133, "vf_loss": 0.3121728623197608, "vf_explained_var": 0.4038481738480429, "kl": 0.015458645003599638, "entropy": 3.260613905216257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 830400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 712704, "num_env_steps_trained": 712704, "num_agent_steps_sampled": 3563520, "num_agent_steps_trained": 3563520}, "sampler_results": {"episode_reward_max": 540.0, "episode_reward_min": -195.0, "episode_reward_mean": 201.8, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5903531661026912, "episode_optimality_min": -0.7560975609756098, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5903531661026912, "episode_optimality_capped_min": -0.7560975609756098, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.36, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5903531661026912, "curr_learning_score_min": -0.7560975609756098, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-120.0, 285.0, 235.0, 465.0, 465.0, -50.0, 135.0, -35.0, 95.0, 340.0, 205.0, 65.0, 55.0, 195.0, 255.0, 80.0, 135.0, 385.0, 200.0, 100.0, 265.0, 200.0, 210.0, 445.0, 260.0, 335.0, 100.0, 255.0, 190.0, -40.0, -155.0, -50.0, 290.0, 260.0, 160.0, 145.0, 230.0, 240.0, 265.0, 175.0, 145.0, -135.0, 230.0, 225.0, 230.0, -30.0, 130.0, 310.0, 405.0, 145.0, 455.0, -40.0, -195.0, 315.0, -105.0, 380.0, 195.0, 415.0, 460.0, 400.0, 235.0, 120.0, 70.0, 275.0, 210.0, 235.0, 170.0, 155.0, 165.0, 260.0, 450.0, 405.0, 440.0, 100.0, 375.0, 320.0, 195.0, 295.0, 45.0, 220.0, 250.0, 540.0, 90.0, 160.0, 300.0, 300.0, 65.0, 20.0, 25.0, 300.0, 245.0, 355.0, 5.0, 345.0, 230.0, 375.0, 40.0, 255.0, 240.0, 95.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.145144744365391, "mean_inference_ms": 1.5249202702550753, "mean_action_processing_ms": 0.5616878152460161, "mean_env_wait_ms": 0.19828990382816528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15559625625610352, "StateBufferConnector_ms": 0.006009578704833984, "ViewRequirementAgentConnector_ms": 0.31400322914123535}}, "episode_reward_max": 540.0, "episode_reward_min": -195.0, "episode_reward_mean": 201.8, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-120.0, 285.0, 235.0, 465.0, 465.0, -50.0, 135.0, -35.0, 95.0, 340.0, 205.0, 65.0, 55.0, 195.0, 255.0, 80.0, 135.0, 385.0, 200.0, 100.0, 265.0, 200.0, 210.0, 445.0, 260.0, 335.0, 100.0, 255.0, 190.0, -40.0, -155.0, -50.0, 290.0, 260.0, 160.0, 145.0, 230.0, 240.0, 265.0, 175.0, 145.0, -135.0, 230.0, 225.0, 230.0, -30.0, 130.0, 310.0, 405.0, 145.0, 455.0, -40.0, -195.0, 315.0, -105.0, 380.0, 195.0, 415.0, 460.0, 400.0, 235.0, 120.0, 70.0, 275.0, 210.0, 235.0, 170.0, 155.0, 165.0, 260.0, 450.0, 405.0, 440.0, 100.0, 375.0, 320.0, 195.0, 295.0, 45.0, 220.0, 250.0, 540.0, 90.0, 160.0, 300.0, 300.0, 65.0, 20.0, 25.0, 300.0, 245.0, 355.0, 5.0, 345.0, 230.0, 375.0, 40.0, 255.0, 240.0, 95.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.145144744365391, "mean_inference_ms": 1.5249202702550753, "mean_action_processing_ms": 0.5616878152460161, "mean_env_wait_ms": 0.19828990382816528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15559625625610352, "StateBufferConnector_ms": 0.006009578704833984, "ViewRequirementAgentConnector_ms": 0.31400322914123535}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3563520, "num_agent_steps_trained": 3563520, "num_env_steps_sampled": 712704, "num_env_steps_trained": 712704, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.96057343519075, "num_env_steps_trained_throughput_per_sec": 70.96057343519075, "timesteps_total": 712704, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3563520, "timers": {"training_iteration_time_ms": 116439.853, "sample_time_ms": 13790.273, "load_time_ms": 1.712, "load_throughput": 4783946.419, "learn_time_ms": 102638.927, "learn_throughput": 79.814, "synch_weights_time_ms": 3.034}, "counters": {"num_env_steps_sampled": 712704, "num_env_steps_trained": 712704, "num_agent_steps_sampled": 3563520, "num_agent_steps_trained": 3563520}, "done": false, "episodes_total": 5568, "training_iteration": 87, "trial_id": "9fade_00019", "date": "2023-11-09_22-31-38", "timestamp": 1699565498, "time_this_iter_s": 115.45955491065979, "time_total_s": 9260.545513391495, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9260.545513391495, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 37.25393939393939, "ram_util_percent": 19.049696969696967}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5421239430371706, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5421239430371706, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.67, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5421239430371706, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9803507744676123, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2755105114050093, "policy_loss": -0.07454723215812313, "vf_loss": 0.3343104648616524, "vf_explained_var": 0.3523777646881839, "kl": 0.01555286716560128, "entropy": 3.2904183546205363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 840000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 720896, "num_env_steps_trained": 720896, "num_agent_steps_sampled": 3604480, "num_agent_steps_trained": 3604480}, "sampler_results": {"episode_reward_max": 545.0, "episode_reward_min": -250.0, "episode_reward_mean": 188.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5421239430371706, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5421239430371706, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.67, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5421239430371706, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [210.0, 235.0, 170.0, 155.0, 165.0, 260.0, 450.0, 405.0, 440.0, 100.0, 375.0, 320.0, 195.0, 295.0, 45.0, 220.0, 250.0, 540.0, 90.0, 160.0, 300.0, 300.0, 65.0, 20.0, 25.0, 300.0, 245.0, 355.0, 5.0, 345.0, 230.0, 375.0, 40.0, 255.0, 240.0, 95.0, 130.0, 65.0, -50.0, 345.0, -40.0, 545.0, 240.0, 115.0, -80.0, 355.0, 240.0, 110.0, -60.0, -195.0, 200.0, 405.0, 205.0, 270.0, 185.0, 170.0, 390.0, 30.0, 40.0, 65.0, 405.0, 250.0, 120.0, 330.0, 525.0, 515.0, -95.0, 340.0, -110.0, 335.0, -250.0, 340.0, 230.0, 125.0, 5.0, 220.0, 340.0, 0.0, 310.0, 400.0, -240.0, 85.0, 245.0, 430.0, 20.0, 35.0, 185.0, 145.0, -65.0, 235.0, 415.0, 25.0, -60.0, 380.0, 490.0, -190.0, 255.0, 65.0, 85.0, 5.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144754146656933, "mean_inference_ms": 1.5241575882528446, "mean_action_processing_ms": 0.561500186498158, "mean_env_wait_ms": 0.19817121303997343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1578524112701416, "StateBufferConnector_ms": 0.0060918331146240234, "ViewRequirementAgentConnector_ms": 0.31843090057373047}}, "episode_reward_max": 545.0, "episode_reward_min": -250.0, "episode_reward_mean": 188.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [210.0, 235.0, 170.0, 155.0, 165.0, 260.0, 450.0, 405.0, 440.0, 100.0, 375.0, 320.0, 195.0, 295.0, 45.0, 220.0, 250.0, 540.0, 90.0, 160.0, 300.0, 300.0, 65.0, 20.0, 25.0, 300.0, 245.0, 355.0, 5.0, 345.0, 230.0, 375.0, 40.0, 255.0, 240.0, 95.0, 130.0, 65.0, -50.0, 345.0, -40.0, 545.0, 240.0, 115.0, -80.0, 355.0, 240.0, 110.0, -60.0, -195.0, 200.0, 405.0, 205.0, 270.0, 185.0, 170.0, 390.0, 30.0, 40.0, 65.0, 405.0, 250.0, 120.0, 330.0, 525.0, 515.0, -95.0, 340.0, -110.0, 335.0, -250.0, 340.0, 230.0, 125.0, 5.0, 220.0, 340.0, 0.0, 310.0, 400.0, -240.0, 85.0, 245.0, 430.0, 20.0, 35.0, 185.0, 145.0, -65.0, 235.0, 415.0, 25.0, -60.0, 380.0, 490.0, -190.0, 255.0, 65.0, 85.0, 5.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144754146656933, "mean_inference_ms": 1.5241575882528446, "mean_action_processing_ms": 0.561500186498158, "mean_env_wait_ms": 0.19817121303997343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1578524112701416, "StateBufferConnector_ms": 0.0060918331146240234, "ViewRequirementAgentConnector_ms": 0.31843090057373047}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3604480, "num_agent_steps_trained": 3604480, "num_env_steps_sampled": 720896, "num_env_steps_trained": 720896, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.16800567886492, "num_env_steps_trained_throughput_per_sec": 70.16800567886492, "timesteps_total": 720896, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3604480, "timers": {"training_iteration_time_ms": 116672.562, "sample_time_ms": 13811.621, "load_time_ms": 1.666, "load_throughput": 4916118.922, "learn_time_ms": 102850.482, "learn_throughput": 79.65, "synch_weights_time_ms": 2.888}, "counters": {"num_env_steps_sampled": 720896, "num_env_steps_trained": 720896, "num_agent_steps_sampled": 3604480, "num_agent_steps_trained": 3604480}, "done": false, "episodes_total": 5632, "training_iteration": 88, "trial_id": "9fade_00019", "date": "2023-11-09_22-33-34", "timestamp": 1699565614, "time_this_iter_s": 116.76496601104736, "time_total_s": 9377.310479402542, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9377.310479402542, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 37.86566265060241, "ram_util_percent": 18.81566265060241}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5386667737938251, "episode_optimality_min": -0.7575757575757576, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5386667737938251, "episode_optimality_capped_min": -0.7575757575757576, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.58, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5386667737938251, "curr_learning_score_min": -0.7575757575757576, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9870548398901398, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2538890668217209, "policy_loss": -0.07665011654540042, "vf_loss": 0.31435316088690646, "vf_explained_var": 0.35991137019048136, "kl": 0.0159861945329439, "entropy": 3.245650328323245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 849600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 729088, "num_env_steps_trained": 729088, "num_agent_steps_sampled": 3645440, "num_agent_steps_trained": 3645440}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -250.0, "episode_reward_mean": 182.9, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5386667737938251, "episode_optimality_min": -0.7575757575757576, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5386667737938251, "episode_optimality_capped_min": -0.7575757575757576, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.58, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5386667737938251, "curr_learning_score_min": -0.7575757575757576, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [525.0, 515.0, -95.0, 340.0, -110.0, 335.0, -250.0, 340.0, 230.0, 125.0, 5.0, 220.0, 340.0, 0.0, 310.0, 400.0, -240.0, 85.0, 245.0, 430.0, 20.0, 35.0, 185.0, 145.0, -65.0, 235.0, 415.0, 25.0, -60.0, 380.0, 490.0, -190.0, 255.0, 65.0, 85.0, 5.0, 240.0, 150.0, 95.0, 205.0, 290.0, 270.0, 110.0, 75.0, 275.0, 380.0, 275.0, 430.0, 145.0, 540.0, 190.0, 150.0, 280.0, 215.0, 230.0, 460.0, 90.0, 200.0, -65.0, 355.0, 275.0, -90.0, 290.0, 360.0, 110.0, 505.0, 90.0, 295.0, 370.0, 85.0, -70.0, 420.0, 115.0, 580.0, 225.0, 120.0, 320.0, 65.0, 45.0, -165.0, -110.0, 285.0, 65.0, 140.0, -40.0, 0.0, 305.0, 310.0, 330.0, 30.0, 415.0, 155.0, 15.0, 410.0, 265.0, 265.0, 65.0, 125.0, -165.0, 120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144485050997086, "mean_inference_ms": 1.5240241465367246, "mean_action_processing_ms": 0.5613713773793496, "mean_env_wait_ms": 0.19809899354238983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15836453437805176, "StateBufferConnector_ms": 0.006218671798706055, "ViewRequirementAgentConnector_ms": 0.3242635726928711}}, "episode_reward_max": 580.0, "episode_reward_min": -250.0, "episode_reward_mean": 182.9, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [525.0, 515.0, -95.0, 340.0, -110.0, 335.0, -250.0, 340.0, 230.0, 125.0, 5.0, 220.0, 340.0, 0.0, 310.0, 400.0, -240.0, 85.0, 245.0, 430.0, 20.0, 35.0, 185.0, 145.0, -65.0, 235.0, 415.0, 25.0, -60.0, 380.0, 490.0, -190.0, 255.0, 65.0, 85.0, 5.0, 240.0, 150.0, 95.0, 205.0, 290.0, 270.0, 110.0, 75.0, 275.0, 380.0, 275.0, 430.0, 145.0, 540.0, 190.0, 150.0, 280.0, 215.0, 230.0, 460.0, 90.0, 200.0, -65.0, 355.0, 275.0, -90.0, 290.0, 360.0, 110.0, 505.0, 90.0, 295.0, 370.0, 85.0, -70.0, 420.0, 115.0, 580.0, 225.0, 120.0, 320.0, 65.0, 45.0, -165.0, -110.0, 285.0, 65.0, 140.0, -40.0, 0.0, 305.0, 310.0, 330.0, 30.0, 415.0, 155.0, 15.0, 410.0, 265.0, 265.0, 65.0, 125.0, -165.0, 120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144485050997086, "mean_inference_ms": 1.5240241465367246, "mean_action_processing_ms": 0.5613713773793496, "mean_env_wait_ms": 0.19809899354238983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15836453437805176, "StateBufferConnector_ms": 0.006218671798706055, "ViewRequirementAgentConnector_ms": 0.3242635726928711}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3645440, "num_agent_steps_trained": 3645440, "num_env_steps_sampled": 729088, "num_env_steps_trained": 729088, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.87258839437281, "num_env_steps_trained_throughput_per_sec": 69.87258839437281, "timesteps_total": 729088, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3645440, "timers": {"training_iteration_time_ms": 116771.005, "sample_time_ms": 13836.374, "load_time_ms": 1.649, "load_throughput": 4967433.623, "learn_time_ms": 102924.26, "learn_throughput": 79.593, "synch_weights_time_ms": 2.825}, "counters": {"num_env_steps_sampled": 729088, "num_env_steps_trained": 729088, "num_agent_steps_sampled": 3645440, "num_agent_steps_trained": 3645440}, "done": false, "episodes_total": 5696, "training_iteration": 89, "trial_id": "9fade_00019", "date": "2023-11-09_22-35-32", "timestamp": 1699565732, "time_this_iter_s": 117.25690221786499, "time_total_s": 9494.567381620407, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9494.567381620407, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 36.88682634730539, "ram_util_percent": 18.795808383233535}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5569920834335657, "episode_optimality_min": -0.78125, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5569920834335657, "episode_optimality_capped_min": -0.78125, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.0, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5569920834335657, "curr_learning_score_min": -0.78125, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.991647892119363, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.26132692405507746, "policy_loss": -0.07581945858818169, "vf_loss": 0.32102233485342974, "vf_explained_var": 0.36725521363938846, "kl": 0.01592498537896669, "entropy": 3.2434955116609734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 859200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 737280, "num_env_steps_trained": 737280, "num_agent_steps_sampled": 3686400, "num_agent_steps_trained": 3686400}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -250.0, "episode_reward_mean": 190.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5569920834335657, "episode_optimality_min": -0.78125, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5569920834335657, "episode_optimality_capped_min": -0.78125, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.0, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5569920834335657, "curr_learning_score_min": -0.78125, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [110.0, 505.0, 90.0, 295.0, 370.0, 85.0, -70.0, 420.0, 115.0, 580.0, 225.0, 120.0, 320.0, 65.0, 45.0, -165.0, -110.0, 285.0, 65.0, 140.0, -40.0, 0.0, 305.0, 310.0, 330.0, 30.0, 415.0, 155.0, 15.0, 410.0, 265.0, 265.0, 65.0, 125.0, -165.0, 120.0, 195.0, 445.0, 185.0, -35.0, 220.0, 295.0, 295.0, -250.0, 120.0, 145.0, 585.0, 265.0, 50.0, 120.0, -135.0, 280.0, 235.0, 170.0, 40.0, 240.0, 45.0, 155.0, 350.0, 40.0, 170.0, 200.0, 255.0, 415.0, 315.0, 25.0, 230.0, 75.0, 120.0, 375.0, 105.0, 330.0, 285.0, 170.0, 155.0, 220.0, -40.0, 10.0, 435.0, -125.0, 330.0, 295.0, 160.0, 390.0, 120.0, 315.0, 280.0, 530.0, 435.0, 130.0, 355.0, 225.0, 10.0, 230.0, 70.0, 280.0, 320.0, 210.0, 125.0, 315.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1442082325977918, "mean_inference_ms": 1.5236648483974908, "mean_action_processing_ms": 0.5612348356828367, "mean_env_wait_ms": 0.19801388720454172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15883255004882812, "StateBufferConnector_ms": 0.006238698959350586, "ViewRequirementAgentConnector_ms": 0.32286810874938965}}, "episode_reward_max": 585.0, "episode_reward_min": -250.0, "episode_reward_mean": 190.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [110.0, 505.0, 90.0, 295.0, 370.0, 85.0, -70.0, 420.0, 115.0, 580.0, 225.0, 120.0, 320.0, 65.0, 45.0, -165.0, -110.0, 285.0, 65.0, 140.0, -40.0, 0.0, 305.0, 310.0, 330.0, 30.0, 415.0, 155.0, 15.0, 410.0, 265.0, 265.0, 65.0, 125.0, -165.0, 120.0, 195.0, 445.0, 185.0, -35.0, 220.0, 295.0, 295.0, -250.0, 120.0, 145.0, 585.0, 265.0, 50.0, 120.0, -135.0, 280.0, 235.0, 170.0, 40.0, 240.0, 45.0, 155.0, 350.0, 40.0, 170.0, 200.0, 255.0, 415.0, 315.0, 25.0, 230.0, 75.0, 120.0, 375.0, 105.0, 330.0, 285.0, 170.0, 155.0, 220.0, -40.0, 10.0, 435.0, -125.0, 330.0, 295.0, 160.0, 390.0, 120.0, 315.0, 280.0, 530.0, 435.0, 130.0, 355.0, 225.0, 10.0, 230.0, 70.0, 280.0, 320.0, 210.0, 125.0, 315.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1442082325977918, "mean_inference_ms": 1.5236648483974908, "mean_action_processing_ms": 0.5612348356828367, "mean_env_wait_ms": 0.19801388720454172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15883255004882812, "StateBufferConnector_ms": 0.006238698959350586, "ViewRequirementAgentConnector_ms": 0.32286810874938965}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3686400, "num_agent_steps_trained": 3686400, "num_env_steps_sampled": 737280, "num_env_steps_trained": 737280, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.17942165522852, "num_env_steps_trained_throughput_per_sec": 69.17942165522852, "timesteps_total": 737280, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3686400, "timers": {"training_iteration_time_ms": 116955.187, "sample_time_ms": 13874.628, "load_time_ms": 1.645, "load_throughput": 4978878.493, "learn_time_ms": 103070.079, "learn_throughput": 79.48, "synch_weights_time_ms": 2.828}, "counters": {"num_env_steps_sampled": 737280, "num_env_steps_trained": 737280, "num_agent_steps_sampled": 3686400, "num_agent_steps_trained": 3686400}, "done": false, "episodes_total": 5760, "training_iteration": 90, "trial_id": "9fade_00019", "date": "2023-11-09_22-37-30", "timestamp": 1699565850, "time_this_iter_s": 118.43220925331116, "time_total_s": 9612.999590873718, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9612.999590873718, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 37.65739644970414, "ram_util_percent": 18.70887573964497}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6380240086791946, "episode_optimality_min": -0.828125, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6380240086791946, "episode_optimality_capped_min": -0.828125, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.88, "episode_reward_normalized_min": -53.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6380240086791946, "curr_learning_score_min": -0.828125, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9759586208406836, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23192001517216945, "policy_loss": -0.0716324567184832, "vf_loss": 0.2884317637591266, "vf_explained_var": 0.4131061440085371, "kl": 0.014934032079227487, "entropy": 3.2247250713407993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 868800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 745472, "num_env_steps_trained": 745472, "num_agent_steps_sampled": 3727360, "num_agent_steps_trained": 3727360}, "sampler_results": {"episode_reward_max": 555.0, "episode_reward_min": -265.0, "episode_reward_mean": 214.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6380240086791946, "episode_optimality_min": -0.828125, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6380240086791946, "episode_optimality_capped_min": -0.828125, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.88, "episode_reward_normalized_min": -53.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6380240086791946, "curr_learning_score_min": -0.828125, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [315.0, 25.0, 230.0, 75.0, 120.0, 375.0, 105.0, 330.0, 285.0, 170.0, 155.0, 220.0, -40.0, 10.0, 435.0, -125.0, 330.0, 295.0, 160.0, 390.0, 120.0, 315.0, 280.0, 530.0, 435.0, 130.0, 355.0, 225.0, 10.0, 230.0, 70.0, 280.0, 320.0, 210.0, 125.0, 315.0, 165.0, 220.0, 290.0, 125.0, 485.0, 545.0, 110.0, 90.0, 200.0, 150.0, -90.0, 410.0, 285.0, 95.0, 130.0, 150.0, 480.0, 135.0, 320.0, 260.0, 140.0, 0.0, 555.0, 335.0, 175.0, 210.0, 110.0, 140.0, 380.0, 310.0, 305.0, 370.0, 405.0, 155.0, 240.0, 435.0, 130.0, 165.0, 150.0, 200.0, 180.0, 5.0, 350.0, 125.0, 430.0, -265.0, 490.0, 230.0, 535.0, 50.0, 225.0, 205.0, 100.0, 5.0, -15.0, 10.0, 405.0, 345.0, 190.0, 25.0, 20.0, 45.0, 285.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1441188587865903, "mean_inference_ms": 1.523474679745733, "mean_action_processing_ms": 0.5611880382926375, "mean_env_wait_ms": 0.19796284465657663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1619570255279541, "StateBufferConnector_ms": 0.006262540817260742, "ViewRequirementAgentConnector_ms": 0.3266565799713135}}, "episode_reward_max": 555.0, "episode_reward_min": -265.0, "episode_reward_mean": 214.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [315.0, 25.0, 230.0, 75.0, 120.0, 375.0, 105.0, 330.0, 285.0, 170.0, 155.0, 220.0, -40.0, 10.0, 435.0, -125.0, 330.0, 295.0, 160.0, 390.0, 120.0, 315.0, 280.0, 530.0, 435.0, 130.0, 355.0, 225.0, 10.0, 230.0, 70.0, 280.0, 320.0, 210.0, 125.0, 315.0, 165.0, 220.0, 290.0, 125.0, 485.0, 545.0, 110.0, 90.0, 200.0, 150.0, -90.0, 410.0, 285.0, 95.0, 130.0, 150.0, 480.0, 135.0, 320.0, 260.0, 140.0, 0.0, 555.0, 335.0, 175.0, 210.0, 110.0, 140.0, 380.0, 310.0, 305.0, 370.0, 405.0, 155.0, 240.0, 435.0, 130.0, 165.0, 150.0, 200.0, 180.0, 5.0, 350.0, 125.0, 430.0, -265.0, 490.0, 230.0, 535.0, 50.0, 225.0, 205.0, 100.0, 5.0, -15.0, 10.0, 405.0, 345.0, 190.0, 25.0, 20.0, 45.0, 285.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1441188587865903, "mean_inference_ms": 1.523474679745733, "mean_action_processing_ms": 0.5611880382926375, "mean_env_wait_ms": 0.19796284465657663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1619570255279541, "StateBufferConnector_ms": 0.006262540817260742, "ViewRequirementAgentConnector_ms": 0.3266565799713135}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3727360, "num_agent_steps_trained": 3727360, "num_env_steps_sampled": 745472, "num_env_steps_trained": 745472, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.3034271736138, "num_env_steps_trained_throughput_per_sec": 68.3034271736138, "timesteps_total": 745472, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3727360, "timers": {"training_iteration_time_ms": 117363.544, "sample_time_ms": 13953.339, "load_time_ms": 1.652, "load_throughput": 4958401.404, "learn_time_ms": 103399.734, "learn_throughput": 79.227, "synch_weights_time_ms": 2.732}, "counters": {"num_env_steps_sampled": 745472, "num_env_steps_trained": 745472, "num_agent_steps_sampled": 3727360, "num_agent_steps_trained": 3727360}, "done": false, "episodes_total": 5824, "training_iteration": 91, "trial_id": "9fade_00019", "date": "2023-11-09_22-39-30", "timestamp": 1699565970, "time_this_iter_s": 119.95113778114319, "time_total_s": 9732.950728654861, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9732.950728654861, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 38.17017543859649, "ram_util_percent": 18.514035087719297}, "checkpoint_dir_name": "checkpoint_000003"}
{"custom_metrics": {"episode_optimality_mean": 0.5771517419778142, "episode_optimality_min": -0.828125, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5771517419778142, "episode_optimality_capped_min": -0.828125, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.19, "episode_reward_normalized_min": -53.0, "episode_reward_normalized_max": 115.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5771517419778142, "curr_learning_score_min": -0.828125, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9697010361030698, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23989383569688166, "policy_loss": -0.07266870568722274, "vf_loss": 0.29761708310489365, "vf_explained_var": 0.3914264884715279, "kl": 0.014760945200008091, "entropy": 3.229083270604412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 878400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 753664, "num_env_steps_trained": 753664, "num_agent_steps_sampled": 3768320, "num_agent_steps_trained": 3768320}, "sampler_results": {"episode_reward_max": 575.0, "episode_reward_min": -265.0, "episode_reward_mean": 195.95, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5771517419778142, "episode_optimality_min": -0.828125, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5771517419778142, "episode_optimality_capped_min": -0.828125, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.19, "episode_reward_normalized_min": -53.0, "episode_reward_normalized_max": 115.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5771517419778142, "curr_learning_score_min": -0.828125, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [380.0, 310.0, 305.0, 370.0, 405.0, 155.0, 240.0, 435.0, 130.0, 165.0, 150.0, 200.0, 180.0, 5.0, 350.0, 125.0, 430.0, -265.0, 490.0, 230.0, 535.0, 50.0, 225.0, 205.0, 100.0, 5.0, -15.0, 10.0, 405.0, 345.0, 190.0, 25.0, 20.0, 45.0, 285.0, 190.0, 5.0, 35.0, 20.0, -40.0, 575.0, 280.0, 305.0, 35.0, 500.0, 155.0, 10.0, 170.0, 420.0, 340.0, 15.0, -195.0, 345.0, 385.0, -190.0, 240.0, 345.0, -15.0, 245.0, 425.0, 305.0, 340.0, 405.0, 235.0, 315.0, 155.0, 80.0, 310.0, 175.0, 375.0, 315.0, 10.0, 210.0, 210.0, 205.0, -30.0, 5.0, 130.0, 405.0, 85.0, 455.0, 65.0, -150.0, 515.0, 150.0, 5.0, 295.0, 365.0, 185.0, 110.0, 65.0, 430.0, 105.0, 20.0, 365.0, 95.0, 120.0, -10.0, 175.0, 175.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144025238139678, "mean_inference_ms": 1.5234714816314716, "mean_action_processing_ms": 0.5611364561562892, "mean_env_wait_ms": 0.19793798481864705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16108489036560059, "StateBufferConnector_ms": 0.006315946578979492, "ViewRequirementAgentConnector_ms": 0.3286120891571045}}, "episode_reward_max": 575.0, "episode_reward_min": -265.0, "episode_reward_mean": 195.95, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [380.0, 310.0, 305.0, 370.0, 405.0, 155.0, 240.0, 435.0, 130.0, 165.0, 150.0, 200.0, 180.0, 5.0, 350.0, 125.0, 430.0, -265.0, 490.0, 230.0, 535.0, 50.0, 225.0, 205.0, 100.0, 5.0, -15.0, 10.0, 405.0, 345.0, 190.0, 25.0, 20.0, 45.0, 285.0, 190.0, 5.0, 35.0, 20.0, -40.0, 575.0, 280.0, 305.0, 35.0, 500.0, 155.0, 10.0, 170.0, 420.0, 340.0, 15.0, -195.0, 345.0, 385.0, -190.0, 240.0, 345.0, -15.0, 245.0, 425.0, 305.0, 340.0, 405.0, 235.0, 315.0, 155.0, 80.0, 310.0, 175.0, 375.0, 315.0, 10.0, 210.0, 210.0, 205.0, -30.0, 5.0, 130.0, 405.0, 85.0, 455.0, 65.0, -150.0, 515.0, 150.0, 5.0, 295.0, 365.0, 185.0, 110.0, 65.0, 430.0, 105.0, 20.0, 365.0, 95.0, 120.0, -10.0, 175.0, 175.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.144025238139678, "mean_inference_ms": 1.5234714816314716, "mean_action_processing_ms": 0.5611364561562892, "mean_env_wait_ms": 0.19793798481864705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16108489036560059, "StateBufferConnector_ms": 0.006315946578979492, "ViewRequirementAgentConnector_ms": 0.3286120891571045}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3768320, "num_agent_steps_trained": 3768320, "num_env_steps_sampled": 753664, "num_env_steps_trained": 753664, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.6103021022065, "num_env_steps_trained_throughput_per_sec": 68.6103021022065, "timesteps_total": 753664, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3768320, "timers": {"training_iteration_time_ms": 117629.257, "sample_time_ms": 13971.968, "load_time_ms": 1.684, "load_throughput": 4863924.913, "learn_time_ms": 103646.705, "learn_throughput": 79.038, "synch_weights_time_ms": 2.796}, "counters": {"num_env_steps_sampled": 753664, "num_env_steps_trained": 753664, "num_agent_steps_sampled": 3768320, "num_agent_steps_trained": 3768320}, "done": false, "episodes_total": 5888, "training_iteration": 92, "trial_id": "9fade_00019", "date": "2023-11-09_22-41-30", "timestamp": 1699566090, "time_this_iter_s": 119.41537022590637, "time_total_s": 9852.366098880768, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9852.366098880768, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 38.02058823529412, "ram_util_percent": 18.629411764705885}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5448995200582984, "episode_optimality_min": -0.7246376811594203, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5448995200582984, "episode_optimality_capped_min": -0.7246376811594203, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 35.52, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5448995200582984, "curr_learning_score_min": -0.7246376811594203, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9818255534892281, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2935179939486989, "policy_loss": -0.07860114346515426, "vf_loss": 0.35577828343187623, "vf_explained_var": 0.3655449335711698, "kl": 0.016139114191426718, "entropy": 3.212625122939547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 888000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 761856, "num_env_steps_trained": 761856, "num_agent_steps_sampled": 3809280, "num_agent_steps_trained": 3809280}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -250.0, "episode_reward_mean": 177.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5448995200582984, "episode_optimality_min": -0.7246376811594203, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5448995200582984, "episode_optimality_capped_min": -0.7246376811594203, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 35.52, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5448995200582984, "curr_learning_score_min": -0.7246376811594203, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [315.0, 155.0, 80.0, 310.0, 175.0, 375.0, 315.0, 10.0, 210.0, 210.0, 205.0, -30.0, 5.0, 130.0, 405.0, 85.0, 455.0, 65.0, -150.0, 515.0, 150.0, 5.0, 295.0, 365.0, 185.0, 110.0, 65.0, 430.0, 105.0, 20.0, 365.0, 95.0, 120.0, -10.0, 175.0, 175.0, 410.0, 310.0, 330.0, -50.0, -75.0, 135.0, -40.0, 585.0, 280.0, 325.0, 210.0, 170.0, 250.0, -170.0, 320.0, 105.0, 355.0, -250.0, 110.0, 130.0, 280.0, -230.0, 400.0, 160.0, 470.0, 125.0, 110.0, -15.0, -130.0, 355.0, 275.0, 105.0, 125.0, -60.0, -35.0, 410.0, 75.0, 380.0, 190.0, 225.0, 65.0, 140.0, 255.0, 165.0, 375.0, 350.0, 115.0, 95.0, 225.0, 100.0, 25.0, 305.0, 120.0, 105.0, 340.0, 300.0, 190.0, 150.0, 215.0, 185.0, 155.0, 265.0, 145.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1439146340059958, "mean_inference_ms": 1.5233237366766679, "mean_action_processing_ms": 0.5610811655482626, "mean_env_wait_ms": 0.19790282910983956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16206574440002441, "StateBufferConnector_ms": 0.0062923431396484375, "ViewRequirementAgentConnector_ms": 0.32799744606018066}}, "episode_reward_max": 585.0, "episode_reward_min": -250.0, "episode_reward_mean": 177.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [315.0, 155.0, 80.0, 310.0, 175.0, 375.0, 315.0, 10.0, 210.0, 210.0, 205.0, -30.0, 5.0, 130.0, 405.0, 85.0, 455.0, 65.0, -150.0, 515.0, 150.0, 5.0, 295.0, 365.0, 185.0, 110.0, 65.0, 430.0, 105.0, 20.0, 365.0, 95.0, 120.0, -10.0, 175.0, 175.0, 410.0, 310.0, 330.0, -50.0, -75.0, 135.0, -40.0, 585.0, 280.0, 325.0, 210.0, 170.0, 250.0, -170.0, 320.0, 105.0, 355.0, -250.0, 110.0, 130.0, 280.0, -230.0, 400.0, 160.0, 470.0, 125.0, 110.0, -15.0, -130.0, 355.0, 275.0, 105.0, 125.0, -60.0, -35.0, 410.0, 75.0, 380.0, 190.0, 225.0, 65.0, 140.0, 255.0, 165.0, 375.0, 350.0, 115.0, 95.0, 225.0, 100.0, 25.0, 305.0, 120.0, 105.0, 340.0, 300.0, 190.0, 150.0, 215.0, 185.0, 155.0, 265.0, 145.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1439146340059958, "mean_inference_ms": 1.5233237366766679, "mean_action_processing_ms": 0.5610811655482626, "mean_env_wait_ms": 0.19790282910983956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16206574440002441, "StateBufferConnector_ms": 0.0062923431396484375, "ViewRequirementAgentConnector_ms": 0.32799744606018066}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3809280, "num_agent_steps_trained": 3809280, "num_env_steps_sampled": 761856, "num_env_steps_trained": 761856, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.29566742542617, "num_env_steps_trained_throughput_per_sec": 68.29566742542617, "timesteps_total": 761856, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3809280, "timers": {"training_iteration_time_ms": 117901.842, "sample_time_ms": 13976.98, "load_time_ms": 1.807, "load_throughput": 4533784.389, "learn_time_ms": 103914.115, "learn_throughput": 78.834, "synch_weights_time_ms": 2.798}, "counters": {"num_env_steps_sampled": 761856, "num_env_steps_trained": 761856, "num_agent_steps_sampled": 3809280, "num_agent_steps_trained": 3809280}, "done": false, "episodes_total": 5952, "training_iteration": 93, "trial_id": "9fade_00019", "date": "2023-11-09_22-43-32", "timestamp": 1699566212, "time_this_iter_s": 119.96389555931091, "time_total_s": 9972.329994440079, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9972.329994440079, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 37.35287356321839, "ram_util_percent": 18.862643678160918}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5620509692858823, "episode_optimality_min": -0.7534246575342466, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5620509692858823, "episode_optimality_capped_min": -0.7534246575342466, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.02, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5620509692858823, "curr_learning_score_min": -0.7534246575342466, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9844349334218229, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2411919988561082, "policy_loss": -0.07237023389912793, "vf_loss": 0.2982213280079789, "vf_explained_var": 0.3732308492747446, "kl": 0.01515151055860277, "entropy": 3.228537616779407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 897600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 770048, "num_env_steps_trained": 770048, "num_agent_steps_sampled": 3850240, "num_agent_steps_trained": 3850240}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -275.0, "episode_reward_mean": 190.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5620509692858823, "episode_optimality_min": -0.7534246575342466, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5620509692858823, "episode_optimality_capped_min": -0.7534246575342466, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.02, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5620509692858823, "curr_learning_score_min": -0.7534246575342466, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-130.0, 355.0, 275.0, 105.0, 125.0, -60.0, -35.0, 410.0, 75.0, 380.0, 190.0, 225.0, 65.0, 140.0, 255.0, 165.0, 375.0, 350.0, 115.0, 95.0, 225.0, 100.0, 25.0, 305.0, 120.0, 105.0, 340.0, 300.0, 190.0, 150.0, 215.0, 185.0, 155.0, 265.0, 145.0, 230.0, 345.0, -40.0, 10.0, 320.0, 90.0, 65.0, 295.0, 325.0, 535.0, 540.0, 500.0, -10.0, 180.0, 355.0, 65.0, 165.0, 225.0, 365.0, 85.0, 175.0, -45.0, -95.0, 170.0, -20.0, 65.0, 60.0, 240.0, 355.0, 200.0, -105.0, 95.0, -275.0, 240.0, 125.0, 150.0, 90.0, 60.0, 70.0, 305.0, 150.0, 110.0, 350.0, 220.0, 600.0, 105.0, 345.0, 80.0, 380.0, 20.0, 460.0, 295.0, 110.0, -15.0, 420.0, 300.0, 315.0, 550.0, 220.0, 10.0, 190.0, 180.0, 85.0, 390.0, 335.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.143586733831062, "mean_inference_ms": 1.52274523196298, "mean_action_processing_ms": 0.560927764120128, "mean_env_wait_ms": 0.19777858818034072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15791678428649902, "StateBufferConnector_ms": 0.006085872650146484, "ViewRequirementAgentConnector_ms": 0.3169245719909668}}, "episode_reward_max": 600.0, "episode_reward_min": -275.0, "episode_reward_mean": 190.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-130.0, 355.0, 275.0, 105.0, 125.0, -60.0, -35.0, 410.0, 75.0, 380.0, 190.0, 225.0, 65.0, 140.0, 255.0, 165.0, 375.0, 350.0, 115.0, 95.0, 225.0, 100.0, 25.0, 305.0, 120.0, 105.0, 340.0, 300.0, 190.0, 150.0, 215.0, 185.0, 155.0, 265.0, 145.0, 230.0, 345.0, -40.0, 10.0, 320.0, 90.0, 65.0, 295.0, 325.0, 535.0, 540.0, 500.0, -10.0, 180.0, 355.0, 65.0, 165.0, 225.0, 365.0, 85.0, 175.0, -45.0, -95.0, 170.0, -20.0, 65.0, 60.0, 240.0, 355.0, 200.0, -105.0, 95.0, -275.0, 240.0, 125.0, 150.0, 90.0, 60.0, 70.0, 305.0, 150.0, 110.0, 350.0, 220.0, 600.0, 105.0, 345.0, 80.0, 380.0, 20.0, 460.0, 295.0, 110.0, -15.0, 420.0, 300.0, 315.0, 550.0, 220.0, 10.0, 190.0, 180.0, 85.0, 390.0, 335.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.143586733831062, "mean_inference_ms": 1.52274523196298, "mean_action_processing_ms": 0.560927764120128, "mean_env_wait_ms": 0.19777858818034072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15791678428649902, "StateBufferConnector_ms": 0.006085872650146484, "ViewRequirementAgentConnector_ms": 0.3169245719909668}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3850240, "num_agent_steps_trained": 3850240, "num_env_steps_sampled": 770048, "num_env_steps_trained": 770048, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.15236590577753, "num_env_steps_trained_throughput_per_sec": 68.15236590577753, "timesteps_total": 770048, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3850240, "timers": {"training_iteration_time_ms": 118216.483, "sample_time_ms": 14012.432, "load_time_ms": 1.795, "load_throughput": 4562743.293, "learn_time_ms": 104193.302, "learn_throughput": 78.623, "synch_weights_time_ms": 2.831}, "counters": {"num_env_steps_sampled": 770048, "num_env_steps_trained": 770048, "num_agent_steps_sampled": 3850240, "num_agent_steps_trained": 3850240}, "done": false, "episodes_total": 6016, "training_iteration": 94, "trial_id": "9fade_00019", "date": "2023-11-09_22-45-32", "timestamp": 1699566332, "time_this_iter_s": 120.21795082092285, "time_total_s": 10092.547945261002, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10092.547945261002, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 37.365497076023395, "ram_util_percent": 18.738596491228073}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5421051539565731, "episode_optimality_min": -0.8222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5421051539565731, "episode_optimality_capped_min": -0.8222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.95, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5421051539565731, "curr_learning_score_min": -0.8222222222222222, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9884065514865021, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2759112317475956, "policy_loss": -0.0745796936149903, "vf_loss": 0.3346137223735665, "vf_explained_var": 0.37151021377493937, "kl": 0.015681187288894685, "entropy": 3.2307856419930854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 907200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 778240, "num_env_steps_trained": 778240, "num_agent_steps_sampled": 3891200, "num_agent_steps_trained": 3891200}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -275.0, "episode_reward_mean": 189.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5421051539565731, "episode_optimality_min": -0.8222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5421051539565731, "episode_optimality_capped_min": -0.8222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.95, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5421051539565731, "curr_learning_score_min": -0.8222222222222222, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [200.0, -105.0, 95.0, -275.0, 240.0, 125.0, 150.0, 90.0, 60.0, 70.0, 305.0, 150.0, 110.0, 350.0, 220.0, 600.0, 105.0, 345.0, 80.0, 380.0, 20.0, 460.0, 295.0, 110.0, -15.0, 420.0, 300.0, 315.0, 550.0, 220.0, 10.0, 190.0, 180.0, 85.0, 390.0, 335.0, -90.0, 250.0, 335.0, 255.0, -30.0, 310.0, 90.0, 205.0, 280.0, 150.0, 210.0, 570.0, 310.0, 235.0, 55.0, 220.0, 250.0, 110.0, 260.0, 120.0, 135.0, 195.0, 290.0, 165.0, 215.0, 270.0, 70.0, 220.0, 0.0, -115.0, 250.0, 125.0, -185.0, 25.0, 165.0, 195.0, 340.0, 110.0, 165.0, 395.0, 275.0, 210.0, 260.0, 65.0, -240.0, -25.0, 270.0, -85.0, 375.0, 210.0, 90.0, -30.0, 135.0, 385.0, 320.0, 430.0, 280.0, 510.0, 340.0, 275.0, 180.0, 155.0, 295.0, 10.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.143395273654181, "mean_inference_ms": 1.5227236587576443, "mean_action_processing_ms": 0.5608259016006069, "mean_env_wait_ms": 0.1977441838956087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15824365615844727, "StateBufferConnector_ms": 0.00623631477355957, "ViewRequirementAgentConnector_ms": 0.32441091537475586}}, "episode_reward_max": 600.0, "episode_reward_min": -275.0, "episode_reward_mean": 189.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [200.0, -105.0, 95.0, -275.0, 240.0, 125.0, 150.0, 90.0, 60.0, 70.0, 305.0, 150.0, 110.0, 350.0, 220.0, 600.0, 105.0, 345.0, 80.0, 380.0, 20.0, 460.0, 295.0, 110.0, -15.0, 420.0, 300.0, 315.0, 550.0, 220.0, 10.0, 190.0, 180.0, 85.0, 390.0, 335.0, -90.0, 250.0, 335.0, 255.0, -30.0, 310.0, 90.0, 205.0, 280.0, 150.0, 210.0, 570.0, 310.0, 235.0, 55.0, 220.0, 250.0, 110.0, 260.0, 120.0, 135.0, 195.0, 290.0, 165.0, 215.0, 270.0, 70.0, 220.0, 0.0, -115.0, 250.0, 125.0, -185.0, 25.0, 165.0, 195.0, 340.0, 110.0, 165.0, 395.0, 275.0, 210.0, 260.0, 65.0, -240.0, -25.0, 270.0, -85.0, 375.0, 210.0, 90.0, -30.0, 135.0, 385.0, 320.0, 430.0, 280.0, 510.0, 340.0, 275.0, 180.0, 155.0, 295.0, 10.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.143395273654181, "mean_inference_ms": 1.5227236587576443, "mean_action_processing_ms": 0.5608259016006069, "mean_env_wait_ms": 0.1977441838956087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15824365615844727, "StateBufferConnector_ms": 0.00623631477355957, "ViewRequirementAgentConnector_ms": 0.32441091537475586}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3891200, "num_agent_steps_trained": 3891200, "num_env_steps_sampled": 778240, "num_env_steps_trained": 778240, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.95844114269215, "num_env_steps_trained_throughput_per_sec": 67.95844114269215, "timesteps_total": 778240, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3891200, "timers": {"training_iteration_time_ms": 118468.935, "sample_time_ms": 14054.335, "load_time_ms": 1.796, "load_throughput": 4561652.93, "learn_time_ms": 104403.818, "learn_throughput": 78.465, "synch_weights_time_ms": 2.829}, "counters": {"num_env_steps_sampled": 778240, "num_env_steps_trained": 778240, "num_agent_steps_sampled": 3891200, "num_agent_steps_trained": 3891200}, "done": false, "episodes_total": 6080, "training_iteration": 95, "trial_id": "9fade_00019", "date": "2023-11-09_22-47-32", "timestamp": 1699566452, "time_this_iter_s": 120.55949807167053, "time_total_s": 10213.107443332672, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10213.107443332672, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 38.236046511627904, "ram_util_percent": 18.70290697674419}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5587230444886528, "episode_optimality_min": -0.8222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5587230444886528, "episode_optimality_capped_min": -0.8222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.06, "episode_reward_normalized_min": -66.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5587230444886528, "curr_learning_score_min": -0.8222222222222222, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9844423220679164, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.250299766092891, "policy_loss": -0.0735855998636786, "vf_loss": 0.3084885299966845, "vf_explained_var": 0.38228408752009274, "kl": 0.015206750826499728, "entropy": 3.2173542337616285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 916800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 786432, "num_env_steps_trained": 786432, "num_agent_steps_sampled": 3932160, "num_agent_steps_trained": 3932160}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -330.0, "episode_reward_mean": 190.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5587230444886528, "episode_optimality_min": -0.8222222222222222, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5587230444886528, "episode_optimality_capped_min": -0.8222222222222222, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.06, "episode_reward_normalized_min": -66.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5587230444886528, "curr_learning_score_min": -0.8222222222222222, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [0.0, -115.0, 250.0, 125.0, -185.0, 25.0, 165.0, 195.0, 340.0, 110.0, 165.0, 395.0, 275.0, 210.0, 260.0, 65.0, -240.0, -25.0, 270.0, -85.0, 375.0, 210.0, 90.0, -30.0, 135.0, 385.0, 320.0, 430.0, 280.0, 510.0, 340.0, 275.0, 180.0, 155.0, 295.0, 10.0, 290.0, 95.0, 360.0, 260.0, 195.0, 160.0, 90.0, -150.0, 230.0, 515.0, -330.0, 380.0, 275.0, 200.0, 450.0, -15.0, 180.0, 525.0, -45.0, 275.0, -45.0, 140.0, 310.0, 280.0, 140.0, 505.0, 215.0, 210.0, 180.0, 90.0, -40.0, 100.0, 370.0, 240.0, 395.0, 195.0, 75.0, 150.0, 395.0, 125.0, -75.0, 355.0, -20.0, 280.0, 30.0, 345.0, 220.0, 320.0, 245.0, 580.0, 170.0, 340.0, 80.0, 150.0, 255.0, 250.0, 110.0, 340.0, 155.0, 45.0, 25.0, 155.0, 445.0, 100.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.143140095592304, "mean_inference_ms": 1.5221321975341733, "mean_action_processing_ms": 0.5606898673767319, "mean_env_wait_ms": 0.19765077298461642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15944647789001465, "StateBufferConnector_ms": 0.006181240081787109, "ViewRequirementAgentConnector_ms": 0.31936097145080566}}, "episode_reward_max": 580.0, "episode_reward_min": -330.0, "episode_reward_mean": 190.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.0, -115.0, 250.0, 125.0, -185.0, 25.0, 165.0, 195.0, 340.0, 110.0, 165.0, 395.0, 275.0, 210.0, 260.0, 65.0, -240.0, -25.0, 270.0, -85.0, 375.0, 210.0, 90.0, -30.0, 135.0, 385.0, 320.0, 430.0, 280.0, 510.0, 340.0, 275.0, 180.0, 155.0, 295.0, 10.0, 290.0, 95.0, 360.0, 260.0, 195.0, 160.0, 90.0, -150.0, 230.0, 515.0, -330.0, 380.0, 275.0, 200.0, 450.0, -15.0, 180.0, 525.0, -45.0, 275.0, -45.0, 140.0, 310.0, 280.0, 140.0, 505.0, 215.0, 210.0, 180.0, 90.0, -40.0, 100.0, 370.0, 240.0, 395.0, 195.0, 75.0, 150.0, 395.0, 125.0, -75.0, 355.0, -20.0, 280.0, 30.0, 345.0, 220.0, 320.0, 245.0, 580.0, 170.0, 340.0, 80.0, 150.0, 255.0, 250.0, 110.0, 340.0, 155.0, 45.0, 25.0, 155.0, 445.0, 100.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.143140095592304, "mean_inference_ms": 1.5221321975341733, "mean_action_processing_ms": 0.5606898673767319, "mean_env_wait_ms": 0.19765077298461642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15944647789001465, "StateBufferConnector_ms": 0.006181240081787109, "ViewRequirementAgentConnector_ms": 0.31936097145080566}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3932160, "num_agent_steps_trained": 3932160, "num_env_steps_sampled": 786432, "num_env_steps_trained": 786432, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.55872120633748, "num_env_steps_trained_throughput_per_sec": 68.55872120633748, "timesteps_total": 786432, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3932160, "timers": {"training_iteration_time_ms": 118736.898, "sample_time_ms": 14099.296, "load_time_ms": 1.719, "load_throughput": 4765104.41, "learn_time_ms": 104626.916, "learn_throughput": 78.297, "synch_weights_time_ms": 2.81}, "counters": {"num_env_steps_sampled": 786432, "num_env_steps_trained": 786432, "num_agent_steps_sampled": 3932160, "num_agent_steps_trained": 3932160}, "done": false, "episodes_total": 6144, "training_iteration": 96, "trial_id": "9fade_00019", "date": "2023-11-09_22-49-32", "timestamp": 1699566572, "time_this_iter_s": 119.50199580192566, "time_total_s": 10332.609439134598, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10332.609439134598, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 37.53823529411765, "ram_util_percent": 18.640588235294114}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.580445767690378, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.580445767690378, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.94, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.580445767690378, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9807560088547568, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2586900242530101, "policy_loss": -0.0767586960003003, "vf_loss": 0.31931101762992814, "vf_explained_var": 0.36878306393822036, "kl": 0.0159384716761258, "entropy": 3.169949381624659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 926400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 794624, "num_env_steps_trained": 794624, "num_agent_steps_sampled": 3973120, "num_agent_steps_trained": 3973120}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -275.0, "episode_reward_mean": 189.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.580445767690378, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.580445767690378, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.94, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.580445767690378, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [180.0, 90.0, -40.0, 100.0, 370.0, 240.0, 395.0, 195.0, 75.0, 150.0, 395.0, 125.0, -75.0, 355.0, -20.0, 280.0, 30.0, 345.0, 220.0, 320.0, 245.0, 580.0, 170.0, 340.0, 80.0, 150.0, 255.0, 250.0, 110.0, 340.0, 155.0, 45.0, 25.0, 155.0, 445.0, 100.0, 170.0, 475.0, 415.0, 255.0, 105.0, 135.0, 315.0, 170.0, 285.0, 75.0, -50.0, 25.0, 255.0, 240.0, -275.0, 85.0, 240.0, -270.0, 325.0, -30.0, 275.0, 170.0, -150.0, 275.0, 435.0, 55.0, 80.0, 320.0, 185.0, 265.0, 90.0, 125.0, 285.0, 180.0, 195.0, 340.0, 330.0, 205.0, 110.0, 60.0, 295.0, 550.0, -65.0, 165.0, 10.0, 425.0, 345.0, -160.0, 225.0, 450.0, 465.0, 195.0, 95.0, -45.0, 25.0, 370.0, 195.0, 340.0, 290.0, 195.0, 145.0, 210.0, 80.0, 220.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.142893411671612, "mean_inference_ms": 1.5217777491857856, "mean_action_processing_ms": 0.560546395126141, "mean_env_wait_ms": 0.19759950366121776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15872740745544434, "StateBufferConnector_ms": 0.00626063346862793, "ViewRequirementAgentConnector_ms": 0.32320189476013184}}, "episode_reward_max": 580.0, "episode_reward_min": -275.0, "episode_reward_mean": 189.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [180.0, 90.0, -40.0, 100.0, 370.0, 240.0, 395.0, 195.0, 75.0, 150.0, 395.0, 125.0, -75.0, 355.0, -20.0, 280.0, 30.0, 345.0, 220.0, 320.0, 245.0, 580.0, 170.0, 340.0, 80.0, 150.0, 255.0, 250.0, 110.0, 340.0, 155.0, 45.0, 25.0, 155.0, 445.0, 100.0, 170.0, 475.0, 415.0, 255.0, 105.0, 135.0, 315.0, 170.0, 285.0, 75.0, -50.0, 25.0, 255.0, 240.0, -275.0, 85.0, 240.0, -270.0, 325.0, -30.0, 275.0, 170.0, -150.0, 275.0, 435.0, 55.0, 80.0, 320.0, 185.0, 265.0, 90.0, 125.0, 285.0, 180.0, 195.0, 340.0, 330.0, 205.0, 110.0, 60.0, 295.0, 550.0, -65.0, 165.0, 10.0, 425.0, 345.0, -160.0, 225.0, 450.0, 465.0, 195.0, 95.0, -45.0, 25.0, 370.0, 195.0, 340.0, 290.0, 195.0, 145.0, 210.0, 80.0, 220.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.142893411671612, "mean_inference_ms": 1.5217777491857856, "mean_action_processing_ms": 0.560546395126141, "mean_env_wait_ms": 0.19759950366121776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15872740745544434, "StateBufferConnector_ms": 0.00626063346862793, "ViewRequirementAgentConnector_ms": 0.32320189476013184}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3973120, "num_agent_steps_trained": 3973120, "num_env_steps_sampled": 794624, "num_env_steps_trained": 794624, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.94863248034999, "num_env_steps_trained_throughput_per_sec": 68.94863248034999, "timesteps_total": 794624, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 3973120, "timers": {"training_iteration_time_ms": 119073.767, "sample_time_ms": 14114.138, "load_time_ms": 1.723, "load_throughput": 4753765.045, "learn_time_ms": 104948.798, "learn_throughput": 78.057, "synch_weights_time_ms": 2.908}, "counters": {"num_env_steps_sampled": 794624, "num_env_steps_trained": 794624, "num_agent_steps_sampled": 3973120, "num_agent_steps_trained": 3973120}, "done": false, "episodes_total": 6208, "training_iteration": 97, "trial_id": "9fade_00019", "date": "2023-11-09_22-51-31", "timestamp": 1699566691, "time_this_iter_s": 118.8301465511322, "time_total_s": 10451.43958568573, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10451.43958568573, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 37.25764705882353, "ram_util_percent": 18.740000000000002}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5450329175991707, "episode_optimality_min": -0.9444444444444444, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5450329175991707, "episode_optimality_capped_min": -0.9444444444444444, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.8, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5450329175991707, "curr_learning_score_min": -0.9444444444444444, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9873041278962046, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.284173662503963, "policy_loss": -0.07549804699101514, "vf_loss": 0.34341035677454784, "vf_explained_var": 0.35419625755399464, "kl": 0.016060594870607094, "entropy": 3.138850912551085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 936000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 802816, "num_env_steps_trained": 802816, "num_agent_steps_sampled": 4014080, "num_agent_steps_trained": 4014080}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -255.0, "episode_reward_mean": 194.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5450329175991707, "episode_optimality_min": -0.9444444444444444, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5450329175991707, "episode_optimality_capped_min": -0.9444444444444444, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.8, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5450329175991707, "curr_learning_score_min": -0.9444444444444444, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [185.0, 265.0, 90.0, 125.0, 285.0, 180.0, 195.0, 340.0, 330.0, 205.0, 110.0, 60.0, 295.0, 550.0, -65.0, 165.0, 10.0, 425.0, 345.0, -160.0, 225.0, 450.0, 465.0, 195.0, 95.0, -45.0, 25.0, 370.0, 195.0, 340.0, 290.0, 195.0, 145.0, 210.0, 80.0, 220.0, 110.0, 170.0, 160.0, 30.0, 140.0, 280.0, 235.0, 445.0, 200.0, -75.0, 75.0, 55.0, 140.0, 195.0, 480.0, 0.0, 185.0, 290.0, 95.0, 150.0, 435.0, 280.0, 240.0, 15.0, 335.0, 340.0, 350.0, 295.0, 385.0, 430.0, 585.0, 435.0, 320.0, 0.0, 325.0, 435.0, 60.0, 10.0, -5.0, -130.0, 85.0, -50.0, 500.0, 410.0, -255.0, 315.0, 350.0, 350.0, 95.0, 20.0, 130.0, 10.0, 45.0, 190.0, 0.0, 105.0, 185.0, 255.0, 215.0, 30.0, 170.0, 195.0, 100.0, 60.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1426809772149642, "mean_inference_ms": 1.5214894927950688, "mean_action_processing_ms": 0.5604439832827811, "mean_env_wait_ms": 0.1975470459370526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15979385375976562, "StateBufferConnector_ms": 0.006309986114501953, "ViewRequirementAgentConnector_ms": 0.32562875747680664}}, "episode_reward_max": 585.0, "episode_reward_min": -255.0, "episode_reward_mean": 194.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [185.0, 265.0, 90.0, 125.0, 285.0, 180.0, 195.0, 340.0, 330.0, 205.0, 110.0, 60.0, 295.0, 550.0, -65.0, 165.0, 10.0, 425.0, 345.0, -160.0, 225.0, 450.0, 465.0, 195.0, 95.0, -45.0, 25.0, 370.0, 195.0, 340.0, 290.0, 195.0, 145.0, 210.0, 80.0, 220.0, 110.0, 170.0, 160.0, 30.0, 140.0, 280.0, 235.0, 445.0, 200.0, -75.0, 75.0, 55.0, 140.0, 195.0, 480.0, 0.0, 185.0, 290.0, 95.0, 150.0, 435.0, 280.0, 240.0, 15.0, 335.0, 340.0, 350.0, 295.0, 385.0, 430.0, 585.0, 435.0, 320.0, 0.0, 325.0, 435.0, 60.0, 10.0, -5.0, -130.0, 85.0, -50.0, 500.0, 410.0, -255.0, 315.0, 350.0, 350.0, 95.0, 20.0, 130.0, 10.0, 45.0, 190.0, 0.0, 105.0, 185.0, 255.0, 215.0, 30.0, 170.0, 195.0, 100.0, 60.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1426809772149642, "mean_inference_ms": 1.5214894927950688, "mean_action_processing_ms": 0.5604439832827811, "mean_env_wait_ms": 0.1975470459370526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15979385375976562, "StateBufferConnector_ms": 0.006309986114501953, "ViewRequirementAgentConnector_ms": 0.32562875747680664}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4014080, "num_agent_steps_trained": 4014080, "num_env_steps_sampled": 802816, "num_env_steps_trained": 802816, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.23026301649622, "num_env_steps_trained_throughput_per_sec": 69.23026301649622, "timesteps_total": 802816, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4014080, "timers": {"training_iteration_time_ms": 119231.906, "sample_time_ms": 14188.594, "load_time_ms": 1.748, "load_throughput": 4686462.671, "learn_time_ms": 105032.417, "learn_throughput": 77.995, "synch_weights_time_ms": 2.975}, "counters": {"num_env_steps_sampled": 802816, "num_env_steps_trained": 802816, "num_agent_steps_sampled": 4014080, "num_agent_steps_trained": 4014080}, "done": false, "episodes_total": 6272, "training_iteration": 98, "trial_id": "9fade_00019", "date": "2023-11-09_22-53-29", "timestamp": 1699566809, "time_this_iter_s": 118.34899997711182, "time_total_s": 10569.788585662842, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10569.788585662842, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 37.62678571428572, "ram_util_percent": 18.746428571428574}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.49730576145942784, "episode_optimality_min": -0.9444444444444444, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.49730576145942784, "episode_optimality_capped_min": -0.9444444444444444, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.34, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.49730576145942784, "curr_learning_score_min": -0.9444444444444444, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9888797589950263, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2527459892682479, "policy_loss": -0.07659760025474194, "vf_loss": 0.31294466403550664, "vf_explained_var": 0.37658999728038905, "kl": 0.016196468719308164, "entropy": 3.115376682182153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 945600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 811008, "num_env_steps_trained": 811008, "num_agent_steps_sampled": 4055040, "num_agent_steps_trained": 4055040}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -275.0, "episode_reward_mean": 181.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.49730576145942784, "episode_optimality_min": -0.9444444444444444, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.49730576145942784, "episode_optimality_capped_min": -0.9444444444444444, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 36.34, "episode_reward_normalized_min": -55.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.49730576145942784, "curr_learning_score_min": -0.9444444444444444, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [385.0, 430.0, 585.0, 435.0, 320.0, 0.0, 325.0, 435.0, 60.0, 10.0, -5.0, -130.0, 85.0, -50.0, 500.0, 410.0, -255.0, 315.0, 350.0, 350.0, 95.0, 20.0, 130.0, 10.0, 45.0, 190.0, 0.0, 105.0, 185.0, 255.0, 215.0, 30.0, 170.0, 195.0, 100.0, 60.0, 280.0, 305.0, 140.0, 290.0, 70.0, 355.0, 460.0, -100.0, 225.0, 315.0, 165.0, 115.0, 70.0, 265.0, -170.0, 260.0, 490.0, -40.0, 380.0, 100.0, 85.0, 130.0, -120.0, 170.0, 425.0, 45.0, 125.0, 190.0, -90.0, 95.0, 265.0, 225.0, 420.0, 80.0, 395.0, -275.0, -20.0, 270.0, 330.0, -135.0, 10.0, 325.0, 430.0, 25.0, 185.0, 355.0, 395.0, 135.0, 145.0, 295.0, 75.0, 175.0, 240.0, 430.0, 455.0, 25.0, 155.0, 315.0, 295.0, 110.0, 520.0, 125.0, 150.0, -145.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1424546800973367, "mean_inference_ms": 1.521273414879644, "mean_action_processing_ms": 0.5604495026962705, "mean_env_wait_ms": 0.1974847159438569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15814661979675293, "StateBufferConnector_ms": 0.006269693374633789, "ViewRequirementAgentConnector_ms": 0.3234105110168457}}, "episode_reward_max": 585.0, "episode_reward_min": -275.0, "episode_reward_mean": 181.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [385.0, 430.0, 585.0, 435.0, 320.0, 0.0, 325.0, 435.0, 60.0, 10.0, -5.0, -130.0, 85.0, -50.0, 500.0, 410.0, -255.0, 315.0, 350.0, 350.0, 95.0, 20.0, 130.0, 10.0, 45.0, 190.0, 0.0, 105.0, 185.0, 255.0, 215.0, 30.0, 170.0, 195.0, 100.0, 60.0, 280.0, 305.0, 140.0, 290.0, 70.0, 355.0, 460.0, -100.0, 225.0, 315.0, 165.0, 115.0, 70.0, 265.0, -170.0, 260.0, 490.0, -40.0, 380.0, 100.0, 85.0, 130.0, -120.0, 170.0, 425.0, 45.0, 125.0, 190.0, -90.0, 95.0, 265.0, 225.0, 420.0, 80.0, 395.0, -275.0, -20.0, 270.0, 330.0, -135.0, 10.0, 325.0, 430.0, 25.0, 185.0, 355.0, 395.0, 135.0, 145.0, 295.0, 75.0, 175.0, 240.0, 430.0, 455.0, 25.0, 155.0, 315.0, 295.0, 110.0, 520.0, 125.0, 150.0, -145.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1424546800973367, "mean_inference_ms": 1.521273414879644, "mean_action_processing_ms": 0.5604495026962705, "mean_env_wait_ms": 0.1974847159438569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15814661979675293, "StateBufferConnector_ms": 0.006269693374633789, "ViewRequirementAgentConnector_ms": 0.3234105110168457}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4055040, "num_agent_steps_trained": 4055040, "num_env_steps_sampled": 811008, "num_env_steps_trained": 811008, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.58375484479569, "num_env_steps_trained_throughput_per_sec": 69.58375484479569, "timesteps_total": 811008, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4055040, "timers": {"training_iteration_time_ms": 119280.572, "sample_time_ms": 14194.221, "load_time_ms": 1.761, "load_throughput": 4650749.644, "learn_time_ms": 105075.566, "learn_throughput": 77.963, "synch_weights_time_ms": 2.909}, "counters": {"num_env_steps_sampled": 811008, "num_env_steps_trained": 811008, "num_agent_steps_sampled": 4055040, "num_agent_steps_trained": 4055040}, "done": false, "episodes_total": 6336, "training_iteration": 99, "trial_id": "9fade_00019", "date": "2023-11-09_22-55-27", "timestamp": 1699566927, "time_this_iter_s": 117.74116587638855, "time_total_s": 10687.52975153923, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10687.52975153923, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 37.00297619047619, "ram_util_percent": 18.880357142857143}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5927910389136443, "episode_optimality_min": -1.0208333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5929993722469775, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.01, "episode_reward_normalized_min": -66.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5929993722469775, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9857944169795761, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.24908462132955417, "policy_loss": -0.07486159590555569, "vf_loss": 0.3081639991922808, "vf_explained_var": 0.4080236071472367, "kl": 0.015587375168636489, "entropy": 3.0916038175175586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 955200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 819200, "num_env_steps_trained": 819200, "num_agent_steps_sampled": 4096000, "num_agent_steps_trained": 4096000}, "sampler_results": {"episode_reward_max": 535.0, "episode_reward_min": -330.0, "episode_reward_mean": 210.05, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5927910389136443, "episode_optimality_min": -1.0208333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5929993722469775, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.01, "episode_reward_normalized_min": -66.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5929993722469775, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-90.0, 95.0, 265.0, 225.0, 420.0, 80.0, 395.0, -275.0, -20.0, 270.0, 330.0, -135.0, 10.0, 325.0, 430.0, 25.0, 185.0, 355.0, 395.0, 135.0, 145.0, 295.0, 75.0, 175.0, 240.0, 430.0, 455.0, 25.0, 155.0, 315.0, 295.0, 110.0, 520.0, 125.0, 150.0, -145.0, 245.0, 265.0, 455.0, 410.0, 435.0, 160.0, 160.0, 175.0, 230.0, 205.0, 270.0, 350.0, 295.0, 60.0, 470.0, 215.0, 310.0, 105.0, 290.0, 230.0, 205.0, 340.0, 280.0, 535.0, 205.0, 295.0, 115.0, 75.0, -60.0, 305.0, 365.0, 75.0, 425.0, 120.0, 245.0, 480.0, 45.0, 415.0, 20.0, 95.0, 170.0, 115.0, 300.0, 485.0, 80.0, 355.0, 310.0, -330.0, -245.0, 430.0, 275.0, 135.0, 325.0, 105.0, 220.0, 270.0, 195.0, 285.0, 105.0, 190.0, 180.0, 135.0, 355.0, -140.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1420998709807706, "mean_inference_ms": 1.5207866611684722, "mean_action_processing_ms": 0.5602940853398678, "mean_env_wait_ms": 0.19738168302064804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15652680397033691, "StateBufferConnector_ms": 0.006090641021728516, "ViewRequirementAgentConnector_ms": 0.3170633316040039}}, "episode_reward_max": 535.0, "episode_reward_min": -330.0, "episode_reward_mean": 210.05, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-90.0, 95.0, 265.0, 225.0, 420.0, 80.0, 395.0, -275.0, -20.0, 270.0, 330.0, -135.0, 10.0, 325.0, 430.0, 25.0, 185.0, 355.0, 395.0, 135.0, 145.0, 295.0, 75.0, 175.0, 240.0, 430.0, 455.0, 25.0, 155.0, 315.0, 295.0, 110.0, 520.0, 125.0, 150.0, -145.0, 245.0, 265.0, 455.0, 410.0, 435.0, 160.0, 160.0, 175.0, 230.0, 205.0, 270.0, 350.0, 295.0, 60.0, 470.0, 215.0, 310.0, 105.0, 290.0, 230.0, 205.0, 340.0, 280.0, 535.0, 205.0, 295.0, 115.0, 75.0, -60.0, 305.0, 365.0, 75.0, 425.0, 120.0, 245.0, 480.0, 45.0, 415.0, 20.0, 95.0, 170.0, 115.0, 300.0, 485.0, 80.0, 355.0, 310.0, -330.0, -245.0, 430.0, 275.0, 135.0, 325.0, 105.0, 220.0, 270.0, 195.0, 285.0, 105.0, 190.0, 180.0, 135.0, 355.0, -140.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1420998709807706, "mean_inference_ms": 1.5207866611684722, "mean_action_processing_ms": 0.5602940853398678, "mean_env_wait_ms": 0.19738168302064804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15652680397033691, "StateBufferConnector_ms": 0.006090641021728516, "ViewRequirementAgentConnector_ms": 0.3170633316040039}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096000, "num_agent_steps_trained": 4096000, "num_env_steps_sampled": 819200, "num_env_steps_trained": 819200, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.13624916844229, "num_env_steps_trained_throughput_per_sec": 70.13624916844229, "timesteps_total": 819200, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4096000, "timers": {"training_iteration_time_ms": 119119.023, "sample_time_ms": 14155.991, "load_time_ms": 1.803, "load_throughput": 4542715.651, "learn_time_ms": 104952.269, "learn_throughput": 78.055, "synch_weights_time_ms": 2.881}, "counters": {"num_env_steps_sampled": 819200, "num_env_steps_trained": 819200, "num_agent_steps_sampled": 4096000, "num_agent_steps_trained": 4096000}, "done": false, "episodes_total": 6400, "training_iteration": 100, "trial_id": "9fade_00019", "date": "2023-11-09_22-57-24", "timestamp": 1699567044, "time_this_iter_s": 116.81753611564636, "time_total_s": 10804.347287654877, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10804.347287654877, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 37.122155688622755, "ram_util_percent": 18.762275449101804}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.536320175919127, "episode_optimality_min": -1.0208333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5365285092524603, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.69, "episode_reward_normalized_min": -66.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5365285092524603, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.987534622742484, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2847547824847182, "policy_loss": -0.07759739052441243, "vf_loss": 0.34575175233519984, "vf_explained_var": 0.3643758819873134, "kl": 0.01639547558787418, "entropy": 3.107299530655146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 964800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 827392, "num_env_steps_trained": 827392, "num_agent_steps_sampled": 4136960, "num_agent_steps_trained": 4136960}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": -330.0, "episode_reward_mean": 188.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.536320175919127, "episode_optimality_min": -1.0208333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5365285092524603, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.69, "episode_reward_normalized_min": -66.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5365285092524603, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-60.0, 305.0, 365.0, 75.0, 425.0, 120.0, 245.0, 480.0, 45.0, 415.0, 20.0, 95.0, 170.0, 115.0, 300.0, 485.0, 80.0, 355.0, 310.0, -330.0, -245.0, 430.0, 275.0, 135.0, 325.0, 105.0, 220.0, 270.0, 195.0, 285.0, 105.0, 190.0, 180.0, 135.0, 355.0, -140.0, 60.0, 205.0, 60.0, 60.0, 170.0, -5.0, 210.0, 60.0, 465.0, 255.0, 275.0, 160.0, 385.0, 10.0, 255.0, -60.0, 280.0, 415.0, 95.0, 250.0, 475.0, 270.0, 360.0, 150.0, -45.0, 115.0, 205.0, 285.0, 420.0, 255.0, 500.0, 125.0, 140.0, 110.0, -90.0, 335.0, 360.0, 195.0, 160.0, 375.0, 370.0, -175.0, 170.0, 65.0, 190.0, 190.0, 5.0, 310.0, -90.0, -55.0, 170.0, 310.0, 450.0, 215.0, -75.0, 210.0, -70.0, 145.0, 180.0, 125.0, 450.0, 380.0, 130.0, 105.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.14174236357111, "mean_inference_ms": 1.5199219654055804, "mean_action_processing_ms": 0.5601264212895929, "mean_env_wait_ms": 0.19724416992149815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15786457061767578, "StateBufferConnector_ms": 0.006058454513549805, "ViewRequirementAgentConnector_ms": 0.3160216808319092}}, "episode_reward_max": 500.0, "episode_reward_min": -330.0, "episode_reward_mean": 188.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, 305.0, 365.0, 75.0, 425.0, 120.0, 245.0, 480.0, 45.0, 415.0, 20.0, 95.0, 170.0, 115.0, 300.0, 485.0, 80.0, 355.0, 310.0, -330.0, -245.0, 430.0, 275.0, 135.0, 325.0, 105.0, 220.0, 270.0, 195.0, 285.0, 105.0, 190.0, 180.0, 135.0, 355.0, -140.0, 60.0, 205.0, 60.0, 60.0, 170.0, -5.0, 210.0, 60.0, 465.0, 255.0, 275.0, 160.0, 385.0, 10.0, 255.0, -60.0, 280.0, 415.0, 95.0, 250.0, 475.0, 270.0, 360.0, 150.0, -45.0, 115.0, 205.0, 285.0, 420.0, 255.0, 500.0, 125.0, 140.0, 110.0, -90.0, 335.0, 360.0, 195.0, 160.0, 375.0, 370.0, -175.0, 170.0, 65.0, 190.0, 190.0, 5.0, 310.0, -90.0, -55.0, 170.0, 310.0, 450.0, 215.0, -75.0, 210.0, -70.0, 145.0, 180.0, 125.0, 450.0, 380.0, 130.0, 105.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.14174236357111, "mean_inference_ms": 1.5199219654055804, "mean_action_processing_ms": 0.5601264212895929, "mean_env_wait_ms": 0.19724416992149815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15786457061767578, "StateBufferConnector_ms": 0.006058454513549805, "ViewRequirementAgentConnector_ms": 0.3160216808319092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4136960, "num_agent_steps_trained": 4136960, "num_env_steps_sampled": 827392, "num_env_steps_trained": 827392, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.7642498164162, "num_env_steps_trained_throughput_per_sec": 69.7642498164162, "timesteps_total": 827392, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4136960, "timers": {"training_iteration_time_ms": 118867.885, "sample_time_ms": 14098.695, "load_time_ms": 1.876, "load_throughput": 4367023.178, "learn_time_ms": 104758.512, "learn_throughput": 78.199, "synch_weights_time_ms": 2.779}, "counters": {"num_env_steps_sampled": 827392, "num_env_steps_trained": 827392, "num_agent_steps_sampled": 4136960, "num_agent_steps_trained": 4136960}, "done": false, "episodes_total": 6464, "training_iteration": 101, "trial_id": "9fade_00019", "date": "2023-11-09_22-59-22", "timestamp": 1699567162, "time_this_iter_s": 117.4397041797638, "time_total_s": 10921.78699183464, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 10921.78699183464, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 39.05178571428572, "ram_util_percent": 18.55297619047619}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.613455720694984, "episode_optimality_min": -0.7446808510638298, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.613455720694984, "episode_optimality_capped_min": -0.7446808510638298, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.56, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.613455720694984, "curr_learning_score_min": -0.7446808510638298, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9929445514393349, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2643147559960683, "policy_loss": -0.07459328314466498, "vf_loss": 0.32302626979144405, "vf_explained_var": 0.36279967297489446, "kl": 0.01568569740814875, "entropy": 3.1148565903802714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 974400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 835584, "num_env_steps_trained": 835584, "num_agent_steps_sampled": 4177920, "num_agent_steps_trained": 4177920}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": -175.0, "episode_reward_mean": 207.8, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.613455720694984, "episode_optimality_min": -0.7446808510638298, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.613455720694984, "episode_optimality_capped_min": -0.7446808510638298, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.56, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.613455720694984, "curr_learning_score_min": -0.7446808510638298, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [420.0, 255.0, 500.0, 125.0, 140.0, 110.0, -90.0, 335.0, 360.0, 195.0, 160.0, 375.0, 370.0, -175.0, 170.0, 65.0, 190.0, 190.0, 5.0, 310.0, -90.0, -55.0, 170.0, 310.0, 450.0, 215.0, -75.0, 210.0, -70.0, 145.0, 180.0, 125.0, 450.0, 380.0, 130.0, 105.0, 415.0, 45.0, 65.0, 280.0, 425.0, 380.0, 245.0, 140.0, 295.0, 500.0, 225.0, 270.0, 70.0, 160.0, 115.0, 285.0, 110.0, 80.0, 365.0, 75.0, 165.0, 395.0, 210.0, 490.0, -175.0, 140.0, 70.0, 235.0, 235.0, 475.0, 220.0, 335.0, 245.0, 185.0, 190.0, 340.0, 425.0, 5.0, 495.0, 275.0, 430.0, -45.0, 145.0, 470.0, 25.0, 310.0, 125.0, 50.0, 345.0, 95.0, 220.0, 360.0, 135.0, 100.0, 365.0, 340.0, 70.0, 165.0, 220.0, 290.0, 135.0, 185.0, 15.0, 140.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1414038975281047, "mean_inference_ms": 1.519190145927228, "mean_action_processing_ms": 0.5599595580328383, "mean_env_wait_ms": 0.19713426760998126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15737628936767578, "StateBufferConnector_ms": 0.006066560745239258, "ViewRequirementAgentConnector_ms": 0.3168375492095947}}, "episode_reward_max": 500.0, "episode_reward_min": -175.0, "episode_reward_mean": 207.8, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [420.0, 255.0, 500.0, 125.0, 140.0, 110.0, -90.0, 335.0, 360.0, 195.0, 160.0, 375.0, 370.0, -175.0, 170.0, 65.0, 190.0, 190.0, 5.0, 310.0, -90.0, -55.0, 170.0, 310.0, 450.0, 215.0, -75.0, 210.0, -70.0, 145.0, 180.0, 125.0, 450.0, 380.0, 130.0, 105.0, 415.0, 45.0, 65.0, 280.0, 425.0, 380.0, 245.0, 140.0, 295.0, 500.0, 225.0, 270.0, 70.0, 160.0, 115.0, 285.0, 110.0, 80.0, 365.0, 75.0, 165.0, 395.0, 210.0, 490.0, -175.0, 140.0, 70.0, 235.0, 235.0, 475.0, 220.0, 335.0, 245.0, 185.0, 190.0, 340.0, 425.0, 5.0, 495.0, 275.0, 430.0, -45.0, 145.0, 470.0, 25.0, 310.0, 125.0, 50.0, 345.0, 95.0, 220.0, 360.0, 135.0, 100.0, 365.0, 340.0, 70.0, 165.0, 220.0, 290.0, 135.0, 185.0, 15.0, 140.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1414038975281047, "mean_inference_ms": 1.519190145927228, "mean_action_processing_ms": 0.5599595580328383, "mean_env_wait_ms": 0.19713426760998126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15737628936767578, "StateBufferConnector_ms": 0.006066560745239258, "ViewRequirementAgentConnector_ms": 0.3168375492095947}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4177920, "num_agent_steps_trained": 4177920, "num_env_steps_sampled": 835584, "num_env_steps_trained": 835584, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 70.83923851502317, "num_env_steps_trained_throughput_per_sec": 70.83923851502317, "timesteps_total": 835584, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4177920, "timers": {"training_iteration_time_ms": 118492.2, "sample_time_ms": 14022.915, "load_time_ms": 1.811, "load_throughput": 4523458.493, "learn_time_ms": 104458.54, "learn_throughput": 78.423, "synch_weights_time_ms": 2.862}, "counters": {"num_env_steps_sampled": 835584, "num_env_steps_trained": 835584, "num_agent_steps_sampled": 4177920, "num_agent_steps_trained": 4177920}, "done": false, "episodes_total": 6528, "training_iteration": 102, "trial_id": "9fade_00019", "date": "2023-11-09_23-01-20", "timestamp": 1699567280, "time_this_iter_s": 115.65850710868835, "time_total_s": 11037.445498943329, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11037.445498943329, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 36.015476190476186, "ram_util_percent": 18.779166666666665}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5860474802358333, "episode_optimality_min": -0.6538461538461539, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5860474802358333, "episode_optimality_capped_min": -0.6538461538461539, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.06, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5860474802358333, "curr_learning_score_min": -0.6538461538461539, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9859164752873282, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25529481053221387, "policy_loss": -0.0765243854243939, "vf_loss": 0.31544619440469734, "vf_explained_var": 0.4041373382136226, "kl": 0.01617086496163438, "entropy": 3.1238498028864465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 984000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 843776, "num_env_steps_trained": 843776, "num_agent_steps_sampled": 4218880, "num_agent_steps_trained": 4218880}, "sampler_results": {"episode_reward_max": 500.0, "episode_reward_min": -200.0, "episode_reward_mean": 200.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5860474802358333, "episode_optimality_min": -0.6538461538461539, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5860474802358333, "episode_optimality_capped_min": -0.6538461538461539, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.06, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 100.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5860474802358333, "curr_learning_score_min": -0.6538461538461539, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [235.0, 475.0, 220.0, 335.0, 245.0, 185.0, 190.0, 340.0, 425.0, 5.0, 495.0, 275.0, 430.0, -45.0, 145.0, 470.0, 25.0, 310.0, 125.0, 50.0, 345.0, 95.0, 220.0, 360.0, 135.0, 100.0, 365.0, 340.0, 70.0, 165.0, 220.0, 290.0, 135.0, 185.0, 15.0, 140.0, 295.0, 395.0, 320.0, 330.0, 260.0, 70.0, 155.0, 265.0, 25.0, 210.0, 25.0, 270.0, 40.0, 130.0, -200.0, 215.0, 450.0, 330.0, 430.0, 0.0, 320.0, 335.0, 150.0, 5.0, 255.0, 75.0, 345.0, 220.0, 315.0, 255.0, 360.0, -170.0, 75.0, 165.0, 300.0, 220.0, 280.0, 90.0, 95.0, 195.0, 120.0, 155.0, 210.0, 255.0, 390.0, 500.0, 120.0, 35.0, 335.0, 210.0, 105.0, 205.0, 185.0, -75.0, 250.0, 100.0, 100.0, -60.0, 295.0, 190.0, 180.0, 270.0, -35.0, -25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1412335369635793, "mean_inference_ms": 1.5188441091975147, "mean_action_processing_ms": 0.559869541845684, "mean_env_wait_ms": 0.1970838453662637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16062259674072266, "StateBufferConnector_ms": 0.006220579147338867, "ViewRequirementAgentConnector_ms": 0.32485342025756836}}, "episode_reward_max": 500.0, "episode_reward_min": -200.0, "episode_reward_mean": 200.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [235.0, 475.0, 220.0, 335.0, 245.0, 185.0, 190.0, 340.0, 425.0, 5.0, 495.0, 275.0, 430.0, -45.0, 145.0, 470.0, 25.0, 310.0, 125.0, 50.0, 345.0, 95.0, 220.0, 360.0, 135.0, 100.0, 365.0, 340.0, 70.0, 165.0, 220.0, 290.0, 135.0, 185.0, 15.0, 140.0, 295.0, 395.0, 320.0, 330.0, 260.0, 70.0, 155.0, 265.0, 25.0, 210.0, 25.0, 270.0, 40.0, 130.0, -200.0, 215.0, 450.0, 330.0, 430.0, 0.0, 320.0, 335.0, 150.0, 5.0, 255.0, 75.0, 345.0, 220.0, 315.0, 255.0, 360.0, -170.0, 75.0, 165.0, 300.0, 220.0, 280.0, 90.0, 95.0, 195.0, 120.0, 155.0, 210.0, 255.0, 390.0, 500.0, 120.0, 35.0, 335.0, 210.0, 105.0, 205.0, 185.0, -75.0, 250.0, 100.0, 100.0, -60.0, 295.0, 190.0, 180.0, 270.0, -35.0, -25.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1412335369635793, "mean_inference_ms": 1.5188441091975147, "mean_action_processing_ms": 0.559869541845684, "mean_env_wait_ms": 0.1970838453662637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16062259674072266, "StateBufferConnector_ms": 0.006220579147338867, "ViewRequirementAgentConnector_ms": 0.32485342025756836}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4218880, "num_agent_steps_trained": 4218880, "num_env_steps_sampled": 843776, "num_env_steps_trained": 843776, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.92395716160502, "num_env_steps_trained_throughput_per_sec": 68.92395716160502, "timesteps_total": 843776, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4218880, "timers": {"training_iteration_time_ms": 118382.857, "sample_time_ms": 14066.45, "load_time_ms": 1.693, "load_throughput": 4838786.403, "learn_time_ms": 104305.685, "learn_throughput": 78.538, "synch_weights_time_ms": 2.994}, "counters": {"num_env_steps_sampled": 843776, "num_env_steps_trained": 843776, "num_agent_steps_sampled": 4218880, "num_agent_steps_trained": 4218880}, "done": false, "episodes_total": 6592, "training_iteration": 103, "trial_id": "9fade_00019", "date": "2023-11-09_23-03-25", "timestamp": 1699567405, "time_this_iter_s": 118.87211060523987, "time_total_s": 11156.317609548569, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11156.317609548569, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 37.68324022346369, "ram_util_percent": 18.746368715083797}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.595472641128424, "episode_optimality_min": -0.6538461538461539, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.595472641128424, "episode_optimality_capped_min": -0.6538461538461539, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.29, "episode_reward_normalized_min": -34.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.595472641128424, "curr_learning_score_min": -0.6538461538461539, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9845682207572585, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.24524281634410727, "policy_loss": -0.07504305704695677, "vf_loss": 0.304375244065565, "vf_explained_var": 0.389559092844526, "kl": 0.015714201608855848, "entropy": 3.1364248145620026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 993600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 851968, "num_env_steps_trained": 851968, "num_agent_steps_sampled": 4259840, "num_agent_steps_trained": 4259840}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -170.0, "episode_reward_mean": 206.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.595472641128424, "episode_optimality_min": -0.6538461538461539, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.595472641128424, "episode_optimality_capped_min": -0.6538461538461539, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.29, "episode_reward_normalized_min": -34.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.595472641128424, "curr_learning_score_min": -0.6538461538461539, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [315.0, 255.0, 360.0, -170.0, 75.0, 165.0, 300.0, 220.0, 280.0, 90.0, 95.0, 195.0, 120.0, 155.0, 210.0, 255.0, 390.0, 500.0, 120.0, 35.0, 335.0, 210.0, 105.0, 205.0, 185.0, -75.0, 250.0, 100.0, 100.0, -60.0, 295.0, 190.0, 180.0, 270.0, -35.0, -25.0, 145.0, 50.0, 155.0, 445.0, 275.0, 180.0, 315.0, 310.0, 140.0, 305.0, -35.0, -95.0, 175.0, 340.0, 200.0, 295.0, 130.0, 260.0, 340.0, 280.0, 220.0, 290.0, -140.0, 30.0, 235.0, 580.0, 395.0, 185.0, 535.0, 175.0, 385.0, 385.0, 125.0, -75.0, 435.0, 425.0, 405.0, 10.0, 270.0, 360.0, 140.0, 220.0, 130.0, 350.0, 225.0, 210.0, 145.0, 440.0, 50.0, 295.0, -10.0, 165.0, 200.0, 290.0, -5.0, 140.0, 20.0, 305.0, 380.0, 350.0, 125.0, 225.0, 265.0, 355.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1410379504685522, "mean_inference_ms": 1.518404597696604, "mean_action_processing_ms": 0.5598780785736449, "mean_env_wait_ms": 0.19701012012691954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15919804573059082, "StateBufferConnector_ms": 0.006215810775756836, "ViewRequirementAgentConnector_ms": 0.32247185707092285}}, "episode_reward_max": 580.0, "episode_reward_min": -170.0, "episode_reward_mean": 206.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [315.0, 255.0, 360.0, -170.0, 75.0, 165.0, 300.0, 220.0, 280.0, 90.0, 95.0, 195.0, 120.0, 155.0, 210.0, 255.0, 390.0, 500.0, 120.0, 35.0, 335.0, 210.0, 105.0, 205.0, 185.0, -75.0, 250.0, 100.0, 100.0, -60.0, 295.0, 190.0, 180.0, 270.0, -35.0, -25.0, 145.0, 50.0, 155.0, 445.0, 275.0, 180.0, 315.0, 310.0, 140.0, 305.0, -35.0, -95.0, 175.0, 340.0, 200.0, 295.0, 130.0, 260.0, 340.0, 280.0, 220.0, 290.0, -140.0, 30.0, 235.0, 580.0, 395.0, 185.0, 535.0, 175.0, 385.0, 385.0, 125.0, -75.0, 435.0, 425.0, 405.0, 10.0, 270.0, 360.0, 140.0, 220.0, 130.0, 350.0, 225.0, 210.0, 145.0, 440.0, 50.0, 295.0, -10.0, 165.0, 200.0, 290.0, -5.0, 140.0, 20.0, 305.0, 380.0, 350.0, 125.0, 225.0, 265.0, 355.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1410379504685522, "mean_inference_ms": 1.518404597696604, "mean_action_processing_ms": 0.5598780785736449, "mean_env_wait_ms": 0.19701012012691954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15919804573059082, "StateBufferConnector_ms": 0.006215810775756836, "ViewRequirementAgentConnector_ms": 0.32247185707092285}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4259840, "num_agent_steps_trained": 4259840, "num_env_steps_sampled": 851968, "num_env_steps_trained": 851968, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 69.35821736719976, "num_env_steps_trained_throughput_per_sec": 69.35821736719976, "timesteps_total": 851968, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4259840, "timers": {"training_iteration_time_ms": 118173.877, "sample_time_ms": 14023.227, "load_time_ms": 1.692, "load_throughput": 4842741.944, "learn_time_ms": 104139.933, "learn_throughput": 78.663, "synch_weights_time_ms": 2.944}, "counters": {"num_env_steps_sampled": 851968, "num_env_steps_trained": 851968, "num_agent_steps_sampled": 4259840, "num_agent_steps_trained": 4259840}, "done": false, "episodes_total": 6656, "training_iteration": 104, "trial_id": "9fade_00019", "date": "2023-11-09_23-05-24", "timestamp": 1699567524, "time_this_iter_s": 118.12861371040344, "time_total_s": 11274.446223258972, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11274.446223258972, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 38.023809523809526, "ram_util_percent": 18.57202380952381}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6212548746049541, "episode_optimality_min": -0.6, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6212548746049541, "episode_optimality_capped_min": -0.6, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.61, "episode_reward_normalized_min": -18.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6212548746049541, "curr_learning_score_min": -0.6, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9880985748053839, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.22436501165211667, "policy_loss": -0.07222077767912803, "vf_loss": 0.28097300266405606, "vf_explained_var": 0.4023291421557466, "kl": 0.015420035692973216, "entropy": 3.1164026133219402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1003200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 860160, "num_env_steps_trained": 860160, "num_agent_steps_sampled": 4300800, "num_agent_steps_trained": 4300800}, "sampler_results": {"episode_reward_max": 535.0, "episode_reward_min": -90.0, "episode_reward_mean": 198.05, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6212548746049541, "episode_optimality_min": -0.6, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6212548746049541, "episode_optimality_capped_min": -0.6, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.61, "episode_reward_normalized_min": -18.0, "episode_reward_normalized_max": 107.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6212548746049541, "curr_learning_score_min": -0.6, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [535.0, 175.0, 385.0, 385.0, 125.0, -75.0, 435.0, 425.0, 405.0, 10.0, 270.0, 360.0, 140.0, 220.0, 130.0, 350.0, 225.0, 210.0, 145.0, 440.0, 50.0, 295.0, -10.0, 165.0, 200.0, 290.0, -5.0, 140.0, 20.0, 305.0, 380.0, 350.0, 125.0, 225.0, 265.0, 355.0, 135.0, 10.0, 185.0, 355.0, 265.0, 45.0, 15.0, 125.0, 20.0, 155.0, 130.0, 305.0, 75.0, 55.0, 195.0, 245.0, 170.0, 385.0, 210.0, 95.0, 105.0, 320.0, 120.0, -35.0, 405.0, -60.0, 105.0, 245.0, -45.0, 70.0, 310.0, 340.0, 65.0, 260.0, 270.0, 50.0, 100.0, 160.0, 40.0, 95.0, 150.0, 215.0, 200.0, 190.0, -10.0, 150.0, 125.0, 200.0, 135.0, 315.0, 405.0, 310.0, -90.0, 115.0, 270.0, 425.0, 245.0, 450.0, 160.0, 110.0, 290.0, 230.0, 280.0, 395.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1407657195090861, "mean_inference_ms": 1.5177175416365598, "mean_action_processing_ms": 0.5597670532199308, "mean_env_wait_ms": 0.1968954727317621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15750837326049805, "StateBufferConnector_ms": 0.006027698516845703, "ViewRequirementAgentConnector_ms": 0.3168306350708008}}, "episode_reward_max": 535.0, "episode_reward_min": -90.0, "episode_reward_mean": 198.05, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [535.0, 175.0, 385.0, 385.0, 125.0, -75.0, 435.0, 425.0, 405.0, 10.0, 270.0, 360.0, 140.0, 220.0, 130.0, 350.0, 225.0, 210.0, 145.0, 440.0, 50.0, 295.0, -10.0, 165.0, 200.0, 290.0, -5.0, 140.0, 20.0, 305.0, 380.0, 350.0, 125.0, 225.0, 265.0, 355.0, 135.0, 10.0, 185.0, 355.0, 265.0, 45.0, 15.0, 125.0, 20.0, 155.0, 130.0, 305.0, 75.0, 55.0, 195.0, 245.0, 170.0, 385.0, 210.0, 95.0, 105.0, 320.0, 120.0, -35.0, 405.0, -60.0, 105.0, 245.0, -45.0, 70.0, 310.0, 340.0, 65.0, 260.0, 270.0, 50.0, 100.0, 160.0, 40.0, 95.0, 150.0, 215.0, 200.0, 190.0, -10.0, 150.0, 125.0, 200.0, 135.0, 315.0, 405.0, 310.0, -90.0, 115.0, 270.0, 425.0, 245.0, 450.0, 160.0, 110.0, 290.0, 230.0, 280.0, 395.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1407657195090861, "mean_inference_ms": 1.5177175416365598, "mean_action_processing_ms": 0.5597670532199308, "mean_env_wait_ms": 0.1968954727317621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15750837326049805, "StateBufferConnector_ms": 0.006027698516845703, "ViewRequirementAgentConnector_ms": 0.3168306350708008}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4300800, "num_agent_steps_trained": 4300800, "num_env_steps_sampled": 860160, "num_env_steps_trained": 860160, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.60555597540284, "num_env_steps_trained_throughput_per_sec": 68.60555597540284, "timesteps_total": 860160, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4300800, "timers": {"training_iteration_time_ms": 118060.175, "sample_time_ms": 13939.042, "load_time_ms": 1.679, "load_throughput": 4880506.004, "learn_time_ms": 104110.458, "learn_throughput": 78.686, "synch_weights_time_ms": 2.968}, "counters": {"num_env_steps_sampled": 860160, "num_env_steps_trained": 860160, "num_agent_steps_sampled": 4300800, "num_agent_steps_trained": 4300800}, "done": false, "episodes_total": 6720, "training_iteration": 105, "trial_id": "9fade_00019", "date": "2023-11-09_23-07-23", "timestamp": 1699567643, "time_this_iter_s": 119.42273497581482, "time_total_s": 11393.868958234787, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11393.868958234787, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 37.504705882352944, "ram_util_percent": 18.66705882352941}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.625789268557522, "episode_optimality_min": -0.7631578947368421, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.625789268557522, "episode_optimality_capped_min": -0.7631578947368421, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.03, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.625789268557522, "curr_learning_score_min": -0.7631578947368421, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9837978652926783, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25116615902161965, "policy_loss": -0.07665981873217485, "vf_loss": 0.3118575369258785, "vf_explained_var": 0.3961655917701622, "kl": 0.015771298726912828, "entropy": 3.084382547338804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1012800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 868352, "num_env_steps_trained": 868352, "num_agent_steps_sampled": 4341760, "num_agent_steps_trained": 4341760}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -290.0, "episode_reward_mean": 210.15, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.625789268557522, "episode_optimality_min": -0.7631578947368421, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.625789268557522, "episode_optimality_capped_min": -0.7631578947368421, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.03, "episode_reward_normalized_min": -58.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.625789268557522, "curr_learning_score_min": -0.7631578947368421, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-45.0, 70.0, 310.0, 340.0, 65.0, 260.0, 270.0, 50.0, 100.0, 160.0, 40.0, 95.0, 150.0, 215.0, 200.0, 190.0, -10.0, 150.0, 125.0, 200.0, 135.0, 315.0, 405.0, 310.0, -90.0, 115.0, 270.0, 425.0, 245.0, 450.0, 160.0, 110.0, 290.0, 230.0, 280.0, 395.0, 350.0, 350.0, 330.0, 360.0, -10.0, 465.0, -150.0, 100.0, 575.0, 440.0, 345.0, 370.0, 30.0, 220.0, 210.0, 355.0, 220.0, 150.0, 245.0, -290.0, 90.0, 315.0, 90.0, 245.0, 135.0, 210.0, 180.0, 365.0, 215.0, 280.0, 160.0, 120.0, 360.0, 60.0, 245.0, -60.0, 375.0, 245.0, 155.0, 5.0, 210.0, 220.0, 285.0, 260.0, -50.0, 45.0, 190.0, 535.0, 310.0, 270.0, 580.0, 235.0, 315.0, -120.0, 340.0, 130.0, 255.0, 365.0, 125.0, 210.0, 275.0, 215.0, 30.0, 350.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1405918112236477, "mean_inference_ms": 1.5173721763652441, "mean_action_processing_ms": 0.5596875919374127, "mean_env_wait_ms": 0.1968304945760714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1591477394104004, "StateBufferConnector_ms": 0.00615692138671875, "ViewRequirementAgentConnector_ms": 0.32046031951904297}}, "episode_reward_max": 580.0, "episode_reward_min": -290.0, "episode_reward_mean": 210.15, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, 70.0, 310.0, 340.0, 65.0, 260.0, 270.0, 50.0, 100.0, 160.0, 40.0, 95.0, 150.0, 215.0, 200.0, 190.0, -10.0, 150.0, 125.0, 200.0, 135.0, 315.0, 405.0, 310.0, -90.0, 115.0, 270.0, 425.0, 245.0, 450.0, 160.0, 110.0, 290.0, 230.0, 280.0, 395.0, 350.0, 350.0, 330.0, 360.0, -10.0, 465.0, -150.0, 100.0, 575.0, 440.0, 345.0, 370.0, 30.0, 220.0, 210.0, 355.0, 220.0, 150.0, 245.0, -290.0, 90.0, 315.0, 90.0, 245.0, 135.0, 210.0, 180.0, 365.0, 215.0, 280.0, 160.0, 120.0, 360.0, 60.0, 245.0, -60.0, 375.0, 245.0, 155.0, 5.0, 210.0, 220.0, 285.0, 260.0, -50.0, 45.0, 190.0, 535.0, 310.0, 270.0, 580.0, 235.0, 315.0, -120.0, 340.0, 130.0, 255.0, 365.0, 125.0, 210.0, 275.0, 215.0, 30.0, 350.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1405918112236477, "mean_inference_ms": 1.5173721763652441, "mean_action_processing_ms": 0.5596875919374127, "mean_env_wait_ms": 0.1968304945760714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1591477394104004, "StateBufferConnector_ms": 0.00615692138671875, "ViewRequirementAgentConnector_ms": 0.32046031951904297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4341760, "num_agent_steps_trained": 4341760, "num_env_steps_sampled": 868352, "num_env_steps_trained": 868352, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.46025294666102, "num_env_steps_trained_throughput_per_sec": 68.46025294666102, "timesteps_total": 868352, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4341760, "timers": {"training_iteration_time_ms": 118077.361, "sample_time_ms": 13945.779, "load_time_ms": 1.752, "load_throughput": 4674857.939, "learn_time_ms": 104120.73, "learn_throughput": 78.678, "synch_weights_time_ms": 3.04}, "counters": {"num_env_steps_sampled": 868352, "num_env_steps_trained": 868352, "num_agent_steps_sampled": 4341760, "num_agent_steps_trained": 4341760}, "done": false, "episodes_total": 6784, "training_iteration": 106, "trial_id": "9fade_00019", "date": "2023-11-09_23-09-23", "timestamp": 1699567763, "time_this_iter_s": 119.67720317840576, "time_total_s": 11513.546161413193, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11513.546161413193, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 37.64011627906977, "ram_util_percent": 18.82034883720931}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5842986533967914, "episode_optimality_min": -0.8518518518518519, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5842986533967914, "episode_optimality_capped_min": -0.8518518518518519, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.28, "episode_reward_normalized_min": -69.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5842986533967914, "curr_learning_score_min": -0.8518518518518519, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9898953064391389, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2590818640511134, "policy_loss": -0.07521252550082863, "vf_loss": 0.3181499745894204, "vf_explained_var": 0.3752850161120296, "kl": 0.01594510029708317, "entropy": 3.0923520443340142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1022400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 876544, "num_env_steps_trained": 876544, "num_agent_steps_sampled": 4382720, "num_agent_steps_trained": 4382720}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -345.0, "episode_reward_mean": 191.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5842986533967914, "episode_optimality_min": -0.8518518518518519, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5842986533967914, "episode_optimality_capped_min": -0.8518518518518519, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.28, "episode_reward_normalized_min": -69.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5842986533967914, "curr_learning_score_min": -0.8518518518518519, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [215.0, 280.0, 160.0, 120.0, 360.0, 60.0, 245.0, -60.0, 375.0, 245.0, 155.0, 5.0, 210.0, 220.0, 285.0, 260.0, -50.0, 45.0, 190.0, 535.0, 310.0, 270.0, 580.0, 235.0, 315.0, -120.0, 340.0, 130.0, 255.0, 365.0, 125.0, 210.0, 275.0, 215.0, 30.0, 350.0, 260.0, 70.0, 160.0, 90.0, 45.0, 250.0, 410.0, 460.0, 130.0, 5.0, 285.0, 170.0, 65.0, 80.0, 465.0, 190.0, 85.0, 265.0, 370.0, 55.0, 30.0, 220.0, 135.0, 90.0, 165.0, 235.0, 205.0, 145.0, 80.0, 70.0, -165.0, 200.0, 210.0, 160.0, -50.0, 175.0, 405.0, -345.0, 120.0, 250.0, 405.0, 555.0, 215.0, 0.0, -25.0, 145.0, 125.0, 285.0, 455.0, 100.0, 375.0, 155.0, 70.0, 525.0, 380.0, 215.0, 200.0, -65.0, 305.0, 185.0, 145.0, 40.0, 135.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1404020564030208, "mean_inference_ms": 1.5170785063102172, "mean_action_processing_ms": 0.5595819717294707, "mean_env_wait_ms": 0.19677868981091484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1586596965789795, "StateBufferConnector_ms": 0.0062122344970703125, "ViewRequirementAgentConnector_ms": 0.3217301368713379}}, "episode_reward_max": 580.0, "episode_reward_min": -345.0, "episode_reward_mean": 191.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [215.0, 280.0, 160.0, 120.0, 360.0, 60.0, 245.0, -60.0, 375.0, 245.0, 155.0, 5.0, 210.0, 220.0, 285.0, 260.0, -50.0, 45.0, 190.0, 535.0, 310.0, 270.0, 580.0, 235.0, 315.0, -120.0, 340.0, 130.0, 255.0, 365.0, 125.0, 210.0, 275.0, 215.0, 30.0, 350.0, 260.0, 70.0, 160.0, 90.0, 45.0, 250.0, 410.0, 460.0, 130.0, 5.0, 285.0, 170.0, 65.0, 80.0, 465.0, 190.0, 85.0, 265.0, 370.0, 55.0, 30.0, 220.0, 135.0, 90.0, 165.0, 235.0, 205.0, 145.0, 80.0, 70.0, -165.0, 200.0, 210.0, 160.0, -50.0, 175.0, 405.0, -345.0, 120.0, 250.0, 405.0, 555.0, 215.0, 0.0, -25.0, 145.0, 125.0, 285.0, 455.0, 100.0, 375.0, 155.0, 70.0, 525.0, 380.0, 215.0, 200.0, -65.0, 305.0, 185.0, 145.0, 40.0, 135.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1404020564030208, "mean_inference_ms": 1.5170785063102172, "mean_action_processing_ms": 0.5595819717294707, "mean_env_wait_ms": 0.19677868981091484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1586596965789795, "StateBufferConnector_ms": 0.0062122344970703125, "ViewRequirementAgentConnector_ms": 0.3217301368713379}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4382720, "num_agent_steps_trained": 4382720, "num_env_steps_sampled": 876544, "num_env_steps_trained": 876544, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.83424007208626, "num_env_steps_trained_throughput_per_sec": 68.83424007208626, "timesteps_total": 876544, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4382720, "timers": {"training_iteration_time_ms": 118097.106, "sample_time_ms": 13951.267, "load_time_ms": 1.739, "load_throughput": 4710039.53, "learn_time_ms": 104134.969, "learn_throughput": 78.667, "synch_weights_time_ms": 3.071}, "counters": {"num_env_steps_sampled": 876544, "num_env_steps_trained": 876544, "num_agent_steps_sampled": 4382720, "num_agent_steps_trained": 4382720}, "done": false, "episodes_total": 6848, "training_iteration": 107, "trial_id": "9fade_00019", "date": "2023-11-09_23-11-22", "timestamp": 1699567882, "time_this_iter_s": 119.02372336387634, "time_total_s": 11632.56988477707, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11632.56988477707, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 37.71058823529411, "ram_util_percent": 18.777647058823533}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5867675416363433, "episode_optimality_min": -0.8518518518518519, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5867675416363433, "episode_optimality_capped_min": -0.8518518518518519, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.81, "episode_reward_normalized_min": -69.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5867675416363433, "curr_learning_score_min": -0.8518518518518519, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9840621544110278, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2623076191250584, "policy_loss": -0.07797813158904318, "vf_loss": 0.32383319223692525, "vf_explained_var": 0.3706720303806166, "kl": 0.01624943945086102, "entropy": 3.0731075558811427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1032000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 884736, "num_env_steps_trained": 884736, "num_agent_steps_sampled": 4423680, "num_agent_steps_trained": 4423680}, "sampler_results": {"episode_reward_max": 555.0, "episode_reward_min": -345.0, "episode_reward_mean": 199.05, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5867675416363433, "episode_optimality_min": -0.8518518518518519, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5867675416363433, "episode_optimality_capped_min": -0.8518518518518519, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.81, "episode_reward_normalized_min": -69.0, "episode_reward_normalized_max": 111.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5867675416363433, "curr_learning_score_min": -0.8518518518518519, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [80.0, 70.0, -165.0, 200.0, 210.0, 160.0, -50.0, 175.0, 405.0, -345.0, 120.0, 250.0, 405.0, 555.0, 215.0, 0.0, -25.0, 145.0, 125.0, 285.0, 455.0, 100.0, 375.0, 155.0, 70.0, 525.0, 380.0, 215.0, 200.0, -65.0, 305.0, 185.0, 145.0, 40.0, 135.0, 230.0, 240.0, 430.0, 140.0, 295.0, 55.0, 110.0, 125.0, 280.0, 5.0, 100.0, 480.0, 220.0, 65.0, -10.0, 180.0, 410.0, 195.0, 40.0, 280.0, 325.0, 240.0, 135.0, 155.0, 280.0, 445.0, 90.0, -15.0, 350.0, 255.0, 465.0, 155.0, 400.0, 165.0, 190.0, -250.0, 290.0, 50.0, 40.0, 455.0, 235.0, 120.0, 320.0, 365.0, 95.0, 480.0, 425.0, 105.0, -55.0, -215.0, 305.0, 430.0, 370.0, 315.0, -70.0, -130.0, 470.0, 110.0, 265.0, 240.0, 380.0, 305.0, 330.0, 320.0, 265.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1402337352464438, "mean_inference_ms": 1.5167651099246091, "mean_action_processing_ms": 0.5594800871299132, "mean_env_wait_ms": 0.19673175091109896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15962529182434082, "StateBufferConnector_ms": 0.0062296390533447266, "ViewRequirementAgentConnector_ms": 0.3223092555999756}}, "episode_reward_max": 555.0, "episode_reward_min": -345.0, "episode_reward_mean": 199.05, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0, 70.0, -165.0, 200.0, 210.0, 160.0, -50.0, 175.0, 405.0, -345.0, 120.0, 250.0, 405.0, 555.0, 215.0, 0.0, -25.0, 145.0, 125.0, 285.0, 455.0, 100.0, 375.0, 155.0, 70.0, 525.0, 380.0, 215.0, 200.0, -65.0, 305.0, 185.0, 145.0, 40.0, 135.0, 230.0, 240.0, 430.0, 140.0, 295.0, 55.0, 110.0, 125.0, 280.0, 5.0, 100.0, 480.0, 220.0, 65.0, -10.0, 180.0, 410.0, 195.0, 40.0, 280.0, 325.0, 240.0, 135.0, 155.0, 280.0, 445.0, 90.0, -15.0, 350.0, 255.0, 465.0, 155.0, 400.0, 165.0, 190.0, -250.0, 290.0, 50.0, 40.0, 455.0, 235.0, 120.0, 320.0, 365.0, 95.0, 480.0, 425.0, 105.0, -55.0, -215.0, 305.0, 430.0, 370.0, 315.0, -70.0, -130.0, 470.0, 110.0, 265.0, 240.0, 380.0, 305.0, 330.0, 320.0, 265.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1402337352464438, "mean_inference_ms": 1.5167651099246091, "mean_action_processing_ms": 0.5594800871299132, "mean_env_wait_ms": 0.19673175091109896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15962529182434082, "StateBufferConnector_ms": 0.0062296390533447266, "ViewRequirementAgentConnector_ms": 0.3223092555999756}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4423680, "num_agent_steps_trained": 4423680, "num_env_steps_sampled": 884736, "num_env_steps_trained": 884736, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.54759720049482, "num_env_steps_trained_throughput_per_sec": 68.54759720049482, "timesteps_total": 884736, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4423680, "timers": {"training_iteration_time_ms": 118214.95, "sample_time_ms": 13880.766, "load_time_ms": 1.786, "load_throughput": 4586863.844, "learn_time_ms": 104323.19, "learn_throughput": 78.525, "synch_weights_time_ms": 3.136}, "counters": {"num_env_steps_sampled": 884736, "num_env_steps_trained": 884736, "num_agent_steps_sampled": 4423680, "num_agent_steps_trained": 4423680}, "done": false, "episodes_total": 6912, "training_iteration": 108, "trial_id": "9fade_00019", "date": "2023-11-09_23-13-22", "timestamp": 1699568002, "time_this_iter_s": 119.5264401435852, "time_total_s": 11752.096324920654, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11752.096324920654, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 37.87352941176471, "ram_util_percent": 18.753529411764706}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5708098737985408, "episode_optimality_min": -0.625, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5708098737985408, "episode_optimality_capped_min": -0.625, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.73, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 103.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5708098737985408, "curr_learning_score_min": -0.625, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9838560085650534, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2607289066310235, "policy_loss": -0.07763903506764715, "vf_loss": 0.32182555568782845, "vf_explained_var": 0.38685618510469794, "kl": 0.016338158014971214, "entropy": 3.05592282657822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1041600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 892928, "num_env_steps_trained": 892928, "num_agent_steps_sampled": 4464640, "num_agent_steps_trained": 4464640}, "sampler_results": {"episode_reward_max": 515.0, "episode_reward_min": -250.0, "episode_reward_mean": 203.65, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5708098737985408, "episode_optimality_min": -0.625, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5708098737985408, "episode_optimality_capped_min": -0.625, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.73, "episode_reward_normalized_min": -50.0, "episode_reward_normalized_max": 103.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5708098737985408, "curr_learning_score_min": -0.625, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [255.0, 465.0, 155.0, 400.0, 165.0, 190.0, -250.0, 290.0, 50.0, 40.0, 455.0, 235.0, 120.0, 320.0, 365.0, 95.0, 480.0, 425.0, 105.0, -55.0, -215.0, 305.0, 430.0, 370.0, 315.0, -70.0, -130.0, 470.0, 110.0, 265.0, 240.0, 380.0, 305.0, 330.0, 320.0, 265.0, 305.0, 370.0, 335.0, -85.0, 175.0, 315.0, 240.0, 285.0, 260.0, 175.0, 240.0, 15.0, 185.0, 250.0, 430.0, 330.0, -95.0, -40.0, 495.0, 215.0, 370.0, 410.0, 515.0, 185.0, 405.0, 190.0, 415.0, 50.0, 230.0, 375.0, -45.0, -30.0, 355.0, 245.0, 50.0, 130.0, 360.0, 315.0, -50.0, 405.0, 265.0, 365.0, 155.0, 140.0, 230.0, 180.0, -15.0, 95.0, 105.0, 25.0, 195.0, 365.0, -160.0, 95.0, 160.0, 110.0, 275.0, -100.0, -145.0, 410.0, 220.0, 205.0, -75.0, -10.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.140029024355546, "mean_inference_ms": 1.5164119580519335, "mean_action_processing_ms": 0.5593751007247069, "mean_env_wait_ms": 0.19664845496405806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1584184169769287, "StateBufferConnector_ms": 0.006260871887207031, "ViewRequirementAgentConnector_ms": 0.319871187210083}}, "episode_reward_max": 515.0, "episode_reward_min": -250.0, "episode_reward_mean": 203.65, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [255.0, 465.0, 155.0, 400.0, 165.0, 190.0, -250.0, 290.0, 50.0, 40.0, 455.0, 235.0, 120.0, 320.0, 365.0, 95.0, 480.0, 425.0, 105.0, -55.0, -215.0, 305.0, 430.0, 370.0, 315.0, -70.0, -130.0, 470.0, 110.0, 265.0, 240.0, 380.0, 305.0, 330.0, 320.0, 265.0, 305.0, 370.0, 335.0, -85.0, 175.0, 315.0, 240.0, 285.0, 260.0, 175.0, 240.0, 15.0, 185.0, 250.0, 430.0, 330.0, -95.0, -40.0, 495.0, 215.0, 370.0, 410.0, 515.0, 185.0, 405.0, 190.0, 415.0, 50.0, 230.0, 375.0, -45.0, -30.0, 355.0, 245.0, 50.0, 130.0, 360.0, 315.0, -50.0, 405.0, 265.0, 365.0, 155.0, 140.0, 230.0, 180.0, -15.0, 95.0, 105.0, 25.0, 195.0, 365.0, -160.0, 95.0, 160.0, 110.0, 275.0, -100.0, -145.0, 410.0, 220.0, 205.0, -75.0, -10.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.140029024355546, "mean_inference_ms": 1.5164119580519335, "mean_action_processing_ms": 0.5593751007247069, "mean_env_wait_ms": 0.19664845496405806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1584184169769287, "StateBufferConnector_ms": 0.006260871887207031, "ViewRequirementAgentConnector_ms": 0.319871187210083}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4464640, "num_agent_steps_trained": 4464640, "num_env_steps_sampled": 892928, "num_env_steps_trained": 892928, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.59654952416311, "num_env_steps_trained_throughput_per_sec": 68.59654952416311, "timesteps_total": 892928, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4464640, "timers": {"training_iteration_time_ms": 118384.379, "sample_time_ms": 13867.671, "load_time_ms": 1.812, "load_throughput": 4520066.613, "learn_time_ms": 104505.734, "learn_throughput": 78.388, "synch_weights_time_ms": 3.105}, "counters": {"num_env_steps_sampled": 892928, "num_env_steps_trained": 892928, "num_agent_steps_sampled": 4464640, "num_agent_steps_trained": 4464640}, "done": false, "episodes_total": 6976, "training_iteration": 109, "trial_id": "9fade_00019", "date": "2023-11-09_23-15-22", "timestamp": 1699568122, "time_this_iter_s": 119.44208264350891, "time_total_s": 11871.538407564163, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11871.538407564163, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 37.74411764705882, "ram_util_percent": 18.645294117647058}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5750772659652816, "episode_optimality_min": -0.5925925925925926, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5750772659652816, "episode_optimality_capped_min": -0.5925925925925926, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.03, "episode_reward_normalized_min": -32.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5750772659652816, "curr_learning_score_min": -0.5925925925925926, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9928939810115844, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25152429513424673, "policy_loss": -0.07879280498869776, "vf_loss": 0.31333656151905115, "vf_explained_var": 0.36489588735004264, "kl": 0.016770900986983292, "entropy": 3.0402341742813586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1051200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 901120, "num_env_steps_trained": 901120, "num_agent_steps_sampled": 4505600, "num_agent_steps_trained": 4505600}, "sampler_results": {"episode_reward_max": 570.0, "episode_reward_min": -160.0, "episode_reward_mean": 210.15, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5750772659652816, "episode_optimality_min": -0.5925925925925926, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5750772659652816, "episode_optimality_capped_min": -0.5925925925925926, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.03, "episode_reward_normalized_min": -32.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5750772659652816, "curr_learning_score_min": -0.5925925925925926, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [230.0, 375.0, -45.0, -30.0, 355.0, 245.0, 50.0, 130.0, 360.0, 315.0, -50.0, 405.0, 265.0, 365.0, 155.0, 140.0, 230.0, 180.0, -15.0, 95.0, 105.0, 25.0, 195.0, 365.0, -160.0, 95.0, 160.0, 110.0, 275.0, -100.0, -145.0, 410.0, 220.0, 205.0, -75.0, -10.0, 110.0, 295.0, 280.0, 310.0, 65.0, 165.0, 300.0, 160.0, 85.0, 185.0, 280.0, 360.0, 250.0, 265.0, 505.0, 270.0, 55.0, 240.0, -10.0, 55.0, 175.0, 290.0, 425.0, 220.0, 160.0, 120.0, 315.0, 190.0, 270.0, 495.0, 235.0, 75.0, 420.0, 10.0, 350.0, 95.0, 330.0, 335.0, 360.0, 255.0, 525.0, 270.0, -30.0, 520.0, -10.0, 360.0, 310.0, 340.0, 40.0, -20.0, 95.0, 140.0, 110.0, 280.0, 330.0, 330.0, 475.0, 300.0, 570.0, 260.0, 345.0, 370.0, 110.0, 215.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1399024804291926, "mean_inference_ms": 1.5163362660490929, "mean_action_processing_ms": 0.5593162667600114, "mean_env_wait_ms": 0.1966106943586796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15926861763000488, "StateBufferConnector_ms": 0.006312131881713867, "ViewRequirementAgentConnector_ms": 0.32574009895324707}}, "episode_reward_max": 570.0, "episode_reward_min": -160.0, "episode_reward_mean": 210.15, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.0, 375.0, -45.0, -30.0, 355.0, 245.0, 50.0, 130.0, 360.0, 315.0, -50.0, 405.0, 265.0, 365.0, 155.0, 140.0, 230.0, 180.0, -15.0, 95.0, 105.0, 25.0, 195.0, 365.0, -160.0, 95.0, 160.0, 110.0, 275.0, -100.0, -145.0, 410.0, 220.0, 205.0, -75.0, -10.0, 110.0, 295.0, 280.0, 310.0, 65.0, 165.0, 300.0, 160.0, 85.0, 185.0, 280.0, 360.0, 250.0, 265.0, 505.0, 270.0, 55.0, 240.0, -10.0, 55.0, 175.0, 290.0, 425.0, 220.0, 160.0, 120.0, 315.0, 190.0, 270.0, 495.0, 235.0, 75.0, 420.0, 10.0, 350.0, 95.0, 330.0, 335.0, 360.0, 255.0, 525.0, 270.0, -30.0, 520.0, -10.0, 360.0, 310.0, 340.0, 40.0, -20.0, 95.0, 140.0, 110.0, 280.0, 330.0, 330.0, 475.0, 300.0, 570.0, 260.0, 345.0, 370.0, 110.0, 215.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1399024804291926, "mean_inference_ms": 1.5163362660490929, "mean_action_processing_ms": 0.5593162667600114, "mean_env_wait_ms": 0.1966106943586796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15926861763000488, "StateBufferConnector_ms": 0.006312131881713867, "ViewRequirementAgentConnector_ms": 0.32574009895324707}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4505600, "num_agent_steps_trained": 4505600, "num_env_steps_sampled": 901120, "num_env_steps_trained": 901120, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.01332377697949, "num_env_steps_trained_throughput_per_sec": 68.01332377697949, "timesteps_total": 901120, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4505600, "timers": {"training_iteration_time_ms": 118748.956, "sample_time_ms": 13949.371, "load_time_ms": 1.762, "load_throughput": 4649239.333, "learn_time_ms": 104788.788, "learn_throughput": 78.176, "synch_weights_time_ms": 3.013}, "counters": {"num_env_steps_sampled": 901120, "num_env_steps_trained": 901120, "num_agent_steps_sampled": 4505600, "num_agent_steps_trained": 4505600}, "done": false, "episodes_total": 7040, "training_iteration": 110, "trial_id": "9fade_00019", "date": "2023-11-09_23-17-22", "timestamp": 1699568242, "time_this_iter_s": 120.46264386177063, "time_total_s": 11992.001051425934, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 11992.001051425934, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 37.1187134502924, "ram_util_percent": 18.772514619883044}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6369812181851412, "episode_optimality_min": -0.8596491228070176, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6369812181851412, "episode_optimality_capped_min": -0.8596491228070176, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.55, "episode_reward_normalized_min": -49.0, "episode_reward_normalized_max": 122.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6369812181851412, "curr_learning_score_min": -0.8596491228070176, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9916176337221017, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2693487791512841, "policy_loss": -0.07625187487717389, "vf_loss": 0.3290536767092514, "vf_explained_var": 0.3859675398779412, "kl": 0.016342692423442128, "entropy": 3.064051438818375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1060800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 909312, "num_env_steps_trained": 909312, "num_agent_steps_sampled": 4546560, "num_agent_steps_trained": 4546560}, "sampler_results": {"episode_reward_max": 610.0, "episode_reward_min": -245.0, "episode_reward_mean": 237.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6369812181851412, "episode_optimality_min": -0.8596491228070176, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6369812181851412, "episode_optimality_capped_min": -0.8596491228070176, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.55, "episode_reward_normalized_min": -49.0, "episode_reward_normalized_max": 122.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6369812181851412, "curr_learning_score_min": -0.8596491228070176, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [270.0, 495.0, 235.0, 75.0, 420.0, 10.0, 350.0, 95.0, 330.0, 335.0, 360.0, 255.0, 525.0, 270.0, -30.0, 520.0, -10.0, 360.0, 310.0, 340.0, 40.0, -20.0, 95.0, 140.0, 110.0, 280.0, 330.0, 330.0, 475.0, 300.0, 570.0, 260.0, 345.0, 370.0, 110.0, 215.0, 315.0, -140.0, 485.0, 210.0, 250.0, 345.0, 355.0, 340.0, 65.0, 325.0, 10.0, 325.0, 610.0, 235.0, 25.0, 465.0, 180.0, 315.0, 65.0, -245.0, 310.0, 270.0, 325.0, 150.0, 220.0, 315.0, 175.0, 395.0, -130.0, 250.0, 200.0, 150.0, 140.0, 475.0, 345.0, 365.0, 165.0, 230.0, 335.0, 335.0, 270.0, 175.0, 245.0, 455.0, 90.0, 440.0, 395.0, 315.0, 200.0, -10.0, 275.0, -5.0, 185.0, 170.0, -125.0, -5.0, 155.0, 385.0, 110.0, -40.0, 115.0, 225.0, 375.0, 360.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139789833855723, "mean_inference_ms": 1.5160581043899173, "mean_action_processing_ms": 0.5592457227226043, "mean_env_wait_ms": 0.19656882510978962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16023707389831543, "StateBufferConnector_ms": 0.006307125091552734, "ViewRequirementAgentConnector_ms": 0.3237733840942383}}, "episode_reward_max": 610.0, "episode_reward_min": -245.0, "episode_reward_mean": 237.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [270.0, 495.0, 235.0, 75.0, 420.0, 10.0, 350.0, 95.0, 330.0, 335.0, 360.0, 255.0, 525.0, 270.0, -30.0, 520.0, -10.0, 360.0, 310.0, 340.0, 40.0, -20.0, 95.0, 140.0, 110.0, 280.0, 330.0, 330.0, 475.0, 300.0, 570.0, 260.0, 345.0, 370.0, 110.0, 215.0, 315.0, -140.0, 485.0, 210.0, 250.0, 345.0, 355.0, 340.0, 65.0, 325.0, 10.0, 325.0, 610.0, 235.0, 25.0, 465.0, 180.0, 315.0, 65.0, -245.0, 310.0, 270.0, 325.0, 150.0, 220.0, 315.0, 175.0, 395.0, -130.0, 250.0, 200.0, 150.0, 140.0, 475.0, 345.0, 365.0, 165.0, 230.0, 335.0, 335.0, 270.0, 175.0, 245.0, 455.0, 90.0, 440.0, 395.0, 315.0, 200.0, -10.0, 275.0, -5.0, 185.0, 170.0, -125.0, -5.0, 155.0, 385.0, 110.0, -40.0, 115.0, 225.0, 375.0, 360.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139789833855723, "mean_inference_ms": 1.5160581043899173, "mean_action_processing_ms": 0.5592457227226043, "mean_env_wait_ms": 0.19656882510978962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16023707389831543, "StateBufferConnector_ms": 0.006307125091552734, "ViewRequirementAgentConnector_ms": 0.3237733840942383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4546560, "num_agent_steps_trained": 4546560, "num_env_steps_sampled": 909312, "num_env_steps_trained": 909312, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.21678858525105, "num_env_steps_trained_throughput_per_sec": 68.21678858525105, "timesteps_total": 909312, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4546560, "timers": {"training_iteration_time_ms": 119015.325, "sample_time_ms": 13978.944, "load_time_ms": 1.734, "load_throughput": 4724156.955, "learn_time_ms": 105025.457, "learn_throughput": 78.0, "synch_weights_time_ms": 3.124}, "counters": {"num_env_steps_sampled": 909312, "num_env_steps_trained": 909312, "num_agent_steps_sampled": 4546560, "num_agent_steps_trained": 4546560}, "done": false, "episodes_total": 7104, "training_iteration": 111, "trial_id": "9fade_00019", "date": "2023-11-09_23-19-22", "timestamp": 1699568362, "time_this_iter_s": 120.10605883598328, "time_total_s": 12112.107110261917, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12112.107110261917, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 38.06569767441861, "ram_util_percent": 18.653488372093022}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5856842041569572, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5856842041569572, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.48, "episode_reward_normalized_min": -42.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5856842041569572, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.981994652201732, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2566481991723413, "policy_loss": -0.07446029918548447, "vf_loss": 0.3151019372845379, "vf_explained_var": 0.41267347353821, "kl": 0.01580894867900099, "entropy": 3.0943191307534774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1070400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 917504, "num_env_steps_trained": 917504, "num_agent_steps_sampled": 4587520, "num_agent_steps_trained": 4587520}, "sampler_results": {"episode_reward_max": 545.0, "episode_reward_min": -210.0, "episode_reward_mean": 202.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5856842041569572, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5856842041569572, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.48, "episode_reward_normalized_min": -42.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5856842041569572, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-130.0, 250.0, 200.0, 150.0, 140.0, 475.0, 345.0, 365.0, 165.0, 230.0, 335.0, 335.0, 270.0, 175.0, 245.0, 455.0, 90.0, 440.0, 395.0, 315.0, 200.0, -10.0, 275.0, -5.0, 185.0, 170.0, -125.0, -5.0, 155.0, 385.0, 110.0, -40.0, 115.0, 225.0, 375.0, 360.0, 85.0, 85.0, 110.0, 250.0, 120.0, -35.0, 115.0, 305.0, 210.0, 445.0, -50.0, 70.0, 140.0, 300.0, 165.0, 390.0, 90.0, 285.0, 440.0, 145.0, 370.0, -20.0, 385.0, 55.0, 20.0, 290.0, 150.0, 285.0, 455.0, 270.0, 250.0, 530.0, 320.0, -210.0, 75.0, 380.0, 135.0, 295.0, 240.0, 40.0, 210.0, 100.0, 40.0, -15.0, 265.0, 250.0, 265.0, 80.0, 375.0, 25.0, -10.0, 100.0, 330.0, 235.0, 270.0, 290.0, 340.0, 75.0, 305.0, 545.0, 220.0, 25.0, 135.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1396887741216648, "mean_inference_ms": 1.5159811910056924, "mean_action_processing_ms": 0.5591524511784378, "mean_env_wait_ms": 0.19657634566002907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1590268611907959, "StateBufferConnector_ms": 0.006407260894775391, "ViewRequirementAgentConnector_ms": 0.32425618171691895}}, "episode_reward_max": 545.0, "episode_reward_min": -210.0, "episode_reward_mean": 202.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-130.0, 250.0, 200.0, 150.0, 140.0, 475.0, 345.0, 365.0, 165.0, 230.0, 335.0, 335.0, 270.0, 175.0, 245.0, 455.0, 90.0, 440.0, 395.0, 315.0, 200.0, -10.0, 275.0, -5.0, 185.0, 170.0, -125.0, -5.0, 155.0, 385.0, 110.0, -40.0, 115.0, 225.0, 375.0, 360.0, 85.0, 85.0, 110.0, 250.0, 120.0, -35.0, 115.0, 305.0, 210.0, 445.0, -50.0, 70.0, 140.0, 300.0, 165.0, 390.0, 90.0, 285.0, 440.0, 145.0, 370.0, -20.0, 385.0, 55.0, 20.0, 290.0, 150.0, 285.0, 455.0, 270.0, 250.0, 530.0, 320.0, -210.0, 75.0, 380.0, 135.0, 295.0, 240.0, 40.0, 210.0, 100.0, 40.0, -15.0, 265.0, 250.0, 265.0, 80.0, 375.0, 25.0, -10.0, 100.0, 330.0, 235.0, 270.0, 290.0, 340.0, 75.0, 305.0, 545.0, 220.0, 25.0, 135.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1396887741216648, "mean_inference_ms": 1.5159811910056924, "mean_action_processing_ms": 0.5591524511784378, "mean_env_wait_ms": 0.19657634566002907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1590268611907959, "StateBufferConnector_ms": 0.006407260894775391, "ViewRequirementAgentConnector_ms": 0.32425618171691895}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4587520, "num_agent_steps_trained": 4587520, "num_env_steps_sampled": 917504, "num_env_steps_trained": 917504, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.25413763517092, "num_env_steps_trained_throughput_per_sec": 68.25413763517092, "timesteps_total": 917504, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4587520, "timers": {"training_iteration_time_ms": 119453.316, "sample_time_ms": 14054.959, "load_time_ms": 1.773, "load_throughput": 4620977.24, "learn_time_ms": 105387.475, "learn_throughput": 77.732, "synch_weights_time_ms": 3.058}, "counters": {"num_env_steps_sampled": 917504, "num_env_steps_trained": 917504, "num_agent_steps_sampled": 4587520, "num_agent_steps_trained": 4587520}, "done": false, "episodes_total": 7168, "training_iteration": 112, "trial_id": "9fade_00019", "date": "2023-11-09_23-21-22", "timestamp": 1699568482, "time_this_iter_s": 120.0401201248169, "time_total_s": 12232.147230386734, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12232.147230386734, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 37.20877192982456, "ram_util_percent": 18.641520467836255}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6096473404916654, "episode_optimality_min": -0.7727272727272727, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6096473404916654, "episode_optimality_capped_min": -0.7727272727272727, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.45, "episode_reward_normalized_min": -42.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6096473404916654, "curr_learning_score_min": -0.7727272727272727, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.975582365092511, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2338528537739573, "policy_loss": -0.07259121192619204, "vf_loss": 0.2908342302612952, "vf_explained_var": 0.3873588411323726, "kl": 0.015417120694495263, "entropy": 3.0764406688263017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1080000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 925696, "num_env_steps_trained": 925696, "num_agent_steps_sampled": 4628480, "num_agent_steps_trained": 4628480}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -210.0, "episode_reward_mean": 217.25, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6096473404916654, "episode_optimality_min": -0.7727272727272727, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6096473404916654, "episode_optimality_capped_min": -0.7727272727272727, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.45, "episode_reward_normalized_min": -42.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6096473404916654, "curr_learning_score_min": -0.7727272727272727, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [455.0, 270.0, 250.0, 530.0, 320.0, -210.0, 75.0, 380.0, 135.0, 295.0, 240.0, 40.0, 210.0, 100.0, 40.0, -15.0, 265.0, 250.0, 265.0, 80.0, 375.0, 25.0, -10.0, 100.0, 330.0, 235.0, 270.0, 290.0, 340.0, 75.0, 305.0, 545.0, 220.0, 25.0, 135.0, 190.0, 220.0, 310.0, 265.0, 65.0, 65.0, 430.0, -35.0, 0.0, 40.0, 350.0, 30.0, 295.0, 345.0, 120.0, 565.0, 65.0, 480.0, -60.0, 185.0, 140.0, -170.0, 380.0, 205.0, 290.0, 235.0, 215.0, 195.0, 480.0, 100.0, -130.0, -115.0, -100.0, 295.0, 480.0, 345.0, 400.0, 30.0, 330.0, 375.0, 315.0, 225.0, 460.0, 525.0, 250.0, 310.0, 155.0, 265.0, 365.0, -35.0, 90.0, 160.0, 225.0, 250.0, 455.0, -55.0, 85.0, 375.0, 630.0, 185.0, 260.0, 240.0, 390.0, 120.0, 340.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1396984527713931, "mean_inference_ms": 1.5162294721319283, "mean_action_processing_ms": 0.559116554626584, "mean_env_wait_ms": 0.19663195475611425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1605846881866455, "StateBufferConnector_ms": 0.0064525604248046875, "ViewRequirementAgentConnector_ms": 0.32943010330200195}}, "episode_reward_max": 630.0, "episode_reward_min": -210.0, "episode_reward_mean": 217.25, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [455.0, 270.0, 250.0, 530.0, 320.0, -210.0, 75.0, 380.0, 135.0, 295.0, 240.0, 40.0, 210.0, 100.0, 40.0, -15.0, 265.0, 250.0, 265.0, 80.0, 375.0, 25.0, -10.0, 100.0, 330.0, 235.0, 270.0, 290.0, 340.0, 75.0, 305.0, 545.0, 220.0, 25.0, 135.0, 190.0, 220.0, 310.0, 265.0, 65.0, 65.0, 430.0, -35.0, 0.0, 40.0, 350.0, 30.0, 295.0, 345.0, 120.0, 565.0, 65.0, 480.0, -60.0, 185.0, 140.0, -170.0, 380.0, 205.0, 290.0, 235.0, 215.0, 195.0, 480.0, 100.0, -130.0, -115.0, -100.0, 295.0, 480.0, 345.0, 400.0, 30.0, 330.0, 375.0, 315.0, 225.0, 460.0, 525.0, 250.0, 310.0, 155.0, 265.0, 365.0, -35.0, 90.0, 160.0, 225.0, 250.0, 455.0, -55.0, 85.0, 375.0, 630.0, 185.0, 260.0, 240.0, 390.0, 120.0, 340.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1396984527713931, "mean_inference_ms": 1.5162294721319283, "mean_action_processing_ms": 0.559116554626584, "mean_env_wait_ms": 0.19663195475611425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1605846881866455, "StateBufferConnector_ms": 0.0064525604248046875, "ViewRequirementAgentConnector_ms": 0.32943010330200195}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4628480, "num_agent_steps_trained": 4628480, "num_env_steps_sampled": 925696, "num_env_steps_trained": 925696, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.57776962079782, "num_env_steps_trained_throughput_per_sec": 66.57776962079782, "timesteps_total": 925696, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4628480, "timers": {"training_iteration_time_ms": 119872.161, "sample_time_ms": 14067.36, "load_time_ms": 1.77, "load_throughput": 4628758.654, "learn_time_ms": 105793.874, "learn_throughput": 77.434, "synch_weights_time_ms": 3.02}, "counters": {"num_env_steps_sampled": 925696, "num_env_steps_trained": 925696, "num_agent_steps_sampled": 4628480, "num_agent_steps_trained": 4628480}, "done": false, "episodes_total": 7232, "training_iteration": 113, "trial_id": "9fade_00019", "date": "2023-11-09_23-23-26", "timestamp": 1699568606, "time_this_iter_s": 123.07994055747986, "time_total_s": 12355.227170944214, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12355.227170944214, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 37.77942857142858, "ram_util_percent": 18.69142857142857}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5931353118221573, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5931353118221573, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.43, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5931353118221573, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9857258546383431, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25874683142701543, "policy_loss": -0.07442103545519785, "vf_loss": 0.31687583787707807, "vf_explained_var": 0.33249012209475043, "kl": 0.016090891777390273, "entropy": 3.0352304432789485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1089600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 933888, "num_env_steps_trained": 933888, "num_agent_steps_sampled": 4669440, "num_agent_steps_trained": 4669440}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -175.0, "episode_reward_mean": 217.15, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5931353118221573, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5931353118221573, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.43, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5931353118221573, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [100.0, -130.0, -115.0, -100.0, 295.0, 480.0, 345.0, 400.0, 30.0, 330.0, 375.0, 315.0, 225.0, 460.0, 525.0, 250.0, 310.0, 155.0, 265.0, 365.0, -35.0, 90.0, 160.0, 225.0, 250.0, 455.0, -55.0, 85.0, 375.0, 630.0, 185.0, 260.0, 240.0, 390.0, 120.0, 340.0, 285.0, 90.0, 290.0, 260.0, 225.0, 240.0, 330.0, 105.0, 265.0, 75.0, 260.0, 45.0, 525.0, 150.0, 345.0, 175.0, 490.0, 140.0, 615.0, 290.0, 190.0, 200.0, 330.0, 250.0, 345.0, 145.0, 340.0, 145.0, 155.0, -20.0, 170.0, -90.0, 155.0, 285.0, 170.0, 55.0, 75.0, 365.0, 140.0, 145.0, 345.0, 455.0, 245.0, -175.0, 105.0, 385.0, 480.0, 45.0, 585.0, 35.0, 190.0, 85.0, 165.0, 80.0, -5.0, 200.0, 70.0, -55.0, 430.0, 480.0, -95.0, 170.0, -170.0, 320.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139778360697521, "mean_inference_ms": 1.5163244650644612, "mean_action_processing_ms": 0.5593528919124523, "mean_env_wait_ms": 0.19665172404734754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1617894172668457, "StateBufferConnector_ms": 0.006434917449951172, "ViewRequirementAgentConnector_ms": 0.3301103115081787}}, "episode_reward_max": 630.0, "episode_reward_min": -175.0, "episode_reward_mean": 217.15, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [100.0, -130.0, -115.0, -100.0, 295.0, 480.0, 345.0, 400.0, 30.0, 330.0, 375.0, 315.0, 225.0, 460.0, 525.0, 250.0, 310.0, 155.0, 265.0, 365.0, -35.0, 90.0, 160.0, 225.0, 250.0, 455.0, -55.0, 85.0, 375.0, 630.0, 185.0, 260.0, 240.0, 390.0, 120.0, 340.0, 285.0, 90.0, 290.0, 260.0, 225.0, 240.0, 330.0, 105.0, 265.0, 75.0, 260.0, 45.0, 525.0, 150.0, 345.0, 175.0, 490.0, 140.0, 615.0, 290.0, 190.0, 200.0, 330.0, 250.0, 345.0, 145.0, 340.0, 145.0, 155.0, -20.0, 170.0, -90.0, 155.0, 285.0, 170.0, 55.0, 75.0, 365.0, 140.0, 145.0, 345.0, 455.0, 245.0, -175.0, 105.0, 385.0, 480.0, 45.0, 585.0, 35.0, 190.0, 85.0, 165.0, 80.0, -5.0, 200.0, 70.0, -55.0, 430.0, 480.0, -95.0, 170.0, -170.0, 320.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139778360697521, "mean_inference_ms": 1.5163244650644612, "mean_action_processing_ms": 0.5593528919124523, "mean_env_wait_ms": 0.19665172404734754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1617894172668457, "StateBufferConnector_ms": 0.006434917449951172, "ViewRequirementAgentConnector_ms": 0.3301103115081787}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4669440, "num_agent_steps_trained": 4669440, "num_env_steps_sampled": 933888, "num_env_steps_trained": 933888, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.53345447858098, "num_env_steps_trained_throughput_per_sec": 67.53345447858098, "timesteps_total": 933888, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4669440, "timers": {"training_iteration_time_ms": 120191.3, "sample_time_ms": 14174.895, "load_time_ms": 1.735, "load_throughput": 4721495.385, "learn_time_ms": 106005.6, "learn_throughput": 77.279, "synch_weights_time_ms": 2.898}, "counters": {"num_env_steps_sampled": 933888, "num_env_steps_trained": 933888, "num_agent_steps_sampled": 4669440, "num_agent_steps_trained": 4669440}, "done": false, "episodes_total": 7296, "training_iteration": 114, "trial_id": "9fade_00019", "date": "2023-11-09_23-25-27", "timestamp": 1699568727, "time_this_iter_s": 121.32206964492798, "time_total_s": 12476.549240589142, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12476.549240589142, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 37.28620689655172, "ram_util_percent": 18.775287356321844}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5391060869177401, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5391060869177401, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.08, "episode_reward_normalized_min": -41.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5391060869177401, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9852971545358499, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.26526194722605095, "policy_loss": -0.0743500944088737, "vf_loss": 0.3233293177946083, "vf_explained_var": 0.3810161425297459, "kl": 0.016081701769297373, "entropy": 3.042153142939011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1099200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 942080, "num_env_steps_trained": 942080, "num_agent_steps_sampled": 4710400, "num_agent_steps_trained": 4710400}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -205.0, "episode_reward_mean": 195.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5391060869177401, "episode_optimality_min": -1.0, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5391060869177401, "episode_optimality_capped_min": -1.0, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.08, "episode_reward_normalized_min": -41.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5391060869177401, "curr_learning_score_min": -1.0, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [155.0, -20.0, 170.0, -90.0, 155.0, 285.0, 170.0, 55.0, 75.0, 365.0, 140.0, 145.0, 345.0, 455.0, 245.0, -175.0, 105.0, 385.0, 480.0, 45.0, 585.0, 35.0, 190.0, 85.0, 165.0, 80.0, -5.0, 200.0, 70.0, -55.0, 430.0, 480.0, -95.0, 170.0, -170.0, 320.0, 350.0, 410.0, 95.0, 40.0, 40.0, 315.0, 280.0, 315.0, 95.0, 500.0, -75.0, 240.0, 255.0, 345.0, 230.0, 395.0, -60.0, 200.0, 65.0, 440.0, 175.0, 210.0, 375.0, 255.0, 395.0, 325.0, 340.0, -55.0, 430.0, 200.0, 290.0, 105.0, 75.0, 495.0, 320.0, 170.0, 75.0, -205.0, -105.0, -40.0, 380.0, 320.0, 270.0, 365.0, 305.0, 340.0, 70.0, 250.0, 235.0, 505.0, 330.0, 285.0, 215.0, 65.0, 175.0, 75.0, 335.0, 80.0, 150.0, -55.0, 15.0, 45.0, 220.0, 285.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139761425287886, "mean_inference_ms": 1.516114206265794, "mean_action_processing_ms": 0.5594597406526749, "mean_env_wait_ms": 0.19662442653829842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16042494773864746, "StateBufferConnector_ms": 0.00623631477355957, "ViewRequirementAgentConnector_ms": 0.3249690532684326}}, "episode_reward_max": 585.0, "episode_reward_min": -205.0, "episode_reward_mean": 195.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [155.0, -20.0, 170.0, -90.0, 155.0, 285.0, 170.0, 55.0, 75.0, 365.0, 140.0, 145.0, 345.0, 455.0, 245.0, -175.0, 105.0, 385.0, 480.0, 45.0, 585.0, 35.0, 190.0, 85.0, 165.0, 80.0, -5.0, 200.0, 70.0, -55.0, 430.0, 480.0, -95.0, 170.0, -170.0, 320.0, 350.0, 410.0, 95.0, 40.0, 40.0, 315.0, 280.0, 315.0, 95.0, 500.0, -75.0, 240.0, 255.0, 345.0, 230.0, 395.0, -60.0, 200.0, 65.0, 440.0, 175.0, 210.0, 375.0, 255.0, 395.0, 325.0, 340.0, -55.0, 430.0, 200.0, 290.0, 105.0, 75.0, 495.0, 320.0, 170.0, 75.0, -205.0, -105.0, -40.0, 380.0, 320.0, 270.0, 365.0, 305.0, 340.0, 70.0, 250.0, 235.0, 505.0, 330.0, 285.0, 215.0, 65.0, 175.0, 75.0, 335.0, 80.0, 150.0, -55.0, 15.0, 45.0, 220.0, 285.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139761425287886, "mean_inference_ms": 1.516114206265794, "mean_action_processing_ms": 0.5594597406526749, "mean_env_wait_ms": 0.19662442653829842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16042494773864746, "StateBufferConnector_ms": 0.00623631477355957, "ViewRequirementAgentConnector_ms": 0.3249690532684326}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4710400, "num_agent_steps_trained": 4710400, "num_env_steps_sampled": 942080, "num_env_steps_trained": 942080, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.76666437172322, "num_env_steps_trained_throughput_per_sec": 66.76666437172322, "timesteps_total": 942080, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4710400, "timers": {"training_iteration_time_ms": 120520.172, "sample_time_ms": 14187.418, "load_time_ms": 1.758, "load_throughput": 4658631.736, "learn_time_ms": 106321.987, "learn_throughput": 77.049, "synch_weights_time_ms": 2.785}, "counters": {"num_env_steps_sampled": 942080, "num_env_steps_trained": 942080, "num_agent_steps_sampled": 4710400, "num_agent_steps_trained": 4710400}, "done": false, "episodes_total": 7360, "training_iteration": 115, "trial_id": "9fade_00019", "date": "2023-11-09_23-27-30", "timestamp": 1699568850, "time_this_iter_s": 122.7117645740509, "time_total_s": 12599.261005163193, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12599.261005163193, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 37.91942857142857, "ram_util_percent": 18.678857142857144}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5919527689995746, "episode_optimality_min": -0.6307692307692307, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5919527689995746, "episode_optimality_capped_min": -0.6307692307692307, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.97, "episode_reward_normalized_min": -41.0, "episode_reward_normalized_max": 101.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5919527689995746, "curr_learning_score_min": -0.6307692307692307, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9915470892315109, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25724524009730276, "policy_loss": -0.07605276929837904, "vf_loss": 0.31679671959432504, "vf_explained_var": 0.3764412711312373, "kl": 0.01629756922292169, "entropy": 3.0302984789262215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1108800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 950272, "num_env_steps_trained": 950272, "num_agent_steps_sampled": 4751360, "num_agent_steps_trained": 4751360}, "sampler_results": {"episode_reward_max": 505.0, "episode_reward_min": -205.0, "episode_reward_mean": 194.85, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5919527689995746, "episode_optimality_min": -0.6307692307692307, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5919527689995746, "episode_optimality_capped_min": -0.6307692307692307, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.97, "episode_reward_normalized_min": -41.0, "episode_reward_normalized_max": 101.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5919527689995746, "curr_learning_score_min": -0.6307692307692307, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [430.0, 200.0, 290.0, 105.0, 75.0, 495.0, 320.0, 170.0, 75.0, -205.0, -105.0, -40.0, 380.0, 320.0, 270.0, 365.0, 305.0, 340.0, 70.0, 250.0, 235.0, 505.0, 330.0, 285.0, 215.0, 65.0, 175.0, 75.0, 335.0, 80.0, 150.0, -55.0, 15.0, 45.0, 220.0, 285.0, 145.0, 105.0, 260.0, 225.0, 120.0, 140.0, 260.0, 130.0, 170.0, 180.0, 320.0, 335.0, -5.0, 145.0, 275.0, 100.0, -45.0, 360.0, 340.0, 390.0, 160.0, -145.0, -150.0, 485.0, 80.0, 230.0, 175.0, 10.0, 160.0, 480.0, 195.0, 170.0, 215.0, -70.0, 180.0, 360.0, 215.0, 210.0, 355.0, 25.0, 185.0, 185.0, 145.0, 130.0, 10.0, 355.0, 320.0, 370.0, 160.0, 125.0, 250.0, 40.0, 225.0, 370.0, 200.0, 475.0, 160.0, 250.0, 220.0, 85.0, 100.0, 310.0, 265.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1395715575243182, "mean_inference_ms": 1.5156037998307306, "mean_action_processing_ms": 0.5593631244976959, "mean_env_wait_ms": 0.19655000362117211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15938949584960938, "StateBufferConnector_ms": 0.006180286407470703, "ViewRequirementAgentConnector_ms": 0.3203437328338623}}, "episode_reward_max": 505.0, "episode_reward_min": -205.0, "episode_reward_mean": 194.85, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [430.0, 200.0, 290.0, 105.0, 75.0, 495.0, 320.0, 170.0, 75.0, -205.0, -105.0, -40.0, 380.0, 320.0, 270.0, 365.0, 305.0, 340.0, 70.0, 250.0, 235.0, 505.0, 330.0, 285.0, 215.0, 65.0, 175.0, 75.0, 335.0, 80.0, 150.0, -55.0, 15.0, 45.0, 220.0, 285.0, 145.0, 105.0, 260.0, 225.0, 120.0, 140.0, 260.0, 130.0, 170.0, 180.0, 320.0, 335.0, -5.0, 145.0, 275.0, 100.0, -45.0, 360.0, 340.0, 390.0, 160.0, -145.0, -150.0, 485.0, 80.0, 230.0, 175.0, 10.0, 160.0, 480.0, 195.0, 170.0, 215.0, -70.0, 180.0, 360.0, 215.0, 210.0, 355.0, 25.0, 185.0, 185.0, 145.0, 130.0, 10.0, 355.0, 320.0, 370.0, 160.0, 125.0, 250.0, 40.0, 225.0, 370.0, 200.0, 475.0, 160.0, 250.0, 220.0, 85.0, 100.0, 310.0, 265.0, 190.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1395715575243182, "mean_inference_ms": 1.5156037998307306, "mean_action_processing_ms": 0.5593631244976959, "mean_env_wait_ms": 0.19655000362117211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15938949584960938, "StateBufferConnector_ms": 0.006180286407470703, "ViewRequirementAgentConnector_ms": 0.3203437328338623}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4751360, "num_agent_steps_trained": 4751360, "num_env_steps_sampled": 950272, "num_env_steps_trained": 950272, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.36754775188723, "num_env_steps_trained_throughput_per_sec": 67.36754775188723, "timesteps_total": 950272, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4751360, "timers": {"training_iteration_time_ms": 120714.262, "sample_time_ms": 14189.579, "load_time_ms": 1.697, "load_throughput": 4827636.655, "learn_time_ms": 106513.795, "learn_throughput": 76.91, "synch_weights_time_ms": 2.922}, "counters": {"num_env_steps_sampled": 950272, "num_env_steps_trained": 950272, "num_agent_steps_sampled": 4751360, "num_agent_steps_trained": 4751360}, "done": false, "episodes_total": 7424, "training_iteration": 116, "trial_id": "9fade_00019", "date": "2023-11-09_23-29-32", "timestamp": 1699568972, "time_this_iter_s": 121.61747169494629, "time_total_s": 12720.878476858139, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12720.878476858139, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 37.804624277456654, "ram_util_percent": 18.572254335260116}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6239406451521643, "episode_optimality_min": -0.7931034482758621, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6239406451521643, "episode_optimality_capped_min": -0.7931034482758621, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.37, "episode_reward_normalized_min": -46.0, "episode_reward_normalized_max": 113.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6239406451521643, "curr_learning_score_min": -0.7931034482758621, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9845872685251137, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2650072495790664, "policy_loss": -0.072504630108524, "vf_loss": 0.32176292241084714, "vf_explained_var": 0.4054645770788193, "kl": 0.015554524406769209, "entropy": 3.0265207653989394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1118400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 958464, "num_env_steps_trained": 958464, "num_agent_steps_sampled": 4792320, "num_agent_steps_trained": 4792320}, "sampler_results": {"episode_reward_max": 565.0, "episode_reward_min": -230.0, "episode_reward_mean": 211.85, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6239406451521643, "episode_optimality_min": -0.7931034482758621, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6239406451521643, "episode_optimality_capped_min": -0.7931034482758621, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.37, "episode_reward_normalized_min": -46.0, "episode_reward_normalized_max": 113.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6239406451521643, "curr_learning_score_min": -0.7931034482758621, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [160.0, 480.0, 195.0, 170.0, 215.0, -70.0, 180.0, 360.0, 215.0, 210.0, 355.0, 25.0, 185.0, 185.0, 145.0, 130.0, 10.0, 355.0, 320.0, 370.0, 160.0, 125.0, 250.0, 40.0, 225.0, 370.0, 200.0, 475.0, 160.0, 250.0, 220.0, 85.0, 100.0, 310.0, 265.0, 190.0, 10.0, 425.0, 345.0, -40.0, -230.0, 45.0, 110.0, 140.0, -40.0, 235.0, 170.0, 350.0, 370.0, 440.0, 365.0, 115.0, 80.0, 225.0, 220.0, -25.0, 115.0, 340.0, 35.0, 210.0, 325.0, 400.0, 180.0, -200.0, 185.0, 260.0, 515.0, 215.0, 225.0, 565.0, 245.0, 555.0, 150.0, 185.0, 145.0, 315.0, 180.0, 245.0, 420.0, 125.0, 205.0, 370.0, 145.0, 350.0, 55.0, 365.0, 55.0, 325.0, 20.0, 45.0, 190.0, 270.0, 190.0, 215.0, 365.0, 285.0, 205.0, 270.0, 160.0, 235.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1394449331219434, "mean_inference_ms": 1.5153711608461122, "mean_action_processing_ms": 0.5592870653879446, "mean_env_wait_ms": 0.1965129022291373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1597764492034912, "StateBufferConnector_ms": 0.006291627883911133, "ViewRequirementAgentConnector_ms": 0.32494330406188965}}, "episode_reward_max": 565.0, "episode_reward_min": -230.0, "episode_reward_mean": 211.85, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [160.0, 480.0, 195.0, 170.0, 215.0, -70.0, 180.0, 360.0, 215.0, 210.0, 355.0, 25.0, 185.0, 185.0, 145.0, 130.0, 10.0, 355.0, 320.0, 370.0, 160.0, 125.0, 250.0, 40.0, 225.0, 370.0, 200.0, 475.0, 160.0, 250.0, 220.0, 85.0, 100.0, 310.0, 265.0, 190.0, 10.0, 425.0, 345.0, -40.0, -230.0, 45.0, 110.0, 140.0, -40.0, 235.0, 170.0, 350.0, 370.0, 440.0, 365.0, 115.0, 80.0, 225.0, 220.0, -25.0, 115.0, 340.0, 35.0, 210.0, 325.0, 400.0, 180.0, -200.0, 185.0, 260.0, 515.0, 215.0, 225.0, 565.0, 245.0, 555.0, 150.0, 185.0, 145.0, 315.0, 180.0, 245.0, 420.0, 125.0, 205.0, 370.0, 145.0, 350.0, 55.0, 365.0, 55.0, 325.0, 20.0, 45.0, 190.0, 270.0, 190.0, 215.0, 365.0, 285.0, 205.0, 270.0, 160.0, 235.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1394449331219434, "mean_inference_ms": 1.5153711608461122, "mean_action_processing_ms": 0.5592870653879446, "mean_env_wait_ms": 0.1965129022291373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1597764492034912, "StateBufferConnector_ms": 0.006291627883911133, "ViewRequirementAgentConnector_ms": 0.32494330406188965}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4792320, "num_agent_steps_trained": 4792320, "num_env_steps_sampled": 958464, "num_env_steps_trained": 958464, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.34646601511118, "num_env_steps_trained_throughput_per_sec": 67.34646601511118, "timesteps_total": 958464, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4792320, "timers": {"training_iteration_time_ms": 120977.173, "sample_time_ms": 14198.99, "load_time_ms": 1.758, "load_throughput": 4660717.068, "learn_time_ms": 106767.296, "learn_throughput": 76.728, "synch_weights_time_ms": 2.816}, "counters": {"num_env_steps_sampled": 958464, "num_env_steps_trained": 958464, "num_agent_steps_sampled": 4792320, "num_agent_steps_trained": 4792320}, "done": false, "episodes_total": 7488, "training_iteration": 117, "trial_id": "9fade_00019", "date": "2023-11-09_23-31-34", "timestamp": 1699569094, "time_this_iter_s": 121.65582847595215, "time_total_s": 12842.534305334091, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12842.534305334091, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 37.092528735632186, "ram_util_percent": 18.791954022988506}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6681891926789528, "episode_optimality_min": -0.2698412698412698, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6681891926789528, "episode_optimality_capped_min": -0.2698412698412698, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.35, "episode_reward_normalized_min": -17.0, "episode_reward_normalized_max": 113.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6681891926789528, "curr_learning_score_min": -0.2698412698412698, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9882328370399773, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23268867071533653, "policy_loss": -0.07118202174181837, "vf_loss": 0.28817363222990633, "vf_explained_var": 0.422255608458072, "kl": 0.015503268389959619, "entropy": 3.0390045692771674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1128000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 966656, "num_env_steps_trained": 966656, "num_agent_steps_sampled": 4833280, "num_agent_steps_trained": 4833280}, "sampler_results": {"episode_reward_max": 565.0, "episode_reward_min": -85.0, "episode_reward_mean": 226.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6681891926789528, "episode_optimality_min": -0.2698412698412698, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6681891926789528, "episode_optimality_capped_min": -0.2698412698412698, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.35, "episode_reward_normalized_min": -17.0, "episode_reward_normalized_max": 113.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6681891926789528, "curr_learning_score_min": -0.2698412698412698, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [185.0, 260.0, 515.0, 215.0, 225.0, 565.0, 245.0, 555.0, 150.0, 185.0, 145.0, 315.0, 180.0, 245.0, 420.0, 125.0, 205.0, 370.0, 145.0, 350.0, 55.0, 365.0, 55.0, 325.0, 20.0, 45.0, 190.0, 270.0, 190.0, 215.0, 365.0, 285.0, 205.0, 270.0, 160.0, 235.0, 85.0, 185.0, 145.0, 440.0, 330.0, 280.0, 150.0, 200.0, 385.0, 355.0, 130.0, 385.0, 70.0, 100.0, -50.0, 180.0, 310.0, 300.0, 230.0, 200.0, -85.0, 75.0, 130.0, 270.0, 220.0, 110.0, 270.0, 270.0, 250.0, 195.0, 160.0, 275.0, 80.0, 175.0, 450.0, 150.0, 185.0, 130.0, 205.0, 385.0, 200.0, 250.0, 275.0, 130.0, 310.0, 165.0, 10.0, 425.0, 280.0, 20.0, -10.0, 425.0, 115.0, 250.0, 470.0, 225.0, 470.0, 215.0, 330.0, -25.0, 190.0, 290.0, 420.0, 85.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1393562045984418, "mean_inference_ms": 1.5152899700153086, "mean_action_processing_ms": 0.5592391356192579, "mean_env_wait_ms": 0.19649833376908976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16017651557922363, "StateBufferConnector_ms": 0.006256818771362305, "ViewRequirementAgentConnector_ms": 0.32605767250061035}}, "episode_reward_max": 565.0, "episode_reward_min": -85.0, "episode_reward_mean": 226.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [185.0, 260.0, 515.0, 215.0, 225.0, 565.0, 245.0, 555.0, 150.0, 185.0, 145.0, 315.0, 180.0, 245.0, 420.0, 125.0, 205.0, 370.0, 145.0, 350.0, 55.0, 365.0, 55.0, 325.0, 20.0, 45.0, 190.0, 270.0, 190.0, 215.0, 365.0, 285.0, 205.0, 270.0, 160.0, 235.0, 85.0, 185.0, 145.0, 440.0, 330.0, 280.0, 150.0, 200.0, 385.0, 355.0, 130.0, 385.0, 70.0, 100.0, -50.0, 180.0, 310.0, 300.0, 230.0, 200.0, -85.0, 75.0, 130.0, 270.0, 220.0, 110.0, 270.0, 270.0, 250.0, 195.0, 160.0, 275.0, 80.0, 175.0, 450.0, 150.0, 185.0, 130.0, 205.0, 385.0, 200.0, 250.0, 275.0, 130.0, 310.0, 165.0, 10.0, 425.0, 280.0, 20.0, -10.0, 425.0, 115.0, 250.0, 470.0, 225.0, 470.0, 215.0, 330.0, -25.0, 190.0, 290.0, 420.0, 85.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1393562045984418, "mean_inference_ms": 1.5152899700153086, "mean_action_processing_ms": 0.5592391356192579, "mean_env_wait_ms": 0.19649833376908976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16017651557922363, "StateBufferConnector_ms": 0.006256818771362305, "ViewRequirementAgentConnector_ms": 0.32605767250061035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4833280, "num_agent_steps_trained": 4833280, "num_env_steps_sampled": 966656, "num_env_steps_trained": 966656, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.99095155140058, "num_env_steps_trained_throughput_per_sec": 66.99095155140058, "timesteps_total": 966656, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4833280, "timers": {"training_iteration_time_ms": 121254.87, "sample_time_ms": 14271.376, "load_time_ms": 1.729, "load_throughput": 4737640.588, "learn_time_ms": 106972.562, "learn_throughput": 76.58, "synch_weights_time_ms": 2.859}, "counters": {"num_env_steps_sampled": 966656, "num_env_steps_trained": 966656, "num_agent_steps_sampled": 4833280, "num_agent_steps_trained": 4833280}, "done": false, "episodes_total": 7552, "training_iteration": 118, "trial_id": "9fade_00019", "date": "2023-11-09_23-33-39", "timestamp": 1699569219, "time_this_iter_s": 122.30308032035828, "time_total_s": 12964.83738565445, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 12964.83738565445, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 37.67078651685393, "ram_util_percent": 18.710112359550564}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6506008177915734, "episode_optimality_min": -0.6363636363636364, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6506008177915734, "episode_optimality_capped_min": -0.6363636363636364, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.86, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6506008177915734, "curr_learning_score_min": -0.6363636363636364, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9754123705066741, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.22492285823197258, "policy_loss": -0.07074717243056511, "vf_loss": 0.2802429621752405, "vf_explained_var": 0.400917831659317, "kl": 0.015236610798480115, "entropy": 3.026149323085944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1137600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 974848, "num_env_steps_trained": 974848, "num_agent_steps_sampled": 4874240, "num_agent_steps_trained": 4874240}, "sampler_results": {"episode_reward_max": 615.0, "episode_reward_min": -140.0, "episode_reward_mean": 224.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6506008177915734, "episode_optimality_min": -0.6363636363636364, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6506008177915734, "episode_optimality_capped_min": -0.6363636363636364, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.86, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6506008177915734, "curr_learning_score_min": -0.6363636363636364, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [250.0, 195.0, 160.0, 275.0, 80.0, 175.0, 450.0, 150.0, 185.0, 130.0, 205.0, 385.0, 200.0, 250.0, 275.0, 130.0, 310.0, 165.0, 10.0, 425.0, 280.0, 20.0, -10.0, 425.0, 115.0, 250.0, 470.0, 225.0, 470.0, 215.0, 330.0, -25.0, 190.0, 290.0, 420.0, 85.0, -130.0, 175.0, 335.0, -25.0, 440.0, 370.0, 220.0, 385.0, 460.0, 190.0, 135.0, 90.0, 260.0, 570.0, 400.0, 135.0, 55.0, 145.0, 415.0, 230.0, 485.0, 165.0, 195.0, 250.0, 380.0, 25.0, 355.0, 180.0, 455.0, 140.0, 240.0, 265.0, 200.0, -5.0, 30.0, 395.0, 195.0, 55.0, 615.0, -35.0, 195.0, 220.0, 585.0, 340.0, 140.0, 175.0, 320.0, 180.0, 50.0, -140.0, 120.0, 300.0, -20.0, 305.0, 325.0, 55.0, 90.0, -70.0, 55.0, 465.0, 285.0, 540.0, 220.0, 100.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139418852350939, "mean_inference_ms": 1.5157871515347592, "mean_action_processing_ms": 0.5592581647542619, "mean_env_wait_ms": 0.19654241352938723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1611177921295166, "StateBufferConnector_ms": 0.006392002105712891, "ViewRequirementAgentConnector_ms": 0.3329620361328125}}, "episode_reward_max": 615.0, "episode_reward_min": -140.0, "episode_reward_mean": 224.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [250.0, 195.0, 160.0, 275.0, 80.0, 175.0, 450.0, 150.0, 185.0, 130.0, 205.0, 385.0, 200.0, 250.0, 275.0, 130.0, 310.0, 165.0, 10.0, 425.0, 280.0, 20.0, -10.0, 425.0, 115.0, 250.0, 470.0, 225.0, 470.0, 215.0, 330.0, -25.0, 190.0, 290.0, 420.0, 85.0, -130.0, 175.0, 335.0, -25.0, 440.0, 370.0, 220.0, 385.0, 460.0, 190.0, 135.0, 90.0, 260.0, 570.0, 400.0, 135.0, 55.0, 145.0, 415.0, 230.0, 485.0, 165.0, 195.0, 250.0, 380.0, 25.0, 355.0, 180.0, 455.0, 140.0, 240.0, 265.0, 200.0, -5.0, 30.0, 395.0, 195.0, 55.0, 615.0, -35.0, 195.0, 220.0, 585.0, 340.0, 140.0, 175.0, 320.0, 180.0, 50.0, -140.0, 120.0, 300.0, -20.0, 305.0, 325.0, 55.0, 90.0, -70.0, 55.0, 465.0, 285.0, 540.0, 220.0, 100.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139418852350939, "mean_inference_ms": 1.5157871515347592, "mean_action_processing_ms": 0.5592581647542619, "mean_env_wait_ms": 0.19654241352938723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1611177921295166, "StateBufferConnector_ms": 0.006392002105712891, "ViewRequirementAgentConnector_ms": 0.3329620361328125}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4874240, "num_agent_steps_trained": 4874240, "num_env_steps_sampled": 974848, "num_env_steps_trained": 974848, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.05872084149078, "num_env_steps_trained_throughput_per_sec": 67.05872084149078, "timesteps_total": 974848, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4874240, "timers": {"training_iteration_time_ms": 121528.736, "sample_time_ms": 14312.402, "load_time_ms": 1.712, "load_throughput": 4784013.028, "learn_time_ms": 107205.284, "learn_throughput": 76.414, "synch_weights_time_ms": 2.981}, "counters": {"num_env_steps_sampled": 974848, "num_env_steps_trained": 974848, "num_agent_steps_sampled": 4874240, "num_agent_steps_trained": 4874240}, "done": false, "episodes_total": 7616, "training_iteration": 119, "trial_id": "9fade_00019", "date": "2023-11-09_23-35-42", "timestamp": 1699569342, "time_this_iter_s": 122.1786994934082, "time_total_s": 13087.016085147858, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13087.016085147858, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 37.40228571428571, "ram_util_percent": 18.744571428571433}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6013540475407383, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6013540475407383, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.6, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6013540475407383, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9825206446647644, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.26113547660517117, "policy_loss": -0.07379273757648964, "vf_loss": 0.31888420501033277, "vf_explained_var": 0.371564324858288, "kl": 0.015845934150275222, "entropy": 2.9921149728943903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1147200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 983040, "num_env_steps_trained": 983040, "num_agent_steps_sampled": 4915200, "num_agent_steps_trained": 4915200}, "sampler_results": {"episode_reward_max": 615.0, "episode_reward_min": -140.0, "episode_reward_mean": 208.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6013540475407383, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6013540475407383, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.6, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 123.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6013540475407383, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [455.0, 140.0, 240.0, 265.0, 200.0, -5.0, 30.0, 395.0, 195.0, 55.0, 615.0, -35.0, 195.0, 220.0, 585.0, 340.0, 140.0, 175.0, 320.0, 180.0, 50.0, -140.0, 120.0, 300.0, -20.0, 305.0, 325.0, 55.0, 90.0, -70.0, 55.0, 465.0, 285.0, 540.0, 220.0, 100.0, 330.0, 225.0, 135.0, 180.0, 135.0, 75.0, 315.0, 115.0, 150.0, 375.0, 160.0, 200.0, 240.0, 0.0, 205.0, -105.0, 30.0, 435.0, 265.0, 165.0, -75.0, -85.0, 205.0, 240.0, 140.0, 585.0, 260.0, 65.0, 490.0, 65.0, 405.0, 145.0, 285.0, 305.0, -10.0, 365.0, 110.0, 15.0, 70.0, 220.0, 185.0, 465.0, 505.0, 185.0, 220.0, 100.0, 240.0, 210.0, 405.0, 50.0, 550.0, 140.0, 570.0, 275.0, 370.0, 150.0, 315.0, 235.0, 115.0, 215.0, -100.0, 155.0, 315.0, 115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139373642558604, "mean_inference_ms": 1.5159652591106971, "mean_action_processing_ms": 0.5592312655500353, "mean_env_wait_ms": 0.1965403071293121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1594710350036621, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.3274867534637451}}, "episode_reward_max": 615.0, "episode_reward_min": -140.0, "episode_reward_mean": 208.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [455.0, 140.0, 240.0, 265.0, 200.0, -5.0, 30.0, 395.0, 195.0, 55.0, 615.0, -35.0, 195.0, 220.0, 585.0, 340.0, 140.0, 175.0, 320.0, 180.0, 50.0, -140.0, 120.0, 300.0, -20.0, 305.0, 325.0, 55.0, 90.0, -70.0, 55.0, 465.0, 285.0, 540.0, 220.0, 100.0, 330.0, 225.0, 135.0, 180.0, 135.0, 75.0, 315.0, 115.0, 150.0, 375.0, 160.0, 200.0, 240.0, 0.0, 205.0, -105.0, 30.0, 435.0, 265.0, 165.0, -75.0, -85.0, 205.0, 240.0, 140.0, 585.0, 260.0, 65.0, 490.0, 65.0, 405.0, 145.0, 285.0, 305.0, -10.0, 365.0, 110.0, 15.0, 70.0, 220.0, 185.0, 465.0, 505.0, 185.0, 220.0, 100.0, 240.0, 210.0, 405.0, 50.0, 550.0, 140.0, 570.0, 275.0, 370.0, 150.0, 315.0, 235.0, 115.0, 215.0, -100.0, 155.0, 315.0, 115.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.139373642558604, "mean_inference_ms": 1.5159652591106971, "mean_action_processing_ms": 0.5592312655500353, "mean_env_wait_ms": 0.1965403071293121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1594710350036621, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.3274867534637451}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4915200, "num_agent_steps_trained": 4915200, "num_env_steps_sampled": 983040, "num_env_steps_trained": 983040, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.09237277339618, "num_env_steps_trained_throughput_per_sec": 67.09237277339618, "timesteps_total": 983040, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4915200, "timers": {"training_iteration_time_ms": 121694.07, "sample_time_ms": 14309.633, "load_time_ms": 1.726, "load_throughput": 4745361.411, "learn_time_ms": 107373.325, "learn_throughput": 76.295, "synch_weights_time_ms": 3.007}, "counters": {"num_env_steps_sampled": 983040, "num_env_steps_trained": 983040, "num_agent_steps_sampled": 4915200, "num_agent_steps_trained": 4915200}, "done": false, "episodes_total": 7680, "training_iteration": 120, "trial_id": "9fade_00019", "date": "2023-11-09_23-37-44", "timestamp": 1699569464, "time_this_iter_s": 122.11516976356506, "time_total_s": 13209.131254911423, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13209.131254911423, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 37.572988505747134, "ram_util_percent": 18.754022988505753}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6077962578398395, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6077962578398395, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.13, "episode_reward_normalized_min": -20.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6077962578398395, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9868077732281139, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.26828625099466685, "policy_loss": -0.07629634105595566, "vf_loss": 0.3281589662642606, "vf_explained_var": 0.37080639698853096, "kl": 0.01622086442096683, "entropy": 3.0144057665516932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1156800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 991232, "num_env_steps_trained": 991232, "num_agent_steps_sampled": 4956160, "num_agent_steps_trained": 4956160}, "sampler_results": {"episode_reward_max": 570.0, "episode_reward_min": -100.0, "episode_reward_mean": 215.65, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6077962578398395, "episode_optimality_min": -0.9090909090909091, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6077962578398395, "episode_optimality_capped_min": -0.9090909090909091, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.13, "episode_reward_normalized_min": -20.0, "episode_reward_normalized_max": 114.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6077962578398395, "curr_learning_score_min": -0.9090909090909091, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [490.0, 65.0, 405.0, 145.0, 285.0, 305.0, -10.0, 365.0, 110.0, 15.0, 70.0, 220.0, 185.0, 465.0, 505.0, 185.0, 220.0, 100.0, 240.0, 210.0, 405.0, 50.0, 550.0, 140.0, 570.0, 275.0, 370.0, 150.0, 315.0, 235.0, 115.0, 215.0, -100.0, 155.0, 315.0, 115.0, 255.0, 295.0, 115.0, 285.0, 380.0, 220.0, 330.0, 410.0, 180.0, 565.0, 110.0, 25.0, 360.0, 420.0, 395.0, 30.0, 35.0, 235.0, 85.0, 205.0, 330.0, 150.0, 170.0, 55.0, 255.0, 230.0, 440.0, 270.0, 80.0, 140.0, 55.0, 175.0, 30.0, 45.0, 60.0, 100.0, 0.0, 245.0, 325.0, 310.0, 285.0, -20.0, 190.0, 380.0, 220.0, 140.0, 425.0, 150.0, 30.0, 395.0, -40.0, 25.0, -55.0, 165.0, 160.0, 485.0, 65.0, 355.0, 110.0, 395.0, 35.0, 305.0, 275.0, 240.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1391412344157856, "mean_inference_ms": 1.5154115235583532, "mean_action_processing_ms": 0.5591157459125315, "mean_env_wait_ms": 0.19646116298254682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15882492065429688, "StateBufferConnector_ms": 0.00613856315612793, "ViewRequirementAgentConnector_ms": 0.3176136016845703}}, "episode_reward_max": 570.0, "episode_reward_min": -100.0, "episode_reward_mean": 215.65, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [490.0, 65.0, 405.0, 145.0, 285.0, 305.0, -10.0, 365.0, 110.0, 15.0, 70.0, 220.0, 185.0, 465.0, 505.0, 185.0, 220.0, 100.0, 240.0, 210.0, 405.0, 50.0, 550.0, 140.0, 570.0, 275.0, 370.0, 150.0, 315.0, 235.0, 115.0, 215.0, -100.0, 155.0, 315.0, 115.0, 255.0, 295.0, 115.0, 285.0, 380.0, 220.0, 330.0, 410.0, 180.0, 565.0, 110.0, 25.0, 360.0, 420.0, 395.0, 30.0, 35.0, 235.0, 85.0, 205.0, 330.0, 150.0, 170.0, 55.0, 255.0, 230.0, 440.0, 270.0, 80.0, 140.0, 55.0, 175.0, 30.0, 45.0, 60.0, 100.0, 0.0, 245.0, 325.0, 310.0, 285.0, -20.0, 190.0, 380.0, 220.0, 140.0, 425.0, 150.0, 30.0, 395.0, -40.0, 25.0, -55.0, 165.0, 160.0, 485.0, 65.0, 355.0, 110.0, 395.0, 35.0, 305.0, 275.0, 240.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1391412344157856, "mean_inference_ms": 1.5154115235583532, "mean_action_processing_ms": 0.5591157459125315, "mean_env_wait_ms": 0.19646116298254682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15882492065429688, "StateBufferConnector_ms": 0.00613856315612793, "ViewRequirementAgentConnector_ms": 0.3176136016845703}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4956160, "num_agent_steps_trained": 4956160, "num_env_steps_sampled": 991232, "num_env_steps_trained": 991232, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.0814718312554, "num_env_steps_trained_throughput_per_sec": 67.0814718312554, "timesteps_total": 991232, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4956160, "timers": {"training_iteration_time_ms": 121897.312, "sample_time_ms": 14233.512, "load_time_ms": 1.677, "load_throughput": 4885224.553, "learn_time_ms": 107652.755, "learn_throughput": 76.097, "synch_weights_time_ms": 3.053}, "counters": {"num_env_steps_sampled": 991232, "num_env_steps_trained": 991232, "num_agent_steps_sampled": 4956160, "num_agent_steps_trained": 4956160}, "done": false, "episodes_total": 7744, "training_iteration": 121, "trial_id": "9fade_00019", "date": "2023-11-09_23-39-47", "timestamp": 1699569587, "time_this_iter_s": 122.13674306869507, "time_total_s": 13331.267997980118, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13331.267997980118, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 37.913714285714285, "ram_util_percent": 18.80457142857143}, "checkpoint_dir_name": "checkpoint_000004"}
{"custom_metrics": {"episode_optimality_mean": 0.5519963052190338, "episode_optimality_min": -0.3333333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5519963052190338, "episode_optimality_capped_min": -0.3333333333333333, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.45, "episode_reward_normalized_min": -14.0, "episode_reward_normalized_max": 97.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5519963052190338, "curr_learning_score_min": -0.3333333333333333, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9848689999928077, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.253478670713921, "policy_loss": -0.07236051138586239, "vf_loss": 0.309830914940588, "vf_explained_var": 0.40217233389616014, "kl": 0.015810633287729844, "entropy": 3.0140818726023038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1166400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 999424, "num_env_steps_trained": 999424, "num_agent_steps_sampled": 4997120, "num_agent_steps_trained": 4997120}, "sampler_results": {"episode_reward_max": 485.0, "episode_reward_min": -70.0, "episode_reward_mean": 192.25, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5519963052190338, "episode_optimality_min": -0.3333333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5519963052190338, "episode_optimality_capped_min": -0.3333333333333333, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.45, "episode_reward_normalized_min": -14.0, "episode_reward_normalized_max": 97.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5519963052190338, "curr_learning_score_min": -0.3333333333333333, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [80.0, 140.0, 55.0, 175.0, 30.0, 45.0, 60.0, 100.0, 0.0, 245.0, 325.0, 310.0, 285.0, -20.0, 190.0, 380.0, 220.0, 140.0, 425.0, 150.0, 30.0, 395.0, -40.0, 25.0, -55.0, 165.0, 160.0, 485.0, 65.0, 355.0, 110.0, 395.0, 35.0, 305.0, 275.0, 240.0, 85.0, -10.0, 135.0, 15.0, 45.0, 395.0, 345.0, 10.0, 390.0, 225.0, 175.0, 35.0, 105.0, 215.0, 480.0, 460.0, 210.0, 90.0, 45.0, 465.0, 180.0, 85.0, 350.0, 95.0, 100.0, 300.0, 120.0, 305.0, 35.0, 355.0, 355.0, 375.0, 190.0, 140.0, -20.0, 95.0, 410.0, -30.0, 245.0, 415.0, 370.0, 270.0, 305.0, 110.0, 205.0, 325.0, 405.0, 255.0, 140.0, 280.0, 355.0, 185.0, -70.0, 5.0, 0.0, 130.0, 150.0, 245.0, 215.0, 395.0, 100.0, 100.0, 65.0, 390.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1389037028613922, "mean_inference_ms": 1.5146924517424498, "mean_action_processing_ms": 0.559011650374382, "mean_env_wait_ms": 0.19636273109370478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15851044654846191, "StateBufferConnector_ms": 0.006061077117919922, "ViewRequirementAgentConnector_ms": 0.3174600601196289}}, "episode_reward_max": 485.0, "episode_reward_min": -70.0, "episode_reward_mean": 192.25, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [80.0, 140.0, 55.0, 175.0, 30.0, 45.0, 60.0, 100.0, 0.0, 245.0, 325.0, 310.0, 285.0, -20.0, 190.0, 380.0, 220.0, 140.0, 425.0, 150.0, 30.0, 395.0, -40.0, 25.0, -55.0, 165.0, 160.0, 485.0, 65.0, 355.0, 110.0, 395.0, 35.0, 305.0, 275.0, 240.0, 85.0, -10.0, 135.0, 15.0, 45.0, 395.0, 345.0, 10.0, 390.0, 225.0, 175.0, 35.0, 105.0, 215.0, 480.0, 460.0, 210.0, 90.0, 45.0, 465.0, 180.0, 85.0, 350.0, 95.0, 100.0, 300.0, 120.0, 305.0, 35.0, 355.0, 355.0, 375.0, 190.0, 140.0, -20.0, 95.0, 410.0, -30.0, 245.0, 415.0, 370.0, 270.0, 305.0, 110.0, 205.0, 325.0, 405.0, 255.0, 140.0, 280.0, 355.0, 185.0, -70.0, 5.0, 0.0, 130.0, 150.0, 245.0, 215.0, 395.0, 100.0, 100.0, 65.0, 390.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1389037028613922, "mean_inference_ms": 1.5146924517424498, "mean_action_processing_ms": 0.559011650374382, "mean_env_wait_ms": 0.19636273109370478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15851044654846191, "StateBufferConnector_ms": 0.006061077117919922, "ViewRequirementAgentConnector_ms": 0.3174600601196289}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4997120, "num_agent_steps_trained": 4997120, "num_env_steps_sampled": 999424, "num_env_steps_trained": 999424, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.40156847547358, "num_env_steps_trained_throughput_per_sec": 67.40156847547358, "timesteps_total": 999424, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 4997120, "timers": {"training_iteration_time_ms": 122049.129, "sample_time_ms": 14155.826, "load_time_ms": 1.657, "load_throughput": 4942922.672, "learn_time_ms": 107882.413, "learn_throughput": 75.935, "synch_weights_time_ms": 2.964}, "counters": {"num_env_steps_sampled": 999424, "num_env_steps_trained": 999424, "num_agent_steps_sampled": 4997120, "num_agent_steps_trained": 4997120}, "done": false, "episodes_total": 7808, "training_iteration": 122, "trial_id": "9fade_00019", "date": "2023-11-09_23-41-48", "timestamp": 1699569708, "time_this_iter_s": 121.55552363395691, "time_total_s": 13452.823521614075, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13452.823521614075, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 37.39080459770115, "ram_util_percent": 18.914367816091957}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6562092389792811, "episode_optimality_min": -0.5409836065573771, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6562092389792811, "episode_optimality_capped_min": -0.5409836065573771, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.2, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6562092389792811, "curr_learning_score_min": -0.5409836065573771, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9763090614213918, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.235450330123446, "policy_loss": -0.07013762004103531, "vf_loss": 0.29043396836944113, "vf_explained_var": 0.4089942982668678, "kl": 0.014966894630694394, "entropy": 3.0147897971669835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1176000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1007616, "num_env_steps_trained": 1007616, "num_agent_steps_sampled": 5038080, "num_agent_steps_trained": 5038080}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -165.0, "episode_reward_mean": 231.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6562092389792811, "episode_optimality_min": -0.5409836065573771, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6562092389792811, "episode_optimality_capped_min": -0.5409836065573771, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.2, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6562092389792811, "curr_learning_score_min": -0.5409836065573771, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [35.0, 355.0, 355.0, 375.0, 190.0, 140.0, -20.0, 95.0, 410.0, -30.0, 245.0, 415.0, 370.0, 270.0, 305.0, 110.0, 205.0, 325.0, 405.0, 255.0, 140.0, 280.0, 355.0, 185.0, -70.0, 5.0, 0.0, 130.0, 150.0, 245.0, 215.0, 395.0, 100.0, 100.0, 65.0, 390.0, 130.0, 310.0, 420.0, 40.0, 275.0, 515.0, 20.0, 330.0, 450.0, -45.0, 540.0, 245.0, 185.0, 265.0, 335.0, 155.0, 135.0, 320.0, 285.0, -25.0, 125.0, 195.0, 370.0, 255.0, 210.0, 305.0, 545.0, 280.0, 275.0, 185.0, 235.0, 385.0, 180.0, 160.0, 365.0, 630.0, 40.0, 320.0, 260.0, 170.0, 195.0, 175.0, 75.0, 45.0, 195.0, 220.0, 525.0, -165.0, 455.0, 320.0, 200.0, 335.0, 160.0, 215.0, 390.0, 140.0, 190.0, 290.0, 110.0, 360.0, 205.0, 260.0, 75.0, 260.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1386711895970725, "mean_inference_ms": 1.5140047988764365, "mean_action_processing_ms": 0.5589114323335289, "mean_env_wait_ms": 0.19627323351684273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15967917442321777, "StateBufferConnector_ms": 0.00611424446105957, "ViewRequirementAgentConnector_ms": 0.3186521530151367}}, "episode_reward_max": 630.0, "episode_reward_min": -165.0, "episode_reward_mean": 231.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.0, 355.0, 355.0, 375.0, 190.0, 140.0, -20.0, 95.0, 410.0, -30.0, 245.0, 415.0, 370.0, 270.0, 305.0, 110.0, 205.0, 325.0, 405.0, 255.0, 140.0, 280.0, 355.0, 185.0, -70.0, 5.0, 0.0, 130.0, 150.0, 245.0, 215.0, 395.0, 100.0, 100.0, 65.0, 390.0, 130.0, 310.0, 420.0, 40.0, 275.0, 515.0, 20.0, 330.0, 450.0, -45.0, 540.0, 245.0, 185.0, 265.0, 335.0, 155.0, 135.0, 320.0, 285.0, -25.0, 125.0, 195.0, 370.0, 255.0, 210.0, 305.0, 545.0, 280.0, 275.0, 185.0, 235.0, 385.0, 180.0, 160.0, 365.0, 630.0, 40.0, 320.0, 260.0, 170.0, 195.0, 175.0, 75.0, 45.0, 195.0, 220.0, 525.0, -165.0, 455.0, 320.0, 200.0, 335.0, 160.0, 215.0, 390.0, 140.0, 190.0, 290.0, 110.0, 360.0, 205.0, 260.0, 75.0, 260.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1386711895970725, "mean_inference_ms": 1.5140047988764365, "mean_action_processing_ms": 0.5589114323335289, "mean_env_wait_ms": 0.19627323351684273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15967917442321777, "StateBufferConnector_ms": 0.00611424446105957, "ViewRequirementAgentConnector_ms": 0.3186521530151367}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5038080, "num_agent_steps_trained": 5038080, "num_env_steps_sampled": 1007616, "num_env_steps_trained": 1007616, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.49282328966737, "num_env_steps_trained_throughput_per_sec": 67.49282328966737, "timesteps_total": 1007616, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5038080, "timers": {"training_iteration_time_ms": 121882.308, "sample_time_ms": 14055.089, "load_time_ms": 1.688, "load_throughput": 4852864.761, "learn_time_ms": 107816.496, "learn_throughput": 75.981, "synch_weights_time_ms": 2.867}, "counters": {"num_env_steps_sampled": 1007616, "num_env_steps_trained": 1007616, "num_agent_steps_sampled": 5038080, "num_agent_steps_trained": 5038080}, "done": false, "episodes_total": 7872, "training_iteration": 123, "trial_id": "9fade_00019", "date": "2023-11-09_23-43-51", "timestamp": 1699569831, "time_this_iter_s": 121.39124512672424, "time_total_s": 13574.214766740799, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13574.214766740799, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 37.56149425287356, "ram_util_percent": 18.789655172413795}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.649089407381223, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.649089407381223, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.67, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.649089407381223, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9858534863187621, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25260745020934944, "policy_loss": -0.0731552498949956, "vf_loss": 0.30957849035249335, "vf_explained_var": 0.3824026890906195, "kl": 0.015984404344139117, "entropy": 2.980655890405178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1185600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1015808, "num_env_steps_trained": 1015808, "num_agent_steps_sampled": 5079040, "num_agent_steps_trained": 5079040}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -165.0, "episode_reward_mean": 228.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.649089407381223, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.649089407381223, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.67, "episode_reward_normalized_min": -33.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.649089407381223, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [275.0, 185.0, 235.0, 385.0, 180.0, 160.0, 365.0, 630.0, 40.0, 320.0, 260.0, 170.0, 195.0, 175.0, 75.0, 45.0, 195.0, 220.0, 525.0, -165.0, 455.0, 320.0, 200.0, 335.0, 160.0, 215.0, 390.0, 140.0, 190.0, 290.0, 110.0, 360.0, 205.0, 260.0, 75.0, 260.0, 275.0, -35.0, 160.0, 140.0, 505.0, 285.0, 180.0, 430.0, 95.0, 25.0, 210.0, 385.0, 345.0, 380.0, 270.0, 415.0, 400.0, 95.0, 350.0, 220.0, 435.0, 235.0, -70.0, 10.0, 270.0, 45.0, 165.0, 155.0, 60.0, 540.0, 130.0, 460.0, 325.0, 25.0, 260.0, 195.0, 365.0, 290.0, 195.0, 405.0, -35.0, 320.0, 190.0, 315.0, 180.0, 225.0, -70.0, 255.0, 300.0, 290.0, 440.0, 0.0, 195.0, 140.0, 95.0, 120.0, 95.0, 390.0, 250.0, 265.0, 45.0, 340.0, 245.0, 185.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1384965321000902, "mean_inference_ms": 1.5139340593371156, "mean_action_processing_ms": 0.558827416044741, "mean_env_wait_ms": 0.1962517076600965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15811514854431152, "StateBufferConnector_ms": 0.00614166259765625, "ViewRequirementAgentConnector_ms": 0.32277464866638184}}, "episode_reward_max": 630.0, "episode_reward_min": -165.0, "episode_reward_mean": 228.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [275.0, 185.0, 235.0, 385.0, 180.0, 160.0, 365.0, 630.0, 40.0, 320.0, 260.0, 170.0, 195.0, 175.0, 75.0, 45.0, 195.0, 220.0, 525.0, -165.0, 455.0, 320.0, 200.0, 335.0, 160.0, 215.0, 390.0, 140.0, 190.0, 290.0, 110.0, 360.0, 205.0, 260.0, 75.0, 260.0, 275.0, -35.0, 160.0, 140.0, 505.0, 285.0, 180.0, 430.0, 95.0, 25.0, 210.0, 385.0, 345.0, 380.0, 270.0, 415.0, 400.0, 95.0, 350.0, 220.0, 435.0, 235.0, -70.0, 10.0, 270.0, 45.0, 165.0, 155.0, 60.0, 540.0, 130.0, 460.0, 325.0, 25.0, 260.0, 195.0, 365.0, 290.0, 195.0, 405.0, -35.0, 320.0, 190.0, 315.0, 180.0, 225.0, -70.0, 255.0, 300.0, 290.0, 440.0, 0.0, 195.0, 140.0, 95.0, 120.0, 95.0, 390.0, 250.0, 265.0, 45.0, 340.0, 245.0, 185.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1384965321000902, "mean_inference_ms": 1.5139340593371156, "mean_action_processing_ms": 0.558827416044741, "mean_env_wait_ms": 0.1962517076600965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15811514854431152, "StateBufferConnector_ms": 0.00614166259765625, "ViewRequirementAgentConnector_ms": 0.32277464866638184}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5079040, "num_agent_steps_trained": 5079040, "num_env_steps_sampled": 1015808, "num_env_steps_trained": 1015808, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.8138560314169, "num_env_steps_trained_throughput_per_sec": 66.8138560314169, "timesteps_total": 1015808, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5079040, "timers": {"training_iteration_time_ms": 122012.955, "sample_time_ms": 14039.086, "load_time_ms": 1.663, "load_throughput": 4924574.094, "learn_time_ms": 107963.267, "learn_throughput": 75.878, "synch_weights_time_ms": 2.858}, "counters": {"num_env_steps_sampled": 1015808, "num_env_steps_trained": 1015808, "num_agent_steps_sampled": 5079040, "num_agent_steps_trained": 5079040}, "done": false, "episodes_total": 7936, "training_iteration": 124, "trial_id": "9fade_00019", "date": "2023-11-09_23-45-54", "timestamp": 1699569954, "time_this_iter_s": 122.62165689468384, "time_total_s": 13696.836423635483, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13696.836423635483, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 37.68628571428572, "ram_util_percent": 18.82628571428572}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6645807633514046, "episode_optimality_min": -0.48, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6645807633514046, "episode_optimality_capped_min": -0.48, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 48.4, "episode_reward_normalized_min": -14.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6645807633514046, "curr_learning_score_min": -0.48, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9827852336193125, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.22953696107292976, "policy_loss": -0.0742084791889162, "vf_loss": 0.287858915869236, "vf_explained_var": 0.3911175931431353, "kl": 0.015690393674579656, "entropy": 2.961634987692038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1195200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -70.0, "episode_reward_mean": 242.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6645807633514046, "episode_optimality_min": -0.48, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6645807633514046, "episode_optimality_capped_min": -0.48, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 48.4, "episode_reward_normalized_min": -14.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6645807633514046, "curr_learning_score_min": -0.48, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [60.0, 540.0, 130.0, 460.0, 325.0, 25.0, 260.0, 195.0, 365.0, 290.0, 195.0, 405.0, -35.0, 320.0, 190.0, 315.0, 180.0, 225.0, -70.0, 255.0, 300.0, 290.0, 440.0, 0.0, 195.0, 140.0, 95.0, 120.0, 95.0, 390.0, 250.0, 265.0, 45.0, 340.0, 245.0, 185.0, 85.0, 365.0, 335.0, 240.0, 550.0, 330.0, 290.0, 360.0, 210.0, 50.0, 290.0, 0.0, 185.0, 50.0, 470.0, 65.0, 330.0, 420.0, 205.0, 160.0, 350.0, 170.0, 225.0, 210.0, 125.0, 305.0, 120.0, -25.0, 115.0, 430.0, 165.0, 210.0, 225.0, 420.0, 230.0, 335.0, 345.0, 410.0, 405.0, 340.0, 335.0, 160.0, 500.0, 345.0, -45.0, 630.0, 0.0, 225.0, 370.0, 65.0, 130.0, 265.0, -60.0, -30.0, 420.0, 445.0, 165.0, 245.0, 400.0, 360.0, 300.0, 155.0, 295.0, 400.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1382726289196663, "mean_inference_ms": 1.5139598932811043, "mean_action_processing_ms": 0.5590538202684712, "mean_env_wait_ms": 0.19621228825907233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15769243240356445, "StateBufferConnector_ms": 0.006146907806396484, "ViewRequirementAgentConnector_ms": 0.31851983070373535}}, "episode_reward_max": 630.0, "episode_reward_min": -70.0, "episode_reward_mean": 242.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.0, 540.0, 130.0, 460.0, 325.0, 25.0, 260.0, 195.0, 365.0, 290.0, 195.0, 405.0, -35.0, 320.0, 190.0, 315.0, 180.0, 225.0, -70.0, 255.0, 300.0, 290.0, 440.0, 0.0, 195.0, 140.0, 95.0, 120.0, 95.0, 390.0, 250.0, 265.0, 45.0, 340.0, 245.0, 185.0, 85.0, 365.0, 335.0, 240.0, 550.0, 330.0, 290.0, 360.0, 210.0, 50.0, 290.0, 0.0, 185.0, 50.0, 470.0, 65.0, 330.0, 420.0, 205.0, 160.0, 350.0, 170.0, 225.0, 210.0, 125.0, 305.0, 120.0, -25.0, 115.0, 430.0, 165.0, 210.0, 225.0, 420.0, 230.0, 335.0, 345.0, 410.0, 405.0, 340.0, 335.0, 160.0, 500.0, 345.0, -45.0, 630.0, 0.0, 225.0, 370.0, 65.0, 130.0, 265.0, -60.0, -30.0, 420.0, 445.0, 165.0, 245.0, 400.0, 360.0, 300.0, 155.0, 295.0, 400.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1382726289196663, "mean_inference_ms": 1.5139598932811043, "mean_action_processing_ms": 0.5590538202684712, "mean_env_wait_ms": 0.19621228825907233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15769243240356445, "StateBufferConnector_ms": 0.006146907806396484, "ViewRequirementAgentConnector_ms": 0.31851983070373535}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.20182813414955, "num_env_steps_trained_throughput_per_sec": 68.20182813414955, "timesteps_total": 1024000, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 121754.767, "sample_time_ms": 14081.535, "load_time_ms": 1.637, "load_throughput": 5004112.603, "learn_time_ms": 107662.758, "learn_throughput": 76.089, "synch_weights_time_ms": 2.838}, "counters": {"num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "episodes_total": 8000, "training_iteration": 125, "trial_id": "9fade_00019", "date": "2023-11-09_23-47-54", "timestamp": 1699570074, "time_this_iter_s": 120.12965297698975, "time_total_s": 13816.966076612473, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13816.966076612473, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 37.280701754385966, "ram_util_percent": 18.916374269005853}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6306037400323885, "episode_optimality_min": -0.48, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6306037400323885, "episode_optimality_capped_min": -0.48, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.5, "episode_reward_normalized_min": -31.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6306037400323885, "curr_learning_score_min": -0.48, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9740724553136776, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.257214272985099, "policy_loss": -0.07507650136269756, "vf_loss": 0.3161253345529478, "vf_explained_var": 0.37159143085901936, "kl": 0.01596586546096603, "entropy": 2.948727627793948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1204800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1032192, "num_env_steps_trained": 1032192, "num_agent_steps_sampled": 5160960, "num_agent_steps_trained": 5160960}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -155.0, "episode_reward_mean": 237.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6306037400323885, "episode_optimality_min": -0.48, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6306037400323885, "episode_optimality_capped_min": -0.48, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.5, "episode_reward_normalized_min": -31.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6306037400323885, "curr_learning_score_min": -0.48, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [115.0, 430.0, 165.0, 210.0, 225.0, 420.0, 230.0, 335.0, 345.0, 410.0, 405.0, 340.0, 335.0, 160.0, 500.0, 345.0, -45.0, 630.0, 0.0, 225.0, 370.0, 65.0, 130.0, 265.0, -60.0, -30.0, 420.0, 445.0, 165.0, 245.0, 400.0, 360.0, 300.0, 155.0, 295.0, 400.0, 375.0, 405.0, 465.0, 200.0, -40.0, 330.0, 220.0, 400.0, 30.0, 520.0, 75.0, 395.0, 105.0, 215.0, 290.0, -120.0, 185.0, 305.0, 275.0, 20.0, -155.0, 200.0, 485.0, 370.0, 40.0, 410.0, 220.0, -20.0, 205.0, 445.0, 50.0, 15.0, 400.0, 30.0, 350.0, 335.0, -15.0, 55.0, 210.0, 125.0, 630.0, 310.0, 340.0, 220.0, 290.0, 265.0, 240.0, 45.0, 90.0, 105.0, 0.0, 330.0, 30.0, 130.0, 305.0, 165.0, 130.0, 55.0, 540.0, 240.0, 575.0, 235.0, 20.0, 350.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137887040679904, "mean_inference_ms": 1.5134659268488688, "mean_action_processing_ms": 0.5589283272778643, "mean_env_wait_ms": 0.19609464965652165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15644288063049316, "StateBufferConnector_ms": 0.006032466888427734, "ViewRequirementAgentConnector_ms": 0.3111281394958496}}, "episode_reward_max": 630.0, "episode_reward_min": -155.0, "episode_reward_mean": 237.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [115.0, 430.0, 165.0, 210.0, 225.0, 420.0, 230.0, 335.0, 345.0, 410.0, 405.0, 340.0, 335.0, 160.0, 500.0, 345.0, -45.0, 630.0, 0.0, 225.0, 370.0, 65.0, 130.0, 265.0, -60.0, -30.0, 420.0, 445.0, 165.0, 245.0, 400.0, 360.0, 300.0, 155.0, 295.0, 400.0, 375.0, 405.0, 465.0, 200.0, -40.0, 330.0, 220.0, 400.0, 30.0, 520.0, 75.0, 395.0, 105.0, 215.0, 290.0, -120.0, 185.0, 305.0, 275.0, 20.0, -155.0, 200.0, 485.0, 370.0, 40.0, 410.0, 220.0, -20.0, 205.0, 445.0, 50.0, 15.0, 400.0, 30.0, 350.0, 335.0, -15.0, 55.0, 210.0, 125.0, 630.0, 310.0, 340.0, 220.0, 290.0, 265.0, 240.0, 45.0, 90.0, 105.0, 0.0, 330.0, 30.0, 130.0, 305.0, 165.0, 130.0, 55.0, 540.0, 240.0, 575.0, 235.0, 20.0, 350.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137887040679904, "mean_inference_ms": 1.5134659268488688, "mean_action_processing_ms": 0.5589283272778643, "mean_env_wait_ms": 0.19609464965652165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15644288063049316, "StateBufferConnector_ms": 0.006032466888427734, "ViewRequirementAgentConnector_ms": 0.3111281394958496}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160960, "num_agent_steps_trained": 5160960, "num_env_steps_sampled": 1032192, "num_env_steps_trained": 1032192, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.81491647290129, "num_env_steps_trained_throughput_per_sec": 66.81491647290129, "timesteps_total": 1032192, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5160960, "timers": {"training_iteration_time_ms": 121855.345, "sample_time_ms": 13993.456, "load_time_ms": 1.618, "load_throughput": 5061537.088, "learn_time_ms": 107851.593, "learn_throughput": 75.956, "synch_weights_time_ms": 2.753}, "counters": {"num_env_steps_sampled": 1032192, "num_env_steps_trained": 1032192, "num_agent_steps_sampled": 5160960, "num_agent_steps_trained": 5160960}, "done": false, "episodes_total": 8064, "training_iteration": 126, "trial_id": "9fade_00019", "date": "2023-11-09_23-49-56", "timestamp": 1699570196, "time_this_iter_s": 122.62509560585022, "time_total_s": 13939.591172218323, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 13939.591172218323, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 37.83542857142857, "ram_util_percent": 18.723428571428574}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6380308449024951, "episode_optimality_min": -0.2, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6380308449024951, "episode_optimality_capped_min": -0.2, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.28, "episode_reward_normalized_min": -10.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6380308449024951, "curr_learning_score_min": -0.2, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.986746067389225, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.22841170521676152, "policy_loss": -0.06896047218169163, "vf_loss": 0.28188339584350613, "vf_explained_var": 0.40462420403336485, "kl": 0.0152975617410101, "entropy": 2.967832112908363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1214400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1040384, "num_env_steps_trained": 1040384, "num_agent_steps_sampled": 5201920, "num_agent_steps_trained": 5201920}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -50.0, "episode_reward_mean": 226.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6380308449024951, "episode_optimality_min": -0.2, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6380308449024951, "episode_optimality_capped_min": -0.2, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.28, "episode_reward_normalized_min": -10.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6380308449024951, "curr_learning_score_min": -0.2, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [205.0, 445.0, 50.0, 15.0, 400.0, 30.0, 350.0, 335.0, -15.0, 55.0, 210.0, 125.0, 630.0, 310.0, 340.0, 220.0, 290.0, 265.0, 240.0, 45.0, 90.0, 105.0, 0.0, 330.0, 30.0, 130.0, 305.0, 165.0, 130.0, 55.0, 540.0, 240.0, 575.0, 235.0, 20.0, 350.0, 285.0, 385.0, 105.0, 70.0, 330.0, 190.0, 250.0, 25.0, 265.0, 165.0, -50.0, 80.0, 180.0, 450.0, 490.0, 360.0, 140.0, 250.0, 445.0, 315.0, 400.0, 170.0, 335.0, -40.0, 230.0, 495.0, 140.0, -5.0, 305.0, 420.0, 210.0, 325.0, 190.0, 165.0, 120.0, 420.0, 135.0, -25.0, 150.0, 400.0, 65.0, 135.0, 340.0, 195.0, 450.0, 75.0, 305.0, 205.0, 270.0, 360.0, 40.0, 25.0, 50.0, 410.0, 300.0, 235.0, 425.0, 95.0, 155.0, 535.0, 220.0, 385.0, 140.0, 110.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1376965600736164, "mean_inference_ms": 1.513157707388259, "mean_action_processing_ms": 0.5588334879231392, "mean_env_wait_ms": 0.19605629780019346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1584622859954834, "StateBufferConnector_ms": 0.006250619888305664, "ViewRequirementAgentConnector_ms": 0.32219552993774414}}, "episode_reward_max": 630.0, "episode_reward_min": -50.0, "episode_reward_mean": 226.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [205.0, 445.0, 50.0, 15.0, 400.0, 30.0, 350.0, 335.0, -15.0, 55.0, 210.0, 125.0, 630.0, 310.0, 340.0, 220.0, 290.0, 265.0, 240.0, 45.0, 90.0, 105.0, 0.0, 330.0, 30.0, 130.0, 305.0, 165.0, 130.0, 55.0, 540.0, 240.0, 575.0, 235.0, 20.0, 350.0, 285.0, 385.0, 105.0, 70.0, 330.0, 190.0, 250.0, 25.0, 265.0, 165.0, -50.0, 80.0, 180.0, 450.0, 490.0, 360.0, 140.0, 250.0, 445.0, 315.0, 400.0, 170.0, 335.0, -40.0, 230.0, 495.0, 140.0, -5.0, 305.0, 420.0, 210.0, 325.0, 190.0, 165.0, 120.0, 420.0, 135.0, -25.0, 150.0, 400.0, 65.0, 135.0, 340.0, 195.0, 450.0, 75.0, 305.0, 205.0, 270.0, 360.0, 40.0, 25.0, 50.0, 410.0, 300.0, 235.0, 425.0, 95.0, 155.0, 535.0, 220.0, 385.0, 140.0, 110.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1376965600736164, "mean_inference_ms": 1.513157707388259, "mean_action_processing_ms": 0.5588334879231392, "mean_env_wait_ms": 0.19605629780019346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1584622859954834, "StateBufferConnector_ms": 0.006250619888305664, "ViewRequirementAgentConnector_ms": 0.32219552993774414}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5201920, "num_agent_steps_trained": 5201920, "num_env_steps_sampled": 1040384, "num_env_steps_trained": 1040384, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.0919090097366, "num_env_steps_trained_throughput_per_sec": 67.0919090097366, "timesteps_total": 1040384, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5201920, "timers": {"training_iteration_time_ms": 121901.497, "sample_time_ms": 14008.559, "load_time_ms": 1.625, "load_throughput": 5040745.609, "learn_time_ms": 107882.528, "learn_throughput": 75.934, "synch_weights_time_ms": 2.844}, "counters": {"num_env_steps_sampled": 1040384, "num_env_steps_trained": 1040384, "num_agent_steps_sampled": 5201920, "num_agent_steps_trained": 5201920}, "done": false, "episodes_total": 8128, "training_iteration": 127, "trial_id": "9fade_00019", "date": "2023-11-09_23-51-59", "timestamp": 1699570319, "time_this_iter_s": 122.11719679832458, "time_total_s": 14061.708369016647, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14061.708369016647, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 37.17931034482759, "ram_util_percent": 18.75402298850575}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6189059997895441, "episode_optimality_min": -0.8955223880597015, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6189059997895441, "episode_optimality_capped_min": -0.8955223880597015, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.27, "episode_reward_normalized_min": -60.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6189059997895441, "curr_learning_score_min": -0.8955223880597015, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9768343403749168, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23149683454200082, "policy_loss": -0.07126837626112623, "vf_loss": 0.2871223250065062, "vf_explained_var": 0.4086037898436189, "kl": 0.015449763429500744, "entropy": 2.9621513760338227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1224000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1048576, "num_env_steps_trained": 1048576, "num_agent_steps_sampled": 5242880, "num_agent_steps_trained": 5242880}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": -300.0, "episode_reward_mean": 221.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6189059997895441, "episode_optimality_min": -0.8955223880597015, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6189059997895441, "episode_optimality_capped_min": -0.8955223880597015, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.27, "episode_reward_normalized_min": -60.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6189059997895441, "curr_learning_score_min": -0.8955223880597015, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [305.0, 420.0, 210.0, 325.0, 190.0, 165.0, 120.0, 420.0, 135.0, -25.0, 150.0, 400.0, 65.0, 135.0, 340.0, 195.0, 450.0, 75.0, 305.0, 205.0, 270.0, 360.0, 40.0, 25.0, 50.0, 410.0, 300.0, 235.0, 425.0, 95.0, 155.0, 535.0, 220.0, 385.0, 140.0, 110.0, -90.0, 450.0, 235.0, 180.0, 55.0, 490.0, 90.0, 475.0, -5.0, 160.0, 40.0, 430.0, 150.0, 165.0, 65.0, 225.0, -80.0, 355.0, 175.0, 130.0, 200.0, 35.0, 145.0, 350.0, 290.0, 160.0, 160.0, 345.0, 290.0, 130.0, 30.0, 75.0, 425.0, 455.0, 550.0, 295.0, 400.0, 185.0, 160.0, 275.0, 290.0, 65.0, 445.0, 355.0, 215.0, 295.0, 280.0, 250.0, 290.0, 530.0, -100.0, 340.0, 340.0, -300.0, 275.0, 110.0, 225.0, 190.0, 85.0, 245.0, -40.0, 350.0, 100.0, 310.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137676129103263, "mean_inference_ms": 1.5131823819992831, "mean_action_processing_ms": 0.5588238572878446, "mean_env_wait_ms": 0.19603988248727636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1613755226135254, "StateBufferConnector_ms": 0.006302595138549805, "ViewRequirementAgentConnector_ms": 0.3268270492553711}}, "episode_reward_max": 550.0, "episode_reward_min": -300.0, "episode_reward_mean": 221.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [305.0, 420.0, 210.0, 325.0, 190.0, 165.0, 120.0, 420.0, 135.0, -25.0, 150.0, 400.0, 65.0, 135.0, 340.0, 195.0, 450.0, 75.0, 305.0, 205.0, 270.0, 360.0, 40.0, 25.0, 50.0, 410.0, 300.0, 235.0, 425.0, 95.0, 155.0, 535.0, 220.0, 385.0, 140.0, 110.0, -90.0, 450.0, 235.0, 180.0, 55.0, 490.0, 90.0, 475.0, -5.0, 160.0, 40.0, 430.0, 150.0, 165.0, 65.0, 225.0, -80.0, 355.0, 175.0, 130.0, 200.0, 35.0, 145.0, 350.0, 290.0, 160.0, 160.0, 345.0, 290.0, 130.0, 30.0, 75.0, 425.0, 455.0, 550.0, 295.0, 400.0, 185.0, 160.0, 275.0, 290.0, 65.0, 445.0, 355.0, 215.0, 295.0, 280.0, 250.0, 290.0, 530.0, -100.0, 340.0, 340.0, -300.0, 275.0, 110.0, 225.0, 190.0, 85.0, 245.0, -40.0, 350.0, 100.0, 310.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137676129103263, "mean_inference_ms": 1.5131823819992831, "mean_action_processing_ms": 0.5588238572878446, "mean_env_wait_ms": 0.19603988248727636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1613755226135254, "StateBufferConnector_ms": 0.006302595138549805, "ViewRequirementAgentConnector_ms": 0.3268270492553711}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5242880, "num_agent_steps_trained": 5242880, "num_env_steps_sampled": 1048576, "num_env_steps_trained": 1048576, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.91111747100456, "num_env_steps_trained_throughput_per_sec": 66.91111747100456, "timesteps_total": 1048576, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5242880, "timers": {"training_iteration_time_ms": 121916.087, "sample_time_ms": 13960.146, "load_time_ms": 1.656, "load_throughput": 4946765.483, "learn_time_ms": 107945.472, "learn_throughput": 75.89, "synch_weights_time_ms": 2.819}, "counters": {"num_env_steps_sampled": 1048576, "num_env_steps_trained": 1048576, "num_agent_steps_sampled": 5242880, "num_agent_steps_trained": 5242880}, "done": false, "episodes_total": 8192, "training_iteration": 128, "trial_id": "9fade_00019", "date": "2023-11-09_23-54-01", "timestamp": 1699570441, "time_this_iter_s": 122.44883275032043, "time_total_s": 14184.157201766968, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14184.157201766968, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 38.09712643678161, "ram_util_percent": 18.773563218390805}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5896245798287478, "episode_optimality_min": -0.8955223880597015, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5896245798287478, "episode_optimality_capped_min": -0.8955223880597015, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.8, "episode_reward_normalized_min": -60.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5896245798287478, "curr_learning_score_min": -0.8955223880597015, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9809086918660129, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.24551345453871667, "policy_loss": -0.07180234979357919, "vf_loss": 0.30143433202482506, "vf_explained_var": 0.4129565541570385, "kl": 0.015685403820104776, "entropy": 2.936751561934749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1233600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1056768, "num_env_steps_trained": 1056768, "num_agent_steps_sampled": 5283840, "num_agent_steps_trained": 5283840}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": -300.0, "episode_reward_mean": 214.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5896245798287478, "episode_optimality_min": -0.8955223880597015, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5896245798287478, "episode_optimality_capped_min": -0.8955223880597015, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.8, "episode_reward_normalized_min": -60.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5896245798287478, "curr_learning_score_min": -0.8955223880597015, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [290.0, 130.0, 30.0, 75.0, 425.0, 455.0, 550.0, 295.0, 400.0, 185.0, 160.0, 275.0, 290.0, 65.0, 445.0, 355.0, 215.0, 295.0, 280.0, 250.0, 290.0, 530.0, -100.0, 340.0, 340.0, -300.0, 275.0, 110.0, 225.0, 190.0, 85.0, 245.0, -40.0, 350.0, 100.0, 310.0, 75.0, 255.0, 330.0, 420.0, 155.0, 410.0, 290.0, 100.0, 30.0, 155.0, -60.0, 10.0, 70.0, 455.0, 280.0, 75.0, 395.0, 410.0, 495.0, 155.0, 485.0, 225.0, 65.0, -35.0, 370.0, -75.0, 295.0, -10.0, 215.0, 50.0, 515.0, 250.0, 340.0, 145.0, 490.0, 390.0, -130.0, 45.0, 365.0, 335.0, 185.0, -70.0, 265.0, 205.0, -60.0, 370.0, 370.0, 180.0, 255.0, 145.0, 180.0, 515.0, 195.0, 20.0, 275.0, 245.0, 160.0, -75.0, -65.0, 135.0, 0.0, 255.0, 255.0, 210.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137430339212291, "mean_inference_ms": 1.5126231529515468, "mean_action_processing_ms": 0.5587085690039951, "mean_env_wait_ms": 0.19594454230798028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15722012519836426, "StateBufferConnector_ms": 0.006047487258911133, "ViewRequirementAgentConnector_ms": 0.3176898956298828}}, "episode_reward_max": 550.0, "episode_reward_min": -300.0, "episode_reward_mean": 214.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [290.0, 130.0, 30.0, 75.0, 425.0, 455.0, 550.0, 295.0, 400.0, 185.0, 160.0, 275.0, 290.0, 65.0, 445.0, 355.0, 215.0, 295.0, 280.0, 250.0, 290.0, 530.0, -100.0, 340.0, 340.0, -300.0, 275.0, 110.0, 225.0, 190.0, 85.0, 245.0, -40.0, 350.0, 100.0, 310.0, 75.0, 255.0, 330.0, 420.0, 155.0, 410.0, 290.0, 100.0, 30.0, 155.0, -60.0, 10.0, 70.0, 455.0, 280.0, 75.0, 395.0, 410.0, 495.0, 155.0, 485.0, 225.0, 65.0, -35.0, 370.0, -75.0, 295.0, -10.0, 215.0, 50.0, 515.0, 250.0, 340.0, 145.0, 490.0, 390.0, -130.0, 45.0, 365.0, 335.0, 185.0, -70.0, 265.0, 205.0, -60.0, 370.0, 370.0, 180.0, 255.0, 145.0, 180.0, 515.0, 195.0, 20.0, 275.0, 245.0, 160.0, -75.0, -65.0, 135.0, 0.0, 255.0, 255.0, 210.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137430339212291, "mean_inference_ms": 1.5126231529515468, "mean_action_processing_ms": 0.5587085690039951, "mean_env_wait_ms": 0.19594454230798028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15722012519836426, "StateBufferConnector_ms": 0.006047487258911133, "ViewRequirementAgentConnector_ms": 0.3176898956298828}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5283840, "num_agent_steps_trained": 5283840, "num_env_steps_sampled": 1056768, "num_env_steps_trained": 1056768, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.54977827288917, "num_env_steps_trained_throughput_per_sec": 66.54977827288917, "timesteps_total": 1056768, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5283840, "timers": {"training_iteration_time_ms": 122009.51, "sample_time_ms": 13847.725, "load_time_ms": 1.699, "load_throughput": 4821675.021, "learn_time_ms": 108151.279, "learn_throughput": 75.746, "synch_weights_time_ms": 2.809}, "counters": {"num_env_steps_sampled": 1056768, "num_env_steps_trained": 1056768, "num_agent_steps_sampled": 5283840, "num_agent_steps_trained": 5283840}, "done": false, "episodes_total": 8256, "training_iteration": 129, "trial_id": "9fade_00019", "date": "2023-11-09_23-56-04", "timestamp": 1699570564, "time_this_iter_s": 123.11222887039185, "time_total_s": 14307.26943063736, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14307.26943063736, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 37.94715909090909, "ram_util_percent": 18.775000000000002}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6384709901100054, "episode_optimality_min": -0.6896551724137931, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6384709901100054, "episode_optimality_capped_min": -0.6896551724137931, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.47, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6384709901100054, "curr_learning_score_min": -0.6896551724137931, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9830330187175423, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23617780165349056, "policy_loss": -0.06979270932696333, "vf_loss": 0.29093816899357383, "vf_explained_var": 0.4048065940476954, "kl": 0.014846756988367153, "entropy": 2.9421343259016672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1243200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1064960, "num_env_steps_trained": 1064960, "num_agent_steps_sampled": 5324800, "num_agent_steps_trained": 5324800}, "sampler_results": {"episode_reward_max": 595.0, "episode_reward_min": -200.0, "episode_reward_mean": 227.35, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6384709901100054, "episode_optimality_min": -0.6896551724137931, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6384709901100054, "episode_optimality_capped_min": -0.6896551724137931, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.47, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6384709901100054, "curr_learning_score_min": -0.6896551724137931, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [215.0, 50.0, 515.0, 250.0, 340.0, 145.0, 490.0, 390.0, -130.0, 45.0, 365.0, 335.0, 185.0, -70.0, 265.0, 205.0, -60.0, 370.0, 370.0, 180.0, 255.0, 145.0, 180.0, 515.0, 195.0, 20.0, 275.0, 245.0, 160.0, -75.0, -65.0, 135.0, 0.0, 255.0, 255.0, 210.0, 285.0, 220.0, 125.0, -200.0, 165.0, 285.0, -50.0, 260.0, 110.0, 445.0, 300.0, 290.0, 325.0, 100.0, -40.0, 245.0, 245.0, 360.0, 440.0, 340.0, 365.0, 425.0, 250.0, 40.0, 360.0, 595.0, 505.0, 445.0, 175.0, 235.0, 505.0, 495.0, 265.0, 20.0, 395.0, 370.0, 120.0, 50.0, -75.0, 270.0, 245.0, 195.0, 270.0, 125.0, 335.0, 170.0, 130.0, 250.0, 185.0, 280.0, 255.0, 165.0, 245.0, 530.0, -10.0, 375.0, -190.0, 455.0, 485.0, 135.0, 75.0, 230.0, 270.0, 310.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137306180858372, "mean_inference_ms": 1.5123975347378007, "mean_action_processing_ms": 0.558645944721035, "mean_env_wait_ms": 0.1959072743137481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15846657752990723, "StateBufferConnector_ms": 0.0062901973724365234, "ViewRequirementAgentConnector_ms": 0.3228778839111328}}, "episode_reward_max": 595.0, "episode_reward_min": -200.0, "episode_reward_mean": 227.35, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [215.0, 50.0, 515.0, 250.0, 340.0, 145.0, 490.0, 390.0, -130.0, 45.0, 365.0, 335.0, 185.0, -70.0, 265.0, 205.0, -60.0, 370.0, 370.0, 180.0, 255.0, 145.0, 180.0, 515.0, 195.0, 20.0, 275.0, 245.0, 160.0, -75.0, -65.0, 135.0, 0.0, 255.0, 255.0, 210.0, 285.0, 220.0, 125.0, -200.0, 165.0, 285.0, -50.0, 260.0, 110.0, 445.0, 300.0, 290.0, 325.0, 100.0, -40.0, 245.0, 245.0, 360.0, 440.0, 340.0, 365.0, 425.0, 250.0, 40.0, 360.0, 595.0, 505.0, 445.0, 175.0, 235.0, 505.0, 495.0, 265.0, 20.0, 395.0, 370.0, 120.0, 50.0, -75.0, 270.0, 245.0, 195.0, 270.0, 125.0, 335.0, 170.0, 130.0, 250.0, 185.0, 280.0, 255.0, 165.0, 245.0, 530.0, -10.0, 375.0, -190.0, 455.0, 485.0, 135.0, 75.0, 230.0, 270.0, 310.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137306180858372, "mean_inference_ms": 1.5123975347378007, "mean_action_processing_ms": 0.558645944721035, "mean_env_wait_ms": 0.1959072743137481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15846657752990723, "StateBufferConnector_ms": 0.0062901973724365234, "ViewRequirementAgentConnector_ms": 0.3228778839111328}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5324800, "num_agent_steps_trained": 5324800, "num_env_steps_sampled": 1064960, "num_env_steps_trained": 1064960, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.70786569092145, "num_env_steps_trained_throughput_per_sec": 66.70786569092145, "timesteps_total": 1064960, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5324800, "timers": {"training_iteration_time_ms": 122079.888, "sample_time_ms": 13840.199, "load_time_ms": 1.742, "load_throughput": 4703076.784, "learn_time_ms": 108228.949, "learn_throughput": 75.691, "synch_weights_time_ms": 2.94}, "counters": {"num_env_steps_sampled": 1064960, "num_env_steps_trained": 1064960, "num_agent_steps_sampled": 5324800, "num_agent_steps_trained": 5324800}, "done": false, "episodes_total": 8320, "training_iteration": 130, "trial_id": "9fade_00019", "date": "2023-11-09_23-58-07", "timestamp": 1699570687, "time_this_iter_s": 122.8205156326294, "time_total_s": 14430.089946269989, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14430.089946269989, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 36.69085714285715, "ram_util_percent": 18.89542857142857}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.599510748231123, "episode_optimality_min": -0.5789473684210527, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.599510748231123, "episode_optimality_capped_min": -0.5789473684210527, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.32, "episode_reward_normalized_min": -38.0, "episode_reward_normalized_max": 118.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.599510748231123, "curr_learning_score_min": -0.5789473684210527, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9849536097965513, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.24243614273773953, "policy_loss": -0.07466186026344075, "vf_loss": 0.3005412662180788, "vf_explained_var": 0.3722485285438597, "kl": 0.016352332073525797, "entropy": 2.911998919968804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1252800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1073152, "num_env_steps_trained": 1073152, "num_agent_steps_sampled": 5365760, "num_agent_steps_trained": 5365760}, "sampler_results": {"episode_reward_max": 590.0, "episode_reward_min": -190.0, "episode_reward_mean": 206.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.599510748231123, "episode_optimality_min": -0.5789473684210527, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.599510748231123, "episode_optimality_capped_min": -0.5789473684210527, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.32, "episode_reward_normalized_min": -38.0, "episode_reward_normalized_max": 118.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.599510748231123, "curr_learning_score_min": -0.5789473684210527, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [175.0, 235.0, 505.0, 495.0, 265.0, 20.0, 395.0, 370.0, 120.0, 50.0, -75.0, 270.0, 245.0, 195.0, 270.0, 125.0, 335.0, 170.0, 130.0, 250.0, 185.0, 280.0, 255.0, 165.0, 245.0, 530.0, -10.0, 375.0, -190.0, 455.0, 485.0, 135.0, 75.0, 230.0, 270.0, 310.0, 360.0, 200.0, 25.0, 95.0, 475.0, 200.0, 110.0, 205.0, 140.0, 345.0, 235.0, 30.0, 140.0, 375.0, 435.0, -165.0, 280.0, -25.0, -125.0, 375.0, 285.0, 500.0, 80.0, 210.0, 370.0, 115.0, 125.0, 375.0, 170.0, 90.0, 125.0, 345.0, 155.0, 195.0, -10.0, 265.0, 35.0, -20.0, 315.0, 200.0, 235.0, 590.0, 210.0, 290.0, 95.0, 395.0, 240.0, 325.0, 100.0, -10.0, 385.0, 235.0, 135.0, -40.0, 460.0, -110.0, 290.0, -20.0, 50.0, 490.0, -50.0, -30.0, -50.0, 470.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1371607608046317, "mean_inference_ms": 1.512064755629916, "mean_action_processing_ms": 0.5585697795235002, "mean_env_wait_ms": 0.19585642090707858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15887665748596191, "StateBufferConnector_ms": 0.006274700164794922, "ViewRequirementAgentConnector_ms": 0.3212399482727051}}, "episode_reward_max": 590.0, "episode_reward_min": -190.0, "episode_reward_mean": 206.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [175.0, 235.0, 505.0, 495.0, 265.0, 20.0, 395.0, 370.0, 120.0, 50.0, -75.0, 270.0, 245.0, 195.0, 270.0, 125.0, 335.0, 170.0, 130.0, 250.0, 185.0, 280.0, 255.0, 165.0, 245.0, 530.0, -10.0, 375.0, -190.0, 455.0, 485.0, 135.0, 75.0, 230.0, 270.0, 310.0, 360.0, 200.0, 25.0, 95.0, 475.0, 200.0, 110.0, 205.0, 140.0, 345.0, 235.0, 30.0, 140.0, 375.0, 435.0, -165.0, 280.0, -25.0, -125.0, 375.0, 285.0, 500.0, 80.0, 210.0, 370.0, 115.0, 125.0, 375.0, 170.0, 90.0, 125.0, 345.0, 155.0, 195.0, -10.0, 265.0, 35.0, -20.0, 315.0, 200.0, 235.0, 590.0, 210.0, 290.0, 95.0, 395.0, 240.0, 325.0, 100.0, -10.0, 385.0, 235.0, 135.0, -40.0, 460.0, -110.0, 290.0, -20.0, 50.0, 490.0, -50.0, -30.0, -50.0, 470.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1371607608046317, "mean_inference_ms": 1.512064755629916, "mean_action_processing_ms": 0.5585697795235002, "mean_env_wait_ms": 0.19585642090707858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15887665748596191, "StateBufferConnector_ms": 0.006274700164794922, "ViewRequirementAgentConnector_ms": 0.3212399482727051}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5365760, "num_agent_steps_trained": 5365760, "num_env_steps_sampled": 1073152, "num_env_steps_trained": 1073152, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.31497073916819, "num_env_steps_trained_throughput_per_sec": 67.31497073916819, "timesteps_total": 1073152, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5365760, "timers": {"training_iteration_time_ms": 122037.527, "sample_time_ms": 13899.775, "load_time_ms": 1.844, "load_throughput": 4442169.694, "learn_time_ms": 108126.829, "learn_throughput": 75.763, "synch_weights_time_ms": 2.929}, "counters": {"num_env_steps_sampled": 1073152, "num_env_steps_trained": 1073152, "num_agent_steps_sampled": 5365760, "num_agent_steps_trained": 5365760}, "done": false, "episodes_total": 8384, "training_iteration": 131, "trial_id": "9fade_00019", "date": "2023-11-10_00-00-09", "timestamp": 1699570809, "time_this_iter_s": 121.71349787712097, "time_total_s": 14551.80344414711, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14551.80344414711, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 38.10693641618497, "ram_util_percent": 18.67861271676301}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5548445153294669, "episode_optimality_min": -0.9130434782608695, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5548445153294669, "episode_optimality_capped_min": -0.9130434782608695, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.23, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5548445153294669, "curr_learning_score_min": -0.9130434782608695, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9723202842691292, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.24656850109879694, "policy_loss": -0.07447493107237581, "vf_loss": 0.30537071230121304, "vf_explained_var": 0.40412547830492257, "kl": 0.015479228678559593, "entropy": 2.922423430035512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1262400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1081344, "num_env_steps_trained": 1081344, "num_agent_steps_sampled": 5406720, "num_agent_steps_trained": 5406720}, "sampler_results": {"episode_reward_max": 620.0, "episode_reward_min": -315.0, "episode_reward_mean": 201.15, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5548445153294669, "episode_optimality_min": -0.9130434782608695, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5548445153294669, "episode_optimality_capped_min": -0.9130434782608695, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.23, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5548445153294669, "curr_learning_score_min": -0.9130434782608695, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [170.0, 90.0, 125.0, 345.0, 155.0, 195.0, -10.0, 265.0, 35.0, -20.0, 315.0, 200.0, 235.0, 590.0, 210.0, 290.0, 95.0, 395.0, 240.0, 325.0, 100.0, -10.0, 385.0, 235.0, 135.0, -40.0, 460.0, -110.0, 290.0, -20.0, 50.0, 490.0, -50.0, -30.0, -50.0, 470.0, 125.0, 215.0, 130.0, 410.0, 455.0, 250.0, 345.0, 285.0, 370.0, 215.0, 305.0, 235.0, 385.0, 440.0, 240.0, 210.0, 200.0, 100.0, 130.0, 530.0, 235.0, 180.0, 265.0, 85.0, 250.0, 470.0, 135.0, 225.0, -80.0, 120.0, 400.0, 270.0, 120.0, 160.0, 480.0, -190.0, 15.0, 120.0, 80.0, 435.0, 140.0, 260.0, 470.0, 160.0, 230.0, 15.0, 240.0, 270.0, 140.0, 240.0, -260.0, 505.0, -60.0, 285.0, -65.0, 610.0, 105.0, -110.0, 340.0, 60.0, 620.0, 210.0, -315.0, 125.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137030413381818, "mean_inference_ms": 1.5118695341451331, "mean_action_processing_ms": 0.558502069330313, "mean_env_wait_ms": 0.195823244113159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15840744972229004, "StateBufferConnector_ms": 0.006326198577880859, "ViewRequirementAgentConnector_ms": 0.32250022888183594}}, "episode_reward_max": 620.0, "episode_reward_min": -315.0, "episode_reward_mean": 201.15, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [170.0, 90.0, 125.0, 345.0, 155.0, 195.0, -10.0, 265.0, 35.0, -20.0, 315.0, 200.0, 235.0, 590.0, 210.0, 290.0, 95.0, 395.0, 240.0, 325.0, 100.0, -10.0, 385.0, 235.0, 135.0, -40.0, 460.0, -110.0, 290.0, -20.0, 50.0, 490.0, -50.0, -30.0, -50.0, 470.0, 125.0, 215.0, 130.0, 410.0, 455.0, 250.0, 345.0, 285.0, 370.0, 215.0, 305.0, 235.0, 385.0, 440.0, 240.0, 210.0, 200.0, 100.0, 130.0, 530.0, 235.0, 180.0, 265.0, 85.0, 250.0, 470.0, 135.0, 225.0, -80.0, 120.0, 400.0, 270.0, 120.0, 160.0, 480.0, -190.0, 15.0, 120.0, 80.0, 435.0, 140.0, 260.0, 470.0, 160.0, 230.0, 15.0, 240.0, 270.0, 140.0, 240.0, -260.0, 505.0, -60.0, 285.0, -65.0, 610.0, 105.0, -110.0, 340.0, 60.0, 620.0, 210.0, -315.0, 125.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.137030413381818, "mean_inference_ms": 1.5118695341451331, "mean_action_processing_ms": 0.558502069330313, "mean_env_wait_ms": 0.195823244113159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15840744972229004, "StateBufferConnector_ms": 0.006326198577880859, "ViewRequirementAgentConnector_ms": 0.32250022888183594}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5406720, "num_agent_steps_trained": 5406720, "num_env_steps_sampled": 1081344, "num_env_steps_trained": 1081344, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.5720423192588, "num_env_steps_trained_throughput_per_sec": 68.5720423192588, "timesteps_total": 1081344, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5406720, "timers": {"training_iteration_time_ms": 121830.068, "sample_time_ms": 13953.338, "load_time_ms": 1.813, "load_throughput": 4518224.041, "learn_time_ms": 107865.898, "learn_throughput": 75.946, "synch_weights_time_ms": 2.894}, "counters": {"num_env_steps_sampled": 1081344, "num_env_steps_trained": 1081344, "num_agent_steps_sampled": 5406720, "num_agent_steps_trained": 5406720}, "done": false, "episodes_total": 8448, "training_iteration": 132, "trial_id": "9fade_00019", "date": "2023-11-10_00-02-08", "timestamp": 1699570928, "time_this_iter_s": 119.47819900512695, "time_total_s": 14671.281643152237, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14671.281643152237, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 37.232163742690055, "ram_util_percent": 18.862573099415204}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5331769034345722, "episode_optimality_min": -0.9130434782608695, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5331769034345722, "episode_optimality_capped_min": -0.9130434782608695, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.22, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5331769034345722, "curr_learning_score_min": -0.9130434782608695, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9888515433032686, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25763736096050704, "policy_loss": -0.06945286535708874, "vf_loss": 0.31160746875752615, "vf_explained_var": 0.3608952847433587, "kl": 0.015291611799302511, "entropy": 2.9182794223477444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1272000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1089536, "num_env_steps_trained": 1089536, "num_agent_steps_sampled": 5447680, "num_agent_steps_trained": 5447680}, "sampler_results": {"episode_reward_max": 620.0, "episode_reward_min": -315.0, "episode_reward_mean": 196.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5331769034345722, "episode_optimality_min": -0.9130434782608695, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5331769034345722, "episode_optimality_capped_min": -0.9130434782608695, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 39.22, "episode_reward_normalized_min": -63.0, "episode_reward_normalized_max": 124.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5331769034345722, "curr_learning_score_min": -0.9130434782608695, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [-80.0, 120.0, 400.0, 270.0, 120.0, 160.0, 480.0, -190.0, 15.0, 120.0, 80.0, 435.0, 140.0, 260.0, 470.0, 160.0, 230.0, 15.0, 240.0, 270.0, 140.0, 240.0, -260.0, 505.0, -60.0, 285.0, -65.0, 610.0, 105.0, -110.0, 340.0, 60.0, 620.0, 210.0, -315.0, 125.0, 370.0, 395.0, 415.0, -20.0, 210.0, 325.0, -85.0, 255.0, 245.0, 455.0, 350.0, 65.0, 190.0, 170.0, 280.0, 310.0, 145.0, 115.0, 370.0, 580.0, 390.0, 270.0, 335.0, 35.0, 120.0, 100.0, 320.0, 165.0, 120.0, 70.0, 110.0, 330.0, 250.0, 60.0, -110.0, 25.0, 500.0, 165.0, 440.0, 575.0, 345.0, 270.0, 230.0, 25.0, 225.0, 160.0, 145.0, -40.0, 210.0, -85.0, 80.0, 310.0, 540.0, 20.0, 265.0, -30.0, 105.0, 260.0, 40.0, 50.0, 235.0, 255.0, 105.0, 335.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1370436795331254, "mean_inference_ms": 1.5120648293171859, "mean_action_processing_ms": 0.5584852941255607, "mean_env_wait_ms": 0.19583111494309158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.162078857421875, "StateBufferConnector_ms": 0.0064296722412109375, "ViewRequirementAgentConnector_ms": 0.32931041717529297}}, "episode_reward_max": 620.0, "episode_reward_min": -315.0, "episode_reward_mean": 196.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-80.0, 120.0, 400.0, 270.0, 120.0, 160.0, 480.0, -190.0, 15.0, 120.0, 80.0, 435.0, 140.0, 260.0, 470.0, 160.0, 230.0, 15.0, 240.0, 270.0, 140.0, 240.0, -260.0, 505.0, -60.0, 285.0, -65.0, 610.0, 105.0, -110.0, 340.0, 60.0, 620.0, 210.0, -315.0, 125.0, 370.0, 395.0, 415.0, -20.0, 210.0, 325.0, -85.0, 255.0, 245.0, 455.0, 350.0, 65.0, 190.0, 170.0, 280.0, 310.0, 145.0, 115.0, 370.0, 580.0, 390.0, 270.0, 335.0, 35.0, 120.0, 100.0, 320.0, 165.0, 120.0, 70.0, 110.0, 330.0, 250.0, 60.0, -110.0, 25.0, 500.0, 165.0, 440.0, 575.0, 345.0, 270.0, 230.0, 25.0, 225.0, 160.0, 145.0, -40.0, 210.0, -85.0, 80.0, 310.0, 540.0, 20.0, 265.0, -30.0, 105.0, 260.0, 40.0, 50.0, 235.0, 255.0, 105.0, 335.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1370436795331254, "mean_inference_ms": 1.5120648293171859, "mean_action_processing_ms": 0.5584852941255607, "mean_env_wait_ms": 0.19583111494309158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.162078857421875, "StateBufferConnector_ms": 0.0064296722412109375, "ViewRequirementAgentConnector_ms": 0.32931041717529297}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5447680, "num_agent_steps_trained": 5447680, "num_env_steps_sampled": 1089536, "num_env_steps_trained": 1089536, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.87581953144779, "num_env_steps_trained_throughput_per_sec": 67.87581953144779, "timesteps_total": 1089536, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5447680, "timers": {"training_iteration_time_ms": 121761.58, "sample_time_ms": 14071.845, "load_time_ms": 1.786, "load_throughput": 4587721.259, "learn_time_ms": 107678.802, "learn_throughput": 76.078, "synch_weights_time_ms": 3.039}, "counters": {"num_env_steps_sampled": 1089536, "num_env_steps_trained": 1089536, "num_agent_steps_sampled": 5447680, "num_agent_steps_trained": 5447680}, "done": false, "episodes_total": 8512, "training_iteration": 133, "trial_id": "9fade_00019", "date": "2023-11-10_00-04-09", "timestamp": 1699571049, "time_this_iter_s": 120.7071750164032, "time_total_s": 14791.98881816864, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14791.98881816864, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 36.82732558139534, "ram_util_percent": 19.04244186046511}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6251642396671369, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6251642396671369, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.92, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6251642396671369, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9761463368358091, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.21548765492994182, "policy_loss": -0.06870666931903542, "vf_loss": 0.26915254166931846, "vf_explained_var": 0.4162647532795866, "kl": 0.01485608054258023, "entropy": 2.9110853856553636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1281600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1097728, "num_env_steps_trained": 1097728, "num_agent_steps_sampled": 5488640, "num_agent_steps_trained": 5488640}, "sampler_results": {"episode_reward_max": 605.0, "episode_reward_min": -140.0, "episode_reward_mean": 219.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6251642396671369, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6251642396671369, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 43.92, "episode_reward_normalized_min": -28.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6251642396671369, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [120.0, 70.0, 110.0, 330.0, 250.0, 60.0, -110.0, 25.0, 500.0, 165.0, 440.0, 575.0, 345.0, 270.0, 230.0, 25.0, 225.0, 160.0, 145.0, -40.0, 210.0, -85.0, 80.0, 310.0, 540.0, 20.0, 265.0, -30.0, 105.0, 260.0, 40.0, 50.0, 235.0, 255.0, 105.0, 335.0, 275.0, 50.0, 530.0, 290.0, 110.0, 360.0, 0.0, 350.0, 395.0, 160.0, 295.0, 475.0, 250.0, 90.0, -90.0, 230.0, 420.0, 285.0, 50.0, 265.0, 510.0, -140.0, 440.0, 175.0, 110.0, 105.0, 160.0, 360.0, 160.0, 120.0, 375.0, 175.0, 200.0, 290.0, 325.0, 395.0, 280.0, 145.0, 420.0, 165.0, 105.0, 190.0, 605.0, 255.0, 305.0, 310.0, 435.0, 300.0, 360.0, 365.0, 265.0, 310.0, 200.0, 445.0, 280.0, 85.0, 290.0, 15.0, 65.0, 130.0, 15.0, 15.0, 45.0, 420.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1369839124145762, "mean_inference_ms": 1.512061847462296, "mean_action_processing_ms": 0.5584180195988678, "mean_env_wait_ms": 0.1958321011480659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15966033935546875, "StateBufferConnector_ms": 0.006324291229248047, "ViewRequirementAgentConnector_ms": 0.3246011734008789}}, "episode_reward_max": 605.0, "episode_reward_min": -140.0, "episode_reward_mean": 219.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [120.0, 70.0, 110.0, 330.0, 250.0, 60.0, -110.0, 25.0, 500.0, 165.0, 440.0, 575.0, 345.0, 270.0, 230.0, 25.0, 225.0, 160.0, 145.0, -40.0, 210.0, -85.0, 80.0, 310.0, 540.0, 20.0, 265.0, -30.0, 105.0, 260.0, 40.0, 50.0, 235.0, 255.0, 105.0, 335.0, 275.0, 50.0, 530.0, 290.0, 110.0, 360.0, 0.0, 350.0, 395.0, 160.0, 295.0, 475.0, 250.0, 90.0, -90.0, 230.0, 420.0, 285.0, 50.0, 265.0, 510.0, -140.0, 440.0, 175.0, 110.0, 105.0, 160.0, 360.0, 160.0, 120.0, 375.0, 175.0, 200.0, 290.0, 325.0, 395.0, 280.0, 145.0, 420.0, 165.0, 105.0, 190.0, 605.0, 255.0, 305.0, 310.0, 435.0, 300.0, 360.0, 365.0, 265.0, 310.0, 200.0, 445.0, 280.0, 85.0, 290.0, 15.0, 65.0, 130.0, 15.0, 15.0, 45.0, 420.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1369839124145762, "mean_inference_ms": 1.512061847462296, "mean_action_processing_ms": 0.5584180195988678, "mean_env_wait_ms": 0.1958321011480659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15966033935546875, "StateBufferConnector_ms": 0.006324291229248047, "ViewRequirementAgentConnector_ms": 0.3246011734008789}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5488640, "num_agent_steps_trained": 5488640, "num_env_steps_sampled": 1097728, "num_env_steps_trained": 1097728, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.2760154651742, "num_env_steps_trained_throughput_per_sec": 67.2760154651742, "timesteps_total": 1097728, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5488640, "timers": {"training_iteration_time_ms": 121677.351, "sample_time_ms": 13993.582, "load_time_ms": 1.85, "load_throughput": 4427116.73, "learn_time_ms": 107672.614, "learn_throughput": 76.082, "synch_weights_time_ms": 3.173}, "counters": {"num_env_steps_sampled": 1097728, "num_env_steps_trained": 1097728, "num_agent_steps_sampled": 5488640, "num_agent_steps_trained": 5488640}, "done": false, "episodes_total": 8576, "training_iteration": 134, "trial_id": "9fade_00019", "date": "2023-11-10_00-06-11", "timestamp": 1699571171, "time_this_iter_s": 121.78520154953003, "time_total_s": 14913.77401971817, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 14913.77401971817, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 37.650867052023116, "ram_util_percent": 18.89132947976879}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.644892423362804, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.644892423362804, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.64, "episode_reward_normalized_min": -24.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.644892423362804, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9764850367015848, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2529544429814511, "policy_loss": -0.06789053208014593, "vf_loss": 0.30537779514270824, "vf_explained_var": 0.3719988124072552, "kl": 0.015276226238470893, "entropy": 2.8955728506793577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1291200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1105920, "num_env_steps_trained": 1105920, "num_agent_steps_sampled": 5529600, "num_agent_steps_trained": 5529600}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -120.0, "episode_reward_mean": 233.2, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.644892423362804, "episode_optimality_min": -0.8, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.644892423362804, "episode_optimality_capped_min": -0.8, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.64, "episode_reward_normalized_min": -24.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.644892423362804, "curr_learning_score_min": -0.8, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [160.0, 120.0, 375.0, 175.0, 200.0, 290.0, 325.0, 395.0, 280.0, 145.0, 420.0, 165.0, 105.0, 190.0, 605.0, 255.0, 305.0, 310.0, 435.0, 300.0, 360.0, 365.0, 265.0, 310.0, 200.0, 445.0, 280.0, 85.0, 290.0, 15.0, 65.0, 130.0, 15.0, 15.0, 45.0, 420.0, 185.0, -15.0, 490.0, 185.0, 195.0, 240.0, 260.0, 175.0, -30.0, 380.0, 320.0, 80.0, 435.0, 265.0, 250.0, 20.0, 170.0, 215.0, 75.0, 220.0, 300.0, 290.0, 425.0, 375.0, 265.0, 160.0, 585.0, 145.0, 270.0, 215.0, 420.0, 325.0, 65.0, 225.0, 75.0, 255.0, 240.0, 275.0, 220.0, 45.0, 630.0, -10.0, 205.0, 135.0, 205.0, 35.0, -80.0, 210.0, 360.0, 180.0, -120.0, 270.0, -35.0, 480.0, 220.0, 190.0, -5.0, 165.0, 235.0, 530.0, 295.0, 145.0, 310.0, 620.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136718247533498, "mean_inference_ms": 1.5114369497476188, "mean_action_processing_ms": 0.5582794067347723, "mean_env_wait_ms": 0.19574764935376998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15645813941955566, "StateBufferConnector_ms": 0.006096363067626953, "ViewRequirementAgentConnector_ms": 0.312974214553833}}, "episode_reward_max": 630.0, "episode_reward_min": -120.0, "episode_reward_mean": 233.2, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [160.0, 120.0, 375.0, 175.0, 200.0, 290.0, 325.0, 395.0, 280.0, 145.0, 420.0, 165.0, 105.0, 190.0, 605.0, 255.0, 305.0, 310.0, 435.0, 300.0, 360.0, 365.0, 265.0, 310.0, 200.0, 445.0, 280.0, 85.0, 290.0, 15.0, 65.0, 130.0, 15.0, 15.0, 45.0, 420.0, 185.0, -15.0, 490.0, 185.0, 195.0, 240.0, 260.0, 175.0, -30.0, 380.0, 320.0, 80.0, 435.0, 265.0, 250.0, 20.0, 170.0, 215.0, 75.0, 220.0, 300.0, 290.0, 425.0, 375.0, 265.0, 160.0, 585.0, 145.0, 270.0, 215.0, 420.0, 325.0, 65.0, 225.0, 75.0, 255.0, 240.0, 275.0, 220.0, 45.0, 630.0, -10.0, 205.0, 135.0, 205.0, 35.0, -80.0, 210.0, 360.0, 180.0, -120.0, 270.0, -35.0, 480.0, 220.0, 190.0, -5.0, 165.0, 235.0, 530.0, 295.0, 145.0, 310.0, 620.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136718247533498, "mean_inference_ms": 1.5114369497476188, "mean_action_processing_ms": 0.5582794067347723, "mean_env_wait_ms": 0.19574764935376998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15645813941955566, "StateBufferConnector_ms": 0.006096363067626953, "ViewRequirementAgentConnector_ms": 0.312974214553833}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5529600, "num_agent_steps_trained": 5529600, "num_env_steps_sampled": 1105920, "num_env_steps_trained": 1105920, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.80419629789506, "num_env_steps_trained_throughput_per_sec": 67.80419629789506, "timesteps_total": 1105920, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5529600, "timers": {"training_iteration_time_ms": 121747.791, "sample_time_ms": 13906.904, "load_time_ms": 1.86, "load_throughput": 4403626.787, "learn_time_ms": 107829.703, "learn_throughput": 75.972, "synch_weights_time_ms": 3.192}, "counters": {"num_env_steps_sampled": 1105920, "num_env_steps_trained": 1105920, "num_agent_steps_sampled": 5529600, "num_agent_steps_trained": 5529600}, "done": false, "episodes_total": 8640, "training_iteration": 135, "trial_id": "9fade_00019", "date": "2023-11-10_00-08-12", "timestamp": 1699571292, "time_this_iter_s": 120.83853268623352, "time_total_s": 15034.612552404404, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15034.612552404404, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 37.29302325581395, "ram_util_percent": 18.822674418604652}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5129246520352776, "episode_optimality_min": -0.8571428571428571, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5129246520352776, "episode_optimality_capped_min": -0.8571428571428571, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.26, "episode_reward_normalized_min": -72.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5129246520352776, "curr_learning_score_min": -0.8571428571428571, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9834370977059007, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2935321191853048, "policy_loss": -0.07354423698673296, "vf_loss": 0.35064949012591873, "vf_explained_var": 0.3493413339120646, "kl": 0.01622406491356552, "entropy": 2.8915174361566702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1300800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1114112, "num_env_steps_trained": 1114112, "num_agent_steps_sampled": 5570560, "num_agent_steps_trained": 5570560}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -360.0, "episode_reward_mean": 191.3, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5129246520352776, "episode_optimality_min": -0.8571428571428571, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5129246520352776, "episode_optimality_capped_min": -0.8571428571428571, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 38.26, "episode_reward_normalized_min": -72.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5129246520352776, "curr_learning_score_min": -0.8571428571428571, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [270.0, 215.0, 420.0, 325.0, 65.0, 225.0, 75.0, 255.0, 240.0, 275.0, 220.0, 45.0, 630.0, -10.0, 205.0, 135.0, 205.0, 35.0, -80.0, 210.0, 360.0, 180.0, -120.0, 270.0, -35.0, 480.0, 220.0, 190.0, -5.0, 165.0, 235.0, 530.0, 295.0, 145.0, 310.0, 620.0, 30.0, -230.0, -15.0, 160.0, 75.0, 440.0, 505.0, 15.0, 420.0, 455.0, -360.0, 115.0, 250.0, -105.0, 455.0, 70.0, 140.0, 350.0, 240.0, 245.0, 275.0, 135.0, 15.0, 170.0, 550.0, 160.0, 20.0, 115.0, 230.0, 115.0, 210.0, 270.0, 350.0, 475.0, -135.0, -85.0, 420.0, 195.0, -15.0, 190.0, -145.0, 45.0, -175.0, 95.0, 215.0, 255.0, 200.0, 60.0, 180.0, 215.0, 385.0, 70.0, 355.0, 105.0, 330.0, 0.0, 375.0, 260.0, 245.0, 145.0, 270.0, 460.0, 80.0, 390.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1365749231127904, "mean_inference_ms": 1.5110854728093341, "mean_action_processing_ms": 0.5581890405778508, "mean_env_wait_ms": 0.19570463044424413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16046524047851562, "StateBufferConnector_ms": 0.006285429000854492, "ViewRequirementAgentConnector_ms": 0.3206033706665039}}, "episode_reward_max": 630.0, "episode_reward_min": -360.0, "episode_reward_mean": 191.3, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [270.0, 215.0, 420.0, 325.0, 65.0, 225.0, 75.0, 255.0, 240.0, 275.0, 220.0, 45.0, 630.0, -10.0, 205.0, 135.0, 205.0, 35.0, -80.0, 210.0, 360.0, 180.0, -120.0, 270.0, -35.0, 480.0, 220.0, 190.0, -5.0, 165.0, 235.0, 530.0, 295.0, 145.0, 310.0, 620.0, 30.0, -230.0, -15.0, 160.0, 75.0, 440.0, 505.0, 15.0, 420.0, 455.0, -360.0, 115.0, 250.0, -105.0, 455.0, 70.0, 140.0, 350.0, 240.0, 245.0, 275.0, 135.0, 15.0, 170.0, 550.0, 160.0, 20.0, 115.0, 230.0, 115.0, 210.0, 270.0, 350.0, 475.0, -135.0, -85.0, 420.0, 195.0, -15.0, 190.0, -145.0, 45.0, -175.0, 95.0, 215.0, 255.0, 200.0, 60.0, 180.0, 215.0, 385.0, 70.0, 355.0, 105.0, 330.0, 0.0, 375.0, 260.0, 245.0, 145.0, 270.0, 460.0, 80.0, 390.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1365749231127904, "mean_inference_ms": 1.5110854728093341, "mean_action_processing_ms": 0.5581890405778508, "mean_env_wait_ms": 0.19570463044424413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16046524047851562, "StateBufferConnector_ms": 0.006285429000854492, "ViewRequirementAgentConnector_ms": 0.3206033706665039}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5570560, "num_agent_steps_trained": 5570560, "num_env_steps_sampled": 1114112, "num_env_steps_trained": 1114112, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.76192497822555, "num_env_steps_trained_throughput_per_sec": 67.76192497822555, "timesteps_total": 1114112, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5570560, "timers": {"training_iteration_time_ms": 121576.441, "sample_time_ms": 14021.887, "load_time_ms": 1.861, "load_throughput": 4401483.189, "learn_time_ms": 107543.34, "learn_throughput": 76.174, "synch_weights_time_ms": 3.219}, "counters": {"num_env_steps_sampled": 1114112, "num_env_steps_trained": 1114112, "num_agent_steps_sampled": 5570560, "num_agent_steps_trained": 5570560}, "done": false, "episodes_total": 8704, "training_iteration": 136, "trial_id": "9fade_00019", "date": "2023-11-10_00-10-13", "timestamp": 1699571413, "time_this_iter_s": 120.91047596931458, "time_total_s": 15155.523028373718, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15155.523028373718, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 37.99826589595376, "ram_util_percent": 18.573410404624276}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5679237131546353, "episode_optimality_min": -0.7631578947368421, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5679237131546353, "episode_optimality_capped_min": -0.7631578947368421, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.32, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5679237131546353, "curr_learning_score_min": -0.7631578947368421, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9744139359208445, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2426294350781245, "policy_loss": -0.06950883895119962, "vf_loss": 0.2970250720547119, "vf_explained_var": 0.3515737899951637, "kl": 0.014926618289521987, "entropy": 2.893074987605214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1310400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1122304, "num_env_steps_trained": 1122304, "num_agent_steps_sampled": 5611520, "num_agent_steps_trained": 5611520}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -175.0, "episode_reward_mean": 206.6, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5679237131546353, "episode_optimality_min": -0.7631578947368421, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5679237131546353, "episode_optimality_capped_min": -0.7631578947368421, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 41.32, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5679237131546353, "curr_learning_score_min": -0.7631578947368421, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [230.0, 115.0, 210.0, 270.0, 350.0, 475.0, -135.0, -85.0, 420.0, 195.0, -15.0, 190.0, -145.0, 45.0, -175.0, 95.0, 215.0, 255.0, 200.0, 60.0, 180.0, 215.0, 385.0, 70.0, 355.0, 105.0, 330.0, 0.0, 375.0, 260.0, 245.0, 145.0, 270.0, 460.0, 80.0, 390.0, 465.0, 460.0, 190.0, 330.0, 540.0, 325.0, 75.0, -65.0, 25.0, 430.0, 215.0, 85.0, 310.0, 505.0, 340.0, 145.0, 145.0, 135.0, 570.0, 475.0, 455.0, 10.0, 135.0, 290.0, 230.0, -40.0, 165.0, 100.0, 395.0, 170.0, 40.0, 225.0, 360.0, -40.0, 215.0, 125.0, 20.0, 20.0, 110.0, 435.0, -5.0, 555.0, 70.0, 280.0, 170.0, -120.0, 530.0, 480.0, -140.0, 70.0, 30.0, 135.0, 125.0, 410.0, 185.0, 90.0, 140.0, 330.0, 215.0, 580.0, 240.0, 100.0, 180.0, 255.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136591879481803, "mean_inference_ms": 1.5111557617872162, "mean_action_processing_ms": 0.5581480896793319, "mean_env_wait_ms": 0.19572830277265083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16164159774780273, "StateBufferConnector_ms": 0.006403446197509766, "ViewRequirementAgentConnector_ms": 0.326831579208374}}, "episode_reward_max": 580.0, "episode_reward_min": -175.0, "episode_reward_mean": 206.6, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [230.0, 115.0, 210.0, 270.0, 350.0, 475.0, -135.0, -85.0, 420.0, 195.0, -15.0, 190.0, -145.0, 45.0, -175.0, 95.0, 215.0, 255.0, 200.0, 60.0, 180.0, 215.0, 385.0, 70.0, 355.0, 105.0, 330.0, 0.0, 375.0, 260.0, 245.0, 145.0, 270.0, 460.0, 80.0, 390.0, 465.0, 460.0, 190.0, 330.0, 540.0, 325.0, 75.0, -65.0, 25.0, 430.0, 215.0, 85.0, 310.0, 505.0, 340.0, 145.0, 145.0, 135.0, 570.0, 475.0, 455.0, 10.0, 135.0, 290.0, 230.0, -40.0, 165.0, 100.0, 395.0, 170.0, 40.0, 225.0, 360.0, -40.0, 215.0, 125.0, 20.0, 20.0, 110.0, 435.0, -5.0, 555.0, 70.0, 280.0, 170.0, -120.0, 530.0, 480.0, -140.0, 70.0, 30.0, 135.0, 125.0, 410.0, 185.0, 90.0, 140.0, 330.0, 215.0, 580.0, 240.0, 100.0, 180.0, 255.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136591879481803, "mean_inference_ms": 1.5111557617872162, "mean_action_processing_ms": 0.5581480896793319, "mean_env_wait_ms": 0.19572830277265083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16164159774780273, "StateBufferConnector_ms": 0.006403446197509766, "ViewRequirementAgentConnector_ms": 0.326831579208374}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5611520, "num_agent_steps_trained": 5611520, "num_env_steps_sampled": 1122304, "num_env_steps_trained": 1122304, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.37923669762469, "num_env_steps_trained_throughput_per_sec": 68.37923669762469, "timesteps_total": 1122304, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5611520, "timers": {"training_iteration_time_ms": 121346.57, "sample_time_ms": 14032.792, "load_time_ms": 1.836, "load_throughput": 4461666.303, "learn_time_ms": 107302.785, "learn_throughput": 76.345, "synch_weights_time_ms": 3.123}, "counters": {"num_env_steps_sampled": 1122304, "num_env_steps_trained": 1122304, "num_agent_steps_sampled": 5611520, "num_agent_steps_trained": 5611520}, "done": false, "episodes_total": 8768, "training_iteration": 137, "trial_id": "9fade_00019", "date": "2023-11-10_00-12-13", "timestamp": 1699571533, "time_this_iter_s": 119.81942296028137, "time_total_s": 15275.342451334, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15275.342451334, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 37.559649122807016, "ram_util_percent": 18.66315789473684}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5455056269032981, "episode_optimality_min": -0.9753086419753086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5455056269032981, "episode_optimality_capped_min": -0.9753086419753086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.6, "episode_reward_normalized_min": -79.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5455056269032981, "curr_learning_score_min": -0.9753086419753086, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9818269531599556, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2590639126846023, "policy_loss": -0.07109815952809488, "vf_loss": 0.31440760576007504, "vf_explained_var": 0.37421188440794745, "kl": 0.015559965941132532, "entropy": 2.899896434172988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1320000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1130496, "num_env_steps_trained": 1130496, "num_agent_steps_sampled": 5652480, "num_agent_steps_trained": 5652480}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -395.0, "episode_reward_mean": 188.0, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5455056269032981, "episode_optimality_min": -0.9753086419753086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5455056269032981, "episode_optimality_capped_min": -0.9753086419753086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 37.6, "episode_reward_normalized_min": -79.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5455056269032981, "curr_learning_score_min": -0.9753086419753086, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [395.0, 170.0, 40.0, 225.0, 360.0, -40.0, 215.0, 125.0, 20.0, 20.0, 110.0, 435.0, -5.0, 555.0, 70.0, 280.0, 170.0, -120.0, 530.0, 480.0, -140.0, 70.0, 30.0, 135.0, 125.0, 410.0, 185.0, 90.0, 140.0, 330.0, 215.0, 580.0, 240.0, 100.0, 180.0, 255.0, 130.0, 50.0, 180.0, 95.0, 210.0, 290.0, 180.0, 280.0, 160.0, 60.0, 390.0, 100.0, 490.0, -65.0, 80.0, -70.0, 220.0, 395.0, 285.0, 230.0, -35.0, 225.0, 115.0, -35.0, 45.0, -20.0, 180.0, 425.0, 105.0, 85.0, 630.0, 360.0, 250.0, 150.0, 415.0, 315.0, 180.0, 205.0, 100.0, 260.0, 385.0, 25.0, 575.0, 235.0, 280.0, -50.0, 175.0, 335.0, -215.0, 235.0, 55.0, 225.0, 105.0, 285.0, 95.0, 250.0, 130.0, -395.0, 220.0, 255.0, 275.0, 330.0, 280.0, 85.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1364459866664796, "mean_inference_ms": 1.511019170166898, "mean_action_processing_ms": 0.5580472040904724, "mean_env_wait_ms": 0.1956997219555533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15849065780639648, "StateBufferConnector_ms": 0.006185293197631836, "ViewRequirementAgentConnector_ms": 0.31887316703796387}}, "episode_reward_max": 630.0, "episode_reward_min": -395.0, "episode_reward_mean": 188.0, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [395.0, 170.0, 40.0, 225.0, 360.0, -40.0, 215.0, 125.0, 20.0, 20.0, 110.0, 435.0, -5.0, 555.0, 70.0, 280.0, 170.0, -120.0, 530.0, 480.0, -140.0, 70.0, 30.0, 135.0, 125.0, 410.0, 185.0, 90.0, 140.0, 330.0, 215.0, 580.0, 240.0, 100.0, 180.0, 255.0, 130.0, 50.0, 180.0, 95.0, 210.0, 290.0, 180.0, 280.0, 160.0, 60.0, 390.0, 100.0, 490.0, -65.0, 80.0, -70.0, 220.0, 395.0, 285.0, 230.0, -35.0, 225.0, 115.0, -35.0, 45.0, -20.0, 180.0, 425.0, 105.0, 85.0, 630.0, 360.0, 250.0, 150.0, 415.0, 315.0, 180.0, 205.0, 100.0, 260.0, 385.0, 25.0, 575.0, 235.0, 280.0, -50.0, 175.0, 335.0, -215.0, 235.0, 55.0, 225.0, 105.0, 285.0, 95.0, 250.0, 130.0, -395.0, 220.0, 255.0, 275.0, 330.0, 280.0, 85.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1364459866664796, "mean_inference_ms": 1.511019170166898, "mean_action_processing_ms": 0.5580472040904724, "mean_env_wait_ms": 0.1956997219555533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15849065780639648, "StateBufferConnector_ms": 0.006185293197631836, "ViewRequirementAgentConnector_ms": 0.31887316703796387}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5652480, "num_agent_steps_trained": 5652480, "num_env_steps_sampled": 1130496, "num_env_steps_trained": 1130496, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 68.01920514313359, "num_env_steps_trained_throughput_per_sec": 68.01920514313359, "timesteps_total": 1130496, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5652480, "timers": {"training_iteration_time_ms": 121147.12, "sample_time_ms": 13994.849, "load_time_ms": 1.845, "load_throughput": 4439185.329, "learn_time_ms": 107141.331, "learn_throughput": 76.46, "synch_weights_time_ms": 3.113}, "counters": {"num_env_steps_sampled": 1130496, "num_env_steps_trained": 1130496, "num_agent_steps_sampled": 5652480, "num_agent_steps_trained": 5652480}, "done": false, "episodes_total": 8832, "training_iteration": 138, "trial_id": "9fade_00019", "date": "2023-11-10_00-14-14", "timestamp": 1699571654, "time_this_iter_s": 120.45256209373474, "time_total_s": 15395.795013427734, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15395.795013427734, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 37.65348837209302, "ram_util_percent": 18.679069767441863}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6265359125802833, "episode_optimality_min": -0.9753086419753086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6265359125802833, "episode_optimality_capped_min": -0.9753086419753086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.38, "episode_reward_normalized_min": -79.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6265359125802833, "curr_learning_score_min": -0.9753086419753086, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9805374999685834, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.21674448482250833, "policy_loss": -0.07287519562710562, "vf_loss": 0.27371048925802827, "vf_explained_var": 0.398610083113114, "kl": 0.01571278052770822, "entropy": 2.913477831284205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1329600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1138688, "num_env_steps_trained": 1138688, "num_agent_steps_sampled": 5693440, "num_agent_steps_trained": 5693440}, "sampler_results": {"episode_reward_max": 630.0, "episode_reward_min": -395.0, "episode_reward_mean": 211.9, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6265359125802833, "episode_optimality_min": -0.9753086419753086, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6265359125802833, "episode_optimality_capped_min": -0.9753086419753086, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 42.38, "episode_reward_normalized_min": -79.0, "episode_reward_normalized_max": 126.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6265359125802833, "curr_learning_score_min": -0.9753086419753086, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [105.0, 85.0, 630.0, 360.0, 250.0, 150.0, 415.0, 315.0, 180.0, 205.0, 100.0, 260.0, 385.0, 25.0, 575.0, 235.0, 280.0, -50.0, 175.0, 335.0, -215.0, 235.0, 55.0, 225.0, 105.0, 285.0, 95.0, 250.0, 130.0, -395.0, 220.0, 255.0, 275.0, 330.0, 280.0, 85.0, 335.0, 115.0, 240.0, 180.0, 295.0, 445.0, 150.0, 360.0, 345.0, 310.0, 125.0, 450.0, -10.0, 570.0, 40.0, 265.0, -160.0, 395.0, 410.0, 125.0, 235.0, 185.0, 105.0, 50.0, 160.0, 160.0, 185.0, 80.0, 550.0, 125.0, 100.0, 225.0, 205.0, 125.0, 320.0, 490.0, 230.0, 190.0, 60.0, 420.0, 75.0, 190.0, 270.0, 260.0, 110.0, 260.0, 55.0, 285.0, -95.0, 65.0, 360.0, 115.0, 105.0, 195.0, 160.0, 285.0, 365.0, 225.0, 360.0, 10.0, 195.0, 420.0, 465.0, 40.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136334278105119, "mean_inference_ms": 1.5108378957491158, "mean_action_processing_ms": 0.5579817477179799, "mean_env_wait_ms": 0.19566557364797926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15958166122436523, "StateBufferConnector_ms": 0.006245136260986328, "ViewRequirementAgentConnector_ms": 0.32176923751831055}}, "episode_reward_max": 630.0, "episode_reward_min": -395.0, "episode_reward_mean": 211.9, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [105.0, 85.0, 630.0, 360.0, 250.0, 150.0, 415.0, 315.0, 180.0, 205.0, 100.0, 260.0, 385.0, 25.0, 575.0, 235.0, 280.0, -50.0, 175.0, 335.0, -215.0, 235.0, 55.0, 225.0, 105.0, 285.0, 95.0, 250.0, 130.0, -395.0, 220.0, 255.0, 275.0, 330.0, 280.0, 85.0, 335.0, 115.0, 240.0, 180.0, 295.0, 445.0, 150.0, 360.0, 345.0, 310.0, 125.0, 450.0, -10.0, 570.0, 40.0, 265.0, -160.0, 395.0, 410.0, 125.0, 235.0, 185.0, 105.0, 50.0, 160.0, 160.0, 185.0, 80.0, 550.0, 125.0, 100.0, 225.0, 205.0, 125.0, 320.0, 490.0, 230.0, 190.0, 60.0, 420.0, 75.0, 190.0, 270.0, 260.0, 110.0, 260.0, 55.0, 285.0, -95.0, 65.0, 360.0, 115.0, 105.0, 195.0, 160.0, 285.0, 365.0, 225.0, 360.0, 10.0, 195.0, 420.0, 465.0, 40.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136334278105119, "mean_inference_ms": 1.5108378957491158, "mean_action_processing_ms": 0.5579817477179799, "mean_env_wait_ms": 0.19566557364797926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15958166122436523, "StateBufferConnector_ms": 0.006245136260986328, "ViewRequirementAgentConnector_ms": 0.32176923751831055}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5693440, "num_agent_steps_trained": 5693440, "num_env_steps_sampled": 1138688, "num_env_steps_trained": 1138688, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.00046340065091, "num_env_steps_trained_throughput_per_sec": 67.00046340065091, "timesteps_total": 1138688, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5693440, "timers": {"training_iteration_time_ms": 121064.319, "sample_time_ms": 14082.233, "load_time_ms": 1.788, "load_throughput": 4581237.366, "learn_time_ms": 106971.251, "learn_throughput": 76.581, "synch_weights_time_ms": 3.005}, "counters": {"num_env_steps_sampled": 1138688, "num_env_steps_trained": 1138688, "num_agent_steps_sampled": 5693440, "num_agent_steps_trained": 5693440}, "done": false, "episodes_total": 8896, "training_iteration": 139, "trial_id": "9fade_00019", "date": "2023-11-10_00-16-16", "timestamp": 1699571776, "time_this_iter_s": 122.28325057029724, "time_total_s": 15518.078263998032, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15518.078263998032, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 38.48275862068966, "ram_util_percent": 18.59022988505747}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6772765792199312, "episode_optimality_min": -0.3333333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6772765792199312, "episode_optimality_capped_min": -0.3333333333333333, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.04, "episode_reward_normalized_min": -19.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6772765792199312, "curr_learning_score_min": -0.3333333333333333, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9882832516077906, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23809522590905544, "policy_loss": -0.07299571696647035, "vf_loss": 0.2949151102481119, "vf_explained_var": 0.40708432664473854, "kl": 0.015976130559895788, "entropy": 2.8980434097598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1339200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1146880, "num_env_steps_trained": 1146880, "num_agent_steps_sampled": 5734400, "num_agent_steps_trained": 5734400}, "sampler_results": {"episode_reward_max": 550.0, "episode_reward_min": -95.0, "episode_reward_mean": 230.2, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6772765792199312, "episode_optimality_min": -0.3333333333333333, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6772765792199312, "episode_optimality_capped_min": -0.3333333333333333, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.04, "episode_reward_normalized_min": -19.0, "episode_reward_normalized_max": 110.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6772765792199312, "curr_learning_score_min": -0.3333333333333333, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [550.0, 125.0, 100.0, 225.0, 205.0, 125.0, 320.0, 490.0, 230.0, 190.0, 60.0, 420.0, 75.0, 190.0, 270.0, 260.0, 110.0, 260.0, 55.0, 285.0, -95.0, 65.0, 360.0, 115.0, 105.0, 195.0, 160.0, 285.0, 365.0, 225.0, 360.0, 10.0, 195.0, 420.0, 465.0, 40.0, 265.0, 150.0, 125.0, 225.0, 130.0, 380.0, 315.0, 120.0, 165.0, 290.0, 35.0, 130.0, 340.0, 150.0, 485.0, 180.0, -35.0, 90.0, 145.0, 255.0, 290.0, 295.0, 60.0, 10.0, 375.0, 85.0, 455.0, 50.0, 400.0, 145.0, 420.0, 190.0, 65.0, 235.0, 350.0, 345.0, 190.0, 335.0, 455.0, 275.0, 315.0, 145.0, 445.0, 205.0, 310.0, 125.0, 50.0, 80.0, 400.0, 240.0, 485.0, 220.0, 275.0, 335.0, 200.0, 35.0, 275.0, 280.0, 375.0, 405.0, 415.0, 85.0, 135.0, 405.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1364412885876267, "mean_inference_ms": 1.511085014700069, "mean_action_processing_ms": 0.5580211704941033, "mean_env_wait_ms": 0.19569422349564874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16371488571166992, "StateBufferConnector_ms": 0.006514787673950195, "ViewRequirementAgentConnector_ms": 0.3346734046936035}}, "episode_reward_max": 550.0, "episode_reward_min": -95.0, "episode_reward_mean": 230.2, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [550.0, 125.0, 100.0, 225.0, 205.0, 125.0, 320.0, 490.0, 230.0, 190.0, 60.0, 420.0, 75.0, 190.0, 270.0, 260.0, 110.0, 260.0, 55.0, 285.0, -95.0, 65.0, 360.0, 115.0, 105.0, 195.0, 160.0, 285.0, 365.0, 225.0, 360.0, 10.0, 195.0, 420.0, 465.0, 40.0, 265.0, 150.0, 125.0, 225.0, 130.0, 380.0, 315.0, 120.0, 165.0, 290.0, 35.0, 130.0, 340.0, 150.0, 485.0, 180.0, -35.0, 90.0, 145.0, 255.0, 290.0, 295.0, 60.0, 10.0, 375.0, 85.0, 455.0, 50.0, 400.0, 145.0, 420.0, 190.0, 65.0, 235.0, 350.0, 345.0, 190.0, 335.0, 455.0, 275.0, 315.0, 145.0, 445.0, 205.0, 310.0, 125.0, 50.0, 80.0, 400.0, 240.0, 485.0, 220.0, 275.0, 335.0, 200.0, 35.0, 275.0, 280.0, 375.0, 405.0, 415.0, 85.0, 135.0, 405.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1364412885876267, "mean_inference_ms": 1.511085014700069, "mean_action_processing_ms": 0.5580211704941033, "mean_env_wait_ms": 0.19569422349564874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16371488571166992, "StateBufferConnector_ms": 0.006514787673950195, "ViewRequirementAgentConnector_ms": 0.3346734046936035}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5734400, "num_agent_steps_trained": 5734400, "num_env_steps_sampled": 1146880, "num_env_steps_trained": 1146880, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.79670995412351, "num_env_steps_trained_throughput_per_sec": 67.79670995412351, "timesteps_total": 1146880, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5734400, "timers": {"training_iteration_time_ms": 120867.092, "sample_time_ms": 14116.004, "load_time_ms": 1.737, "load_throughput": 4715145.719, "learn_time_ms": 106740.644, "learn_throughput": 76.747, "synch_weights_time_ms": 2.846}, "counters": {"num_env_steps_sampled": 1146880, "num_env_steps_trained": 1146880, "num_agent_steps_sampled": 5734400, "num_agent_steps_trained": 5734400}, "done": false, "episodes_total": 8960, "training_iteration": 140, "trial_id": "9fade_00019", "date": "2023-11-10_00-18-18", "timestamp": 1699571898, "time_this_iter_s": 120.84439420700073, "time_total_s": 15638.922658205032, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15638.922658205032, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 37.61436781609195, "ram_util_percent": 18.85919540229885}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.7033814018254371, "episode_optimality_min": -0.23076923076923078, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.7033814018254371, "episode_optimality_capped_min": -0.23076923076923078, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 49.54, "episode_reward_normalized_min": -6.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.7033814018254371, "curr_learning_score_min": -0.23076923076923078, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9902057291877766, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23248488422022395, "policy_loss": -0.0735347897646716, "vf_loss": 0.2898455074746259, "vf_explained_var": 0.3771583130521079, "kl": 0.01597448503027901, "entropy": 2.91321498028934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1348800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1155072, "num_env_steps_trained": 1155072, "num_agent_steps_sampled": 5775360, "num_agent_steps_trained": 5775360}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -30.0, "episode_reward_mean": 247.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.7033814018254371, "episode_optimality_min": -0.23076923076923078, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.7033814018254371, "episode_optimality_capped_min": -0.23076923076923078, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 49.54, "episode_reward_normalized_min": -6.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.7033814018254371, "curr_learning_score_min": -0.23076923076923078, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [400.0, 145.0, 420.0, 190.0, 65.0, 235.0, 350.0, 345.0, 190.0, 335.0, 455.0, 275.0, 315.0, 145.0, 445.0, 205.0, 310.0, 125.0, 50.0, 80.0, 400.0, 240.0, 485.0, 220.0, 275.0, 335.0, 200.0, 35.0, 275.0, 280.0, 375.0, 405.0, 415.0, 85.0, 135.0, 405.0, -20.0, 290.0, 470.0, 335.0, 15.0, 180.0, 285.0, 290.0, -30.0, 325.0, 110.0, 400.0, 160.0, 115.0, 55.0, 335.0, 80.0, 145.0, 120.0, 395.0, 130.0, 265.0, 75.0, 235.0, 435.0, 295.0, 150.0, 75.0, 295.0, 305.0, 215.0, 245.0, 140.0, 65.0, 175.0, 465.0, 0.0, 225.0, 130.0, 335.0, 200.0, 585.0, 260.0, 440.0, 470.0, 145.0, 115.0, 180.0, 165.0, 545.0, 180.0, 525.0, 70.0, 130.0, 270.0, 325.0, 445.0, 480.0, 235.0, 415.0, 95.0, 75.0, 195.0, 270.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1364214856298014, "mean_inference_ms": 1.5110557159985085, "mean_action_processing_ms": 0.5579898148079336, "mean_env_wait_ms": 0.19569300260152434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16168761253356934, "StateBufferConnector_ms": 0.006296873092651367, "ViewRequirementAgentConnector_ms": 0.3265116214752197}}, "episode_reward_max": 585.0, "episode_reward_min": -30.0, "episode_reward_mean": 247.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [400.0, 145.0, 420.0, 190.0, 65.0, 235.0, 350.0, 345.0, 190.0, 335.0, 455.0, 275.0, 315.0, 145.0, 445.0, 205.0, 310.0, 125.0, 50.0, 80.0, 400.0, 240.0, 485.0, 220.0, 275.0, 335.0, 200.0, 35.0, 275.0, 280.0, 375.0, 405.0, 415.0, 85.0, 135.0, 405.0, -20.0, 290.0, 470.0, 335.0, 15.0, 180.0, 285.0, 290.0, -30.0, 325.0, 110.0, 400.0, 160.0, 115.0, 55.0, 335.0, 80.0, 145.0, 120.0, 395.0, 130.0, 265.0, 75.0, 235.0, 435.0, 295.0, 150.0, 75.0, 295.0, 305.0, 215.0, 245.0, 140.0, 65.0, 175.0, 465.0, 0.0, 225.0, 130.0, 335.0, 200.0, 585.0, 260.0, 440.0, 470.0, 145.0, 115.0, 180.0, 165.0, 545.0, 180.0, 525.0, 70.0, 130.0, 270.0, 325.0, 445.0, 480.0, 235.0, 415.0, 95.0, 75.0, 195.0, 270.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1364214856298014, "mean_inference_ms": 1.5110557159985085, "mean_action_processing_ms": 0.5579898148079336, "mean_env_wait_ms": 0.19569300260152434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16168761253356934, "StateBufferConnector_ms": 0.006296873092651367, "ViewRequirementAgentConnector_ms": 0.3265116214752197}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5775360, "num_agent_steps_trained": 5775360, "num_env_steps_sampled": 1155072, "num_env_steps_trained": 1155072, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.02035145228872, "num_env_steps_trained_throughput_per_sec": 67.02035145228872, "timesteps_total": 1155072, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5775360, "timers": {"training_iteration_time_ms": 120920.59, "sample_time_ms": 14100.733, "load_time_ms": 1.646, "load_throughput": 4976787.133, "learn_time_ms": 106809.583, "learn_throughput": 76.697, "synch_weights_time_ms": 2.797}, "counters": {"num_env_steps_sampled": 1155072, "num_env_steps_trained": 1155072, "num_agent_steps_sampled": 5775360, "num_agent_steps_trained": 5775360}, "done": false, "episodes_total": 9024, "training_iteration": 141, "trial_id": "9fade_00019", "date": "2023-11-10_00-20-20", "timestamp": 1699572020, "time_this_iter_s": 122.24856686592102, "time_total_s": 15761.171225070953, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15761.171225070953, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 37.495977011494254, "ram_util_percent": 18.897701149425288}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6466204135114118, "episode_optimality_min": -0.6428571428571429, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6466204135114118, "episode_optimality_capped_min": -0.6428571428571429, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.49, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6466204135114118, "curr_learning_score_min": -0.6428571428571429, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9851886981446296, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2611019345320528, "policy_loss": -0.0698109801223715, "vf_loss": 0.3154946088900518, "vf_explained_var": 0.4008152099015812, "kl": 0.015227955826400527, "entropy": 2.9159479533632595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1358400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1163264, "num_env_steps_trained": 1163264, "num_agent_steps_sampled": 5816320, "num_agent_steps_trained": 5816320}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -180.0, "episode_reward_mean": 232.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6466204135114118, "episode_optimality_min": -0.6428571428571429, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6466204135114118, "episode_optimality_capped_min": -0.6428571428571429, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.49, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6466204135114118, "curr_learning_score_min": -0.6428571428571429, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [295.0, 305.0, 215.0, 245.0, 140.0, 65.0, 175.0, 465.0, 0.0, 225.0, 130.0, 335.0, 200.0, 585.0, 260.0, 440.0, 470.0, 145.0, 115.0, 180.0, 165.0, 545.0, 180.0, 525.0, 70.0, 130.0, 270.0, 325.0, 445.0, 480.0, 235.0, 415.0, 95.0, 75.0, 195.0, 270.0, 65.0, 325.0, 310.0, 225.0, 385.0, 195.0, 400.0, 125.0, 520.0, 250.0, 115.0, 215.0, 85.0, 90.0, 120.0, 90.0, 475.0, 370.0, 180.0, 400.0, 355.0, -5.0, 185.0, 145.0, 150.0, 145.0, 530.0, 140.0, 460.0, 60.0, 265.0, 295.0, -25.0, 150.0, 490.0, 185.0, 300.0, -140.0, 265.0, 220.0, 265.0, 245.0, 435.0, 90.0, 20.0, 455.0, 360.0, -90.0, 125.0, 160.0, 145.0, 195.0, 425.0, 250.0, 310.0, 350.0, 75.0, -70.0, -180.0, 450.0, 285.0, 270.0, 275.0, -120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1363532453666716, "mean_inference_ms": 1.5108550929152378, "mean_action_processing_ms": 0.5579375769724845, "mean_env_wait_ms": 0.195670168158388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1604599952697754, "StateBufferConnector_ms": 0.00621342658996582, "ViewRequirementAgentConnector_ms": 0.3246314525604248}}, "episode_reward_max": 585.0, "episode_reward_min": -180.0, "episode_reward_mean": 232.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [295.0, 305.0, 215.0, 245.0, 140.0, 65.0, 175.0, 465.0, 0.0, 225.0, 130.0, 335.0, 200.0, 585.0, 260.0, 440.0, 470.0, 145.0, 115.0, 180.0, 165.0, 545.0, 180.0, 525.0, 70.0, 130.0, 270.0, 325.0, 445.0, 480.0, 235.0, 415.0, 95.0, 75.0, 195.0, 270.0, 65.0, 325.0, 310.0, 225.0, 385.0, 195.0, 400.0, 125.0, 520.0, 250.0, 115.0, 215.0, 85.0, 90.0, 120.0, 90.0, 475.0, 370.0, 180.0, 400.0, 355.0, -5.0, 185.0, 145.0, 150.0, 145.0, 530.0, 140.0, 460.0, 60.0, 265.0, 295.0, -25.0, 150.0, 490.0, 185.0, 300.0, -140.0, 265.0, 220.0, 265.0, 245.0, 435.0, 90.0, 20.0, 455.0, 360.0, -90.0, 125.0, 160.0, 145.0, 195.0, 425.0, 250.0, 310.0, 350.0, 75.0, -70.0, -180.0, 450.0, 285.0, 270.0, 275.0, -120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1363532453666716, "mean_inference_ms": 1.5108550929152378, "mean_action_processing_ms": 0.5579375769724845, "mean_env_wait_ms": 0.195670168158388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1604599952697754, "StateBufferConnector_ms": 0.00621342658996582, "ViewRequirementAgentConnector_ms": 0.3246314525604248}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5816320, "num_agent_steps_trained": 5816320, "num_env_steps_sampled": 1163264, "num_env_steps_trained": 1163264, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.09083180692356, "num_env_steps_trained_throughput_per_sec": 66.09083180692356, "timesteps_total": 1163264, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5816320, "timers": {"training_iteration_time_ms": 121369.091, "sample_time_ms": 14086.892, "load_time_ms": 1.712, "load_throughput": 4783680.004, "learn_time_ms": 107271.519, "learn_throughput": 76.367, "synch_weights_time_ms": 3.097}, "counters": {"num_env_steps_sampled": 1163264, "num_env_steps_trained": 1163264, "num_agent_steps_sampled": 5816320, "num_agent_steps_trained": 5816320}, "done": false, "episodes_total": 9088, "training_iteration": 142, "trial_id": "9fade_00019", "date": "2023-11-10_00-22-24", "timestamp": 1699572144, "time_this_iter_s": 123.96836686134338, "time_total_s": 15885.139591932297, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15885.139591932297, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 37.85875706214689, "ram_util_percent": 18.62316384180791}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.5914459734261172, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5914459734261172, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.54, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5914459734261172, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9806926774031793, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.24645668942900859, "policy_loss": -0.06880448534560855, "vf_loss": 0.30020475637793426, "vf_explained_var": 0.3768818852181236, "kl": 0.014870535922224235, "entropy": 2.953567350829641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1368000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1171456, "num_env_steps_trained": 1171456, "num_agent_steps_sampled": 5857280, "num_agent_steps_trained": 5857280}, "sampler_results": {"episode_reward_max": 605.0, "episode_reward_min": -180.0, "episode_reward_mean": 202.7, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.5914459734261172, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.5914459734261172, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 40.54, "episode_reward_normalized_min": -36.0, "episode_reward_normalized_max": 121.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.5914459734261172, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [460.0, 60.0, 265.0, 295.0, -25.0, 150.0, 490.0, 185.0, 300.0, -140.0, 265.0, 220.0, 265.0, 245.0, 435.0, 90.0, 20.0, 455.0, 360.0, -90.0, 125.0, 160.0, 145.0, 195.0, 425.0, 250.0, 310.0, 350.0, 75.0, -70.0, -180.0, 450.0, 285.0, 270.0, 275.0, -120.0, 75.0, -110.0, 255.0, 175.0, 415.0, 40.0, 275.0, 85.0, 465.0, 55.0, 445.0, 100.0, 220.0, -50.0, 250.0, -60.0, 520.0, 280.0, 605.0, 390.0, 265.0, 440.0, 110.0, 120.0, 285.0, 75.0, 140.0, -135.0, 320.0, 330.0, 230.0, 80.0, 160.0, 460.0, 585.0, 110.0, 315.0, 220.0, 175.0, 125.0, 80.0, -100.0, 310.0, 280.0, 270.0, 265.0, 100.0, 175.0, 215.0, -175.0, 105.0, 255.0, 310.0, 140.0, 210.0, 400.0, 290.0, 255.0, 140.0, 185.0, 275.0, 5.0, 100.0, 90.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136294943548559, "mean_inference_ms": 1.5107476798434134, "mean_action_processing_ms": 0.5578994064226261, "mean_env_wait_ms": 0.19563944662388758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16127324104309082, "StateBufferConnector_ms": 0.006195783615112305, "ViewRequirementAgentConnector_ms": 0.3222379684448242}}, "episode_reward_max": 605.0, "episode_reward_min": -180.0, "episode_reward_mean": 202.7, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [460.0, 60.0, 265.0, 295.0, -25.0, 150.0, 490.0, 185.0, 300.0, -140.0, 265.0, 220.0, 265.0, 245.0, 435.0, 90.0, 20.0, 455.0, 360.0, -90.0, 125.0, 160.0, 145.0, 195.0, 425.0, 250.0, 310.0, 350.0, 75.0, -70.0, -180.0, 450.0, 285.0, 270.0, 275.0, -120.0, 75.0, -110.0, 255.0, 175.0, 415.0, 40.0, 275.0, 85.0, 465.0, 55.0, 445.0, 100.0, 220.0, -50.0, 250.0, -60.0, 520.0, 280.0, 605.0, 390.0, 265.0, 440.0, 110.0, 120.0, 285.0, 75.0, 140.0, -135.0, 320.0, 330.0, 230.0, 80.0, 160.0, 460.0, 585.0, 110.0, 315.0, 220.0, 175.0, 125.0, 80.0, -100.0, 310.0, 280.0, 270.0, 265.0, 100.0, 175.0, 215.0, -175.0, 105.0, 255.0, 310.0, 140.0, 210.0, 400.0, 290.0, 255.0, 140.0, 185.0, 275.0, 5.0, 100.0, 90.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.136294943548559, "mean_inference_ms": 1.5107476798434134, "mean_action_processing_ms": 0.5578994064226261, "mean_env_wait_ms": 0.19563944662388758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16127324104309082, "StateBufferConnector_ms": 0.006195783615112305, "ViewRequirementAgentConnector_ms": 0.3222379684448242}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5857280, "num_agent_steps_trained": 5857280, "num_env_steps_sampled": 1171456, "num_env_steps_trained": 1171456, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 65.73761144951284, "num_env_steps_trained_throughput_per_sec": 65.73761144951284, "timesteps_total": 1171456, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5857280, "timers": {"training_iteration_time_ms": 121761.655, "sample_time_ms": 14011.279, "load_time_ms": 1.709, "load_throughput": 4794493.598, "learn_time_ms": 107739.636, "learn_throughput": 76.035, "synch_weights_time_ms": 3.098}, "counters": {"num_env_steps_sampled": 1171456, "num_env_steps_trained": 1171456, "num_agent_steps_sampled": 5857280, "num_agent_steps_trained": 5857280}, "done": false, "episodes_total": 9152, "training_iteration": 143, "trial_id": "9fade_00019", "date": "2023-11-10_00-24-29", "timestamp": 1699572269, "time_this_iter_s": 124.63493752479553, "time_total_s": 16009.774529457092, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16009.774529457092, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 38.40955056179775, "ram_util_percent": 18.530898876404493}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6651598616085235, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6651598616085235, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.49, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6651598616085235, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.989386969404295, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2473208533357926, "policy_loss": -0.07227320631175341, "vf_loss": 0.3038937399441784, "vf_explained_var": 0.3851609449957808, "kl": 0.015506487209670279, "entropy": 2.9104723414530356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1377600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1179648, "num_env_steps_trained": 1179648, "num_agent_steps_sampled": 5898240, "num_agent_steps_trained": 5898240}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -175.0, "episode_reward_mean": 227.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6651598616085235, "episode_optimality_min": -0.7, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6651598616085235, "episode_optimality_capped_min": -0.7, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 45.49, "episode_reward_normalized_min": -35.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6651598616085235, "curr_learning_score_min": -0.7, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [320.0, 330.0, 230.0, 80.0, 160.0, 460.0, 585.0, 110.0, 315.0, 220.0, 175.0, 125.0, 80.0, -100.0, 310.0, 280.0, 270.0, 265.0, 100.0, 175.0, 215.0, -175.0, 105.0, 255.0, 310.0, 140.0, 210.0, 400.0, 290.0, 255.0, 140.0, 185.0, 275.0, 5.0, 100.0, 90.0, 270.0, 240.0, 500.0, 415.0, 210.0, -105.0, 245.0, 135.0, 335.0, 365.0, 150.0, 275.0, 70.0, 105.0, 120.0, 265.0, 325.0, 260.0, 440.0, 430.0, 55.0, 485.0, 340.0, 220.0, 170.0, 395.0, -30.0, 50.0, 340.0, 195.0, 510.0, 205.0, 185.0, 280.0, 345.0, 365.0, -55.0, 150.0, 270.0, 80.0, 125.0, 230.0, 255.0, 350.0, 435.0, 275.0, 145.0, 260.0, 280.0, 150.0, -75.0, 350.0, 470.0, 115.0, 275.0, 265.0, 120.0, 150.0, -10.0, 405.0, 120.0, 270.0, 585.0, 305.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1361039214817787, "mean_inference_ms": 1.5103713212194685, "mean_action_processing_ms": 0.5578130617648115, "mean_env_wait_ms": 0.19557795921571525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1577591896057129, "StateBufferConnector_ms": 0.006098508834838867, "ViewRequirementAgentConnector_ms": 0.31673479080200195}}, "episode_reward_max": 585.0, "episode_reward_min": -175.0, "episode_reward_mean": 227.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [320.0, 330.0, 230.0, 80.0, 160.0, 460.0, 585.0, 110.0, 315.0, 220.0, 175.0, 125.0, 80.0, -100.0, 310.0, 280.0, 270.0, 265.0, 100.0, 175.0, 215.0, -175.0, 105.0, 255.0, 310.0, 140.0, 210.0, 400.0, 290.0, 255.0, 140.0, 185.0, 275.0, 5.0, 100.0, 90.0, 270.0, 240.0, 500.0, 415.0, 210.0, -105.0, 245.0, 135.0, 335.0, 365.0, 150.0, 275.0, 70.0, 105.0, 120.0, 265.0, 325.0, 260.0, 440.0, 430.0, 55.0, 485.0, 340.0, 220.0, 170.0, 395.0, -30.0, 50.0, 340.0, 195.0, 510.0, 205.0, 185.0, 280.0, 345.0, 365.0, -55.0, 150.0, 270.0, 80.0, 125.0, 230.0, 255.0, 350.0, 435.0, 275.0, 145.0, 260.0, 280.0, 150.0, -75.0, 350.0, 470.0, 115.0, 275.0, 265.0, 120.0, 150.0, -10.0, 405.0, 120.0, 270.0, 585.0, 305.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1361039214817787, "mean_inference_ms": 1.5103713212194685, "mean_action_processing_ms": 0.5578130617648115, "mean_env_wait_ms": 0.19557795921571525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1577591896057129, "StateBufferConnector_ms": 0.006098508834838867, "ViewRequirementAgentConnector_ms": 0.31673479080200195}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5898240, "num_agent_steps_trained": 5898240, "num_env_steps_sampled": 1179648, "num_env_steps_trained": 1179648, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 65.79911538735251, "num_env_steps_trained_throughput_per_sec": 65.79911538735251, "timesteps_total": 1179648, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5898240, "timers": {"training_iteration_time_ms": 122034.969, "sample_time_ms": 14002.032, "load_time_ms": 1.665, "load_throughput": 4921259.022, "learn_time_ms": 108022.369, "learn_throughput": 75.836, "synch_weights_time_ms": 2.983}, "counters": {"num_env_steps_sampled": 1179648, "num_env_steps_trained": 1179648, "num_agent_steps_sampled": 5898240, "num_agent_steps_trained": 5898240}, "done": false, "episodes_total": 9216, "training_iteration": 144, "trial_id": "9fade_00019", "date": "2023-11-10_00-26-34", "timestamp": 1699572394, "time_this_iter_s": 124.51856994628906, "time_total_s": 16134.293099403381, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16134.293099403381, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 37.79491525423728, "ram_util_percent": 18.736158192090397}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6571773544927239, "episode_optimality_min": -0.75, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6571773544927239, "episode_optimality_capped_min": -0.75, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.43, "episode_reward_normalized_min": -18.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6571773544927239, "curr_learning_score_min": -0.75, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9912790965816627, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23787663265578884, "policy_loss": -0.06890153930037438, "vf_loss": 0.29127783149150976, "vf_explained_var": 0.3796924335199098, "kl": 0.015308977660237512, "entropy": 2.916441559890906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1387200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1187840, "num_env_steps_trained": 1187840, "num_agent_steps_sampled": 5939200, "num_agent_steps_trained": 5939200}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -90.0, "episode_reward_mean": 237.15, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6571773544927239, "episode_optimality_min": -0.75, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6571773544927239, "episode_optimality_capped_min": -0.75, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.43, "episode_reward_normalized_min": -18.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6571773544927239, "curr_learning_score_min": -0.75, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [340.0, 195.0, 510.0, 205.0, 185.0, 280.0, 345.0, 365.0, -55.0, 150.0, 270.0, 80.0, 125.0, 230.0, 255.0, 350.0, 435.0, 275.0, 145.0, 260.0, 280.0, 150.0, -75.0, 350.0, 470.0, 115.0, 275.0, 265.0, 120.0, 150.0, -10.0, 405.0, 120.0, 270.0, 585.0, 305.0, 100.0, 395.0, 330.0, 180.0, 405.0, 265.0, 275.0, 280.0, -5.0, 35.0, 85.0, 20.0, 210.0, 160.0, 210.0, 315.0, 355.0, 340.0, 240.0, 125.0, 360.0, 165.0, -10.0, 380.0, -30.0, 300.0, -90.0, 220.0, 435.0, 515.0, 315.0, 100.0, 300.0, 380.0, 445.0, 420.0, 70.0, 260.0, 130.0, 110.0, 370.0, 280.0, 170.0, 565.0, 270.0, 100.0, 255.0, 105.0, 440.0, 220.0, 230.0, 205.0, 95.0, 290.0, 110.0, 215.0, 270.0, 215.0, 380.0, 355.0, 55.0, 160.0, 285.0, 260.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1358871320951227, "mean_inference_ms": 1.5098730993430924, "mean_action_processing_ms": 0.5577033572946974, "mean_env_wait_ms": 0.1955134441758669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1575756072998047, "StateBufferConnector_ms": 0.006119728088378906, "ViewRequirementAgentConnector_ms": 0.3166959285736084}}, "episode_reward_max": 585.0, "episode_reward_min": -90.0, "episode_reward_mean": 237.15, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [340.0, 195.0, 510.0, 205.0, 185.0, 280.0, 345.0, 365.0, -55.0, 150.0, 270.0, 80.0, 125.0, 230.0, 255.0, 350.0, 435.0, 275.0, 145.0, 260.0, 280.0, 150.0, -75.0, 350.0, 470.0, 115.0, 275.0, 265.0, 120.0, 150.0, -10.0, 405.0, 120.0, 270.0, 585.0, 305.0, 100.0, 395.0, 330.0, 180.0, 405.0, 265.0, 275.0, 280.0, -5.0, 35.0, 85.0, 20.0, 210.0, 160.0, 210.0, 315.0, 355.0, 340.0, 240.0, 125.0, 360.0, 165.0, -10.0, 380.0, -30.0, 300.0, -90.0, 220.0, 435.0, 515.0, 315.0, 100.0, 300.0, 380.0, 445.0, 420.0, 70.0, 260.0, 130.0, 110.0, 370.0, 280.0, 170.0, 565.0, 270.0, 100.0, 255.0, 105.0, 440.0, 220.0, 230.0, 205.0, 95.0, 290.0, 110.0, 215.0, 270.0, 215.0, 380.0, 355.0, 55.0, 160.0, 285.0, 260.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1358871320951227, "mean_inference_ms": 1.5098730993430924, "mean_action_processing_ms": 0.5577033572946974, "mean_env_wait_ms": 0.1955134441758669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1575756072998047, "StateBufferConnector_ms": 0.006119728088378906, "ViewRequirementAgentConnector_ms": 0.3166959285736084}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5939200, "num_agent_steps_trained": 5939200, "num_env_steps_sampled": 1187840, "num_env_steps_trained": 1187840, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.12451395057063, "num_env_steps_trained_throughput_per_sec": 66.12451395057063, "timesteps_total": 1187840, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5939200, "timers": {"training_iteration_time_ms": 122341.869, "sample_time_ms": 14045.203, "load_time_ms": 1.742, "load_throughput": 4702047.016, "learn_time_ms": 108285.869, "learn_throughput": 75.652, "synch_weights_time_ms": 3.027}, "counters": {"num_env_steps_sampled": 1187840, "num_env_steps_trained": 1187840, "num_agent_steps_sampled": 5939200, "num_agent_steps_trained": 5939200}, "done": false, "episodes_total": 9280, "training_iteration": 145, "trial_id": "9fade_00019", "date": "2023-11-10_00-28-38", "timestamp": 1699572518, "time_this_iter_s": 123.90656328201294, "time_total_s": 16258.199662685394, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16258.199662685394, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 37.347727272727276, "ram_util_percent": 18.799431818181816}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6447867406856542, "episode_optimality_min": -0.9622641509433962, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6447867406856542, "episode_optimality_capped_min": -0.9622641509433962, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.82, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6447867406856542, "curr_learning_score_min": -0.9622641509433962, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9810671146400273, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.26411957287748616, "policy_loss": -0.07028209092241014, "vf_loss": 0.3188097552278972, "vf_explained_var": 0.3636941597610712, "kl": 0.015399414828456581, "entropy": 2.8736245147387187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1396800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1196032, "num_env_steps_trained": 1196032, "num_agent_steps_sampled": 5980160, "num_agent_steps_trained": 5980160}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -255.0, "episode_reward_mean": 239.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6447867406856542, "episode_optimality_min": -0.9622641509433962, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6447867406856542, "episode_optimality_capped_min": -0.9622641509433962, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.82, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6447867406856542, "curr_learning_score_min": -0.9622641509433962, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [435.0, 515.0, 315.0, 100.0, 300.0, 380.0, 445.0, 420.0, 70.0, 260.0, 130.0, 110.0, 370.0, 280.0, 170.0, 565.0, 270.0, 100.0, 255.0, 105.0, 440.0, 220.0, 230.0, 205.0, 95.0, 290.0, 110.0, 215.0, 270.0, 215.0, 380.0, 355.0, 55.0, 160.0, 285.0, 260.0, 120.0, 415.0, 235.0, 200.0, 40.0, 215.0, 195.0, 95.0, 120.0, 180.0, 305.0, 320.0, 270.0, 510.0, 420.0, 270.0, 325.0, 415.0, 185.0, 20.0, 360.0, 155.0, 255.0, 420.0, 515.0, 420.0, -40.0, 65.0, 410.0, -5.0, 375.0, 230.0, 15.0, 230.0, 65.0, 180.0, 545.0, 210.0, -50.0, 515.0, 340.0, 415.0, 375.0, 55.0, 285.0, 285.0, 100.0, 415.0, 190.0, 420.0, 275.0, 300.0, -5.0, -130.0, -20.0, 525.0, 170.0, -235.0, -255.0, 585.0, 190.0, 290.0, 5.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1357495447977732, "mean_inference_ms": 1.5095375134840916, "mean_action_processing_ms": 0.5576187701154042, "mean_env_wait_ms": 0.19547455477625367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1595463752746582, "StateBufferConnector_ms": 0.006124734878540039, "ViewRequirementAgentConnector_ms": 0.32108592987060547}}, "episode_reward_max": 585.0, "episode_reward_min": -255.0, "episode_reward_mean": 239.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [435.0, 515.0, 315.0, 100.0, 300.0, 380.0, 445.0, 420.0, 70.0, 260.0, 130.0, 110.0, 370.0, 280.0, 170.0, 565.0, 270.0, 100.0, 255.0, 105.0, 440.0, 220.0, 230.0, 205.0, 95.0, 290.0, 110.0, 215.0, 270.0, 215.0, 380.0, 355.0, 55.0, 160.0, 285.0, 260.0, 120.0, 415.0, 235.0, 200.0, 40.0, 215.0, 195.0, 95.0, 120.0, 180.0, 305.0, 320.0, 270.0, 510.0, 420.0, 270.0, 325.0, 415.0, 185.0, 20.0, 360.0, 155.0, 255.0, 420.0, 515.0, 420.0, -40.0, 65.0, 410.0, -5.0, 375.0, 230.0, 15.0, 230.0, 65.0, 180.0, 545.0, 210.0, -50.0, 515.0, 340.0, 415.0, 375.0, 55.0, 285.0, 285.0, 100.0, 415.0, 190.0, 420.0, 275.0, 300.0, -5.0, -130.0, -20.0, 525.0, 170.0, -235.0, -255.0, 585.0, 190.0, 290.0, 5.0, 230.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1357495447977732, "mean_inference_ms": 1.5095375134840916, "mean_action_processing_ms": 0.5576187701154042, "mean_env_wait_ms": 0.19547455477625367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1595463752746582, "StateBufferConnector_ms": 0.006124734878540039, "ViewRequirementAgentConnector_ms": 0.32108592987060547}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5980160, "num_agent_steps_trained": 5980160, "num_env_steps_sampled": 1196032, "num_env_steps_trained": 1196032, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.31523026475372, "num_env_steps_trained_throughput_per_sec": 66.31523026475372, "timesteps_total": 1196032, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 5980160, "timers": {"training_iteration_time_ms": 122605.604, "sample_time_ms": 14006.284, "load_time_ms": 1.77, "load_throughput": 4628633.946, "learn_time_ms": 108588.532, "learn_throughput": 75.441, "synch_weights_time_ms": 2.958}, "counters": {"num_env_steps_sampled": 1196032, "num_env_steps_trained": 1196032, "num_agent_steps_sampled": 5980160, "num_agent_steps_trained": 5980160}, "done": false, "episodes_total": 9344, "training_iteration": 146, "trial_id": "9fade_00019", "date": "2023-11-10_00-30-41", "timestamp": 1699572641, "time_this_iter_s": 123.54474973678589, "time_total_s": 16381.74441242218, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16381.74441242218, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 37.49602272727273, "ram_util_percent": 18.806250000000002}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6475096191476237, "episode_optimality_min": -0.9622641509433962, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6475096191476237, "episode_optimality_capped_min": -0.9622641509433962, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.69, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6475096191476237, "curr_learning_score_min": -0.9622641509433962, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9830277768926075, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2334994457133386, "policy_loss": -0.06636029460423742, "vf_loss": 0.2850528169387447, "vf_explained_var": 0.4167370040218035, "kl": 0.014624120585642875, "entropy": 2.8556039869536955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1406400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1204224, "num_env_steps_trained": 1204224, "num_agent_steps_sampled": 6021120, "num_agent_steps_trained": 6021120}, "sampler_results": {"episode_reward_max": 585.0, "episode_reward_min": -255.0, "episode_reward_mean": 233.45, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6475096191476237, "episode_optimality_min": -0.9622641509433962, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6475096191476237, "episode_optimality_capped_min": -0.9622641509433962, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 46.69, "episode_reward_normalized_min": -51.0, "episode_reward_normalized_max": 117.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6475096191476237, "curr_learning_score_min": -0.9622641509433962, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [410.0, -5.0, 375.0, 230.0, 15.0, 230.0, 65.0, 180.0, 545.0, 210.0, -50.0, 515.0, 340.0, 415.0, 375.0, 55.0, 285.0, 285.0, 100.0, 415.0, 190.0, 420.0, 275.0, 300.0, -5.0, -130.0, -20.0, 525.0, 170.0, -235.0, -255.0, 585.0, 190.0, 290.0, 5.0, 230.0, 140.0, 50.0, 95.0, 490.0, 260.0, 145.0, 160.0, 260.0, 405.0, 485.0, 130.0, 145.0, 280.0, 100.0, 240.0, 160.0, 480.0, 505.0, 385.0, 165.0, -95.0, 510.0, 310.0, 295.0, 355.0, 25.0, 170.0, 110.0, 170.0, 285.0, 235.0, 335.0, 435.0, 265.0, 385.0, 145.0, 420.0, 575.0, 325.0, 135.0, 360.0, 365.0, 190.0, 235.0, 485.0, -85.0, 200.0, 280.0, 200.0, 260.0, 155.0, 270.0, -200.0, 375.0, 380.0, 255.0, 220.0, 205.0, 165.0, 525.0, 160.0, 105.0, 95.0, 150.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1355917746576742, "mean_inference_ms": 1.5092061638797363, "mean_action_processing_ms": 0.5575321400906796, "mean_env_wait_ms": 0.19543275653210757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15839457511901855, "StateBufferConnector_ms": 0.00613093376159668, "ViewRequirementAgentConnector_ms": 0.3191874027252197}}, "episode_reward_max": 585.0, "episode_reward_min": -255.0, "episode_reward_mean": 233.45, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [410.0, -5.0, 375.0, 230.0, 15.0, 230.0, 65.0, 180.0, 545.0, 210.0, -50.0, 515.0, 340.0, 415.0, 375.0, 55.0, 285.0, 285.0, 100.0, 415.0, 190.0, 420.0, 275.0, 300.0, -5.0, -130.0, -20.0, 525.0, 170.0, -235.0, -255.0, 585.0, 190.0, 290.0, 5.0, 230.0, 140.0, 50.0, 95.0, 490.0, 260.0, 145.0, 160.0, 260.0, 405.0, 485.0, 130.0, 145.0, 280.0, 100.0, 240.0, 160.0, 480.0, 505.0, 385.0, 165.0, -95.0, 510.0, 310.0, 295.0, 355.0, 25.0, 170.0, 110.0, 170.0, 285.0, 235.0, 335.0, 435.0, 265.0, 385.0, 145.0, 420.0, 575.0, 325.0, 135.0, 360.0, 365.0, 190.0, 235.0, 485.0, -85.0, 200.0, 280.0, 200.0, 260.0, 155.0, 270.0, -200.0, 375.0, 380.0, 255.0, 220.0, 205.0, 165.0, 525.0, 160.0, 105.0, 95.0, 150.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1355917746576742, "mean_inference_ms": 1.5092061638797363, "mean_action_processing_ms": 0.5575321400906796, "mean_env_wait_ms": 0.19543275653210757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15839457511901855, "StateBufferConnector_ms": 0.00613093376159668, "ViewRequirementAgentConnector_ms": 0.3191874027252197}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6021120, "num_agent_steps_trained": 6021120, "num_env_steps_sampled": 1204224, "num_env_steps_trained": 1204224, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.31739042571208, "num_env_steps_trained_throughput_per_sec": 66.31739042571208, "timesteps_total": 1204224, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6021120, "timers": {"training_iteration_time_ms": 122978.075, "sample_time_ms": 13978.211, "load_time_ms": 1.756, "load_throughput": 4664830.005, "learn_time_ms": 108988.987, "learn_throughput": 75.164, "synch_weights_time_ms": 3.042}, "counters": {"num_env_steps_sampled": 1204224, "num_env_steps_trained": 1204224, "num_agent_steps_sampled": 6021120, "num_agent_steps_trained": 6021120}, "done": false, "episodes_total": 9408, "training_iteration": 147, "trial_id": "9fade_00019", "date": "2023-11-10_00-32-48", "timestamp": 1699572768, "time_this_iter_s": 123.54368114471436, "time_total_s": 16505.288093566895, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16505.288093566895, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 37.59944751381215, "ram_util_percent": 18.942541436464087}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6897423751526897, "episode_optimality_min": -0.7272727272727273, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6897423751526897, "episode_optimality_capped_min": -0.7272727272727273, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.56, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6897423751526897, "curr_learning_score_min": -0.7272727272727273, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.988812361061573, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.22515019038122167, "policy_loss": -0.06401811785108294, "vf_loss": 0.2743699751917302, "vf_explained_var": 0.38044755143423875, "kl": 0.0146156368295442, "entropy": 2.8958834436535836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1416000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1212416, "num_env_steps_trained": 1212416, "num_agent_steps_sampled": 6062080, "num_agent_steps_trained": 6062080}, "sampler_results": {"episode_reward_max": 580.0, "episode_reward_min": -200.0, "episode_reward_mean": 237.8, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6897423751526897, "episode_optimality_min": -0.7272727272727273, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6897423751526897, "episode_optimality_capped_min": -0.7272727272727273, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.56, "episode_reward_normalized_min": -40.0, "episode_reward_normalized_max": 116.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6897423751526897, "curr_learning_score_min": -0.7272727272727273, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [170.0, 285.0, 235.0, 335.0, 435.0, 265.0, 385.0, 145.0, 420.0, 575.0, 325.0, 135.0, 360.0, 365.0, 190.0, 235.0, 485.0, -85.0, 200.0, 280.0, 200.0, 260.0, 155.0, 270.0, -200.0, 375.0, 380.0, 255.0, 220.0, 205.0, 165.0, 525.0, 160.0, 105.0, 95.0, 150.0, 300.0, 35.0, 185.0, 5.0, 160.0, 85.0, 580.0, 240.0, 495.0, 315.0, 105.0, 470.0, 235.0, 115.0, 410.0, 295.0, 225.0, 195.0, 350.0, 35.0, 200.0, 180.0, 310.0, 160.0, 190.0, -80.0, 430.0, 380.0, 285.0, 540.0, 300.0, 45.0, 270.0, 435.0, 105.0, 225.0, 160.0, 95.0, 380.0, 150.0, 135.0, 285.0, -105.0, 435.0, 390.0, -10.0, 475.0, 200.0, 150.0, 225.0, 150.0, 135.0, 170.0, 240.0, 145.0, 120.0, 160.0, 270.0, 10.0, 410.0, 230.0, 160.0, 420.0, 325.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1353883258149888, "mean_inference_ms": 1.509046245222326, "mean_action_processing_ms": 0.5574227745895132, "mean_env_wait_ms": 0.1953984524976795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15757274627685547, "StateBufferConnector_ms": 0.006261587142944336, "ViewRequirementAgentConnector_ms": 0.31861352920532227}}, "episode_reward_max": 580.0, "episode_reward_min": -200.0, "episode_reward_mean": 237.8, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [170.0, 285.0, 235.0, 335.0, 435.0, 265.0, 385.0, 145.0, 420.0, 575.0, 325.0, 135.0, 360.0, 365.0, 190.0, 235.0, 485.0, -85.0, 200.0, 280.0, 200.0, 260.0, 155.0, 270.0, -200.0, 375.0, 380.0, 255.0, 220.0, 205.0, 165.0, 525.0, 160.0, 105.0, 95.0, 150.0, 300.0, 35.0, 185.0, 5.0, 160.0, 85.0, 580.0, 240.0, 495.0, 315.0, 105.0, 470.0, 235.0, 115.0, 410.0, 295.0, 225.0, 195.0, 350.0, 35.0, 200.0, 180.0, 310.0, 160.0, 190.0, -80.0, 430.0, 380.0, 285.0, 540.0, 300.0, 45.0, 270.0, 435.0, 105.0, 225.0, 160.0, 95.0, 380.0, 150.0, 135.0, 285.0, -105.0, 435.0, 390.0, -10.0, 475.0, 200.0, 150.0, 225.0, 150.0, 135.0, 170.0, 240.0, 145.0, 120.0, 160.0, 270.0, 10.0, 410.0, 230.0, 160.0, 420.0, 325.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1353883258149888, "mean_inference_ms": 1.509046245222326, "mean_action_processing_ms": 0.5574227745895132, "mean_env_wait_ms": 0.1953984524976795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15757274627685547, "StateBufferConnector_ms": 0.006261587142944336, "ViewRequirementAgentConnector_ms": 0.31861352920532227}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6062080, "num_agent_steps_trained": 6062080, "num_env_steps_sampled": 1212416, "num_env_steps_trained": 1212416, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 67.02410678071745, "num_env_steps_trained_throughput_per_sec": 67.02410678071745, "timesteps_total": 1212416, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6062080, "timers": {"training_iteration_time_ms": 123156.887, "sample_time_ms": 13974.966, "load_time_ms": 1.712, "load_throughput": 4784346.097, "learn_time_ms": 109171.257, "learn_throughput": 75.038, "synch_weights_time_ms": 2.899}, "counters": {"num_env_steps_sampled": 1212416, "num_env_steps_trained": 1212416, "num_agent_steps_sampled": 6062080, "num_agent_steps_trained": 6062080}, "done": false, "episodes_total": 9472, "training_iteration": 148, "trial_id": "9fade_00019", "date": "2023-11-10_00-34-50", "timestamp": 1699572890, "time_this_iter_s": 122.24026298522949, "time_total_s": 16627.528356552124, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16627.528356552124, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 36.98965517241379, "ram_util_percent": 18.98045977011494}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6397990553306205, "episode_optimality_min": -0.9512195121951219, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6397990553306205, "episode_optimality_capped_min": -0.9512195121951219, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.58, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6397990553306205, "curr_learning_score_min": -0.9512195121951219, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9891480070538818, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2517494521002906, "policy_loss": -0.06618903389586193, "vf_loss": 0.3027514969740635, "vf_explained_var": 0.37425509226198, "kl": 0.01499949499621105, "entropy": 2.8941978139430287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1425600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1220608, "num_env_steps_trained": 1220608, "num_agent_steps_sampled": 6103040, "num_agent_steps_trained": 6103040}, "sampler_results": {"episode_reward_max": 540.0, "episode_reward_min": -195.0, "episode_reward_mean": 222.9, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6397990553306205, "episode_optimality_min": -0.9512195121951219, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6397990553306205, "episode_optimality_capped_min": -0.9512195121951219, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.58, "episode_reward_normalized_min": -39.0, "episode_reward_normalized_max": 108.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6397990553306205, "curr_learning_score_min": -0.9512195121951219, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [285.0, 540.0, 300.0, 45.0, 270.0, 435.0, 105.0, 225.0, 160.0, 95.0, 380.0, 150.0, 135.0, 285.0, -105.0, 435.0, 390.0, -10.0, 475.0, 200.0, 150.0, 225.0, 150.0, 135.0, 170.0, 240.0, 145.0, 120.0, 160.0, 270.0, 10.0, 410.0, 230.0, 160.0, 420.0, 325.0, 230.0, 230.0, 85.0, -185.0, 320.0, 215.0, 280.0, 195.0, 405.0, 445.0, -195.0, 330.0, 60.0, -30.0, 305.0, 420.0, 240.0, 365.0, 255.0, 240.0, 340.0, 250.0, 120.0, 380.0, 275.0, 165.0, 230.0, 500.0, 380.0, 440.0, 125.0, 140.0, 150.0, 135.0, 225.0, 365.0, 130.0, 120.0, 250.0, 325.0, 370.0, 250.0, 305.0, 160.0, -25.0, 230.0, 210.0, 395.0, 515.0, 70.0, -170.0, 105.0, 295.0, 265.0, 325.0, 310.0, -95.0, 255.0, 105.0, 110.0, 115.0, 175.0, 525.0, 120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1352692514338634, "mean_inference_ms": 1.5089193986280933, "mean_action_processing_ms": 0.5573509419467897, "mean_env_wait_ms": 0.19538096457676132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15817761421203613, "StateBufferConnector_ms": 0.006232023239135742, "ViewRequirementAgentConnector_ms": 0.3215515613555908}}, "episode_reward_max": 540.0, "episode_reward_min": -195.0, "episode_reward_mean": 222.9, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.0, 540.0, 300.0, 45.0, 270.0, 435.0, 105.0, 225.0, 160.0, 95.0, 380.0, 150.0, 135.0, 285.0, -105.0, 435.0, 390.0, -10.0, 475.0, 200.0, 150.0, 225.0, 150.0, 135.0, 170.0, 240.0, 145.0, 120.0, 160.0, 270.0, 10.0, 410.0, 230.0, 160.0, 420.0, 325.0, 230.0, 230.0, 85.0, -185.0, 320.0, 215.0, 280.0, 195.0, 405.0, 445.0, -195.0, 330.0, 60.0, -30.0, 305.0, 420.0, 240.0, 365.0, 255.0, 240.0, 340.0, 250.0, 120.0, 380.0, 275.0, 165.0, 230.0, 500.0, 380.0, 440.0, 125.0, 140.0, 150.0, 135.0, 225.0, 365.0, 130.0, 120.0, 250.0, 325.0, 370.0, 250.0, 305.0, 160.0, -25.0, 230.0, 210.0, 395.0, 515.0, 70.0, -170.0, 105.0, 295.0, 265.0, 325.0, 310.0, -95.0, 255.0, 105.0, 110.0, 115.0, 175.0, 525.0, 120.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1352692514338634, "mean_inference_ms": 1.5089193986280933, "mean_action_processing_ms": 0.5573509419467897, "mean_env_wait_ms": 0.19538096457676132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15817761421203613, "StateBufferConnector_ms": 0.006232023239135742, "ViewRequirementAgentConnector_ms": 0.3215515613555908}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6103040, "num_agent_steps_trained": 6103040, "num_env_steps_sampled": 1220608, "num_env_steps_trained": 1220608, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 65.55196226189821, "num_env_steps_trained_throughput_per_sec": 65.55196226189821, "timesteps_total": 1220608, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6103040, "timers": {"training_iteration_time_ms": 123427.062, "sample_time_ms": 13955.404, "load_time_ms": 1.723, "load_throughput": 4753370.46, "learn_time_ms": 109461.008, "learn_throughput": 74.839, "synch_weights_time_ms": 2.912}, "counters": {"num_env_steps_sampled": 1220608, "num_env_steps_trained": 1220608, "num_agent_steps_sampled": 6103040, "num_agent_steps_trained": 6103040}, "done": false, "episodes_total": 9536, "training_iteration": 149, "trial_id": "9fade_00019", "date": "2023-11-10_00-36-55", "timestamp": 1699573015, "time_this_iter_s": 124.98259210586548, "time_total_s": 16752.51094865799, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16752.51094865799, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 37.7185393258427, "ram_util_percent": 19.15280898876404}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.636211666517895, "episode_optimality_min": -0.9444444444444444, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.636211666517895, "episode_optimality_capped_min": -0.9444444444444444, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.5, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.636211666517895, "curr_learning_score_min": -0.9444444444444444, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9845288964174688, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25170935594939997, "policy_loss": -0.06512674189793567, "vf_loss": 0.30192810808527915, "vf_explained_var": 0.38608299418662984, "kl": 0.014723939758371026, "entropy": 2.8985145696997643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1435200.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1228800, "num_env_steps_trained": 1228800, "num_agent_steps_sampled": 6144000, "num_agent_steps_trained": 6144000}, "sampler_results": {"episode_reward_max": 595.0, "episode_reward_min": -185.0, "episode_reward_mean": 222.5, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.636211666517895, "episode_optimality_min": -0.9444444444444444, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.636211666517895, "episode_optimality_capped_min": -0.9444444444444444, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 44.5, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 119.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.636211666517895, "curr_learning_score_min": -0.9444444444444444, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [380.0, 440.0, 125.0, 140.0, 150.0, 135.0, 225.0, 365.0, 130.0, 120.0, 250.0, 325.0, 370.0, 250.0, 305.0, 160.0, -25.0, 230.0, 210.0, 395.0, 515.0, 70.0, -170.0, 105.0, 295.0, 265.0, 325.0, 310.0, -95.0, 255.0, 105.0, 110.0, 115.0, 175.0, 525.0, 120.0, 70.0, 435.0, 235.0, 195.0, 165.0, 205.0, 85.0, -10.0, 65.0, 465.0, 230.0, -50.0, 95.0, 45.0, 50.0, 130.0, 100.0, 120.0, -15.0, 235.0, 335.0, 195.0, 595.0, 305.0, 270.0, -65.0, 400.0, 205.0, 350.0, 80.0, 345.0, 260.0, 60.0, 405.0, 110.0, 85.0, 450.0, 315.0, 235.0, 310.0, 315.0, 365.0, 350.0, 85.0, 380.0, 95.0, 185.0, 45.0, 490.0, 505.0, 420.0, 295.0, 385.0, 120.0, 420.0, 160.0, 400.0, 305.0, 275.0, -185.0, 235.0, 270.0, 315.0, 220.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1351272524199896, "mean_inference_ms": 1.5084972249196726, "mean_action_processing_ms": 0.5572715560938765, "mean_env_wait_ms": 0.19533408369369035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1580357551574707, "StateBufferConnector_ms": 0.006179094314575195, "ViewRequirementAgentConnector_ms": 0.3185396194458008}}, "episode_reward_max": 595.0, "episode_reward_min": -185.0, "episode_reward_mean": 222.5, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [380.0, 440.0, 125.0, 140.0, 150.0, 135.0, 225.0, 365.0, 130.0, 120.0, 250.0, 325.0, 370.0, 250.0, 305.0, 160.0, -25.0, 230.0, 210.0, 395.0, 515.0, 70.0, -170.0, 105.0, 295.0, 265.0, 325.0, 310.0, -95.0, 255.0, 105.0, 110.0, 115.0, 175.0, 525.0, 120.0, 70.0, 435.0, 235.0, 195.0, 165.0, 205.0, 85.0, -10.0, 65.0, 465.0, 230.0, -50.0, 95.0, 45.0, 50.0, 130.0, 100.0, 120.0, -15.0, 235.0, 335.0, 195.0, 595.0, 305.0, 270.0, -65.0, 400.0, 205.0, 350.0, 80.0, 345.0, 260.0, 60.0, 405.0, 110.0, 85.0, 450.0, 315.0, 235.0, 310.0, 315.0, 365.0, 350.0, 85.0, 380.0, 95.0, 185.0, 45.0, 490.0, 505.0, 420.0, 295.0, 385.0, 120.0, 420.0, 160.0, 400.0, 305.0, 275.0, -185.0, 235.0, 270.0, 315.0, 220.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1351272524199896, "mean_inference_ms": 1.5084972249196726, "mean_action_processing_ms": 0.5572715560938765, "mean_env_wait_ms": 0.19533408369369035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1580357551574707, "StateBufferConnector_ms": 0.006179094314575195, "ViewRequirementAgentConnector_ms": 0.3185396194458008}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144000, "num_agent_steps_trained": 6144000, "num_env_steps_sampled": 1228800, "num_env_steps_trained": 1228800, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.91471083581708, "num_env_steps_trained_throughput_per_sec": 66.91471083581708, "timesteps_total": 1228800, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6144000, "timers": {"training_iteration_time_ms": 123586.329, "sample_time_ms": 13837.737, "load_time_ms": 1.719, "load_throughput": 4765368.76, "learn_time_ms": 109737.831, "learn_throughput": 74.651, "synch_weights_time_ms": 2.898}, "counters": {"num_env_steps_sampled": 1228800, "num_env_steps_trained": 1228800, "num_agent_steps_sampled": 6144000, "num_agent_steps_trained": 6144000}, "done": false, "episodes_total": 9600, "training_iteration": 150, "trial_id": "9fade_00019", "date": "2023-11-10_00-38-58", "timestamp": 1699573138, "time_this_iter_s": 122.43971347808838, "time_total_s": 16874.950662136078, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16874.950662136078, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 37.25257142857143, "ram_util_percent": 19.090285714285713}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6725800328068003, "episode_optimality_min": -0.8409090909090909, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6725800328068003, "episode_optimality_capped_min": -0.8409090909090909, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.28, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6725800328068003, "curr_learning_score_min": -0.8409090909090909, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9744252307588855, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.25082497319339986, "policy_loss": -0.06372227068197389, "vf_loss": 0.300109001800544, "vf_explained_var": 0.42137854249527057, "kl": 0.014259990567061322, "entropy": 2.902890470425288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1444800.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1236992, "num_env_steps_trained": 1236992, "num_agent_steps_sampled": 6184960, "num_agent_steps_trained": 6184960}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -185.0, "episode_reward_mean": 236.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6725800328068003, "episode_optimality_min": -0.8409090909090909, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6725800328068003, "episode_optimality_capped_min": -0.8409090909090909, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.28, "episode_reward_normalized_min": -37.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6725800328068003, "curr_learning_score_min": -0.8409090909090909, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [350.0, 80.0, 345.0, 260.0, 60.0, 405.0, 110.0, 85.0, 450.0, 315.0, 235.0, 310.0, 315.0, 365.0, 350.0, 85.0, 380.0, 95.0, 185.0, 45.0, 490.0, 505.0, 420.0, 295.0, 385.0, 120.0, 420.0, 160.0, 400.0, 305.0, 275.0, -185.0, 235.0, 270.0, 315.0, 220.0, 265.0, 280.0, 30.0, 345.0, 85.0, -115.0, 45.0, 300.0, 105.0, 65.0, 475.0, 240.0, 385.0, -85.0, 320.0, 200.0, 270.0, 45.0, 295.0, 265.0, 330.0, 290.0, 295.0, 120.0, 330.0, 110.0, 320.0, 395.0, 155.0, 60.0, -45.0, 315.0, 45.0, 230.0, 405.0, 360.0, 205.0, 230.0, 225.0, 600.0, 345.0, 370.0, 165.0, 265.0, 160.0, 125.0, 15.0, 170.0, 300.0, 275.0, 20.0, 230.0, 445.0, 220.0, 70.0, 330.0, 255.0, 475.0, 110.0, 370.0, -70.0, 170.0, 490.0, 90.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1349559990916487, "mean_inference_ms": 1.5080540740089936, "mean_action_processing_ms": 0.5571826262486715, "mean_env_wait_ms": 0.19528444445371065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15857863426208496, "StateBufferConnector_ms": 0.006142854690551758, "ViewRequirementAgentConnector_ms": 0.316908597946167}}, "episode_reward_max": 600.0, "episode_reward_min": -185.0, "episode_reward_mean": 236.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [350.0, 80.0, 345.0, 260.0, 60.0, 405.0, 110.0, 85.0, 450.0, 315.0, 235.0, 310.0, 315.0, 365.0, 350.0, 85.0, 380.0, 95.0, 185.0, 45.0, 490.0, 505.0, 420.0, 295.0, 385.0, 120.0, 420.0, 160.0, 400.0, 305.0, 275.0, -185.0, 235.0, 270.0, 315.0, 220.0, 265.0, 280.0, 30.0, 345.0, 85.0, -115.0, 45.0, 300.0, 105.0, 65.0, 475.0, 240.0, 385.0, -85.0, 320.0, 200.0, 270.0, 45.0, 295.0, 265.0, 330.0, 290.0, 295.0, 120.0, 330.0, 110.0, 320.0, 395.0, 155.0, 60.0, -45.0, 315.0, 45.0, 230.0, 405.0, 360.0, 205.0, 230.0, 225.0, 600.0, 345.0, 370.0, 165.0, 265.0, 160.0, 125.0, 15.0, 170.0, 300.0, 275.0, 20.0, 230.0, 445.0, 220.0, 70.0, 330.0, 255.0, 475.0, 110.0, 370.0, -70.0, 170.0, 490.0, 90.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1349559990916487, "mean_inference_ms": 1.5080540740089936, "mean_action_processing_ms": 0.5571826262486715, "mean_env_wait_ms": 0.19528444445371065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15857863426208496, "StateBufferConnector_ms": 0.006142854690551758, "ViewRequirementAgentConnector_ms": 0.316908597946167}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6184960, "num_agent_steps_trained": 6184960, "num_env_steps_sampled": 1236992, "num_env_steps_trained": 1236992, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.39480126911731, "num_env_steps_trained_throughput_per_sec": 66.39480126911731, "timesteps_total": 1236992, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6184960, "timers": {"training_iteration_time_ms": 123701.492, "sample_time_ms": 13845.562, "load_time_ms": 1.712, "load_throughput": 4785812.155, "learn_time_ms": 109845.245, "learn_throughput": 74.578, "synch_weights_time_ms": 2.798}, "counters": {"num_env_steps_sampled": 1236992, "num_env_steps_trained": 1236992, "num_agent_steps_sampled": 6184960, "num_agent_steps_trained": 6184960}, "done": false, "episodes_total": 9664, "training_iteration": 151, "trial_id": "9fade_00019", "date": "2023-11-10_00-41-01", "timestamp": 1699573261, "time_this_iter_s": 123.3954598903656, "time_total_s": 16998.346122026443, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 16998.346122026443, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 37.28636363636363, "ram_util_percent": 18.782386363636366}, "checkpoint_dir_name": "checkpoint_000005"}
{"custom_metrics": {"episode_optimality_mean": 0.6610602958371251, "episode_optimality_min": -0.9523809523809523, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6610602958371251, "episode_optimality_capped_min": -0.9523809523809523, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.08, "episode_reward_normalized_min": -20.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6610602958371251, "curr_learning_score_min": -0.9523809523809523, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9835396961867809, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.2222309010340056, "policy_loss": -0.06251104848738274, "vf_loss": 0.27008824696657635, "vf_explained_var": 0.40315106659506755, "kl": 0.014472791756141988, "entropy": 2.8965007100005944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1454400.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1245184, "num_env_steps_trained": 1245184, "num_agent_steps_sampled": 6225920, "num_agent_steps_trained": 6225920}, "sampler_results": {"episode_reward_max": 600.0, "episode_reward_min": -100.0, "episode_reward_mean": 235.4, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6610602958371251, "episode_optimality_min": -0.9523809523809523, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6610602958371251, "episode_optimality_capped_min": -0.9523809523809523, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.08, "episode_reward_normalized_min": -20.0, "episode_reward_normalized_max": 120.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6610602958371251, "curr_learning_score_min": -0.9523809523809523, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [155.0, 60.0, -45.0, 315.0, 45.0, 230.0, 405.0, 360.0, 205.0, 230.0, 225.0, 600.0, 345.0, 370.0, 165.0, 265.0, 160.0, 125.0, 15.0, 170.0, 300.0, 275.0, 20.0, 230.0, 445.0, 220.0, 70.0, 330.0, 255.0, 475.0, 110.0, 370.0, -70.0, 170.0, 490.0, 90.0, 310.0, -45.0, 155.0, 105.0, 240.0, 150.0, 185.0, 370.0, 225.0, 50.0, 420.0, 390.0, 150.0, 475.0, 425.0, 375.0, 350.0, 210.0, 155.0, 320.0, 220.0, 220.0, -100.0, 120.0, 405.0, 385.0, 325.0, 435.0, 285.0, 360.0, 310.0, 170.0, 345.0, 395.0, 140.0, 195.0, 420.0, 225.0, 270.0, 460.0, -15.0, 225.0, 395.0, 185.0, 330.0, 255.0, 320.0, 55.0, 320.0, 375.0, -25.0, -20.0, 210.0, 170.0, 205.0, 305.0, 60.0, 250.0, 305.0, 50.0, 315.0, -15.0, 505.0, 0.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1347524399092848, "mean_inference_ms": 1.507629226648981, "mean_action_processing_ms": 0.5570868402389109, "mean_env_wait_ms": 0.19523518268383896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15717101097106934, "StateBufferConnector_ms": 0.006144523620605469, "ViewRequirementAgentConnector_ms": 0.31703805923461914}}, "episode_reward_max": 600.0, "episode_reward_min": -100.0, "episode_reward_mean": 235.4, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [155.0, 60.0, -45.0, 315.0, 45.0, 230.0, 405.0, 360.0, 205.0, 230.0, 225.0, 600.0, 345.0, 370.0, 165.0, 265.0, 160.0, 125.0, 15.0, 170.0, 300.0, 275.0, 20.0, 230.0, 445.0, 220.0, 70.0, 330.0, 255.0, 475.0, 110.0, 370.0, -70.0, 170.0, 490.0, 90.0, 310.0, -45.0, 155.0, 105.0, 240.0, 150.0, 185.0, 370.0, 225.0, 50.0, 420.0, 390.0, 150.0, 475.0, 425.0, 375.0, 350.0, 210.0, 155.0, 320.0, 220.0, 220.0, -100.0, 120.0, 405.0, 385.0, 325.0, 435.0, 285.0, 360.0, 310.0, 170.0, 345.0, 395.0, 140.0, 195.0, 420.0, 225.0, 270.0, 460.0, -15.0, 225.0, 395.0, 185.0, 330.0, 255.0, 320.0, 55.0, 320.0, 375.0, -25.0, -20.0, 210.0, 170.0, 205.0, 305.0, 60.0, 250.0, 305.0, 50.0, 315.0, -15.0, 505.0, 0.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1347524399092848, "mean_inference_ms": 1.507629226648981, "mean_action_processing_ms": 0.5570868402389109, "mean_env_wait_ms": 0.19523518268383896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15717101097106934, "StateBufferConnector_ms": 0.006144523620605469, "ViewRequirementAgentConnector_ms": 0.31703805923461914}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6225920, "num_agent_steps_trained": 6225920, "num_env_steps_sampled": 1245184, "num_env_steps_trained": 1245184, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.40938882369137, "num_env_steps_trained_throughput_per_sec": 66.40938882369137, "timesteps_total": 1245184, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6225920, "timers": {"training_iteration_time_ms": 123642.035, "sample_time_ms": 13807.25, "load_time_ms": 1.699, "load_throughput": 4821201.432, "learn_time_ms": 109824.321, "learn_throughput": 74.592, "synch_weights_time_ms": 2.534}, "counters": {"num_env_steps_sampled": 1245184, "num_env_steps_trained": 1245184, "num_agent_steps_sampled": 6225920, "num_agent_steps_trained": 6225920}, "done": false, "episodes_total": 9728, "training_iteration": 152, "trial_id": "9fade_00019", "date": "2023-11-10_00-43-05", "timestamp": 1699573385, "time_this_iter_s": 123.37380743026733, "time_total_s": 17121.71992945671, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 17121.71992945671, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 37.039204545454545, "ram_util_percent": 18.901136363636365}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.6622963627806305, "episode_optimality_min": -0.7419354838709677, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6622963627806305, "episode_optimality_capped_min": -0.7419354838709677, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.55, "episode_reward_normalized_min": -29.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6622963627806305, "curr_learning_score_min": -0.7419354838709677, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9816085512718806, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.23958424276463727, "policy_loss": -0.0664938841585778, "vf_loss": 0.29172672205958405, "vf_explained_var": 0.3856992790102959, "kl": 0.014174226545915568, "entropy": 2.8823172063628832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1464000.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1253376, "num_env_steps_trained": 1253376, "num_agent_steps_sampled": 6266880, "num_agent_steps_trained": 6266880}, "sampler_results": {"episode_reward_max": 545.0, "episode_reward_min": -145.0, "episode_reward_mean": 237.75, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.6622963627806305, "episode_optimality_min": -0.7419354838709677, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.6622963627806305, "episode_optimality_capped_min": -0.7419354838709677, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 47.55, "episode_reward_normalized_min": -29.0, "episode_reward_normalized_max": 109.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.6622963627806305, "curr_learning_score_min": -0.7419354838709677, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [285.0, 360.0, 310.0, 170.0, 345.0, 395.0, 140.0, 195.0, 420.0, 225.0, 270.0, 460.0, -15.0, 225.0, 395.0, 185.0, 330.0, 255.0, 320.0, 55.0, 320.0, 375.0, -25.0, -20.0, 210.0, 170.0, 205.0, 305.0, 60.0, 250.0, 305.0, 50.0, 315.0, -15.0, 505.0, 0.0, 300.0, 225.0, 170.0, 115.0, 15.0, 435.0, -145.0, 310.0, 215.0, 450.0, 155.0, 350.0, 230.0, 145.0, -10.0, -55.0, -35.0, 245.0, 50.0, 325.0, 265.0, 335.0, 545.0, 170.0, 120.0, 380.0, 355.0, 140.0, 360.0, 255.0, -115.0, 365.0, 275.0, 300.0, 240.0, 20.0, 140.0, 105.0, 190.0, 190.0, -65.0, 235.0, 380.0, 105.0, 415.0, 515.0, 435.0, 215.0, 270.0, 470.0, 195.0, 355.0, 270.0, 295.0, 245.0, 525.0, 245.0, 90.0, 345.0, 420.0, 175.0, 410.0, 360.0, 410.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1346275433370197, "mean_inference_ms": 1.5073489057680138, "mean_action_processing_ms": 0.5571062336494941, "mean_env_wait_ms": 0.1951976518164612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15927505493164062, "StateBufferConnector_ms": 0.006215095520019531, "ViewRequirementAgentConnector_ms": 0.3192622661590576}}, "episode_reward_max": 545.0, "episode_reward_min": -145.0, "episode_reward_mean": 237.75, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [285.0, 360.0, 310.0, 170.0, 345.0, 395.0, 140.0, 195.0, 420.0, 225.0, 270.0, 460.0, -15.0, 225.0, 395.0, 185.0, 330.0, 255.0, 320.0, 55.0, 320.0, 375.0, -25.0, -20.0, 210.0, 170.0, 205.0, 305.0, 60.0, 250.0, 305.0, 50.0, 315.0, -15.0, 505.0, 0.0, 300.0, 225.0, 170.0, 115.0, 15.0, 435.0, -145.0, 310.0, 215.0, 450.0, 155.0, 350.0, 230.0, 145.0, -10.0, -55.0, -35.0, 245.0, 50.0, 325.0, 265.0, 335.0, 545.0, 170.0, 120.0, 380.0, 355.0, 140.0, 360.0, 255.0, -115.0, 365.0, 275.0, 300.0, 240.0, 20.0, 140.0, 105.0, 190.0, 190.0, -65.0, 235.0, 380.0, 105.0, 415.0, 515.0, 435.0, 215.0, 270.0, 470.0, 195.0, 355.0, 270.0, 295.0, 245.0, 525.0, 245.0, 90.0, 345.0, 420.0, 175.0, 410.0, 360.0, 410.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1346275433370197, "mean_inference_ms": 1.5073489057680138, "mean_action_processing_ms": 0.5571062336494941, "mean_env_wait_ms": 0.1951976518164612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15927505493164062, "StateBufferConnector_ms": 0.006215095520019531, "ViewRequirementAgentConnector_ms": 0.3192622661590576}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6266880, "num_agent_steps_trained": 6266880, "num_env_steps_sampled": 1253376, "num_env_steps_trained": 1253376, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 66.56287757648776, "num_env_steps_trained_throughput_per_sec": 66.56287757648776, "timesteps_total": 1253376, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6266880, "timers": {"training_iteration_time_ms": 123487.531, "sample_time_ms": 13822.778, "load_time_ms": 1.7, "load_throughput": 4817821.359, "learn_time_ms": 109654.327, "learn_throughput": 74.707, "synch_weights_time_ms": 2.556}, "counters": {"num_env_steps_sampled": 1253376, "num_env_steps_trained": 1253376, "num_agent_steps_sampled": 6266880, "num_agent_steps_trained": 6266880}, "done": false, "episodes_total": 9792, "training_iteration": 153, "trial_id": "9fade_00019", "date": "2023-11-10_00-45-08", "timestamp": 1699573508, "time_this_iter_s": 123.0894627571106, "time_total_s": 17244.80939221382, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 17244.80939221382, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 37.226285714285716, "ram_util_percent": 18.771428571428572}, "checkpoint_dir_name": null}
{"custom_metrics": {"episode_optimality_mean": 0.7248906670449208, "episode_optimality_min": -0.7419354838709677, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.7248906670449208, "episode_optimality_capped_min": -0.7419354838709677, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 55.02, "episode_reward_normalized_min": -23.0, "episode_reward_normalized_max": 112.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.7248906670449208, "curr_learning_score_min": -0.7419354838709677, "curr_learning_score_max": 1.0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9766970327775926, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.00011210859819985454, "total_loss": 0.22681262517634118, "policy_loss": -0.06507203711601808, "vf_loss": 0.27705724056063746, "vf_explained_var": 0.41048447516436376, "kl": 0.014644366961581265, "entropy": 2.8941490105042855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1473600.5, "diff_num_grad_updates_vs_sampler_policy": 4799.5}}, "num_env_steps_sampled": 1261568, "num_env_steps_trained": 1261568, "num_agent_steps_sampled": 6307840, "num_agent_steps_trained": 6307840}, "sampler_results": {"episode_reward_max": 560.0, "episode_reward_min": -115.0, "episode_reward_mean": 275.1, "episode_len_mean": 128.0, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"episode_optimality_mean": 0.7248906670449208, "episode_optimality_min": -0.7419354838709677, "episode_optimality_max": 1.0, "episode_optimality_capped_mean": 0.7248906670449208, "episode_optimality_capped_min": -0.7419354838709677, "episode_optimality_capped_max": 1.0, "episode_reward_normalized_mean": 55.02, "episode_reward_normalized_min": -23.0, "episode_reward_normalized_max": 112.0, "curriculum_task_mean": 0.0, "curriculum_task_min": 0, "curriculum_task_max": 0, "curr_learning_score_mean": 0.7248906670449208, "curr_learning_score_min": -0.7419354838709677, "curr_learning_score_max": 1.0}, "hist_stats": {"episode_reward": [360.0, 255.0, -115.0, 365.0, 275.0, 300.0, 240.0, 20.0, 140.0, 105.0, 190.0, 190.0, -65.0, 235.0, 380.0, 105.0, 415.0, 515.0, 435.0, 215.0, 270.0, 470.0, 195.0, 355.0, 270.0, 295.0, 245.0, 525.0, 245.0, 90.0, 345.0, 420.0, 175.0, 410.0, 360.0, 410.0, 305.0, 450.0, 75.0, 505.0, 240.0, 415.0, 80.0, 270.0, 350.0, 475.0, 530.0, 265.0, 105.0, 135.0, 400.0, 380.0, 195.0, 425.0, 20.0, 245.0, 275.0, 375.0, 315.0, 325.0, 100.0, 480.0, 160.0, 420.0, 325.0, 560.0, 135.0, -25.0, 140.0, 150.0, 340.0, 165.0, 395.0, 200.0, 520.0, 215.0, 160.0, 30.0, 360.0, 350.0, 110.0, 85.0, 115.0, 120.0, 370.0, 240.0, 315.0, 375.0, 255.0, 485.0, 210.0, 365.0, 450.0, 235.0, 395.0, 480.0, 0.0, 230.0, 405.0, 295.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1345521580655678, "mean_inference_ms": 1.5070799476374788, "mean_action_processing_ms": 0.5570724306367748, "mean_env_wait_ms": 0.19516059053405196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15970730781555176, "StateBufferConnector_ms": 0.006233930587768555, "ViewRequirementAgentConnector_ms": 0.3196539878845215}}, "episode_reward_max": 560.0, "episode_reward_min": -115.0, "episode_reward_mean": 275.1, "episode_len_mean": 128.0, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [360.0, 255.0, -115.0, 365.0, 275.0, 300.0, 240.0, 20.0, 140.0, 105.0, 190.0, 190.0, -65.0, 235.0, 380.0, 105.0, 415.0, 515.0, 435.0, 215.0, 270.0, 470.0, 195.0, 355.0, 270.0, 295.0, 245.0, 525.0, 245.0, 90.0, 345.0, 420.0, 175.0, 410.0, 360.0, 410.0, 305.0, 450.0, 75.0, 505.0, 240.0, 415.0, 80.0, 270.0, 350.0, 475.0, 530.0, 265.0, 105.0, 135.0, 400.0, 380.0, 195.0, 425.0, 20.0, 245.0, 275.0, 375.0, 315.0, 325.0, 100.0, 480.0, 160.0, 420.0, 325.0, 560.0, 135.0, -25.0, 140.0, 150.0, 340.0, 165.0, 395.0, 200.0, 520.0, 215.0, 160.0, 30.0, 360.0, 350.0, 110.0, 85.0, 115.0, 120.0, 370.0, 240.0, 315.0, 375.0, 255.0, 485.0, 210.0, 365.0, 450.0, 235.0, 395.0, 480.0, 0.0, 230.0, 405.0, 295.0], "episode_lengths": [128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1345521580655678, "mean_inference_ms": 1.5070799476374788, "mean_action_processing_ms": 0.5570724306367748, "mean_env_wait_ms": 0.19516059053405196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.15970730781555176, "StateBufferConnector_ms": 0.006233930587768555, "ViewRequirementAgentConnector_ms": 0.3196539878845215}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6307840, "num_agent_steps_trained": 6307840, "num_env_steps_sampled": 1261568, "num_env_steps_trained": 1261568, "num_env_steps_sampled_this_iter": 8192, "num_env_steps_trained_this_iter": 8192, "num_env_steps_sampled_throughput_per_sec": 65.74958054375952, "num_env_steps_trained_throughput_per_sec": 65.74958054375952, "timesteps_total": 1261568, "num_steps_trained_this_iter": 8192, "agent_timesteps_total": 6307840, "timers": {"training_iteration_time_ms": 123496.911, "sample_time_ms": 13856.736, "load_time_ms": 1.754, "load_throughput": 4670219.427, "learn_time_ms": 109629.642, "learn_throughput": 74.724, "synch_weights_time_ms": 2.611}, "counters": {"num_env_steps_sampled": 1261568, "num_env_steps_trained": 1261568, "num_agent_steps_sampled": 6307840, "num_agent_steps_trained": 6307840}, "done": false, "episodes_total": 9856, "training_iteration": 154, "trial_id": "9fade_00019", "date": "2023-11-10_00-47-15", "timestamp": 1699573635, "time_this_iter_s": 124.61018443107605, "time_total_s": 17369.419576644897, "pid": 129105, "hostname": "tikgpu05", "node_ip": "129.132.190.223", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'envs.communication_v0.environment.CommunicationV0_env'>", "env_config": {"render_mode": "silent", "agent_config": {"n_agents": 5, "size_com_vec": 2, "com_range": 2, "len_trace": 2}, "max_steps": 128, "curriculum_learning": true, "model_configs": {"0": {"description": "find_plattform_1", "model_params": {"agent_placement": "center", "plattform_distance": 1, "oracle_burn_in": 0, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "1": {"description": "find_plattform_2", "model_params": {"agent_placement": "center", "plattform_distance": 2, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "2": {"description": "find_plattform_3", "model_params": {"agent_placement": "center", "plattform_distance": 3, "oracle_burn_in": 5, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "3": {"description": "find_plattform_4", "model_params": {"agent_placement": "center", "plattform_distance": 4, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "4": {"description": "find_plattform_5", "model_params": {"agent_placement": "center", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "5": {"description": "solve", "model_params": {"agent_placement": "random", "plattform_distance": 3, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}, "6": {"description": "solve_2", "model_params": {"agent_placement": "random", "plattform_distance": 5, "oracle_burn_in": 11, "p_oracle_change": 0.05, "n_tiles_x": 11, "n_tiles_y": 11}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7fc362a4d4e0>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.1275449969510959, "lr": 0.00011210859819985454, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 8192, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'models.fully_connected.FullyConnected'>", "custom_model_config": {"nn_action_hiddens": [256, 256], "nn_action_activation": "relu", "nn_value_hiddens": [256, 256], "nn_value_activation": "relu"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fc363f4ede0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'envs.communication_v0.callbacks.ReportModelStateCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 17369.419576644897, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 37.82762430939226, "ram_util_percent": 18.712154696132593}, "checkpoint_dir_name": null}
