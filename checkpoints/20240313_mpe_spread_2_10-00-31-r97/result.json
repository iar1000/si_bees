{"custom_metrics": {"collisions_mean": 121.4, "collisions_min": 74, "collisions_max": 162, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9993078854234739, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 3.105618870554856, "policy_loss": 0.02369241184827968, "vf_loss": 5.847556293627312, "vf_explained_var": -0.040124604379993746, "kl": 0.0, "entropy": 24.76336162172515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500}, "sampler_results": {"episode_reward_max": -396.09792880844475, "episode_reward_min": -981.7339551050236, "episode_reward_mean": -641.4634534568961, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 121.4, "collisions_min": 74, "collisions_max": 162, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7623560088293782, "mean_inference_ms": 10.484309350905635, "mean_action_processing_ms": 0.5383379027539374, "mean_env_wait_ms": 1.0389509509916734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9471583366394043, "StateBufferConnector_ms": 0.0075435638427734375, "ViewRequirementAgentConnector_ms": 0.28041839599609375}}, "episode_reward_max": -396.09792880844475, "episode_reward_min": -981.7339551050236, "episode_reward_mean": -641.4634534568961, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7623560088293782, "mean_inference_ms": 10.484309350905635, "mean_action_processing_ms": 0.5383379027539374, "mean_env_wait_ms": 1.0389509509916734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9471583366394043, "StateBufferConnector_ms": 0.0075435638427734375, "ViewRequirementAgentConnector_ms": 0.28041839599609375}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500, "num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 4.876112691339103, "num_agent_steps_trained_throughput_per_sec": 4.876112691339103, "timesteps_total": 7500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 7500, "timers": {"training_iteration_time_ms": 1538110.425, "sample_time_ms": 34666.965, "load_time_ms": 0.767, "load_throughput": 3261511.664, "learn_time_ms": 1503439.879, "learn_throughput": 1.663, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 2500, "num_env_steps_trained": 2500, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7500}, "done": false, "episodes_total": 10, "training_iteration": 1, "trial_id": "2532e_00097", "date": "2024-03-13_17-59-25", "timestamp": 1710349165, "time_this_iter_s": 1538.1111636161804, "time_total_s": 1538.1111636161804, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1538.1111636161804, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.826884191176475, "ram_util_percent": 16.200045955882356}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"collisions_mean": 120.6, "collisions_min": 66, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 3.1094334992184036, "policy_loss": 0.015372198549281249, "vf_loss": 5.870580556611905, "vf_explained_var": -0.0743929222739976, "kl": 0.0, "entropy": 24.77787721787376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2610.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "sampler_results": {"episode_reward_max": -396.09792880844475, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -652.8269123381273, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 120.6, "collisions_min": 66, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7765685130668039, "mean_inference_ms": 10.567898575325492, "mean_action_processing_ms": 0.538915069101361, "mean_env_wait_ms": 1.0406541033872017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.917506217956543, "StateBufferConnector_ms": 0.007441043853759766, "ViewRequirementAgentConnector_ms": 0.277332067489624}}, "episode_reward_max": -396.09792880844475, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -652.8269123381273, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7765685130668039, "mean_inference_ms": 10.567898575325492, "mean_action_processing_ms": 0.538915069101361, "mean_env_wait_ms": 1.0406541033872017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.917506217956543, "StateBufferConnector_ms": 0.007441043853759766, "ViewRequirementAgentConnector_ms": 0.277332067489624}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000, "num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 4.864232238667206, "num_agent_steps_trained_throughput_per_sec": 4.864232238667206, "timesteps_total": 15000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 1539988.781, "sample_time_ms": 35172.471, "load_time_ms": 1.132, "load_throughput": 2209388.959, "learn_time_ms": 1504812.604, "learn_throughput": 1.661, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 5000, "num_env_steps_trained": 5000, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 15000}, "done": false, "episodes_total": 20, "training_iteration": 2, "trial_id": "2532e_00097", "date": "2024-03-13_18-25-12", "timestamp": 1710350712, "time_this_iter_s": 1541.8680737018585, "time_total_s": 3079.979237318039, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3079.979237318039, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.02859753312014, "ram_util_percent": 15.835358611238007}, "checkpoint_dir_name": "checkpoint_000001"}
{"custom_metrics": {"collisions_mean": 101.86666666666666, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.94512541900421, "policy_loss": -0.0032727116994538353, "vf_loss": 5.594203561338885, "vf_explained_var": -0.1797965338175324, "kl": 0.0, "entropy": 24.860797087351482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4350.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500}, "sampler_results": {"episode_reward_max": -396.09792880844475, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -629.8694878280331, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 101.86666666666666, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7866681603120076, "mean_inference_ms": 10.634716968981394, "mean_action_processing_ms": 0.5397840197067548, "mean_env_wait_ms": 1.0427199386269126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9206589063008627, "StateBufferConnector_ms": 0.007394949595133464, "ViewRequirementAgentConnector_ms": 0.279694398244222}}, "episode_reward_max": -396.09792880844475, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -629.8694878280331, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7866681603120076, "mean_inference_ms": 10.634716968981394, "mean_action_processing_ms": 0.5397840197067548, "mean_env_wait_ms": 1.0427199386269126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9206589063008627, "StateBufferConnector_ms": 0.007394949595133464, "ViewRequirementAgentConnector_ms": 0.279694398244222}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 4.94788930998477, "num_agent_steps_trained_throughput_per_sec": 4.94788930998477, "timesteps_total": 22500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 22500, "timers": {"training_iteration_time_ms": 1531925.128, "sample_time_ms": 35521.696, "load_time_ms": 1.007, "load_throughput": 2482424.242, "learn_time_ms": 1496400.003, "learn_throughput": 1.671, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 7500, "num_env_steps_trained": 7500, "num_agent_steps_sampled": 22500, "num_agent_steps_trained": 22500}, "done": false, "episodes_total": 30, "training_iteration": 3, "trial_id": "2532e_00097", "date": "2024-03-13_18-50-28", "timestamp": 1710352228, "time_this_iter_s": 1515.7988290786743, "time_total_s": 4595.778066396713, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4595.778066396713, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.13542830540037, "ram_util_percent": 15.319739292364993}, "checkpoint_dir_name": "checkpoint_000002"}
{"custom_metrics": {"collisions_mean": 91.15, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.892897211477674, "policy_loss": 0.002835349130294361, "vf_loss": 5.483518051553046, "vf_explained_var": 0.03588774567362906, "kl": 0.0, "entropy": 24.81275135785684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6090.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "sampler_results": {"episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -601.2754242680527, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 91.15, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7923170193585094, "mean_inference_ms": 10.67793479767577, "mean_action_processing_ms": 0.5399866805756418, "mean_env_wait_ms": 1.0437896600515937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9247487783432007, "StateBufferConnector_ms": 0.007364749908447266, "ViewRequirementAgentConnector_ms": 0.2949976921081543}}, "episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -601.2754242680527, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7923170193585094, "mean_inference_ms": 10.67793479767577, "mean_action_processing_ms": 0.5399866805756418, "mean_env_wait_ms": 1.0437896600515937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9247487783432007, "StateBufferConnector_ms": 0.007364749908447266, "ViewRequirementAgentConnector_ms": 0.2949976921081543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000, "num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 4.938876526482271, "num_agent_steps_trained_throughput_per_sec": 4.938876526482271, "timesteps_total": 30000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 1528584.83, "sample_time_ms": 35623.368, "load_time_ms": 0.992, "load_throughput": 2520918.38, "learn_time_ms": 1492958.104, "learn_throughput": 1.675, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 10000, "num_env_steps_trained": 10000, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 30000}, "done": false, "episodes_total": 40, "training_iteration": 4, "trial_id": "2532e_00097", "date": "2024-03-13_19-15-47", "timestamp": 1710353747, "time_this_iter_s": 1518.5654516220093, "time_total_s": 6114.3435180187225, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 6114.3435180187225, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.86772093023256, "ram_util_percent": 15.865720930232559}, "checkpoint_dir_name": "checkpoint_000003"}
{"custom_metrics": {"collisions_mean": 82.8, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.630405628544161, "policy_loss": -0.011320098016100625, "vf_loss": 5.0123324157862825, "vf_explained_var": -0.13258788804898317, "kl": 0.0, "entropy": 24.813850830341206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7830.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500}, "sampler_results": {"episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -572.7636647331855, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 82.8, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7965035890846226, "mean_inference_ms": 10.711795898659297, "mean_action_processing_ms": 0.5401641926699223, "mean_env_wait_ms": 1.0446134531719655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9210939407348633, "StateBufferConnector_ms": 0.007348537445068359, "ViewRequirementAgentConnector_ms": 0.29233598709106445}}, "episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -572.7636647331855, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7965035890846226, "mean_inference_ms": 10.711795898659297, "mean_action_processing_ms": 0.5401641926699223, "mean_env_wait_ms": 1.0446134531719655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9210939407348633, "StateBufferConnector_ms": 0.007348537445068359, "ViewRequirementAgentConnector_ms": 0.29233598709106445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500, "num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.031535431038479, "num_agent_steps_trained_throughput_per_sec": 5.031535431038479, "timesteps_total": 37500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 37500, "timers": {"training_iteration_time_ms": 1520987.585, "sample_time_ms": 35736.125, "load_time_ms": 0.97, "load_throughput": 2577493.732, "learn_time_ms": 1485248.118, "learn_throughput": 1.683, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 12500, "num_env_steps_trained": 12500, "num_agent_steps_sampled": 37500, "num_agent_steps_trained": 37500}, "done": false, "episodes_total": 50, "training_iteration": 5, "trial_id": "2532e_00097", "date": "2024-03-13_19-40-38", "timestamp": 1710355238, "time_this_iter_s": 1490.6001081466675, "time_total_s": 7604.94362616539, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 7604.94362616539, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.23194312796208, "ram_util_percent": 16.284928909952605}, "checkpoint_dir_name": "checkpoint_000004"}
{"custom_metrics": {"collisions_mean": 77.46666666666667, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.7085588266452154, "policy_loss": -0.008080641795806158, "vf_loss": 5.154471530585454, "vf_explained_var": -0.03142382605322476, "kl": 0.0, "entropy": 24.84749283626162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9570.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "sampler_results": {"episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -555.5412781426344, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 77.46666666666667, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.799690895438244, "mean_inference_ms": 10.737968226785615, "mean_action_processing_ms": 0.5404034559298246, "mean_env_wait_ms": 1.0452447032124772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9241163730621338, "StateBufferConnector_ms": 0.0073146820068359375, "ViewRequirementAgentConnector_ms": 0.29031912485758465}}, "episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -555.5412781426344, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.799690895438244, "mean_inference_ms": 10.737968226785615, "mean_action_processing_ms": 0.5404034559298246, "mean_env_wait_ms": 1.0452447032124772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9241163730621338, "StateBufferConnector_ms": 0.0073146820068359375, "ViewRequirementAgentConnector_ms": 0.29031912485758465}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000, "num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.089518838541089, "num_agent_steps_trained_throughput_per_sec": 5.089518838541089, "timesteps_total": 45000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 45000, "timers": {"training_iteration_time_ms": 1513092.434, "sample_time_ms": 35798.933, "load_time_ms": 0.995, "load_throughput": 2513064.11, "learn_time_ms": 1477290.168, "learn_throughput": 1.692, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 15000, "num_agent_steps_sampled": 45000, "num_agent_steps_trained": 45000}, "done": false, "episodes_total": 60, "training_iteration": 6, "trial_id": "2532e_00097", "date": "2024-03-13_20-05-12", "timestamp": 1710356712, "time_this_iter_s": 1473.6183412075043, "time_total_s": 9078.561967372894, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 9078.561967372894, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.96633141762451, "ram_util_percent": 16.041522988505747}, "checkpoint_dir_name": "checkpoint_000005"}
{"custom_metrics": {"collisions_mean": 74.08571428571429, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.2023305301790006, "policy_loss": -0.0033411844316388255, "vf_loss": 4.184976416415181, "vf_explained_var": -0.14426798149086964, "kl": 0.0, "entropy": 24.79487895198252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11310.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500}, "sampler_results": {"episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -535.0141396606341, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 74.08571428571429, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8016639249731579, "mean_inference_ms": 10.75520926003233, "mean_action_processing_ms": 0.5405567722872626, "mean_env_wait_ms": 1.0456446070560876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.921257563999721, "StateBufferConnector_ms": 0.0072928837367466515, "ViewRequirementAgentConnector_ms": 0.2880522183009556}}, "episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -535.0141396606341, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8016639249731579, "mean_inference_ms": 10.75520926003233, "mean_action_processing_ms": 0.5405567722872626, "mean_env_wait_ms": 1.0456446070560876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.921257563999721, "StateBufferConnector_ms": 0.0072928837367466515, "ViewRequirementAgentConnector_ms": 0.2880522183009556}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500, "num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.127097129960397, "num_agent_steps_trained_throughput_per_sec": 5.127097129960397, "timesteps_total": 52500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 52500, "timers": {"training_iteration_time_ms": 1505910.087, "sample_time_ms": 35766.868, "load_time_ms": 0.955, "load_throughput": 2617980.526, "learn_time_ms": 1470139.957, "learn_throughput": 1.701, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 17500, "num_env_steps_trained": 17500, "num_agent_steps_sampled": 52500, "num_agent_steps_trained": 52500}, "done": false, "episodes_total": 70, "training_iteration": 7, "trial_id": "2532e_00097", "date": "2024-03-13_20-29-36", "timestamp": 1710358176, "time_this_iter_s": 1462.8178856372833, "time_total_s": 10541.379853010178, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 10541.379853010178, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.083325301204816, "ram_util_percent": 16.68920481927711}, "checkpoint_dir_name": "checkpoint_000006"}
{"custom_metrics": {"collisions_mean": 72.55, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.233399964884009, "policy_loss": 0.008995818782694124, "vf_loss": 4.220518761188134, "vf_explained_var": -0.029106765779955635, "kl": 0.0, "entropy": 24.84325169968879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13050.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -523.1195141365613, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 72.55, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8025867213514015, "mean_inference_ms": 10.765952994986689, "mean_action_processing_ms": 0.5405197881072292, "mean_env_wait_ms": 1.045827713933771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9173917770385742, "StateBufferConnector_ms": 0.0072449445724487305, "ViewRequirementAgentConnector_ms": 0.28564453125}}, "episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -523.1195141365613, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8025867213514015, "mean_inference_ms": 10.765952994986689, "mean_action_processing_ms": 0.5405197881072292, "mean_env_wait_ms": 1.045827713933771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9173917770385742, "StateBufferConnector_ms": 0.0072449445724487305, "ViewRequirementAgentConnector_ms": 0.28564453125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.1578682028239555, "num_agent_steps_trained_throughput_per_sec": 5.1578682028239555, "timesteps_total": 60000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 1499432.459, "sample_time_ms": 35704.853, "load_time_ms": 0.973, "load_throughput": 2568701.35, "learn_time_ms": 1463724.368, "learn_throughput": 1.708, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 80, "training_iteration": 8, "trial_id": "2532e_00097", "date": "2024-03-13_20-53-50", "timestamp": 1710359630, "time_this_iter_s": 1454.0911338329315, "time_total_s": 11995.47098684311, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 11995.47098684311, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.975145348837216, "ram_util_percent": 16.71690891472868}, "checkpoint_dir_name": "checkpoint_000007"}
{"custom_metrics": {"collisions_mean": 72.88888888888889, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.055571838812207, "policy_loss": -0.016597678666217145, "vf_loss": 3.9316732784797406, "vf_explained_var": 0.047146908099623935, "kl": 0.0, "entropy": 24.81192349181778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14790.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500}, "sampler_results": {"episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -512.4690756093893, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 72.88888888888889, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8027867965683053, "mean_inference_ms": 10.771492802799818, "mean_action_processing_ms": 0.5403295890857297, "mean_env_wait_ms": 1.0458203236320864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9151501125759549, "StateBufferConnector_ms": 0.007199446360270183, "ViewRequirementAgentConnector_ms": 0.2842524316575792}}, "episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -512.4690756093893, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8027867965683053, "mean_inference_ms": 10.771492802799818, "mean_action_processing_ms": 0.5403295890857297, "mean_env_wait_ms": 1.0458203236320864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9151501125759549, "StateBufferConnector_ms": 0.007199446360270183, "ViewRequirementAgentConnector_ms": 0.2842524316575792}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500, "num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.2959305490782125, "num_agent_steps_trained_throughput_per_sec": 5.2959305490782125, "timesteps_total": 67500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 67500, "timers": {"training_iteration_time_ms": 1490182.371, "sample_time_ms": 35621.151, "load_time_ms": 0.942, "load_throughput": 2652682.707, "learn_time_ms": 1454558.08, "learn_throughput": 1.719, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 22500, "num_env_steps_trained": 22500, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67500}, "done": false, "episodes_total": 90, "training_iteration": 9, "trial_id": "2532e_00097", "date": "2024-03-13_21-17-27", "timestamp": 1710361047, "time_this_iter_s": 1416.183645248413, "time_total_s": 13411.654632091522, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 13411.654632091522, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.364260826281736, "ram_util_percent": 16.860876057740175}, "checkpoint_dir_name": "checkpoint_000008"}
{"custom_metrics": {"collisions_mean": 72.0, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.921277962934397, "policy_loss": -0.009243290587435423, "vf_loss": 3.662914060176104, "vf_explained_var": 0.1396069803799706, "kl": 0.0, "entropy": 24.95099427014932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16530.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000}, "sampler_results": {"episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -504.0492429347612, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 72.0, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8021370487357087, "mean_inference_ms": 10.77119713206839, "mean_action_processing_ms": 0.5399654600627553, "mean_env_wait_ms": 1.0454864330497498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.91229248046875, "StateBufferConnector_ms": 0.007181644439697266, "ViewRequirementAgentConnector_ms": 0.2828977108001709}}, "episode_reward_max": -329.84967919045084, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -504.0492429347612, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-981.7339551050236, -828.7284088549919, -653.2906573037482, -684.2722009821399, -467.57747460361577, -850.2812896158765, -509.09390220731274, -396.09792880844475, -567.5388934822363, -476.0198236055713, -483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8021370487357087, "mean_inference_ms": 10.77119713206839, "mean_action_processing_ms": 0.5399654600627553, "mean_env_wait_ms": 1.0454864330497498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.91229248046875, "StateBufferConnector_ms": 0.007181644439697266, "ViewRequirementAgentConnector_ms": 0.2828977108001709}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000, "num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.275724509177829, "num_agent_steps_trained_throughput_per_sec": 5.275724509177829, "timesteps_total": 75000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 75000, "timers": {"training_iteration_time_ms": 1483324.7, "sample_time_ms": 35466.26, "load_time_ms": 0.945, "load_throughput": 2644113.271, "learn_time_ms": 1447855.355, "learn_throughput": 1.727, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 25000, "num_env_steps_trained": 25000, "num_agent_steps_sampled": 75000, "num_agent_steps_trained": 75000}, "done": false, "episodes_total": 100, "training_iteration": 10, "trial_id": "2532e_00097", "date": "2024-03-13_21-41-10", "timestamp": 1710362470, "time_this_iter_s": 1421.6077892780304, "time_total_s": 14833.262421369553, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 14833.262421369553, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.02576808721506, "ram_util_percent": 16.78384539147671}, "checkpoint_dir_name": "checkpoint_000009"}
{"custom_metrics": {"collisions_mean": 67.3, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.8866971305539382, "policy_loss": 0.0007676414021387183, "vf_loss": 3.5783069590727488, "vf_explained_var": 0.08732130709050716, "kl": 0.0, "entropy": 24.82296079109455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18270.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -481.41666001182364, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 67.3, "collisions_min": 14, "collisions_max": 184, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8051027627373737, "mean_inference_ms": 10.797502714349319, "mean_action_processing_ms": 0.5396934131401268, "mean_env_wait_ms": 1.045724661560925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9092910289764404, "StateBufferConnector_ms": 0.0070972442626953125, "ViewRequirementAgentConnector_ms": 0.2809290885925293}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1189.9703157707306, "episode_reward_mean": -481.41666001182364, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-483.2068989636808, -499.813303066054, -1067.261786758603, -415.35652029636236, -450.0290956121022, -1115.0007825644864, -1189.9703157707306, -503.0037930634629, -431.84788911632114, -486.4133269817837, -992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8051027627373737, "mean_inference_ms": 10.797502714349319, "mean_action_processing_ms": 0.5396934131401268, "mean_env_wait_ms": 1.045724661560925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9092910289764404, "StateBufferConnector_ms": 0.0070972442626953125, "ViewRequirementAgentConnector_ms": 0.2809290885925293}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500, "num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.247021201864032, "num_agent_steps_trained_throughput_per_sec": 5.247021201864032, "timesteps_total": 82500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 82500, "timers": {"training_iteration_time_ms": 1472451.899, "sample_time_ms": 35468.003, "load_time_ms": 0.948, "load_throughput": 2636070.19, "learn_time_ms": 1436980.904, "learn_throughput": 1.74, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 27500, "num_env_steps_trained": 27500, "num_agent_steps_sampled": 82500, "num_agent_steps_trained": 82500}, "done": false, "episodes_total": 110, "training_iteration": 11, "trial_id": "2532e_00097", "date": "2024-03-13_22-05-01", "timestamp": 1710363901, "time_this_iter_s": 1429.3846108913422, "time_total_s": 16262.647032260895, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 16262.647032260895, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.03438579181056, "ram_util_percent": 16.788751850024667}, "checkpoint_dir_name": "checkpoint_000010"}
{"custom_metrics": {"collisions_mean": 62.9, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.2642211854650545, "policy_loss": 0.0005488607197486121, "vf_loss": 4.29502505968357, "vf_explained_var": -0.012434092540850584, "kl": 0.0, "entropy": 24.82650754533965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20010.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -992.2357229686769, "episode_reward_mean": -458.09565943488093, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 62.9, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8047005746499991, "mean_inference_ms": 10.803775092958332, "mean_action_processing_ms": 0.5391794125105065, "mean_env_wait_ms": 1.0453433085093764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9082260131835938, "StateBufferConnector_ms": 0.007035017013549805, "ViewRequirementAgentConnector_ms": 0.28034472465515137}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -992.2357229686769, "episode_reward_mean": -458.09565943488093, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-992.2357229686769, -403.26601597003935, -458.4294482149271, -812.0962534188558, -398.3007432505947, -406.51251755886034, -541.6536146412568, -407.97356050998616, -789.5736472202583, -629.5048643249908, -601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8047005746499991, "mean_inference_ms": 10.803775092958332, "mean_action_processing_ms": 0.5391794125105065, "mean_env_wait_ms": 1.0453433085093764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9082260131835938, "StateBufferConnector_ms": 0.007035017013549805, "ViewRequirementAgentConnector_ms": 0.28034472465515137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.06308040182906, "num_agent_steps_trained_throughput_per_sec": 5.06308040182906, "timesteps_total": 90000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 1466396.347, "sample_time_ms": 35310.36, "load_time_ms": 0.876, "load_throughput": 2853578.621, "learn_time_ms": 1431083.054, "learn_throughput": 1.747, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 30000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 120, "training_iteration": 12, "trial_id": "2532e_00097", "date": "2024-03-13_22-29-42", "timestamp": 1710365382, "time_this_iter_s": 1481.3138582706451, "time_total_s": 17743.96089053154, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 17743.96089053154, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 45.75169289461135, "ram_util_percent": 16.540915593705293}, "checkpoint_dir_name": "checkpoint_000011"}
{"custom_metrics": {"collisions_mean": 63.34, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9988505747126437, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.159760325997747, "policy_loss": -0.008592763277380887, "vf_loss": 4.114169161415648, "vf_explained_var": 0.014101620172632152, "kl": 0.0, "entropy": 25.27129413670507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21750.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -446.8897470311757, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 63.34, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8027434935574886, "mean_inference_ms": 10.79854786348053, "mean_action_processing_ms": 0.538514738121079, "mean_env_wait_ms": 1.044486959320542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9070608615875244, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.27937841415405273}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -446.8897470311757, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-601.6679477935457, -785.8228454015314, -509.95195649436187, -748.1100721106553, -361.1100703937664, -451.7122642486336, -329.84967919045084, -505.72487257392635, -390.67819334023153, -470.30443433401274, -486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8027434935574886, "mean_inference_ms": 10.79854786348053, "mean_action_processing_ms": 0.538514738121079, "mean_env_wait_ms": 1.044486959320542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9070608615875244, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.27937841415405273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500, "num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.0627406773359205, "num_agent_steps_trained_throughput_per_sec": 5.0627406773359205, "timesteps_total": 97500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 97500, "timers": {"training_iteration_time_ms": 1462957.664, "sample_time_ms": 35224.807, "load_time_ms": 0.874, "load_throughput": 2859336.824, "learn_time_ms": 1427729.952, "learn_throughput": 1.751, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 32500, "num_env_steps_trained": 32500, "num_agent_steps_sampled": 97500, "num_agent_steps_trained": 97500}, "done": false, "episodes_total": 130, "training_iteration": 13, "trial_id": "2532e_00097", "date": "2024-03-13_22-54-24", "timestamp": 1710366864, "time_this_iter_s": 1481.41330742836, "time_total_s": 19225.3741979599, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 19225.3741979599, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.06407442748092, "ram_util_percent": 15.778435114503816}, "checkpoint_dir_name": "checkpoint_000012"}
{"custom_metrics": {"collisions_mean": 64.76, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.0732953994679426, "policy_loss": 0.013686580190317299, "vf_loss": 3.9078409968436447, "vf_explained_var": 0.09677185131900612, "kl": 0.0, "entropy": 25.041369910623835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23490.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -439.62067375879184, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 64.76, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8004517853095274, "mean_inference_ms": 10.788850032826268, "mean_action_processing_ms": 0.537892140126648, "mean_env_wait_ms": 1.0434702135650742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9024980068206787, "StateBufferConnector_ms": 0.006970643997192383, "ViewRequirementAgentConnector_ms": 0.2716376781463623}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -439.62067375879184, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-486.44670709221845, -474.77065438482526, -383.28764171445187, -412.7426523855525, -398.75069264621334, -516.0033224402963, -403.2281726893579, -447.28995467472896, -484.9067659449741, -579.7397019645452, -449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8004517853095274, "mean_inference_ms": 10.788850032826268, "mean_action_processing_ms": 0.537892140126648, "mean_env_wait_ms": 1.0434702135650742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9024980068206787, "StateBufferConnector_ms": 0.006970643997192383, "ViewRequirementAgentConnector_ms": 0.2716376781463623}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000, "num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.142614447824961, "num_agent_steps_trained_throughput_per_sec": 5.142614447824961, "timesteps_total": 105000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 105000, "timers": {"training_iteration_time_ms": 1456941.483, "sample_time_ms": 35130.795, "load_time_ms": 0.865, "load_throughput": 2890709.599, "learn_time_ms": 1421807.831, "learn_throughput": 1.758, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 35000, "num_env_steps_trained": 35000, "num_agent_steps_sampled": 105000, "num_agent_steps_trained": 105000}, "done": false, "episodes_total": 140, "training_iteration": 14, "trial_id": "2532e_00097", "date": "2024-03-13_23-18-44", "timestamp": 1710368324, "time_this_iter_s": 1458.404450893402, "time_total_s": 20683.778648853302, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 20683.778648853302, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 45.32046444121916, "ram_util_percent": 15.585728108369619}, "checkpoint_dir_name": "checkpoint_000013"}
{"custom_metrics": {"collisions_mean": 66.34, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.3746580095426446, "policy_loss": 0.041562383604937116, "vf_loss": 4.426746785674972, "vf_explained_var": 0.09322268705943536, "kl": 0.0, "entropy": 25.11087241008364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25230.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -439.54270134170326, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 66.34, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7974429370191427, "mean_inference_ms": 10.773060231876556, "mean_action_processing_ms": 0.5371824932320234, "mean_env_wait_ms": 1.0421914133200756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8976876735687256, "StateBufferConnector_ms": 0.0069332122802734375, "ViewRequirementAgentConnector_ms": 0.2697000503540039}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -439.54270134170326, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-449.28250305308325, -443.34410785268096, -447.140283784177, -414.6167188626315, -441.985096076284, -435.48461068051193, -570.5685122050688, -422.2747863019743, -566.891892567527, -502.7049405148509, -402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7974429370191427, "mean_inference_ms": 10.773060231876556, "mean_action_processing_ms": 0.5371824932320234, "mean_env_wait_ms": 1.0421914133200756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8976876735687256, "StateBufferConnector_ms": 0.0069332122802734375, "ViewRequirementAgentConnector_ms": 0.2697000503540039}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500, "num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.124883384933212, "num_agent_steps_trained_throughput_per_sec": 5.124883384933212, "timesteps_total": 112500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 112500, "timers": {"training_iteration_time_ms": 1454226.413, "sample_time_ms": 34937.551, "load_time_ms": 0.877, "load_throughput": 2851638.519, "learn_time_ms": 1419286.063, "learn_throughput": 1.761, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 37500, "num_env_steps_trained": 37500, "num_agent_steps_sampled": 112500, "num_agent_steps_trained": 112500}, "done": false, "episodes_total": 150, "training_iteration": 15, "trial_id": "2532e_00097", "date": "2024-03-13_23-43-08", "timestamp": 1710369788, "time_this_iter_s": 1463.449961900711, "time_total_s": 22147.228610754013, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 22147.228610754013, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.53471752776437, "ram_util_percent": 15.383437952679868}, "checkpoint_dir_name": "checkpoint_000014"}
{"custom_metrics": {"collisions_mean": 68.44, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.8389613069120216, "policy_loss": 0.006251979804993875, "vf_loss": 3.477328606138284, "vf_explained_var": 0.07811102418378851, "kl": 0.0, "entropy": 24.616697140397697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26970.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -431.3376722316726, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 68.44, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7940899469423406, "mean_inference_ms": 10.754549517518425, "mean_action_processing_ms": 0.5363855762397207, "mean_env_wait_ms": 1.0407763355979127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8958301544189453, "StateBufferConnector_ms": 0.006922006607055664, "ViewRequirementAgentConnector_ms": 0.26868700981140137}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -431.3376722316726, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-402.24555512248105, -361.4169320459709, -459.16519866773007, -440.03433977965693, -383.16081027929147, -397.56297190524174, -377.07555067890746, -562.3694460491402, -395.94546364336924, -339.53681951454547, -449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7940899469423406, "mean_inference_ms": 10.754549517518425, "mean_action_processing_ms": 0.5363855762397207, "mean_env_wait_ms": 1.0407763355979127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8958301544189453, "StateBufferConnector_ms": 0.006922006607055664, "ViewRequirementAgentConnector_ms": 0.26868700981140137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.221119687125848, "num_agent_steps_trained_throughput_per_sec": 5.221119687125848, "timesteps_total": 120000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 1450512.09, "sample_time_ms": 34815.151, "load_time_ms": 0.878, "load_throughput": 2847302.251, "learn_time_ms": 1415694.173, "learn_throughput": 1.766, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 160, "training_iteration": 16, "trial_id": "2532e_00097", "date": "2024-03-14_00-07-05", "timestamp": 1710371225, "time_this_iter_s": 1436.4756112098694, "time_total_s": 23583.704221963882, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 23583.704221963882, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 44.518467583497056, "ram_util_percent": 15.57755402750491}, "checkpoint_dir_name": "checkpoint_000015"}
{"custom_metrics": {"collisions_mean": 70.42, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4597273605864967, "policy_loss": 0.0032265419044114393, "vf_loss": 2.7635216893478374, "vf_explained_var": 0.007161018560672629, "kl": 0.0, "entropy": 24.45590264550571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28710.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -425.0748190918216, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 70.42, "collisions_min": 14, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7907167652355576, "mean_inference_ms": 10.735734724009253, "mean_action_processing_ms": 0.5355850970559913, "mean_env_wait_ms": 1.0393256674609552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8927395343780518, "StateBufferConnector_ms": 0.0068662166595458984, "ViewRequirementAgentConnector_ms": 0.26786303520202637}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -425.0748190918216, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-449.18357317220773, -345.65971287670214, -408.40546118309675, -345.75430291225206, -426.6957094249792, -560.6366292622282, -471.5034322141597, -556.966118326406, -453.1129188325401, -380.65349647593683, -527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7907167652355576, "mean_inference_ms": 10.735734724009253, "mean_action_processing_ms": 0.5355850970559913, "mean_env_wait_ms": 1.0393256674609552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8927395343780518, "StateBufferConnector_ms": 0.0068662166595458984, "ViewRequirementAgentConnector_ms": 0.26786303520202637}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500, "num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.270829548785904, "num_agent_steps_trained_throughput_per_sec": 5.270829548785904, "timesteps_total": 127500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 127500, "timers": {"training_iteration_time_ms": 1446523.079, "sample_time_ms": 34705.296, "load_time_ms": 0.88, "load_throughput": 2840668.599, "learn_time_ms": 1411815.058, "learn_throughput": 1.771, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 42500, "num_env_steps_trained": 42500, "num_agent_steps_sampled": 127500, "num_agent_steps_trained": 127500}, "done": false, "episodes_total": 170, "training_iteration": 17, "trial_id": "2532e_00097", "date": "2024-03-14_00-30-48", "timestamp": 1710372648, "time_this_iter_s": 1422.9280860424042, "time_total_s": 25006.632308006287, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 25006.632308006287, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.11655104063429, "ram_util_percent": 15.538701684836472}, "checkpoint_dir_name": "checkpoint_000016"}
{"custom_metrics": {"collisions_mean": 71.14, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.7929614841252908, "policy_loss": -0.005319402531463781, "vf_loss": 3.4120050839309033, "vf_explained_var": 0.04784415234094379, "kl": 0.0, "entropy": 24.590062473560202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30450.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -418.6097724770401, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 71.14, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.787411943970494, "mean_inference_ms": 10.716761373058619, "mean_action_processing_ms": 0.5347964406367192, "mean_env_wait_ms": 1.0378261442789432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8913445472717285, "StateBufferConnector_ms": 0.006832122802734375, "ViewRequirementAgentConnector_ms": 0.2670567035675049}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -418.6097724770401, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-527.5114075382179, -332.23185329342834, -418.4691859647149, -481.51145553293816, -368.2429491526241, -375.4548557248449, -383.2494610789869, -485.9136779087078, -455.95729067899475, -444.1135370466628, -533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.787411943970494, "mean_inference_ms": 10.716761373058619, "mean_action_processing_ms": 0.5347964406367192, "mean_env_wait_ms": 1.0378261442789432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8913445472717285, "StateBufferConnector_ms": 0.006832122802734375, "ViewRequirementAgentConnector_ms": 0.2670567035675049}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000, "num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.228545785743435, "num_agent_steps_trained_throughput_per_sec": 5.228545785743435, "timesteps_total": 135000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 135000, "timers": {"training_iteration_time_ms": 1444557.496, "sample_time_ms": 34576.341, "load_time_ms": 0.872, "load_throughput": 2867782.518, "learn_time_ms": 1409978.476, "learn_throughput": 1.773, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 45000, "num_env_steps_trained": 45000, "num_agent_steps_sampled": 135000, "num_agent_steps_trained": 135000}, "done": false, "episodes_total": 180, "training_iteration": 18, "trial_id": "2532e_00097", "date": "2024-03-14_00-54-43", "timestamp": 1710374083, "time_this_iter_s": 1434.435361623764, "time_total_s": 26441.06766963005, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 26441.06766963005, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 46.01022615535889, "ram_util_percent": 16.36897738446411}, "checkpoint_dir_name": "checkpoint_000017"}
{"custom_metrics": {"collisions_mean": 69.72, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.7568357717245817, "policy_loss": -0.005044081724307703, "vf_loss": 3.3429388366553976, "vf_explained_var": 0.07568787336349488, "kl": 0.0, "entropy": 24.67749458181447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32190.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500}, "sampler_results": {"episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -413.4535286424855, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 69.72, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7843434640535814, "mean_inference_ms": 10.699069490633253, "mean_action_processing_ms": 0.5340955883825004, "mean_env_wait_ms": 1.0363865862731276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8905284404754639, "StateBufferConnector_ms": 0.0068089962005615234, "ViewRequirementAgentConnector_ms": 0.26602602005004883}}, "episode_reward_max": -302.8834693332148, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -413.4535286424855, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-533.6974954452655, -513.9853096617643, -404.09691878843284, -424.85559932002053, -355.1638868485266, -478.5842805269572, -400.6607127233088, -375.505642848036, -395.0488378437385, -401.1088046250427, -317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7843434640535814, "mean_inference_ms": 10.699069490633253, "mean_action_processing_ms": 0.5340955883825004, "mean_env_wait_ms": 1.0363865862731276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8905284404754639, "StateBufferConnector_ms": 0.0068089962005615234, "ViewRequirementAgentConnector_ms": 0.26602602005004883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500, "num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.261757077058777, "num_agent_steps_trained_throughput_per_sec": 5.261757077058777, "timesteps_total": 142500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 142500, "timers": {"training_iteration_time_ms": 1445477.263, "sample_time_ms": 34510.916, "load_time_ms": 0.891, "load_throughput": 2805329.338, "learn_time_ms": 1410963.634, "learn_throughput": 1.772, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 47500, "num_env_steps_trained": 47500, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142500}, "done": false, "episodes_total": 190, "training_iteration": 19, "trial_id": "2532e_00097", "date": "2024-03-14_01-18-28", "timestamp": 1710375508, "time_this_iter_s": 1425.3814730644226, "time_total_s": 27866.449142694473, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 27866.449142694473, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 44.826063303659744, "ram_util_percent": 15.87650840751731}, "checkpoint_dir_name": "checkpoint_000018"}
{"custom_metrics": {"collisions_mean": 70.12, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 2.000952292285089, "policy_loss": 0.019273816799777077, "vf_loss": 3.759978245010321, "vf_explained_var": 0.0693444006401917, "kl": 0.0, "entropy": 24.811762890870543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33930.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "sampler_results": {"episode_reward_max": -302.14707286803156, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -409.89535682487605, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 70.12, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.781922874945276, "mean_inference_ms": 10.685073840596505, "mean_action_processing_ms": 0.5335582575505755, "mean_env_wait_ms": 1.0352009837091531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8890061378479004, "StateBufferConnector_ms": 0.0067822933197021484, "ViewRequirementAgentConnector_ms": 0.2655057907104492}}, "episode_reward_max": -302.14707286803156, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -409.89535682487605, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-317.1591202261765, -396.846472887295, -392.7090101081979, -448.8659937417608, -570.1335463703354, -367.8117421249134, -420.2031456359101, -302.8834693332148, -566.4093283761296, -368.35441347126226, -305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.781922874945276, "mean_inference_ms": 10.685073840596505, "mean_action_processing_ms": 0.5335582575505755, "mean_env_wait_ms": 1.0352009837091531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8890061378479004, "StateBufferConnector_ms": 0.0067822933197021484, "ViewRequirementAgentConnector_ms": 0.2655057907104492}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000, "num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.241912295812982, "num_agent_steps_trained_throughput_per_sec": 5.241912295812982, "timesteps_total": 150000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 150000, "timers": {"training_iteration_time_ms": 1446394.249, "sample_time_ms": 34540.225, "load_time_ms": 0.905, "load_throughput": 2762973.308, "learn_time_ms": 1411851.298, "learn_throughput": 1.771, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 50000, "num_env_steps_trained": 50000, "num_agent_steps_sampled": 150000, "num_agent_steps_trained": 150000}, "done": false, "episodes_total": 200, "training_iteration": 20, "trial_id": "2532e_00097", "date": "2024-03-14_01-42-20", "timestamp": 1710376940, "time_this_iter_s": 1430.7778489589691, "time_total_s": 29297.226991653442, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 29297.226991653442, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.56099605522682, "ram_util_percent": 16.04063116370809}, "checkpoint_dir_name": "checkpoint_000019"}
{"custom_metrics": {"collisions_mean": 68.34, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.7595438517721091, "policy_loss": 0.013795337850634736, "vf_loss": 3.312331721974515, "vf_explained_var": 0.010075969942684832, "kl": 0.0, "entropy": 24.83741327263843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35670.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -403.33708045508155, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 68.34, "collisions_min": 22, "collisions_max": 128, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7798158952194367, "mean_inference_ms": 10.672427698626148, "mean_action_processing_ms": 0.5330913072645485, "mean_env_wait_ms": 1.0340961117792804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.890739917755127, "StateBufferConnector_ms": 0.0068132877349853516, "ViewRequirementAgentConnector_ms": 0.26618456840515137}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -403.33708045508155, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-305.77881416447525, -525.9769707703205, -433.0835672591403, -394.50528291473404, -472.4523122275423, -499.80418430169084, -339.84699887218005, -530.4567836267089, -416.67498585917093, -391.2237545033667, -354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7798158952194367, "mean_inference_ms": 10.672427698626148, "mean_action_processing_ms": 0.5330913072645485, "mean_env_wait_ms": 1.0340961117792804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.890739917755127, "StateBufferConnector_ms": 0.0068132877349853516, "ViewRequirementAgentConnector_ms": 0.26618456840515137}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500, "num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.25035429236305, "num_agent_steps_trained_throughput_per_sec": 5.25035429236305, "timesteps_total": 157500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 157500, "timers": {"training_iteration_time_ms": 1446303.508, "sample_time_ms": 34520.745, "load_time_ms": 0.897, "load_throughput": 2788469.312, "learn_time_ms": 1411780.085, "learn_throughput": 1.771, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 52500, "num_env_steps_trained": 52500, "num_agent_steps_sampled": 157500, "num_agent_steps_trained": 157500}, "done": false, "episodes_total": 210, "training_iteration": 21, "trial_id": "2532e_00097", "date": "2024-03-14_02-06-09", "timestamp": 1710378369, "time_this_iter_s": 1428.4770636558533, "time_total_s": 30725.704055309296, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 30725.704055309296, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 43.93236309817464, "ram_util_percent": 15.606709422792308}, "checkpoint_dir_name": "checkpoint_000020"}
{"custom_metrics": {"collisions_mean": 68.1, "collisions_min": 20, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.7176755114608369, "policy_loss": 0.014946477919624283, "vf_loss": 3.230707817550363, "vf_explained_var": 0.06300854826795643, "kl": 0.0, "entropy": 24.823416199081244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37410.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -395.1124656426898, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 68.1, "collisions_min": 20, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7781327826287705, "mean_inference_ms": 10.662490156503145, "mean_action_processing_ms": 0.5327163478491767, "mean_env_wait_ms": 1.0332216913311802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8910088539123535, "StateBufferConnector_ms": 0.006816387176513672, "ViewRequirementAgentConnector_ms": 0.2661092281341553}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -1059.9899997117766, "episode_reward_mean": -395.1124656426898, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-354.4143559787452, -436.56493765109224, -505.6982181843209, -341.51835467193064, -1059.9899997117766, -427.1846471118496, -314.7075298254777, -469.99040815776465, -406.83573308759225, -402.05096332736997, -533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7781327826287705, "mean_inference_ms": 10.662490156503145, "mean_action_processing_ms": 0.5327163478491767, "mean_env_wait_ms": 1.0332216913311802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8910088539123535, "StateBufferConnector_ms": 0.006816387176513672, "ViewRequirementAgentConnector_ms": 0.2661092281341553}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000, "num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.238649112436647, "num_agent_steps_trained_throughput_per_sec": 5.238649112436647, "timesteps_total": 165000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 165000, "timers": {"training_iteration_time_ms": 1441339.022, "sample_time_ms": 34563.813, "load_time_ms": 0.946, "load_throughput": 2642580.645, "learn_time_ms": 1406772.55, "learn_throughput": 1.777, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 55000, "num_env_steps_trained": 55000, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 165000}, "done": false, "episodes_total": 220, "training_iteration": 22, "trial_id": "2532e_00097", "date": "2024-03-14_02-30-02", "timestamp": 1710379802, "time_this_iter_s": 1431.6689808368683, "time_total_s": 32157.373036146164, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 32157.373036146164, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 43.36712598425197, "ram_util_percent": 14.72691929133858}, "checkpoint_dir_name": "checkpoint_000021"}
{"custom_metrics": {"collisions_mean": 68.08, "collisions_min": 20, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.443568423479774, "policy_loss": -0.003786997292886606, "vf_loss": 2.7461694589291494, "vf_explained_var": 0.1299530273196341, "kl": 0.0, "entropy": 24.63938307378484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39150.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -709.0140579457809, "episode_reward_mean": -380.05098660368094, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 68.08, "collisions_min": 20, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7763168870502832, "mean_inference_ms": 10.652597387010475, "mean_action_processing_ms": 0.5322792378486855, "mean_env_wait_ms": 1.0323116211155052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8879525661468506, "StateBufferConnector_ms": 0.006773233413696289, "ViewRequirementAgentConnector_ms": 0.2653048038482666}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -709.0140579457809, "episode_reward_mean": -380.05098660368094, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-533.4338685942893, -661.5803247006892, -316.6054158901696, -497.8378253297756, -452.821477827921, -383.70901525158905, -433.15714525066477, -368.4174701534804, -396.5295143524544, -383.9329512916929, -422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7763168870502832, "mean_inference_ms": 10.652597387010475, "mean_action_processing_ms": 0.5322792378486855, "mean_env_wait_ms": 1.0323116211155052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8879525661468506, "StateBufferConnector_ms": 0.006773233413696289, "ViewRequirementAgentConnector_ms": 0.2653048038482666}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500, "num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.2017940088848205, "num_agent_steps_trained_throughput_per_sec": 5.2017940088848205, "timesteps_total": 172500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 172500, "timers": {"training_iteration_time_ms": 1437378.946, "sample_time_ms": 34527.289, "load_time_ms": 0.941, "load_throughput": 2657246.395, "learn_time_ms": 1402849.021, "learn_throughput": 1.782, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 57500, "num_env_steps_trained": 57500, "num_agent_steps_sampled": 172500, "num_agent_steps_trained": 172500}, "done": false, "episodes_total": 230, "training_iteration": 23, "trial_id": "2532e_00097", "date": "2024-03-14_02-54-04", "timestamp": 1710381244, "time_this_iter_s": 1441.8123393058777, "time_total_s": 33599.18537545204, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 33599.18537545204, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 43.481996086105674, "ram_util_percent": 14.769716242661447}, "checkpoint_dir_name": "checkpoint_000022"}
{"custom_metrics": {"collisions_mean": 66.76, "collisions_min": 20, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3862642891889696, "policy_loss": -0.01861204914066234, "vf_loss": 2.665570916697897, "vf_explained_var": 0.148345592960544, "kl": 0.0, "entropy": 24.79271491587847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40890.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -709.0140579457809, "episode_reward_mean": -368.74118370786965, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 66.76, "collisions_min": 20, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7745946164061472, "mean_inference_ms": 10.643270906953228, "mean_action_processing_ms": 0.5318923153259858, "mean_env_wait_ms": 1.0315053558777334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8897843360900879, "StateBufferConnector_ms": 0.006793022155761719, "ViewRequirementAgentConnector_ms": 0.26662468910217285}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -709.0140579457809, "episode_reward_mean": -368.74118370786965, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-422.6683803396451, -502.4381181967413, -329.6811526876398, -709.0140579457809, -550.3401898484695, -436.3977477228512, -388.90078618353465, -400.54514197240803, -442.9965817982456, -396.38686753299726, -371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7745946164061472, "mean_inference_ms": 10.643270906953228, "mean_action_processing_ms": 0.5318923153259858, "mean_env_wait_ms": 1.0315053558777334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8897843360900879, "StateBufferConnector_ms": 0.006793022155761719, "ViewRequirementAgentConnector_ms": 0.26662468910217285}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.120324668086462, "num_agent_steps_trained_throughput_per_sec": 5.120324668086462, "timesteps_total": 180000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 1438013.817, "sample_time_ms": 34522.597, "load_time_ms": 0.932, "load_throughput": 2681711.465, "learn_time_ms": 1403488.619, "learn_throughput": 1.781, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 240, "training_iteration": 24, "trial_id": "2532e_00097", "date": "2024-03-14_03-18-30", "timestamp": 1710382710, "time_this_iter_s": 1464.7529475688934, "time_total_s": 35063.938323020935, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 35063.938323020935, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 43.39638554216867, "ram_util_percent": 14.780289156626505}, "checkpoint_dir_name": "checkpoint_000023"}
{"custom_metrics": {"collisions_mean": 68.28, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3655389401756612, "policy_loss": -0.007807346127108382, "vf_loss": 2.6057467148221773, "vf_explained_var": 0.11959211843452235, "kl": 0.0, "entropy": 24.528348575241264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42630.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -356.1012545293772, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 68.28, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7730975806309686, "mean_inference_ms": 10.635228849868476, "mean_action_processing_ms": 0.5315042042735568, "mean_env_wait_ms": 1.0307933104392462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8912112712860107, "StateBufferConnector_ms": 0.006774425506591797, "ViewRequirementAgentConnector_ms": 0.26671791076660156}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -356.1012545293772, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-371.8546335137501, -458.03227859541573, -341.258759122753, -348.1410518720403, -396.28685584257056, -344.09791767046454, -371.90426545569267, -446.6817393529602, -359.25716643646285, -436.2758730335988, -330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7730975806309686, "mean_inference_ms": 10.635228849868476, "mean_action_processing_ms": 0.5315042042735568, "mean_env_wait_ms": 1.0307933104392462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8912112712860107, "StateBufferConnector_ms": 0.006774425506591797, "ViewRequirementAgentConnector_ms": 0.26671791076660156}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500, "num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.151521761712674, "num_agent_steps_trained_throughput_per_sec": 5.151521761712674, "timesteps_total": 187500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 187500, "timers": {"training_iteration_time_ms": 1437257.071, "sample_time_ms": 34524.982, "load_time_ms": 0.953, "load_throughput": 2624458.127, "learn_time_ms": 1402729.441, "learn_throughput": 1.782, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 62500, "num_env_steps_trained": 62500, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187500}, "done": false, "episodes_total": 250, "training_iteration": 25, "trial_id": "2532e_00097", "date": "2024-03-14_03-42-46", "timestamp": 1710384166, "time_this_iter_s": 1455.8826146125793, "time_total_s": 36519.820937633514, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 36519.820937633514, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 43.50450799806107, "ram_util_percent": 14.747406689287446}, "checkpoint_dir_name": "checkpoint_000024"}
{"custom_metrics": {"collisions_mean": 67.84, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.7235478610940407, "policy_loss": 0.005005529560630434, "vf_loss": 3.2607115089550787, "vf_explained_var": 0.04464777831373543, "kl": 0.0, "entropy": 24.797035000242037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44370.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -352.1987485599958, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 67.84, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7715215536833244, "mean_inference_ms": 10.626271223900996, "mean_action_processing_ms": 0.531044322727403, "mean_env_wait_ms": 1.0300728226774654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8897480964660645, "StateBufferConnector_ms": 0.006740093231201172, "ViewRequirementAgentConnector_ms": 0.26551342010498047}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -352.1987485599958, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-330.79068522803846, -316.5545705232674, -358.54376270848934, -338.0197931227848, -363.9331437181102, -398.00234272610123, -351.86522068919163, -355.9416453620637, -366.08841213043576, -312.48819749276635, -362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7715215536833244, "mean_inference_ms": 10.626271223900996, "mean_action_processing_ms": 0.531044322727403, "mean_env_wait_ms": 1.0300728226774654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8897480964660645, "StateBufferConnector_ms": 0.006740093231201172, "ViewRequirementAgentConnector_ms": 0.26551342010498047}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000, "num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.164992272060956, "num_agent_steps_trained_throughput_per_sec": 5.164992272060956, "timesteps_total": 195000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 195000, "timers": {"training_iteration_time_ms": 1438818.07, "sample_time_ms": 34408.192, "load_time_ms": 0.912, "load_throughput": 2741303.495, "learn_time_ms": 1404407.205, "learn_throughput": 1.78, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 65000, "num_env_steps_trained": 65000, "num_agent_steps_sampled": 195000, "num_agent_steps_trained": 195000}, "done": false, "episodes_total": 260, "training_iteration": 26, "trial_id": "2532e_00097", "date": "2024-03-14_04-06-59", "timestamp": 1710385619, "time_this_iter_s": 1452.0880017280579, "time_total_s": 37971.90893936157, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 37971.90893936157, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 43.390719144800784, "ram_util_percent": 14.854567541302238}, "checkpoint_dir_name": "checkpoint_000025"}
{"custom_metrics": {"collisions_mean": 65.82, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.6314138574557828, "policy_loss": 0.010629505010846274, "vf_loss": 3.0752284137339427, "vf_explained_var": 0.11127543099995317, "kl": 0.0, "entropy": 24.616966572027096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46110.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -349.9473939350975, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 65.82, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7701786565071946, "mean_inference_ms": 10.61856465502205, "mean_action_processing_ms": 0.5306097334724845, "mean_env_wait_ms": 1.0294134532285082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8904972076416016, "StateBufferConnector_ms": 0.00678253173828125, "ViewRequirementAgentConnector_ms": 0.26565980911254883}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -349.9473939350975, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-362.2134427868485, -362.41733646285417, -331.99984951369015, -445.9245432963437, -304.5465971757751, -485.23101565349106, -362.21296430637545, -340.4063851976861, -356.0763934535196, -401.0381653557759, -462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7701786565071946, "mean_inference_ms": 10.61856465502205, "mean_action_processing_ms": 0.5306097334724845, "mean_env_wait_ms": 1.0294134532285082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8904972076416016, "StateBufferConnector_ms": 0.00678253173828125, "ViewRequirementAgentConnector_ms": 0.26565980911254883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.1754561413157925, "num_agent_steps_trained_throughput_per_sec": 5.1754561413157925, "timesteps_total": 202500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 202500, "timers": {"training_iteration_time_ms": 1441440.239, "sample_time_ms": 34443.703, "load_time_ms": 0.962, "load_throughput": 2597800.02, "learn_time_ms": 1406993.801, "learn_throughput": 1.777, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 67500, "num_env_steps_trained": 67500, "num_agent_steps_sampled": 202500, "num_agent_steps_trained": 202500}, "done": false, "episodes_total": 270, "training_iteration": 27, "trial_id": "2532e_00097", "date": "2024-03-14_04-31-08", "timestamp": 1710387068, "time_this_iter_s": 1449.1497929096222, "time_total_s": 39421.058732271194, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 39421.058732271194, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 43.16879570941005, "ram_util_percent": 14.783422720624086}, "checkpoint_dir_name": "checkpoint_000026"}
{"custom_metrics": {"collisions_mean": 63.78, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.725641099785872, "policy_loss": -0.0004262045892918932, "vf_loss": 3.274989172610743, "vf_explained_var": 0.01167891244778688, "kl": 0.0, "entropy": 24.65303797667054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47850.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -342.43756134396347, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 63.78, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7691946807719439, "mean_inference_ms": 10.612459524591621, "mean_action_processing_ms": 0.5302999766344692, "mean_env_wait_ms": 1.0288622451440952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8920035362243652, "StateBufferConnector_ms": 0.006794452667236328, "ViewRequirementAgentConnector_ms": 0.26659512519836426}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -342.43756134396347, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-462.9770594917595, -337.1309722246845, -336.9893054416615, -347.8867547907142, -333.83505833979257, -370.7286754985082, -360.602957658594, -415.1008972453478, -355.9070978435849, -435.8725119300033, -344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7691946807719439, "mean_inference_ms": 10.612459524591621, "mean_action_processing_ms": 0.5302999766344692, "mean_env_wait_ms": 1.0288622451440952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8920035362243652, "StateBufferConnector_ms": 0.006794452667236328, "ViewRequirementAgentConnector_ms": 0.26659512519836426}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000, "num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.153613415126129, "num_agent_steps_trained_throughput_per_sec": 5.153613415126129, "timesteps_total": 210000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 210000, "timers": {"training_iteration_time_ms": 1443525.872, "sample_time_ms": 34509.529, "load_time_ms": 0.942, "load_throughput": 2654219.612, "learn_time_ms": 1409013.609, "learn_throughput": 1.774, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 70000, "num_env_steps_trained": 70000, "num_agent_steps_sampled": 210000, "num_agent_steps_trained": 210000}, "done": false, "episodes_total": 280, "training_iteration": 28, "trial_id": "2532e_00097", "date": "2024-03-14_04-55-24", "timestamp": 1710388524, "time_this_iter_s": 1455.2917747497559, "time_total_s": 40876.35050702095, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 40876.35050702095, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 43.43949539058709, "ram_util_percent": 14.914847161572055}, "checkpoint_dir_name": "checkpoint_000027"}
{"custom_metrics": {"collisions_mean": 63.64, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.6061802666032172, "policy_loss": 0.017790588386485288, "vf_loss": 3.013763713151559, "vf_explained_var": 0.09042818053015347, "kl": 0.0, "entropy": 24.789763503239072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49590.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -334.37595517041, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 63.64, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7684095638762007, "mean_inference_ms": 10.607361516731487, "mean_action_processing_ms": 0.5300361664770677, "mean_env_wait_ms": 1.028372832234578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8921163082122803, "StateBufferConnector_ms": 0.0068035125732421875, "ViewRequirementAgentConnector_ms": 0.26700830459594727}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -334.37595517041, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-344.8193213611995, -455.4496013282062, -345.98455258797503, -429.736092832105, -325.0059671835693, -455.2894075469069, -453.77237883891587, -302.14707286803156, -426.8534485772266, -387.8324637460173, -315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7684095638762007, "mean_inference_ms": 10.607361516731487, "mean_action_processing_ms": 0.5300361664770677, "mean_env_wait_ms": 1.028372832234578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8921163082122803, "StateBufferConnector_ms": 0.0068035125732421875, "ViewRequirementAgentConnector_ms": 0.26700830459594727}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500, "num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.19700900022917, "num_agent_steps_trained_throughput_per_sec": 5.19700900022917, "timesteps_total": 217500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 217500, "timers": {"training_iteration_time_ms": 1445301.712, "sample_time_ms": 34544.719, "load_time_ms": 0.98, "load_throughput": 2550783.303, "learn_time_ms": 1410754.226, "learn_throughput": 1.772, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 72500, "num_env_steps_trained": 72500, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217500}, "done": false, "episodes_total": 290, "training_iteration": 29, "trial_id": "2532e_00097", "date": "2024-03-14_05-19-28", "timestamp": 1710389968, "time_this_iter_s": 1443.14000082016, "time_total_s": 42319.49050784111, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 42319.49050784111, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 43.47096774193549, "ram_util_percent": 14.839540566959926}, "checkpoint_dir_name": "checkpoint_000028"}
{"custom_metrics": {"collisions_mean": 62.36, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.5243843140115363, "policy_loss": 0.017777960280748618, "vf_loss": 2.8585904315627855, "vf_explained_var": 0.045453663461509794, "kl": 0.0, "entropy": 24.81327380695562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51330.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "sampler_results": {"episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -325.3845422802657, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 62.36, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7676737589020264, "mean_inference_ms": 10.602570673781768, "mean_action_processing_ms": 0.5297911718443834, "mean_env_wait_ms": 1.0278891048325585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8911089897155762, "StateBufferConnector_ms": 0.0067844390869140625, "ViewRequirementAgentConnector_ms": 0.2665231227874756}}, "episode_reward_max": -245.81435932698884, "episode_reward_min": -551.0754313079349, "episode_reward_mean": -325.3845422802657, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-315.064653745783, -340.4885678819773, -348.75000786710655, -357.0675778634326, -551.0754313079349, -315.5696600577398, -323.76881060985374, -361.14123843291884, -336.80829820200955, -245.81435932698884, -356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7676737589020264, "mean_inference_ms": 10.602570673781768, "mean_action_processing_ms": 0.5297911718443834, "mean_env_wait_ms": 1.0278891048325585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8911089897155762, "StateBufferConnector_ms": 0.0067844390869140625, "ViewRequirementAgentConnector_ms": 0.2665231227874756}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000, "num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.211294386414298, "num_agent_steps_trained_throughput_per_sec": 5.211294386414298, "timesteps_total": 225000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 225000, "timers": {"training_iteration_time_ms": 1446142.335, "sample_time_ms": 34524.071, "load_time_ms": 0.94, "load_throughput": 2659065.781, "learn_time_ms": 1411615.513, "learn_throughput": 1.771, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 75000, "num_env_steps_trained": 75000, "num_agent_steps_sampled": 225000, "num_agent_steps_trained": 225000}, "done": false, "episodes_total": 300, "training_iteration": 30, "trial_id": "2532e_00097", "date": "2024-03-14_05-43-28", "timestamp": 1710391408, "time_this_iter_s": 1439.1839385032654, "time_total_s": 43758.674446344376, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 43758.674446344376, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 43.5984811366977, "ram_util_percent": 14.914012738853506}, "checkpoint_dir_name": "checkpoint_000029"}
{"custom_metrics": {"collisions_mean": 63.48, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.5742683510317457, "policy_loss": 0.012500313594910563, "vf_loss": 2.9632525957863907, "vf_explained_var": 0.07402068592351059, "kl": 0.0, "entropy": 24.714299310486894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53070.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "sampler_results": {"episode_reward_max": -247.6224057443592, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -321.3236315903308, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 63.48, "collisions_min": 16, "collisions_max": 154, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.767045212396349, "mean_inference_ms": 10.598520518449511, "mean_action_processing_ms": 0.5295910339552731, "mean_env_wait_ms": 1.0274134275275373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8881750106811523, "StateBufferConnector_ms": 0.006756782531738281, "ViewRequirementAgentConnector_ms": 0.2660210132598877}}, "episode_reward_max": -247.6224057443592, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -321.3236315903308, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-356.34255066308225, -344.47195430057104, -448.414120995311, -338.75077014289974, -337.3507165488304, -321.09884698020375, -339.05679601110603, -304.9479453282289, -353.6171037641381, -343.2913685257781, -324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.767045212396349, "mean_inference_ms": 10.598520518449511, "mean_action_processing_ms": 0.5295910339552731, "mean_env_wait_ms": 1.0274134275275373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8881750106811523, "StateBufferConnector_ms": 0.006756782531738281, "ViewRequirementAgentConnector_ms": 0.2660210132598877}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500, "num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.208181418356492, "num_agent_steps_trained_throughput_per_sec": 5.208181418356492, "timesteps_total": 232500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 232500, "timers": {"training_iteration_time_ms": 1447299.033, "sample_time_ms": 34555.19, "load_time_ms": 0.971, "load_throughput": 2574835.478, "learn_time_ms": 1412740.995, "learn_throughput": 1.77, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 77500, "num_env_steps_trained": 77500, "num_agent_steps_sampled": 232500, "num_agent_steps_trained": 232500}, "done": false, "episodes_total": 310, "training_iteration": 31, "trial_id": "2532e_00097", "date": "2024-03-14_06-07-28", "timestamp": 1710392848, "time_this_iter_s": 1440.0442769527435, "time_total_s": 45198.71872329712, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 45198.71872329712, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 43.58211660950515, "ram_util_percent": 14.800097991180797}, "checkpoint_dir_name": "checkpoint_000030"}
{"custom_metrics": {"collisions_mean": 62.4, "collisions_min": 16, "collisions_max": 136, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.6146727548352169, "policy_loss": 0.006135261564076632, "vf_loss": 3.051991576984011, "vf_explained_var": 0.11312210402269474, "kl": 0.0, "entropy": 24.69390521213926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54810.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": -237.83951777689427, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -316.01484013803275, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 62.4, "collisions_min": 16, "collisions_max": 136, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7665144157215382, "mean_inference_ms": 10.59483208590217, "mean_action_processing_ms": 0.5294254621121641, "mean_env_wait_ms": 1.0269609679975216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8900027275085449, "StateBufferConnector_ms": 0.00674891471862793, "ViewRequirementAgentConnector_ms": 0.26615166664123535}}, "episode_reward_max": -237.83951777689427, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -316.01484013803275, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-324.8531443139141, -299.13062231026754, -354.0605751266794, -270.04456950324163, -320.9767587000303, -317.0545147861246, -300.83190613475324, -345.0178147708631, -314.1038857056065, -366.7334524555658, -268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7665144157215382, "mean_inference_ms": 10.59483208590217, "mean_action_processing_ms": 0.5294254621121641, "mean_env_wait_ms": 1.0269609679975216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8900027275085449, "StateBufferConnector_ms": 0.00674891471862793, "ViewRequirementAgentConnector_ms": 0.26615166664123535}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.225008448158195, "num_agent_steps_trained_throughput_per_sec": 5.225008448158195, "timesteps_total": 240000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 1447672.791, "sample_time_ms": 34563.91, "load_time_ms": 0.924, "load_throughput": 2705723.28, "learn_time_ms": 1413106.078, "learn_throughput": 1.769, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 320, "training_iteration": 32, "trial_id": "2532e_00097", "date": "2024-03-14_06-31-24", "timestamp": 1710394284, "time_this_iter_s": 1435.4065907001495, "time_total_s": 46634.12531399727, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 46634.12531399727, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 43.57832923832924, "ram_util_percent": 14.740540540540541}, "checkpoint_dir_name": "checkpoint_000031"}
{"custom_metrics": {"collisions_mean": 61.94, "collisions_min": 16, "collisions_max": 136, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.513628239872405, "policy_loss": 0.013093368553599322, "vf_loss": 2.847070582330912, "vf_explained_var": 0.1299921445805451, "kl": 0.0, "entropy": 24.58372259468868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56550.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500}, "sampler_results": {"episode_reward_max": -237.83951777689427, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -314.65051147151627, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 61.94, "collisions_min": 16, "collisions_max": 136, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7659524470995478, "mean_inference_ms": 10.590115623110075, "mean_action_processing_ms": 0.5292379967786607, "mean_env_wait_ms": 1.0265190599534122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8895306587219238, "StateBufferConnector_ms": 0.0067484378814697266, "ViewRequirementAgentConnector_ms": 0.26584696769714355}}, "episode_reward_max": -237.83951777689427, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -314.65051147151627, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-268.8922080047351, -317.2575642659609, -344.17504122098705, -294.90996237260043, -373.67006405198623, -306.8238206102636, -314.2948212697291, -314.95254447386344, -286.3564769640616, -475.7122158274016, -345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7659524470995478, "mean_inference_ms": 10.590115623110075, "mean_action_processing_ms": 0.5292379967786607, "mean_env_wait_ms": 1.0265190599534122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8895306587219238, "StateBufferConnector_ms": 0.0067484378814697266, "ViewRequirementAgentConnector_ms": 0.26584696769714355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500, "num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.300591592974992, "num_agent_steps_trained_throughput_per_sec": 5.300591592974992, "timesteps_total": 247500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 247500, "timers": {"training_iteration_time_ms": 1444985.405, "sample_time_ms": 34465.017, "load_time_ms": 0.965, "load_throughput": 2590611.721, "learn_time_ms": 1410517.544, "learn_throughput": 1.772, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 82500, "num_env_steps_trained": 82500, "num_agent_steps_sampled": 247500, "num_agent_steps_trained": 247500}, "done": false, "episodes_total": 330, "training_iteration": 33, "trial_id": "2532e_00097", "date": "2024-03-14_06-54-59", "timestamp": 1710395699, "time_this_iter_s": 1414.9385001659393, "time_total_s": 48049.06381416321, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 48049.06381416321, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 43.07299451918286, "ram_util_percent": 15.085849526656704}, "checkpoint_dir_name": "checkpoint_000032"}
{"custom_metrics": {"collisions_mean": 64.16, "collisions_min": 16, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.5888219591915265, "policy_loss": 0.009393128241283884, "vf_loss": 2.996761665176386, "vf_explained_var": 0.06109852533915947, "kl": 0.0, "entropy": 24.589062627156576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58290.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "sampler_results": {"episode_reward_max": -237.83951777689427, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -310.84789115930533, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 64.16, "collisions_min": 16, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7652993770497993, "mean_inference_ms": 10.584744177258, "mean_action_processing_ms": 0.5290239353249129, "mean_env_wait_ms": 1.0260709029937392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8878579139709473, "StateBufferConnector_ms": 0.006689310073852539, "ViewRequirementAgentConnector_ms": 0.2648179531097412}}, "episode_reward_max": -237.83951777689427, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -310.84789115930533, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-345.9017221051953, -351.6191474984161, -311.8571865504218, -296.6257834618189, -309.3542504922964, -319.41434087100697, -285.1039570804213, -356.9654284229116, -371.2094264791598, -367.3248634174248, -310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7652993770497993, "mean_inference_ms": 10.584744177258, "mean_action_processing_ms": 0.5290239353249129, "mean_env_wait_ms": 1.0260709029937392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8878579139709473, "StateBufferConnector_ms": 0.006689310073852539, "ViewRequirementAgentConnector_ms": 0.2648179531097412}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000, "num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.3281414017963655, "num_agent_steps_trained_throughput_per_sec": 5.3281414017963655, "timesteps_total": 255000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 255000, "timers": {"training_iteration_time_ms": 1439272.348, "sample_time_ms": 34382.904, "load_time_ms": 0.966, "load_throughput": 2588181.863, "learn_time_ms": 1404886.572, "learn_throughput": 1.78, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 85000, "num_env_steps_trained": 85000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "done": false, "episodes_total": 340, "training_iteration": 34, "trial_id": "2532e_00097", "date": "2024-03-14_07-18-29", "timestamp": 1710397109, "time_this_iter_s": 1407.6224834918976, "time_total_s": 49456.686297655106, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 49456.686297655106, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 43.91060530265132, "ram_util_percent": 15.235567783891945}, "checkpoint_dir_name": "checkpoint_000033"}
{"custom_metrics": {"collisions_mean": 63.4, "collisions_min": 18, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.7299390357581834, "policy_loss": 0.011243001546378879, "vf_loss": 3.261003143965513, "vf_explained_var": 0.0009842757863559942, "kl": 0.0, "entropy": 24.76642459233602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60030.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500}, "sampler_results": {"episode_reward_max": -233.68168871078072, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -309.7182311665658, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 63.4, "collisions_min": 18, "collisions_max": 138, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7646182666949994, "mean_inference_ms": 10.579562005837804, "mean_action_processing_ms": 0.5288389384688789, "mean_env_wait_ms": 1.0256370988068237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8852903842926025, "StateBufferConnector_ms": 0.006803274154663086, "ViewRequirementAgentConnector_ms": 0.26451706886291504}}, "episode_reward_max": -233.68168871078072, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -309.7182311665658, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-310.3391703077409, -366.63131718227186, -267.11685340257645, -443.9610311786786, -333.1209754410698, -370.07564876189, -426.47970184061813, -342.2295853643237, -320.99354653434784, -302.5921139440576, -368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7646182666949994, "mean_inference_ms": 10.579562005837804, "mean_action_processing_ms": 0.5288389384688789, "mean_env_wait_ms": 1.0256370988068237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8852903842926025, "StateBufferConnector_ms": 0.006803274154663086, "ViewRequirementAgentConnector_ms": 0.26451706886291504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500, "num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.341203285187823, "num_agent_steps_trained_throughput_per_sec": 5.341203285187823, "timesteps_total": 262500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 262500, "timers": {"training_iteration_time_ms": 1434102.097, "sample_time_ms": 34357.422, "load_time_ms": 0.946, "load_throughput": 2642247.701, "learn_time_ms": 1399741.823, "learn_throughput": 1.786, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 87500, "num_env_steps_trained": 87500, "num_agent_steps_sampled": 262500, "num_agent_steps_trained": 262500}, "done": false, "episodes_total": 350, "training_iteration": 35, "trial_id": "2532e_00097", "date": "2024-03-14_07-41-54", "timestamp": 1710398514, "time_this_iter_s": 1404.1801164150238, "time_total_s": 50860.86641407013, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 50860.86641407013, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 45.62309236947791, "ram_util_percent": 16.774899598393578}, "checkpoint_dir_name": "checkpoint_000034"}
{"custom_metrics": {"collisions_mean": 62.88, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4223932309418745, "policy_loss": -0.005563932566785778, "vf_loss": 2.7093637937615656, "vf_explained_var": 0.0931633304247911, "kl": 0.0, "entropy": 24.755821110736363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61770.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": -205.76873019077934, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -303.30949312460046, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 62.88, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7639712703509058, "mean_inference_ms": 10.575046246720536, "mean_action_processing_ms": 0.528696330909553, "mean_env_wait_ms": 1.0252375610998934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8837587833404541, "StateBufferConnector_ms": 0.006791353225708008, "ViewRequirementAgentConnector_ms": 0.2647697925567627}}, "episode_reward_max": -205.76873019077934, "episode_reward_min": -486.65332957181926, "episode_reward_mean": -303.30949312460046, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-368.3339325238695, -486.65332957181926, -283.7584898232193, -297.619831351787, -318.3272371096484, -330.90653495112883, -269.580743022398, -292.24646068246807, -333.8993102888809, -285.7664418861927, -313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7639712703509058, "mean_inference_ms": 10.575046246720536, "mean_action_processing_ms": 0.528696330909553, "mean_env_wait_ms": 1.0252375610998934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8837587833404541, "StateBufferConnector_ms": 0.006791353225708008, "ViewRequirementAgentConnector_ms": 0.2647697925567627}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.350114382750418, "num_agent_steps_trained_throughput_per_sec": 5.350114382750418, "timesteps_total": 270000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 1429077.669, "sample_time_ms": 34364.704, "load_time_ms": 0.945, "load_throughput": 2645914.711, "learn_time_ms": 1394710.2, "learn_throughput": 1.792, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 360, "training_iteration": 36, "trial_id": "2532e_00097", "date": "2024-03-14_08-05-17", "timestamp": 1710399917, "time_this_iter_s": 1401.8412578105927, "time_total_s": 52262.70767188072, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 52262.70767188072, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 45.530050251256284, "ram_util_percent": 16.847035175879398}, "checkpoint_dir_name": "checkpoint_000035"}
{"custom_metrics": {"collisions_mean": 64.4, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3565694579439795, "policy_loss": 0.011437847368397761, "vf_loss": 2.5522130313960987, "vf_explained_var": 0.04629262209623709, "kl": 0.0, "entropy": 24.89378383132233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63510.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500}, "sampler_results": {"episode_reward_max": -205.76873019077934, "episode_reward_min": -457.1408195713576, "episode_reward_mean": -300.0134533047495, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 64.4, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7632168136362538, "mean_inference_ms": 10.569935262677697, "mean_action_processing_ms": 0.5285136506423764, "mean_env_wait_ms": 1.0247992311104617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8814547061920166, "StateBufferConnector_ms": 0.0067408084869384766, "ViewRequirementAgentConnector_ms": 0.263688325881958}}, "episode_reward_max": -205.76873019077934, "episode_reward_min": -457.1408195713576, "episode_reward_mean": -300.0134533047495, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-313.2267228327648, -344.31403463123803, -330.3432095884479, -271.1163289239612, -340.31064773719976, -257.4938488995888, -291.273675238122, -322.87598568410596, -261.3041932015424, -268.82478735197606, -247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7632168136362538, "mean_inference_ms": 10.569935262677697, "mean_action_processing_ms": 0.5285136506423764, "mean_env_wait_ms": 1.0247992311104617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8814547061920166, "StateBufferConnector_ms": 0.0067408084869384766, "ViewRequirementAgentConnector_ms": 0.263688325881958}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500, "num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.326175512011664, "num_agent_steps_trained_throughput_per_sec": 5.326175512011664, "timesteps_total": 277500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 277500, "timers": {"training_iteration_time_ms": 1424976.892, "sample_time_ms": 34275.845, "load_time_ms": 0.89, "load_throughput": 2809990.353, "learn_time_ms": 1390698.35, "learn_throughput": 1.798, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 92500, "num_env_steps_trained": 92500, "num_agent_steps_sampled": 277500, "num_agent_steps_trained": 277500}, "done": false, "episodes_total": 370, "training_iteration": 37, "trial_id": "2532e_00097", "date": "2024-03-14_08-28-45", "timestamp": 1710401325, "time_this_iter_s": 1408.1419870853424, "time_total_s": 53670.849658966064, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 53670.849658966064, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 45.38458458458459, "ram_util_percent": 16.908458458458462}, "checkpoint_dir_name": "checkpoint_000036"}
{"custom_metrics": {"collisions_mean": 65.96, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.1981472229392365, "policy_loss": 0.019233336401889206, "vf_loss": 2.2368364239646787, "vf_explained_var": 0.09914583745359004, "kl": 0.0, "entropy": 24.850080387071632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65250.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "sampler_results": {"episode_reward_max": -205.76873019077934, "episode_reward_min": -457.1408195713576, "episode_reward_mean": -296.4835972930052, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 65.96, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7623797784129065, "mean_inference_ms": 10.564644095121514, "mean_action_processing_ms": 0.528293881608873, "mean_env_wait_ms": 1.0243430928483417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.88134765625, "StateBufferConnector_ms": 0.006750345230102539, "ViewRequirementAgentConnector_ms": 0.26331520080566406}}, "episode_reward_max": -205.76873019077934, "episode_reward_min": -457.1408195713576, "episode_reward_mean": -296.4835972930052, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-247.6224057443592, -295.3822508982982, -275.29183437185924, -307.44186313733195, -391.0842346985079, -286.2262509667724, -277.04508629604356, -321.70885080047515, -284.2980470812765, -264.7698491143885, -299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7623797784129065, "mean_inference_ms": 10.564644095121514, "mean_action_processing_ms": 0.528293881608873, "mean_env_wait_ms": 1.0243430928483417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.88134765625, "StateBufferConnector_ms": 0.006750345230102539, "ViewRequirementAgentConnector_ms": 0.26331520080566406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000, "num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.223723365783373, "num_agent_steps_trained_throughput_per_sec": 5.223723365783373, "timesteps_total": 285000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 285000, "timers": {"training_iteration_time_ms": 1423023.683, "sample_time_ms": 34220.092, "load_time_ms": 0.878, "load_throughput": 2846452.033, "learn_time_ms": 1388800.923, "learn_throughput": 1.8, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 95000, "num_env_steps_trained": 95000, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 285000}, "done": false, "episodes_total": 380, "training_iteration": 38, "trial_id": "2532e_00097", "date": "2024-03-14_08-52-42", "timestamp": 1710402762, "time_this_iter_s": 1435.759581565857, "time_total_s": 55106.60924053192, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 55106.60924053192, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 47.3533398821218, "ram_util_percent": 17.942043222003928}, "checkpoint_dir_name": "checkpoint_000037"}
{"custom_metrics": {"collisions_mean": 64.96, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3047287559144778, "policy_loss": 0.013190878156690334, "vf_loss": 2.4505258698230503, "vf_explained_var": 0.09749690893737749, "kl": 0.0, "entropy": 24.810402341820726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66990.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500}, "sampler_results": {"episode_reward_max": -205.76873019077934, "episode_reward_min": -457.1408195713576, "episode_reward_mean": -295.26734477961975, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 64.96, "collisions_min": 12, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.761518445984629, "mean_inference_ms": 10.559389648468452, "mean_action_processing_ms": 0.5280720175300091, "mean_env_wait_ms": 1.023898449173179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8810806274414062, "StateBufferConnector_ms": 0.006747722625732422, "ViewRequirementAgentConnector_ms": 0.2630596160888672}}, "episode_reward_max": -205.76873019077934, "episode_reward_min": -457.1408195713576, "episode_reward_mean": -295.26734477961975, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-299.4182525668841, -457.1408195713576, -270.4719261795896, -300.0241921601693, -267.57782694693, -279.62632333514904, -295.06540035803823, -333.3392937996104, -276.1899885747811, -248.8949943632158, -296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.761518445984629, "mean_inference_ms": 10.559389648468452, "mean_action_processing_ms": 0.5280720175300091, "mean_env_wait_ms": 1.023898449173179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8810806274414062, "StateBufferConnector_ms": 0.006747722625732422, "ViewRequirementAgentConnector_ms": 0.2630596160888672}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500, "num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.209137187038119, "num_agent_steps_trained_throughput_per_sec": 5.209137187038119, "timesteps_total": 292500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 292500, "timers": {"training_iteration_time_ms": 1422687.684, "sample_time_ms": 34197.105, "load_time_ms": 0.82, "load_throughput": 3050314.173, "learn_time_ms": 1388487.984, "learn_throughput": 1.801, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 97500, "num_env_steps_trained": 97500, "num_agent_steps_sampled": 292500, "num_agent_steps_trained": 292500}, "done": false, "episodes_total": 390, "training_iteration": 39, "trial_id": "2532e_00097", "date": "2024-03-14_09-16-42", "timestamp": 1710404202, "time_this_iter_s": 1439.779844045639, "time_total_s": 56546.38908457756, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 56546.38908457756, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 47.73366045142297, "ram_util_percent": 18.620608439646713}, "checkpoint_dir_name": "checkpoint_000038"}
{"custom_metrics": {"collisions_mean": 64.02, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.259196553786617, "policy_loss": 0.019264140317280746, "vf_loss": 2.3526111817736735, "vf_explained_var": 0.04570084515659288, "kl": 0.0, "entropy": 24.771206275896095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68730.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -166.1574893732168, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -290.90289885654164, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 64.02, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7607395250802818, "mean_inference_ms": 10.55474973390716, "mean_action_processing_ms": 0.5278769429532205, "mean_env_wait_ms": 1.0235251904580285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.881842851638794, "StateBufferConnector_ms": 0.006743907928466797, "ViewRequirementAgentConnector_ms": 0.2632138729095459}}, "episode_reward_max": -166.1574893732168, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -290.90289885654164, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-296.00608737729385, -314.84341777764587, -291.8748324241931, -380.19356721445746, -272.59523464141836, -338.9398100337736, -313.91692705924385, -315.8880917832933, -297.83285437491014, -267.36671361603067, -247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7607395250802818, "mean_inference_ms": 10.55474973390716, "mean_action_processing_ms": 0.5278769429532205, "mean_env_wait_ms": 1.0235251904580285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.881842851638794, "StateBufferConnector_ms": 0.006743907928466797, "ViewRequirementAgentConnector_ms": 0.2632138729095459}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.192456548605276, "num_agent_steps_trained_throughput_per_sec": 5.192456548605276, "timesteps_total": 300000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 1423209.809, "sample_time_ms": 34235.995, "load_time_ms": 0.815, "load_throughput": 3066011.696, "learn_time_ms": 1388971.208, "learn_throughput": 1.8, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 400, "training_iteration": 40, "trial_id": "2532e_00097", "date": "2024-03-14_09-40-47", "timestamp": 1710405647, "time_this_iter_s": 1444.4051876068115, "time_total_s": 57990.79427218437, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 57990.79427218437, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 49.22804103566194, "ram_util_percent": 18.444259892525647}, "checkpoint_dir_name": "checkpoint_000039"}
{"custom_metrics": {"collisions_mean": 64.5, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.5119243121296488, "policy_loss": 0.018013015888021167, "vf_loss": 2.8345032051376915, "vf_explained_var": 0.03121369172786844, "kl": 0.0, "entropy": 24.847348521221644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70470.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500}, "sampler_results": {"episode_reward_max": -166.1574893732168, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -289.6670024709667, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 64.5, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7599553126630405, "mean_inference_ms": 10.550097982577242, "mean_action_processing_ms": 0.52767248021059, "mean_env_wait_ms": 1.0231572439470817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8826634883880615, "StateBufferConnector_ms": 0.0067539215087890625, "ViewRequirementAgentConnector_ms": 0.263608455657959}}, "episode_reward_max": -166.1574893732168, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -289.6670024709667, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-247.69905579224837, -309.0563774131428, -237.83951777689427, -290.16107442175706, -251.24118766470718, -294.0689144921079, -320.69779887333897, -307.4444072331217, -402.3155258940554, -295.9391684689705, -359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7599553126630405, "mean_inference_ms": 10.550097982577242, "mean_action_processing_ms": 0.52767248021059, "mean_env_wait_ms": 1.0231572439470817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8826634883880615, "StateBufferConnector_ms": 0.0067539215087890625, "ViewRequirementAgentConnector_ms": 0.263608455657959}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500, "num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.171731383741398, "num_agent_steps_trained_throughput_per_sec": 5.171731383741398, "timesteps_total": 307500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 307500, "timers": {"training_iteration_time_ms": 1424224.741, "sample_time_ms": 34217.037, "load_time_ms": 0.782, "load_throughput": 3198438.263, "learn_time_ms": 1390005.116, "learn_throughput": 1.799, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 102500, "num_env_steps_trained": 102500, "num_agent_steps_sampled": 307500, "num_agent_steps_trained": 307500}, "done": false, "episodes_total": 410, "training_iteration": 41, "trial_id": "2532e_00097", "date": "2024-03-14_10-04-58", "timestamp": 1710407098, "time_this_iter_s": 1450.1935787200928, "time_total_s": 59440.987850904465, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 59440.987850904465, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 48.823830409356724, "ram_util_percent": 18.474415204678362}, "checkpoint_dir_name": "checkpoint_000040"}
{"custom_metrics": {"collisions_mean": 61.88, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.1654534655256497, "policy_loss": 0.01707350260380056, "vf_loss": 2.1789022604538792, "vf_explained_var": 0.024769699607772387, "kl": 0.0, "entropy": 24.681632246916323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72210.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000}, "sampler_results": {"episode_reward_max": -157.44425964314343, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -283.0387826355416, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 61.88, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7592205447756037, "mean_inference_ms": 10.54597746490558, "mean_action_processing_ms": 0.5274984414827424, "mean_env_wait_ms": 1.0228431697365463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8811569213867188, "StateBufferConnector_ms": 0.006800651550292969, "ViewRequirementAgentConnector_ms": 0.26359105110168457}}, "episode_reward_max": -157.44425964314343, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -283.0387826355416, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-359.8762379136346, -346.5189764149769, -395.8216099094388, -264.5208848447084, -304.79435333732147, -327.44600608037473, -255.93335606453985, -262.6797898879333, -304.9391986989615, -253.84396400350226, -333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7592205447756037, "mean_inference_ms": 10.54597746490558, "mean_action_processing_ms": 0.5274984414827424, "mean_env_wait_ms": 1.0228431697365463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8811569213867188, "StateBufferConnector_ms": 0.006800651550292969, "ViewRequirementAgentConnector_ms": 0.26359105110168457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000, "num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.175386386195606, "num_agent_steps_trained_throughput_per_sec": 5.175386386195606, "timesteps_total": 315000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 315000, "timers": {"training_iteration_time_ms": 1425601.019, "sample_time_ms": 34264.861, "load_time_ms": 0.824, "load_throughput": 3033898.501, "learn_time_ms": 1391333.517, "learn_throughput": 1.797, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 105000, "num_env_steps_trained": 105000, "num_agent_steps_sampled": 315000, "num_agent_steps_trained": 315000}, "done": false, "episodes_total": 420, "training_iteration": 42, "trial_id": "2532e_00097", "date": "2024-03-14_10-29-08", "timestamp": 1710408548, "time_this_iter_s": 1449.1693017482758, "time_total_s": 60890.15715265274, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 60890.15715265274, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 46.13281402142161, "ram_util_percent": 16.177458617332036}, "checkpoint_dir_name": "checkpoint_000041"}
{"custom_metrics": {"collisions_mean": 61.6, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3564073797154785, "policy_loss": 0.010968938627181275, "vf_loss": 2.552795198251461, "vf_explained_var": 0.04359726570118433, "kl": 0.0, "entropy": 24.64583452487814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73950.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500}, "sampler_results": {"episode_reward_max": -157.44425964314343, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -279.8541991897632, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 61.6, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7584807336538577, "mean_inference_ms": 10.541800915231486, "mean_action_processing_ms": 0.5273111248099549, "mean_env_wait_ms": 1.0225305198076824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8818750381469727, "StateBufferConnector_ms": 0.0068073272705078125, "ViewRequirementAgentConnector_ms": 0.2634437084197998}}, "episode_reward_max": -157.44425964314343, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -279.8541991897632, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-333.2544460124531, -291.715735420167, -286.67616660110855, -339.80794800353453, -265.4323277026667, -318.8000103179633, -279.99341695197484, -269.0084254097285, -256.8600339817174, -275.234177439179, -272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7584807336538577, "mean_inference_ms": 10.541800915231486, "mean_action_processing_ms": 0.5273111248099549, "mean_env_wait_ms": 1.0225305198076824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8818750381469727, "StateBufferConnector_ms": 0.0068073272705078125, "ViewRequirementAgentConnector_ms": 0.2634437084197998}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500, "num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.174994308227302, "num_agent_steps_trained_throughput_per_sec": 5.174994308227302, "timesteps_total": 322500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 322500, "timers": {"training_iteration_time_ms": 1429035.072, "sample_time_ms": 34218.575, "load_time_ms": 0.792, "load_throughput": 3155984.951, "learn_time_ms": 1394813.85, "learn_throughput": 1.792, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 107500, "num_env_steps_trained": 107500, "num_agent_steps_sampled": 322500, "num_agent_steps_trained": 322500}, "done": false, "episodes_total": 430, "training_iteration": 43, "trial_id": "2532e_00097", "date": "2024-03-14_10-53-18", "timestamp": 1710409998, "time_this_iter_s": 1449.279352903366, "time_total_s": 62339.43650555611, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 62339.43650555611, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 53.01335282651072, "ram_util_percent": 19.55477582846004}, "checkpoint_dir_name": "checkpoint_000042"}
{"custom_metrics": {"collisions_mean": 58.48, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.2527874141576936, "policy_loss": 0.02399171601724008, "vf_loss": 2.3314807046247625, "vf_explained_var": 0.00897506725514072, "kl": 0.0, "entropy": 24.721597376637074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75690.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000}, "sampler_results": {"episode_reward_max": -157.44425964314343, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -275.7597011350608, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 58.48, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7577710765873977, "mean_inference_ms": 10.538019791030488, "mean_action_processing_ms": 0.5271359606482531, "mean_env_wait_ms": 1.0222448172473049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8815047740936279, "StateBufferConnector_ms": 0.00680851936340332, "ViewRequirementAgentConnector_ms": 0.26271843910217285}}, "episode_reward_max": -157.44425964314343, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -275.7597011350608, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-272.8739442904917, -287.2684009251274, -316.4902859270356, -329.6770388219701, -233.68168871078072, -404.3353851518832, -262.48433914062053, -363.40483782645697, -408.27818087843804, -323.916005432313, -239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7577710765873977, "mean_inference_ms": 10.538019791030488, "mean_action_processing_ms": 0.5271359606482531, "mean_env_wait_ms": 1.0222448172473049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8815047740936279, "StateBufferConnector_ms": 0.00680851936340332, "ViewRequirementAgentConnector_ms": 0.26271843910217285}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000, "num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.228122544510812, "num_agent_steps_trained_throughput_per_sec": 5.228122544510812, "timesteps_total": 330000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 330000, "timers": {"training_iteration_time_ms": 1431727.982, "sample_time_ms": 34236.012, "load_time_ms": 0.856, "load_throughput": 2921719.747, "learn_time_ms": 1397489.257, "learn_throughput": 1.789, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 110000, "num_env_steps_trained": 110000, "num_agent_steps_sampled": 330000, "num_agent_steps_trained": 330000}, "done": false, "episodes_total": 440, "training_iteration": 44, "trial_id": "2532e_00097", "date": "2024-03-14_11-17-13", "timestamp": 1710411433, "time_this_iter_s": 1434.551435470581, "time_total_s": 63773.98794102669, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 63773.98794102669, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 44.95174618789965, "ram_util_percent": 15.99247417609444}, "checkpoint_dir_name": "checkpoint_000043"}
{"custom_metrics": {"collisions_mean": 55.6, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.2863537502319862, "policy_loss": -0.0034963247793105743, "vf_loss": 2.4473234684302887, "vf_explained_var": 0.09205453368439072, "kl": 0.0, "entropy": 24.866225774260773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77430.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 112500, "num_env_steps_trained": 112500, "num_agent_steps_sampled": 337500, "num_agent_steps_trained": 337500}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -268.31290273190655, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.6, "collisions_min": 0, "collisions_max": 256, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7571881185682907, "mean_inference_ms": 10.535041627864327, "mean_action_processing_ms": 0.5270048237715463, "mean_env_wait_ms": 1.0220315388165213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8835113048553467, "StateBufferConnector_ms": 0.006718158721923828, "ViewRequirementAgentConnector_ms": 0.26354360580444336}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -443.99296804492644, "episode_reward_mean": -268.31290273190655, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-239.53420582123303, -274.4943475740364, -303.15632552684013, -205.76873019077934, -265.67454941822297, -251.77592067973606, -254.44431676333858, -350.51477942881354, -253.30999631311323, -443.99296804492644, -305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7571881185682907, "mean_inference_ms": 10.535041627864327, "mean_action_processing_ms": 0.5270048237715463, "mean_env_wait_ms": 1.0220315388165213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8835113048553467, "StateBufferConnector_ms": 0.006718158721923828, "ViewRequirementAgentConnector_ms": 0.26354360580444336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337500, "num_agent_steps_trained": 337500, "num_env_steps_sampled": 112500, "num_env_steps_trained": 112500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.048504835416962, "num_agent_steps_trained_throughput_per_sec": 5.048504835416962, "timesteps_total": 337500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 337500, "timers": {"training_iteration_time_ms": 1439869.02, "sample_time_ms": 34319.859, "load_time_ms": 0.827, "load_throughput": 3022181.231, "learn_time_ms": 1405546.488, "learn_throughput": 1.779, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 112500, "num_env_steps_trained": 112500, "num_agent_steps_sampled": 337500, "num_agent_steps_trained": 337500}, "done": false, "episodes_total": 450, "training_iteration": 45, "trial_id": "2532e_00097", "date": "2024-03-14_11-41-59", "timestamp": 1710412919, "time_this_iter_s": 1485.5906779766083, "time_total_s": 65259.578619003296, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 65259.578619003296, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 49.742578496669836, "ram_util_percent": 17.09153187440533}, "checkpoint_dir_name": "checkpoint_000044"}
{"custom_metrics": {"collisions_mean": 55.46, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3656538498044635, "policy_loss": 0.02582937195019304, "vf_loss": 2.54214343303579, "vf_explained_var": 0.09201770270692891, "kl": 0.0, "entropy": 24.65795320532788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79170.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 115000, "num_env_steps_trained": 115000, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 345000}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -411.7708411551698, "episode_reward_mean": -265.967178084915, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.46, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.756729056144868, "mean_inference_ms": 10.532757242466332, "mean_action_processing_ms": 0.5269129368833511, "mean_env_wait_ms": 1.021859660325196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.884580135345459, "StateBufferConnector_ms": 0.00675201416015625, "ViewRequirementAgentConnector_ms": 0.2643930912017822}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -411.7708411551698, "episode_reward_mean": -265.967178084915, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-305.99312385414896, -278.0351652881674, -238.5074332026074, -312.3575440719496, -328.71727357544313, -241.4284041089775, -269.1832568354778, -278.3105044603487, -371.2279936682313, -313.72763016096735, -313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.756729056144868, "mean_inference_ms": 10.532757242466332, "mean_action_processing_ms": 0.5269129368833511, "mean_env_wait_ms": 1.021859660325196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.884580135345459, "StateBufferConnector_ms": 0.00675201416015625, "ViewRequirementAgentConnector_ms": 0.2643930912017822}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 345000, "num_env_steps_sampled": 115000, "num_env_steps_trained": 115000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.11399006617548, "num_agent_steps_trained_throughput_per_sec": 5.11399006617548, "timesteps_total": 345000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 345000, "timers": {"training_iteration_time_ms": 1446341.624, "sample_time_ms": 34387.45, "load_time_ms": 0.864, "load_throughput": 2893581.323, "learn_time_ms": 1411951.445, "learn_throughput": 1.771, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 115000, "num_env_steps_trained": 115000, "num_agent_steps_sampled": 345000, "num_agent_steps_trained": 345000}, "done": false, "episodes_total": 460, "training_iteration": 46, "trial_id": "2532e_00097", "date": "2024-03-14_12-06-26", "timestamp": 1710414386, "time_this_iter_s": 1466.5673446655273, "time_total_s": 66726.14596366882, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 66726.14596366882, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 48.50973493975903, "ram_util_percent": 17.1344578313253}, "checkpoint_dir_name": "checkpoint_000045"}
{"custom_metrics": {"collisions_mean": 53.64, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3863500227560235, "policy_loss": 0.011643818206014647, "vf_loss": 2.608326986414948, "vf_explained_var": -0.04385024727075949, "kl": 0.0, "entropy": 24.77462424574227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80910.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 117500, "num_env_steps_trained": 117500, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352500}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -411.7708411551698, "episode_reward_mean": -260.52955411644064, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.64, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7563100708751278, "mean_inference_ms": 10.53071454294809, "mean_action_processing_ms": 0.5268307592943112, "mean_env_wait_ms": 1.0216929690884458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8842971324920654, "StateBufferConnector_ms": 0.006752967834472656, "ViewRequirementAgentConnector_ms": 0.2648274898529053}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -411.7708411551698, "episode_reward_mean": -260.52955411644064, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-313.93232061825245, -246.26348358564928, -253.22942359226914, -249.1587779953458, -277.0756284168562, -269.1491157897652, -268.2690977084857, -243.95071182806274, -286.0650290223312, -241.0042443574917, -354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7563100708751278, "mean_inference_ms": 10.53071454294809, "mean_action_processing_ms": 0.5268307592943112, "mean_env_wait_ms": 1.0216929690884458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8842971324920654, "StateBufferConnector_ms": 0.006752967834472656, "ViewRequirementAgentConnector_ms": 0.2648274898529053}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352500, "num_env_steps_sampled": 117500, "num_env_steps_trained": 117500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.277163083817329, "num_agent_steps_trained_throughput_per_sec": 5.277163083817329, "timesteps_total": 352500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 352500, "timers": {"training_iteration_time_ms": 1447649.455, "sample_time_ms": 34393.814, "load_time_ms": 0.863, "load_throughput": 2895259.132, "learn_time_ms": 1413252.91, "learn_throughput": 1.769, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 117500, "num_env_steps_trained": 117500, "num_agent_steps_sampled": 352500, "num_agent_steps_trained": 352500}, "done": false, "episodes_total": 470, "training_iteration": 47, "trial_id": "2532e_00097", "date": "2024-03-14_12-30-08", "timestamp": 1710415808, "time_this_iter_s": 1421.220312833786, "time_total_s": 68147.36627650261, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 68147.36627650261, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 46.58330019880716, "ram_util_percent": 16.184741550695822}, "checkpoint_dir_name": "checkpoint_000046"}
{"custom_metrics": {"collisions_mean": 53.1, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3317062357478058, "policy_loss": 0.00514577860681704, "vf_loss": 2.5169766787139847, "vf_explained_var": 0.027807138706075735, "kl": 0.0, "entropy": 24.766232577137565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82650.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -411.7708411551698, "episode_reward_mean": -258.0534813467444, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.1, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.755926752578047, "mean_inference_ms": 10.529092753099933, "mean_action_processing_ms": 0.5267528177486491, "mean_env_wait_ms": 1.0215792235307517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8815262317657471, "StateBufferConnector_ms": 0.006726741790771484, "ViewRequirementAgentConnector_ms": 0.26390552520751953}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -411.7708411551698, "episode_reward_mean": -258.0534813467444, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-354.56021497338253, -260.1573326069918, -274.39884634119954, -257.01584262473295, -247.7429019381001, -276.13505069551127, -372.1493668776756, -253.93330201057285, -262.0353256486535, -271.11723805395724, -260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.755926752578047, "mean_inference_ms": 10.529092753099933, "mean_action_processing_ms": 0.5267528177486491, "mean_env_wait_ms": 1.0215792235307517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8815262317657471, "StateBufferConnector_ms": 0.006726741790771484, "ViewRequirementAgentConnector_ms": 0.26390552520751953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.307479979299342, "num_agent_steps_trained_throughput_per_sec": 5.307479979299342, "timesteps_total": 360000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 1445383.706, "sample_time_ms": 34432.151, "load_time_ms": 0.905, "load_throughput": 2761590.73, "learn_time_ms": 1410948.767, "learn_throughput": 1.772, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 480, "training_iteration": 48, "trial_id": "2532e_00097", "date": "2024-03-14_12-53-42", "timestamp": 1710417222, "time_this_iter_s": 1413.1021225452423, "time_total_s": 69560.46839904785, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 69560.46839904785, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 45.9046953046953, "ram_util_percent": 16.086863136863137}, "checkpoint_dir_name": "checkpoint_000047"}
{"custom_metrics": {"collisions_mean": 55.16, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.6103864303278876, "policy_loss": 0.01451625022796336, "vf_loss": 3.027956989304773, "vf_explained_var": -0.0086887174981764, "kl": 0.0, "entropy": 24.870956174258527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84390.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 122500, "num_env_steps_trained": 122500, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367500}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -258.1577832299019, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.16, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7555199697366755, "mean_inference_ms": 10.527276873215952, "mean_action_processing_ms": 0.5266806926853658, "mean_env_wait_ms": 1.0214310845840122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.879680871963501, "StateBufferConnector_ms": 0.006724119186401367, "ViewRequirementAgentConnector_ms": 0.26398301124572754}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -258.1577832299019, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-260.4886650517764, -275.15549258764054, -267.0664637697222, -235.14643178027697, -166.1574893732168, -303.46864307877064, -322.12487841530435, -218.8898609318765, -277.1484990059285, -265.65800155340276, -253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7555199697366755, "mean_inference_ms": 10.527276873215952, "mean_action_processing_ms": 0.5266806926853658, "mean_env_wait_ms": 1.0214310845840122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.879680871963501, "StateBufferConnector_ms": 0.006724119186401367, "ViewRequirementAgentConnector_ms": 0.26398301124572754}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367500, "num_env_steps_sampled": 122500, "num_env_steps_trained": 122500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.272488808549474, "num_agent_steps_trained_throughput_per_sec": 5.272488808549474, "timesteps_total": 367500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 367500, "timers": {"training_iteration_time_ms": 1443653.738, "sample_time_ms": 34389.994, "load_time_ms": 0.907, "load_throughput": 2755929.352, "learn_time_ms": 1409260.932, "learn_throughput": 1.774, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 122500, "num_env_steps_trained": 122500, "num_agent_steps_sampled": 367500, "num_agent_steps_trained": 367500}, "done": false, "episodes_total": 490, "training_iteration": 49, "trial_id": "2532e_00097", "date": "2024-03-14_13-17-26", "timestamp": 1710418646, "time_this_iter_s": 1422.480355501175, "time_total_s": 70982.94875454903, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 70982.94875454903, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 42.10595238095238, "ram_util_percent": 14.469742063492063}, "checkpoint_dir_name": "checkpoint_000048"}
{"custom_metrics": {"collisions_mean": 56.82, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.559881667309205, "policy_loss": 0.01218660862409863, "vf_loss": 2.9365509407958763, "vf_explained_var": 0.03991535614276755, "kl": 0.0, "entropy": 24.887560004749517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86130.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 125000, "num_env_steps_trained": 125000, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 375000}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -258.4692116834545, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 56.82, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7550145689319925, "mean_inference_ms": 10.524979149371104, "mean_action_processing_ms": 0.5265488670072761, "mean_env_wait_ms": 1.0212143872805919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8764450550079346, "StateBufferConnector_ms": 0.006688833236694336, "ViewRequirementAgentConnector_ms": 0.26200199127197266}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -258.4692116834545, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-253.62581612642376, -352.422909615457, -293.85584842921185, -260.929710475845, -252.63634674927138, -411.7708411551698, -259.69973329558377, -306.64267350623584, -253.6032650714793, -320.6807533200821, -226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7550145689319925, "mean_inference_ms": 10.524979149371104, "mean_action_processing_ms": 0.5265488670072761, "mean_env_wait_ms": 1.0212143872805919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8764450550079346, "StateBufferConnector_ms": 0.006688833236694336, "ViewRequirementAgentConnector_ms": 0.26200199127197266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 375000, "num_env_steps_sampled": 125000, "num_env_steps_trained": 125000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.139132966942504, "num_agent_steps_trained_throughput_per_sec": 5.139132966942504, "timesteps_total": 375000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 375000, "timers": {"training_iteration_time_ms": 1445152.449, "sample_time_ms": 34290.918, "load_time_ms": 0.917, "load_throughput": 2725272.897, "learn_time_ms": 1410858.737, "learn_throughput": 1.772, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 125000, "num_env_steps_trained": 125000, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 375000}, "done": false, "episodes_total": 500, "training_iteration": 50, "trial_id": "2532e_00097", "date": "2024-03-14_13-41-46", "timestamp": 1710420106, "time_this_iter_s": 1459.3922746181488, "time_total_s": 72442.34102916718, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 72442.34102916718, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 44.26786060019361, "ram_util_percent": 16.604743465634073}, "checkpoint_dir_name": "checkpoint_000049"}
{"custom_metrics": {"collisions_mean": 53.82, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.279854769211653, "policy_loss": 0.019398939916489367, "vf_loss": 2.391551696945881, "vf_explained_var": 0.04212107185659737, "kl": 0.0, "entropy": 24.55503921837642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87870.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 127500, "num_env_steps_trained": 127500, "num_agent_steps_sampled": 382500, "num_agent_steps_trained": 382500}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -250.6550826421435, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.82, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7545763078809875, "mean_inference_ms": 10.52306051175453, "mean_action_processing_ms": 0.5264398415289393, "mean_env_wait_ms": 1.0210432796170308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8795793056488037, "StateBufferConnector_ms": 0.006748199462890625, "ViewRequirementAgentConnector_ms": 0.2630884647369385}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -250.6550826421435, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-226.36630231142587, -243.43170044396715, -266.7622566437538, -228.92975688516583, -251.7207394777876, -260.52844274536017, -259.436179356944, -164.20924735218594, -157.44425964314343, -234.81215962810282, -247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7545763078809875, "mean_inference_ms": 10.52306051175453, "mean_action_processing_ms": 0.5264398415289393, "mean_env_wait_ms": 1.0210432796170308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8795793056488037, "StateBufferConnector_ms": 0.006748199462890625, "ViewRequirementAgentConnector_ms": 0.2630884647369385}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 382500, "num_agent_steps_trained": 382500, "num_env_steps_sampled": 127500, "num_env_steps_trained": 127500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.115275763091142, "num_agent_steps_trained_throughput_per_sec": 5.115275763091142, "timesteps_total": 382500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 382500, "timers": {"training_iteration_time_ms": 1446752.979, "sample_time_ms": 34347.353, "load_time_ms": 0.959, "load_throughput": 2605805.169, "learn_time_ms": 1412402.839, "learn_throughput": 1.77, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 127500, "num_env_steps_trained": 127500, "num_agent_steps_sampled": 382500, "num_agent_steps_trained": 382500}, "done": false, "episodes_total": 510, "training_iteration": 51, "trial_id": "2532e_00097", "date": "2024-03-14_14-06-13", "timestamp": 1710421573, "time_this_iter_s": 1466.1988759040833, "time_total_s": 73908.53990507126, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 73908.53990507126, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 44.42729898892634, "ram_util_percent": 16.71569571497352}, "checkpoint_dir_name": "checkpoint_000050"}
{"custom_metrics": {"collisions_mean": 56.7, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4440938069319202, "policy_loss": 0.02213605906568125, "vf_loss": 2.697980669397732, "vf_explained_var": -0.08967478384916809, "kl": 0.0, "entropy": 24.904369667754775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89610.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -251.8758410903073, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 56.7, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7540304003408762, "mean_inference_ms": 10.52044315625214, "mean_action_processing_ms": 0.5262721987275524, "mean_env_wait_ms": 1.0208240285801653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8781304359436035, "StateBufferConnector_ms": 0.0066912174224853516, "ViewRequirementAgentConnector_ms": 0.26247477531433105}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -251.8758410903073, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-247.60450517893955, -276.92790484337644, -230.74074980495988, -312.9574091121571, -339.15620070528007, -277.2556723487855, -270.8458564310432, -324.0932665786449, -225.68114791246146, -252.65331966190385, -292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7540304003408762, "mean_inference_ms": 10.52044315625214, "mean_action_processing_ms": 0.5262721987275524, "mean_env_wait_ms": 1.0208240285801653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8781304359436035, "StateBufferConnector_ms": 0.0066912174224853516, "ViewRequirementAgentConnector_ms": 0.26247477531433105}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000, "num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.1887462633846155, "num_agent_steps_trained_throughput_per_sec": 5.1887462633846155, "timesteps_total": 390000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 390000, "timers": {"training_iteration_time_ms": 1446379.851, "sample_time_ms": 34231.124, "load_time_ms": 0.907, "load_throughput": 2755856.921, "learn_time_ms": 1412146.008, "learn_throughput": 1.77, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 130000, "num_env_steps_trained": 130000, "num_agent_steps_sampled": 390000, "num_agent_steps_trained": 390000}, "done": false, "episodes_total": 520, "training_iteration": 52, "trial_id": "2532e_00097", "date": "2024-03-14_14-30-19", "timestamp": 1710423019, "time_this_iter_s": 1445.4380192756653, "time_total_s": 75353.97792434692, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 75353.97792434692, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 44.478369140625006, "ram_util_percent": 16.581933593749998}, "checkpoint_dir_name": "checkpoint_000051"}
{"custom_metrics": {"collisions_mean": 55.14, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4001424552308095, "policy_loss": 0.019138449470341292, "vf_loss": 2.62027626249982, "vf_explained_var": 0.059137471208627196, "kl": 0.0, "entropy": 24.634300281261577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91350.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 132500, "num_env_steps_trained": 132500, "num_agent_steps_sampled": 397500, "num_agent_steps_trained": 397500}, "sampler_results": {"episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -247.07869417275495, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.14, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7536357327527332, "mean_inference_ms": 10.518982027860455, "mean_action_processing_ms": 0.5261498355188092, "mean_env_wait_ms": 1.0206596061281963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8803205490112305, "StateBufferConnector_ms": 0.0067234039306640625, "ViewRequirementAgentConnector_ms": 0.2629854679107666}}, "episode_reward_max": -149.35780554723306, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -247.07869417275495, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-292.9587721630664, -247.4174170564492, -277.76130596858235, -280.9536703854562, -232.8577279301533, -252.22226924957133, -245.60755039900704, -197.55580867381914, -292.970706976653, -187.02765356749742, -254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7536357327527332, "mean_inference_ms": 10.518982027860455, "mean_action_processing_ms": 0.5261498355188092, "mean_env_wait_ms": 1.0206596061281963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8803205490112305, "StateBufferConnector_ms": 0.0067234039306640625, "ViewRequirementAgentConnector_ms": 0.2629854679107666}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 397500, "num_agent_steps_trained": 397500, "num_env_steps_sampled": 132500, "num_env_steps_trained": 132500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.257056218101831, "num_agent_steps_trained_throughput_per_sec": 5.257056218101831, "timesteps_total": 397500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 397500, "timers": {"training_iteration_time_ms": 1444117.551, "sample_time_ms": 34382.701, "load_time_ms": 0.895, "load_throughput": 2792702.48, "learn_time_ms": 1409732.176, "learn_throughput": 1.773, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 132500, "num_env_steps_trained": 132500, "num_agent_steps_sampled": 397500, "num_agent_steps_trained": 397500}, "done": false, "episodes_total": 530, "training_iteration": 53, "trial_id": "2532e_00097", "date": "2024-03-14_14-54-07", "timestamp": 1710424447, "time_this_iter_s": 1426.6561570167542, "time_total_s": 76780.63408136368, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 76780.63408136368, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 44.33623331685616, "ram_util_percent": 16.62916460701928}, "checkpoint_dir_name": "checkpoint_000052"}
{"custom_metrics": {"collisions_mean": 56.9, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.6301990542453768, "policy_loss": 0.018706192228482802, "vf_loss": 3.0575990083060045, "vf_explained_var": -0.1077763674588039, "kl": 0.0, "entropy": 24.840781471647066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 93090.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 135000, "num_env_steps_trained": 135000, "num_agent_steps_sampled": 405000, "num_agent_steps_trained": 405000}, "sampler_results": {"episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -247.59814186978608, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 56.9, "collisions_min": 0, "collisions_max": 158, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.753145813819978, "mean_inference_ms": 10.516710173775943, "mean_action_processing_ms": 0.5259723945422471, "mean_env_wait_ms": 1.0204538907654463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8786287307739258, "StateBufferConnector_ms": 0.0066988468170166016, "ViewRequirementAgentConnector_ms": 0.26242899894714355}}, "episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -247.59814186978608, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-254.80133118675082, -220.59909796436224, -247.35245322566414, -320.1172830836972, -149.35780554723306, -229.73486013376998, -249.66720066461576, -268.2998279470757, -165.97564209651796, -351.8247649400088, -304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.753145813819978, "mean_inference_ms": 10.516710173775943, "mean_action_processing_ms": 0.5259723945422471, "mean_env_wait_ms": 1.0204538907654463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8786287307739258, "StateBufferConnector_ms": 0.0066988468170166016, "ViewRequirementAgentConnector_ms": 0.26242899894714355}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 405000, "num_agent_steps_trained": 405000, "num_env_steps_sampled": 135000, "num_env_steps_trained": 135000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.220475780906362, "num_agent_steps_trained_throughput_per_sec": 5.220475780906362, "timesteps_total": 405000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 405000, "timers": {"training_iteration_time_ms": 1444327.678, "sample_time_ms": 34232.163, "load_time_ms": 0.827, "load_throughput": 3023401.188, "learn_time_ms": 1410092.921, "learn_throughput": 1.773, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 135000, "num_env_steps_trained": 135000, "num_agent_steps_sampled": 405000, "num_agent_steps_trained": 405000}, "done": false, "episodes_total": 540, "training_iteration": 54, "trial_id": "2532e_00097", "date": "2024-03-14_15-18-05", "timestamp": 1710425885, "time_this_iter_s": 1436.6527559757233, "time_total_s": 78217.2868373394, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 78217.2868373394, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 42.90997542997543, "ram_util_percent": 15.94751842751843}, "checkpoint_dir_name": "checkpoint_000053"}
{"custom_metrics": {"collisions_mean": 57.58, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.2355984085735907, "policy_loss": 0.0012846257965797665, "vf_loss": 2.3419505541009467, "vf_explained_var": -0.09259561430448773, "kl": 0.0, "entropy": 24.50220127873037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 94830.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled": 412500, "num_agent_steps_trained": 412500}, "sampler_results": {"episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -244.22114485012744, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 57.58, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7526001590337705, "mean_inference_ms": 10.51391155389856, "mean_action_processing_ms": 0.5257671809384992, "mean_env_wait_ms": 1.0202178632560583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8766913414001465, "StateBufferConnector_ms": 0.006655216217041016, "ViewRequirementAgentConnector_ms": 0.2613871097564697}}, "episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -244.22114485012744, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-304.39957136893565, -339.0810108709505, -234.35093940476824, -243.92247399210038, -246.98102202769056, -186.2536121069979, -206.35881620982332, -314.233674394459, -264.98182619207796, -267.5307284940764, -249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7526001590337705, "mean_inference_ms": 10.51391155389856, "mean_action_processing_ms": 0.5257671809384992, "mean_env_wait_ms": 1.0202178632560583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8766913414001465, "StateBufferConnector_ms": 0.006655216217041016, "ViewRequirementAgentConnector_ms": 0.2613871097564697}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412500, "num_agent_steps_trained": 412500, "num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.376571352722255, "num_agent_steps_trained_throughput_per_sec": 5.376571352722255, "timesteps_total": 412500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 412500, "timers": {"training_iteration_time_ms": 1435262.946, "sample_time_ms": 34139.946, "load_time_ms": 0.875, "load_throughput": 2857544.625, "learn_time_ms": 1401120.368, "learn_throughput": 1.784, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 137500, "num_env_steps_trained": 137500, "num_agent_steps_sampled": 412500, "num_agent_steps_trained": 412500}, "done": false, "episodes_total": 550, "training_iteration": 55, "trial_id": "2532e_00097", "date": "2024-03-14_15-41-21", "timestamp": 1710427281, "time_this_iter_s": 1394.9431927204132, "time_total_s": 79612.23003005981, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 79612.23003005981, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.691809908998984, "ram_util_percent": 13.09469160768453}, "checkpoint_dir_name": "checkpoint_000054"}
{"custom_metrics": {"collisions_mean": 57.76, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3946315559478284, "policy_loss": 0.013780852365601894, "vf_loss": 2.6199853838860303, "vf_explained_var": -0.004430603604207094, "kl": 0.0, "entropy": 24.559425195058186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 96570.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -241.62553985777646, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 57.76, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7519889429925561, "mean_inference_ms": 10.510431183859318, "mean_action_processing_ms": 0.5255204269235239, "mean_env_wait_ms": 1.0199457492558859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8752536773681641, "StateBufferConnector_ms": 0.00661158561706543, "ViewRequirementAgentConnector_ms": 0.25986647605895996}}, "episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -241.62553985777646, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-249.6423421737663, -151.00388035566115, -273.0560297117784, -292.5780299371041, -177.66841790177452, -297.6306827363148, -305.23635456971016, -234.51743428833927, -193.6100583642288, -218.78270234020147, -191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7519889429925561, "mean_inference_ms": 10.510431183859318, "mean_action_processing_ms": 0.5255204269235239, "mean_env_wait_ms": 1.0199457492558859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8752536773681641, "StateBufferConnector_ms": 0.00661158561706543, "ViewRequirementAgentConnector_ms": 0.25986647605895996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.390016012092861, "num_agent_steps_trained_throughput_per_sec": 5.390016012092861, "timesteps_total": 420000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 1427752.577, "sample_time_ms": 34009.88, "load_time_ms": 0.83, "load_throughput": 3013669.023, "learn_time_ms": 1393740.091, "learn_throughput": 1.794, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 560, "training_iteration": 56, "trial_id": "2532e_00097", "date": "2024-03-14_16-04-33", "timestamp": 1710428673, "time_this_iter_s": 1391.4637911319733, "time_total_s": 81003.69382119179, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 81003.69382119179, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 37.66139015728057, "ram_util_percent": 13.117554540842209}, "checkpoint_dir_name": "checkpoint_000055"}
{"custom_metrics": {"collisions_mean": 59.6, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.555821118261344, "policy_loss": 0.02053494469019124, "vf_loss": 2.913006681126767, "vf_explained_var": -0.049258912534549316, "kl": 0.0, "entropy": 24.330442621516085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 98310.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142500, "num_agent_steps_sampled": 427500, "num_agent_steps_trained": 427500}, "sampler_results": {"episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -241.61467545158524, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 59.6, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7513723942306623, "mean_inference_ms": 10.506951377732854, "mean_action_processing_ms": 0.5252721679329219, "mean_env_wait_ms": 1.0196845344763532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8776464462280273, "StateBufferConnector_ms": 0.006619930267333984, "ViewRequirementAgentConnector_ms": 0.26020050048828125}}, "episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -241.61467545158524, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-191.09271860726162, -192.68291114378832, -183.53283015094934, -306.0109210300579, -273.8430367231681, -216.9825885678779, -275.06570573436807, -184.76113594453923, -270.2771054000714, -306.24160264280454, -210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7513723942306623, "mean_inference_ms": 10.506951377732854, "mean_action_processing_ms": 0.5252721679329219, "mean_env_wait_ms": 1.0196845344763532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8776464462280273, "StateBufferConnector_ms": 0.006619930267333984, "ViewRequirementAgentConnector_ms": 0.26020050048828125}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427500, "num_agent_steps_trained": 427500, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.390656714844258, "num_agent_steps_trained_throughput_per_sec": 5.390656714844258, "timesteps_total": 427500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 427500, "timers": {"training_iteration_time_ms": 1424760.378, "sample_time_ms": 33984.719, "load_time_ms": 0.828, "load_throughput": 3017832.268, "learn_time_ms": 1390773.063, "learn_throughput": 1.798, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 142500, "num_env_steps_trained": 142500, "num_agent_steps_sampled": 427500, "num_agent_steps_trained": 427500}, "done": false, "episodes_total": 570, "training_iteration": 57, "trial_id": "2532e_00097", "date": "2024-03-14_16-27-45", "timestamp": 1710430065, "time_this_iter_s": 1391.2981886863708, "time_total_s": 82394.99200987816, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 82394.99200987816, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 37.7605476673428, "ram_util_percent": 13.0433569979716}, "checkpoint_dir_name": "checkpoint_000056"}
{"custom_metrics": {"collisions_mean": 59.08, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3451756795779963, "policy_loss": 0.007087436426784201, "vf_loss": 2.538849146355843, "vf_explained_var": 0.07154484243913628, "kl": 0.0, "entropy": 24.799171651642897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 100050.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 145000, "num_env_steps_trained": 145000, "num_agent_steps_sampled": 435000, "num_agent_steps_trained": 435000}, "sampler_results": {"episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -240.72877153425708, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 59.08, "collisions_min": 0, "collisions_max": 148, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7507770870610562, "mean_inference_ms": 10.503179831352977, "mean_action_processing_ms": 0.5250182574687945, "mean_env_wait_ms": 1.019382398881625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8807713985443115, "StateBufferConnector_ms": 0.006669521331787109, "ViewRequirementAgentConnector_ms": 0.2612912654876709}}, "episode_reward_max": -133.8258880859981, "episode_reward_min": -507.7008308231772, "episode_reward_mean": -240.72877153425708, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-210.61364516307276, -284.2470420105472, -243.55535690043985, -254.503857927329, -282.5418614464813, -357.35710121003865, -272.0457582977736, -215.32571577089368, -507.7008308231772, -211.78444053677762, -243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7507770870610562, "mean_inference_ms": 10.503179831352977, "mean_action_processing_ms": 0.5250182574687945, "mean_env_wait_ms": 1.019382398881625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8807713985443115, "StateBufferConnector_ms": 0.006669521331787109, "ViewRequirementAgentConnector_ms": 0.2612912654876709}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 435000, "num_agent_steps_trained": 435000, "num_env_steps_sampled": 145000, "num_env_steps_trained": 145000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.385555686912159, "num_agent_steps_trained_throughput_per_sec": 5.385555686912159, "timesteps_total": 435000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 435000, "timers": {"training_iteration_time_ms": 1422711.773, "sample_time_ms": 33923.379, "load_time_ms": 0.798, "load_throughput": 3134475.234, "learn_time_ms": 1388785.855, "learn_throughput": 1.8, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 145000, "num_env_steps_trained": 145000, "num_agent_steps_sampled": 435000, "num_agent_steps_trained": 435000}, "done": false, "episodes_total": 580, "training_iteration": 58, "trial_id": "2532e_00097", "date": "2024-03-14_16-50-59", "timestamp": 1710431459, "time_this_iter_s": 1392.6159410476685, "time_total_s": 83787.60795092583, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 83787.60795092583, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.78070886075949, "ram_util_percent": 13.045873417721518}, "checkpoint_dir_name": "checkpoint_000057"}
{"custom_metrics": {"collisions_mean": 57.46, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3470778548798321, "policy_loss": 0.01956818140267084, "vf_loss": 2.5187776721842674, "vf_explained_var": -0.13755637307961782, "kl": 0.0, "entropy": 24.52833638246032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 101790.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 147500, "num_env_steps_trained": 147500, "num_agent_steps_sampled": 442500, "num_agent_steps_trained": 442500}, "sampler_results": {"episode_reward_max": -123.86266464958678, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -234.34457637092578, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 57.46, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7501690331773088, "mean_inference_ms": 10.499255007980105, "mean_action_processing_ms": 0.5247527693339644, "mean_env_wait_ms": 1.0190729077216947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8794693946838379, "StateBufferConnector_ms": 0.0066564083099365234, "ViewRequirementAgentConnector_ms": 0.26099419593811035}}, "episode_reward_max": -123.86266464958678, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -234.34457637092578, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-243.0686103764211, -303.7820140680259, -301.941026133087, -243.36824926970183, -241.39091834372854, -253.06764142860112, -248.78951050112403, -274.4767373343321, -247.9275414057569, -264.6350220423946, -261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7501690331773088, "mean_inference_ms": 10.499255007980105, "mean_action_processing_ms": 0.5247527693339644, "mean_env_wait_ms": 1.0190729077216947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8794693946838379, "StateBufferConnector_ms": 0.0066564083099365234, "ViewRequirementAgentConnector_ms": 0.26099419593811035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 442500, "num_agent_steps_trained": 442500, "num_env_steps_sampled": 147500, "num_env_steps_trained": 147500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.347766949293705, "num_agent_steps_trained_throughput_per_sec": 5.347766949293705, "timesteps_total": 442500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 442500, "timers": {"training_iteration_time_ms": 1420709.415, "sample_time_ms": 33870.877, "load_time_ms": 0.814, "load_throughput": 3069601.874, "learn_time_ms": 1386835.989, "learn_throughput": 1.803, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 147500, "num_env_steps_trained": 147500, "num_agent_steps_sampled": 442500, "num_agent_steps_trained": 442500}, "done": false, "episodes_total": 590, "training_iteration": 59, "trial_id": "2532e_00097", "date": "2024-03-14_17-14-22", "timestamp": 1710432862, "time_this_iter_s": 1402.4566569328308, "time_total_s": 85190.06460785866, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 85190.06460785866, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 37.81031187122736, "ram_util_percent": 13.096277665995975}, "checkpoint_dir_name": "checkpoint_000058"}
{"custom_metrics": {"collisions_mean": 55.28, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.2033516769388413, "policy_loss": 0.02423183228178271, "vf_loss": 2.237227211053344, "vf_explained_var": 0.01647865940099475, "kl": 0.0, "entropy": 24.40491664820704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 103530.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -228.53755781146117, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.28, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7496787412241595, "mean_inference_ms": 10.49595979277467, "mean_action_processing_ms": 0.524550017539458, "mean_env_wait_ms": 1.0188320859858877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8833532333374023, "StateBufferConnector_ms": 0.006728649139404297, "ViewRequirementAgentConnector_ms": 0.26355886459350586}}, "episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -228.53755781146117, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-261.8382163248359, -263.47040714565145, -234.58524851952416, -226.85804519893705, -230.39248423822062, -251.2546188548162, -171.4231442003913, -191.76636299375474, -171.67334454977245, -181.1931215877564, -267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7496787412241595, "mean_inference_ms": 10.49595979277467, "mean_action_processing_ms": 0.524550017539458, "mean_env_wait_ms": 1.0188320859858877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8833532333374023, "StateBufferConnector_ms": 0.006728649139404297, "ViewRequirementAgentConnector_ms": 0.26355886459350586}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.378571459560365, "num_agent_steps_trained_throughput_per_sec": 5.378571459560365, "timesteps_total": 450000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 1414212.631, "sample_time_ms": 33969.797, "load_time_ms": 0.811, "load_throughput": 3082868.315, "learn_time_ms": 1380240.277, "learn_throughput": 1.811, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 150000, "num_env_steps_trained": 150000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 600, "training_iteration": 60, "trial_id": "2532e_00097", "date": "2024-03-14_17-37-37", "timestamp": 1710434257, "time_this_iter_s": 1394.4244797229767, "time_total_s": 86584.48908758163, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 86584.48908758163, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 37.26983805668016, "ram_util_percent": 12.886993927125506}, "checkpoint_dir_name": "checkpoint_000059"}
{"custom_metrics": {"collisions_mean": 57.5, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.314791975655304, "policy_loss": 0.010425076902651324, "vf_loss": 2.4748672642413228, "vf_explained_var": -0.14029630384911065, "kl": 0.0, "entropy": 24.31935779856539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 105270.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 152500, "num_env_steps_trained": 152500, "num_agent_steps_sampled": 457500, "num_agent_steps_trained": 457500}, "sampler_results": {"episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -228.53915210062965, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 57.5, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.748986025124586, "mean_inference_ms": 10.491463007152698, "mean_action_processing_ms": 0.5242843078378459, "mean_env_wait_ms": 1.0184907174270688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8762471675872803, "StateBufferConnector_ms": 0.006631612777709961, "ViewRequirementAgentConnector_ms": 0.26116132736206055}}, "episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -228.53915210062965, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-267.2873371525457, -224.02698548690142, -269.92325211086086, -181.7726954521489, -272.9165551512206, -263.23590465794774, -266.30967553757296, -229.98860037309026, -251.36551682918846, -188.89036655274242, -274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.748986025124586, "mean_inference_ms": 10.491463007152698, "mean_action_processing_ms": 0.5242843078378459, "mean_env_wait_ms": 1.0184907174270688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8762471675872803, "StateBufferConnector_ms": 0.006631612777709961, "ViewRequirementAgentConnector_ms": 0.26116132736206055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 457500, "num_agent_steps_trained": 457500, "num_env_steps_sampled": 152500, "num_env_steps_trained": 152500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.4424953790378074, "num_agent_steps_trained_throughput_per_sec": 5.4424953790378074, "timesteps_total": 457500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 457500, "timers": {"training_iteration_time_ms": 1405397.404, "sample_time_ms": 33730.368, "load_time_ms": 0.776, "load_throughput": 3220343.356, "learn_time_ms": 1371664.522, "learn_throughput": 1.823, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 152500, "num_env_steps_trained": 152500, "num_agent_steps_sampled": 457500, "num_agent_steps_trained": 457500}, "done": false, "episodes_total": 610, "training_iteration": 61, "trial_id": "2532e_00097", "date": "2024-03-14_18-00-36", "timestamp": 1710435636, "time_this_iter_s": 1378.0464496612549, "time_total_s": 87962.53553724289, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 87962.53553724289, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 36.51679467485919, "ram_util_percent": 12.390732206861243}, "checkpoint_dir_name": "checkpoint_000060"}
{"custom_metrics": {"collisions_mean": 55.2, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.0293775910270753, "policy_loss": 0.016098692468313993, "vf_loss": 1.9225654775812022, "vf_explained_var": 0.02678019531156825, "kl": 0.0, "entropy": 24.27861890354376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 107010.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 155000, "num_env_steps_trained": 155000, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 465000}, "sampler_results": {"episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -223.9616448968137, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.2, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7482225858901084, "mean_inference_ms": 10.486802171705692, "mean_action_processing_ms": 0.5239997467710428, "mean_env_wait_ms": 1.018100333214739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.870612621307373, "StateBufferConnector_ms": 0.006605386734008789, "ViewRequirementAgentConnector_ms": 0.25866103172302246}}, "episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -223.9616448968137, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-274.11742152916605, -284.8016011691073, -208.6082170666188, -220.25384495971355, -257.03670158096986, -168.70136309101446, -257.9214875254764, -184.19401519997552, -201.62863898082813, -220.93804971944323, -271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7482225858901084, "mean_inference_ms": 10.486802171705692, "mean_action_processing_ms": 0.5239997467710428, "mean_env_wait_ms": 1.018100333214739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.870612621307373, "StateBufferConnector_ms": 0.006605386734008789, "ViewRequirementAgentConnector_ms": 0.25866103172302246}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 465000, "num_env_steps_sampled": 155000, "num_env_steps_trained": 155000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.460687279042135, "num_agent_steps_trained_throughput_per_sec": 5.460687279042135, "timesteps_total": 465000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 465000, "timers": {"training_iteration_time_ms": 1398199.166, "sample_time_ms": 33655.786, "load_time_ms": 0.88, "load_throughput": 2840822.519, "learn_time_ms": 1364540.775, "learn_throughput": 1.832, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 155000, "num_env_steps_trained": 155000, "num_agent_steps_sampled": 465000, "num_agent_steps_trained": 465000}, "done": false, "episodes_total": 620, "training_iteration": 62, "trial_id": "2532e_00097", "date": "2024-03-14_18-23-30", "timestamp": 1710437010, "time_this_iter_s": 1373.4555151462555, "time_total_s": 89335.99105238914, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 89335.99105238914, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 36.52280431432973, "ram_util_percent": 12.394504365690809}, "checkpoint_dir_name": "checkpoint_000061"}
{"custom_metrics": {"collisions_mean": 55.64, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.2264298918325154, "policy_loss": 0.008288553402084729, "vf_loss": 2.3112654405164306, "vf_explained_var": -0.12444679620622218, "kl": 0.0, "entropy": 24.44653660785193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 108750.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 157500, "num_env_steps_trained": 157500, "num_agent_steps_sampled": 472500, "num_agent_steps_trained": 472500}, "sampler_results": {"episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -222.73127550213562, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.64, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7472805873364288, "mean_inference_ms": 10.480949712249066, "mean_action_processing_ms": 0.5236590120358402, "mean_env_wait_ms": 1.0176262254436772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8633038997650146, "StateBufferConnector_ms": 0.0065424442291259766, "ViewRequirementAgentConnector_ms": 0.2564430236816406}}, "episode_reward_max": -108.06509019079833, "episode_reward_min": -331.37349960154955, "episode_reward_mean": -222.73127550213562, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-271.25602348662466, -133.8258880859981, -270.27807138136933, -263.90106262276237, -331.37349960154955, -241.8418006894449, -265.94069218203117, -306.0514858765553, -235.5641543798275, -239.24497376721, -134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7472805873364288, "mean_inference_ms": 10.480949712249066, "mean_action_processing_ms": 0.5236590120358402, "mean_env_wait_ms": 1.0176262254436772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8633038997650146, "StateBufferConnector_ms": 0.0065424442291259766, "ViewRequirementAgentConnector_ms": 0.2564430236816406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472500, "num_agent_steps_trained": 472500, "num_env_steps_sampled": 157500, "num_env_steps_trained": 157500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.4555753022623215, "num_agent_steps_trained_throughput_per_sec": 5.4555753022623215, "timesteps_total": 472500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 472500, "timers": {"training_iteration_time_ms": 1393007.815, "sample_time_ms": 33410.611, "load_time_ms": 0.881, "load_throughput": 2837824.087, "learn_time_ms": 1359594.59, "learn_throughput": 1.839, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 157500, "num_env_steps_trained": 157500, "num_agent_steps_sampled": 472500, "num_agent_steps_trained": 472500}, "done": false, "episodes_total": 630, "training_iteration": 63, "trial_id": "2532e_00097", "date": "2024-03-14_18-46-26", "timestamp": 1710438386, "time_this_iter_s": 1374.7426233291626, "time_total_s": 90710.73367571831, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 90710.73367571831, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.0782452539764, "ram_util_percent": 14.161723961005645}, "checkpoint_dir_name": "checkpoint_000062"}
{"custom_metrics": {"collisions_mean": 53.04, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.29780597815828, "policy_loss": 0.01684749034292268, "vf_loss": 2.4304528417943536, "vf_explained_var": -0.06459157788890532, "kl": 0.0, "entropy": 24.54029222247244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 110490.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": -108.06509019079833, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -217.8554998575875, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.04, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.746396268941327, "mean_inference_ms": 10.47558136456475, "mean_action_processing_ms": 0.5233658219018715, "mean_env_wait_ms": 1.0171603586493614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8611147403717041, "StateBufferConnector_ms": 0.0065419673919677734, "ViewRequirementAgentConnector_ms": 0.25608229637145996}}, "episode_reward_max": -108.06509019079833, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -217.8554998575875, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-134.52765522457355, -232.7956403489939, -143.06229780630719, -252.04223380893228, -261.4212293268076, -179.04089213156638, -271.92158822718295, -240.43167748511962, -162.77475842005157, -242.01259204429533, -244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.746396268941327, "mean_inference_ms": 10.47558136456475, "mean_action_processing_ms": 0.5233658219018715, "mean_env_wait_ms": 1.0171603586493614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8611147403717041, "StateBufferConnector_ms": 0.0065419673919677734, "ViewRequirementAgentConnector_ms": 0.25608229637145996}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.5133474612418025, "num_agent_steps_trained_throughput_per_sec": 5.5133474612418025, "timesteps_total": 480000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 1385376.256, "sample_time_ms": 33454.734, "load_time_ms": 0.914, "load_throughput": 2735368.081, "learn_time_ms": 1351918.882, "learn_throughput": 1.849, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 640, "training_iteration": 64, "trial_id": "2532e_00097", "date": "2024-03-14_19-09-08", "timestamp": 1710439748, "time_this_iter_s": 1360.337159395218, "time_total_s": 92071.07083511353, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 92071.07083511353, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.92780942516831, "ram_util_percent": 12.454686690833766}, "checkpoint_dir_name": "checkpoint_000063"}
{"custom_metrics": {"collisions_mean": 53.14, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.326864539321255, "policy_loss": 0.020008795543563093, "vf_loss": 2.4795895229297122, "vf_explained_var": -0.006752833347210939, "kl": 0.0, "entropy": 24.398788123295226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 112230.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 162500, "num_env_steps_trained": 162500, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500}, "sampler_results": {"episode_reward_max": -108.06509019079833, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -217.2755693881305, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.14, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7454441367514952, "mean_inference_ms": 10.46991277035273, "mean_action_processing_ms": 0.5230527463601728, "mean_env_wait_ms": 1.0166506276445548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.857961893081665, "StateBufferConnector_ms": 0.006514310836791992, "ViewRequirementAgentConnector_ms": 0.254807710647583}}, "episode_reward_max": -108.06509019079833, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -217.2755693881305, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-244.81797980974736, -207.66390517176316, -231.17024944774283, -210.00792580604843, -234.94943031445464, -285.8651924939508, -168.51833683760677, -301.47028915883755, -212.9411525087345, -251.1287142778921, -305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7454441367514952, "mean_inference_ms": 10.46991277035273, "mean_action_processing_ms": 0.5230527463601728, "mean_env_wait_ms": 1.0166506276445548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.857961893081665, "StateBufferConnector_ms": 0.006514310836791992, "ViewRequirementAgentConnector_ms": 0.254807710647583}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500, "num_env_steps_sampled": 162500, "num_env_steps_trained": 162500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.517984228057844, "num_agent_steps_trained_throughput_per_sec": 5.517984228057844, "timesteps_total": 487500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 487500, "timers": {"training_iteration_time_ms": 1381801.352, "sample_time_ms": 33355.492, "load_time_ms": 0.883, "load_throughput": 2832764.21, "learn_time_ms": 1348443.271, "learn_throughput": 1.854, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 162500, "num_env_steps_trained": 162500, "num_agent_steps_sampled": 487500, "num_agent_steps_trained": 487500}, "done": false, "episodes_total": 650, "training_iteration": 65, "trial_id": "2532e_00097", "date": "2024-03-14_19-31-47", "timestamp": 1710441107, "time_this_iter_s": 1359.1940610408783, "time_total_s": 93430.2648961544, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 93430.2648961544, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 36.89424273858921, "ram_util_percent": 12.83858921161826}, "checkpoint_dir_name": "checkpoint_000064"}
{"custom_metrics": {"collisions_mean": 52.78, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.283380083518167, "policy_loss": 0.010246104569891576, "vf_loss": 2.415606850471305, "vf_explained_var": -0.01004840495257542, "kl": 0.0, "entropy": 24.66431645470104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 113970.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled": 495000, "num_agent_steps_trained": 495000}, "sampler_results": {"episode_reward_max": -108.06509019079833, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -215.9095078298763, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 52.78, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7444732425905716, "mean_inference_ms": 10.464409370674066, "mean_action_processing_ms": 0.5227594917095293, "mean_env_wait_ms": 1.0161354861614829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8552119731903076, "StateBufferConnector_ms": 0.006501913070678711, "ViewRequirementAgentConnector_ms": 0.25462865829467773}}, "episode_reward_max": -108.06509019079833, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -215.9095078298763, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-305.0246113299897, -261.5229493027361, -233.67410258774802, -280.7034887060407, -226.01851792630436, -237.8919789015917, -264.2835544479416, -187.36011250070095, -248.87945325103033, -147.2807228056763, -265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7444732425905716, "mean_inference_ms": 10.464409370674066, "mean_action_processing_ms": 0.5227594917095293, "mean_env_wait_ms": 1.0161354861614829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8552119731903076, "StateBufferConnector_ms": 0.006501913070678711, "ViewRequirementAgentConnector_ms": 0.25462865829467773}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 495000, "num_agent_steps_trained": 495000, "num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.53619983465887, "num_agent_steps_trained_throughput_per_sec": 5.53619983465887, "timesteps_total": 495000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 495000, "timers": {"training_iteration_time_ms": 1378127.187, "sample_time_ms": 33338.988, "load_time_ms": 0.951, "load_throughput": 2627944.162, "learn_time_ms": 1344785.559, "learn_throughput": 1.859, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 165000, "num_env_steps_trained": 165000, "num_agent_steps_sampled": 495000, "num_agent_steps_trained": 495000}, "done": false, "episodes_total": 660, "training_iteration": 66, "trial_id": "2532e_00097", "date": "2024-03-14_19-54-23", "timestamp": 1710442463, "time_this_iter_s": 1354.7219429016113, "time_total_s": 94784.98683905602, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 94784.98683905602, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 36.380072840790845, "ram_util_percent": 12.42143600416233}, "checkpoint_dir_name": "checkpoint_000065"}
{"custom_metrics": {"collisions_mean": 49.92, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.1465387052484393, "policy_loss": 0.0173138781627319, "vf_loss": 2.14255786020009, "vf_explained_var": -0.06474972398116671, "kl": 0.0, "entropy": 24.2391528644781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 115710.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 167500, "num_env_steps_trained": 167500, "num_agent_steps_sampled": 502500, "num_agent_steps_trained": 502500}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -211.23624010650252, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 49.92, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7433800857600537, "mean_inference_ms": 10.458143645333614, "mean_action_processing_ms": 0.5224179809852783, "mean_env_wait_ms": 1.0155503675270732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8484077453613281, "StateBufferConnector_ms": 0.00643467903137207, "ViewRequirementAgentConnector_ms": 0.2514657974243164}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -211.23624010650252, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-265.97660452731935, -169.1038218181196, -219.97368064649902, -277.918282550734, -235.91638329076386, -232.45019884798077, -235.03624334002444, -217.05099162413853, -220.4341955781475, -238.03976198833962, -194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7433800857600537, "mean_inference_ms": 10.458143645333614, "mean_action_processing_ms": 0.5224179809852783, "mean_env_wait_ms": 1.0155503675270732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8484077453613281, "StateBufferConnector_ms": 0.00643467903137207, "ViewRequirementAgentConnector_ms": 0.2514657974243164}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 502500, "num_agent_steps_trained": 502500, "num_env_steps_sampled": 167500, "num_env_steps_trained": 167500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.602443898882283, "num_agent_steps_trained_throughput_per_sec": 5.602443898882283, "timesteps_total": 502500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 502500, "timers": {"training_iteration_time_ms": 1372867.719, "sample_time_ms": 33138.28, "load_time_ms": 0.952, "load_throughput": 2625115.161, "learn_time_ms": 1339726.783, "learn_throughput": 1.866, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 167500, "num_env_steps_trained": 167500, "num_agent_steps_sampled": 502500, "num_agent_steps_trained": 502500}, "done": false, "episodes_total": 670, "training_iteration": 67, "trial_id": "2532e_00097", "date": "2024-03-14_20-16-43", "timestamp": 1710443803, "time_this_iter_s": 1338.7034678459167, "time_total_s": 96123.69030690193, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 96123.69030690193, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 36.083798001052074, "ram_util_percent": 11.832193582325093}, "checkpoint_dir_name": "checkpoint_000066"}
{"custom_metrics": {"collisions_mean": 48.8, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.1636657711915972, "policy_loss": 0.025748231650287307, "vf_loss": 2.159051169634893, "vf_explained_var": -0.15306342826492486, "kl": 0.0, "entropy": 24.578998100894623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 117450.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -208.713491028368, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 48.8, "collisions_min": 0, "collisions_max": 122, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7420879245389604, "mean_inference_ms": 10.450831090166346, "mean_action_processing_ms": 0.5220131123153825, "mean_env_wait_ms": 1.014883938658072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8416726589202881, "StateBufferConnector_ms": 0.0063359737396240234, "ViewRequirementAgentConnector_ms": 0.2479708194732666}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -321.57116156159765, "episode_reward_mean": -208.713491028368, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-194.93020038228818, -229.09703188852515, -251.4930428387231, -182.49846682196846, -216.6680165577054, -321.57116156159765, -140.71009071245635, -295.76388039062664, -244.6615379499286, -123.86266464958678, -231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7420879245389604, "mean_inference_ms": 10.450831090166346, "mean_action_processing_ms": 0.5220131123153825, "mean_env_wait_ms": 1.014883938658072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8416726589202881, "StateBufferConnector_ms": 0.0063359737396240234, "ViewRequirementAgentConnector_ms": 0.2479708194732666}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000, "num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.591375272785191, "num_agent_steps_trained_throughput_per_sec": 5.591375272785191, "timesteps_total": 510000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 510000, "timers": {"training_iteration_time_ms": 1367741.481, "sample_time_ms": 32868.12, "load_time_ms": 0.945, "load_throughput": 2646048.249, "learn_time_ms": 1334870.673, "learn_throughput": 1.873, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 170000, "num_env_steps_trained": 170000, "num_agent_steps_sampled": 510000, "num_agent_steps_trained": 510000}, "done": false, "episodes_total": 680, "training_iteration": 68, "trial_id": "2532e_00097", "date": "2024-03-14_20-39-05", "timestamp": 1710445145, "time_this_iter_s": 1341.3536036014557, "time_total_s": 97465.04391050339, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 97465.04391050339, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 36.07678571428571, "ram_util_percent": 11.787027310924369}, "checkpoint_dir_name": "checkpoint_000067"}
{"custom_metrics": {"collisions_mean": 50.12, "collisions_min": 0, "collisions_max": 116, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.5135986901263054, "policy_loss": 0.0040760185521352904, "vf_loss": 2.8641237784048608, "vf_explained_var": -0.04576204076580618, "kl": 0.0, "entropy": 24.578116119867083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 119190.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 172500, "num_env_steps_trained": 172500, "num_agent_steps_sampled": 517500, "num_agent_steps_trained": 517500}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -331.5990926324275, "episode_reward_mean": -211.3499673185116, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 50.12, "collisions_min": 0, "collisions_max": 116, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7407711116715898, "mean_inference_ms": 10.443444265572458, "mean_action_processing_ms": 0.5215926342018292, "mean_env_wait_ms": 1.0141836551761279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.83986496925354, "StateBufferConnector_ms": 0.006339550018310547, "ViewRequirementAgentConnector_ms": 0.24722528457641602}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -331.5990926324275, "episode_reward_mean": -211.3499673185116, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-231.89422527149287, -247.16418113865885, -185.1499208839476, -219.14780373933735, -221.55094513502624, -178.09391042802997, -145.68057041936356, -108.06509019079833, -240.71262982621698, -264.2861379238383, -269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7407711116715898, "mean_inference_ms": 10.443444265572458, "mean_action_processing_ms": 0.5215926342018292, "mean_env_wait_ms": 1.0141836551761279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.83986496925354, "StateBufferConnector_ms": 0.006339550018310547, "ViewRequirementAgentConnector_ms": 0.24722528457641602}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 517500, "num_agent_steps_trained": 517500, "num_env_steps_sampled": 172500, "num_env_steps_trained": 172500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.616686965056149, "num_agent_steps_trained_throughput_per_sec": 5.616686965056149, "timesteps_total": 517500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 517500, "timers": {"training_iteration_time_ms": 1361026.702, "sample_time_ms": 32800.153, "load_time_ms": 0.979, "load_throughput": 2552459.775, "learn_time_ms": 1328223.85, "learn_throughput": 1.882, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 172500, "num_env_steps_trained": 172500, "num_agent_steps_sampled": 517500, "num_agent_steps_trained": 517500}, "done": false, "episodes_total": 690, "training_iteration": 69, "trial_id": "2532e_00097", "date": "2024-03-14_21-01-21", "timestamp": 1710446481, "time_this_iter_s": 1335.3086817264557, "time_total_s": 98800.35259222984, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 98800.35259222984, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 36.06026385224275, "ram_util_percent": 11.772770448548814}, "checkpoint_dir_name": "checkpoint_000068"}
{"custom_metrics": {"collisions_mean": 51.22, "collisions_min": 0, "collisions_max": 132, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3170491381660747, "policy_loss": 0.024369116711440958, "vf_loss": 2.4526929340143315, "vf_explained_var": -0.23668865489548652, "kl": 0.0, "entropy": 24.557541278312947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 120930.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 175000, "num_env_steps_trained": 175000, "num_agent_steps_sampled": 525000, "num_agent_steps_trained": 525000}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -331.5990926324275, "episode_reward_mean": -211.4470203632276, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 51.22, "collisions_min": 0, "collisions_max": 132, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7393089508646353, "mean_inference_ms": 10.435047164182755, "mean_action_processing_ms": 0.5211256022810328, "mean_env_wait_ms": 1.0133987733605319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8342893123626709, "StateBufferConnector_ms": 0.006268024444580078, "ViewRequirementAgentConnector_ms": 0.24480438232421875}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -331.5990926324275, "episode_reward_mean": -211.4470203632276, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-269.2361281094357, -157.362175676143, -262.636696874756, -115.81560396898261, -232.35555454436323, -269.18652464807315, -234.780846540234, -241.72050226412136, -143.62020095937112, -257.900188945027, -118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7393089508646353, "mean_inference_ms": 10.435047164182755, "mean_action_processing_ms": 0.5211256022810328, "mean_env_wait_ms": 1.0133987733605319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8342893123626709, "StateBufferConnector_ms": 0.006268024444580078, "ViewRequirementAgentConnector_ms": 0.24480438232421875}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 525000, "num_agent_steps_trained": 525000, "num_env_steps_sampled": 175000, "num_env_steps_trained": 175000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.589806430097206, "num_agent_steps_trained_throughput_per_sec": 5.589806430097206, "timesteps_total": 525000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 525000, "timers": {"training_iteration_time_ms": 1355757.275, "sample_time_ms": 32550.49, "load_time_ms": 0.981, "load_throughput": 2549604.882, "learn_time_ms": 1323204.112, "learn_throughput": 1.889, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 175000, "num_env_steps_trained": 175000, "num_agent_steps_sampled": 525000, "num_agent_steps_trained": 525000}, "done": false, "episodes_total": 700, "training_iteration": 70, "trial_id": "2532e_00097", "date": "2024-03-14_21-23-44", "timestamp": 1710447824, "time_this_iter_s": 1341.7300539016724, "time_total_s": 100142.08264613152, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 100142.08264613152, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 36.01261166579086, "ram_util_percent": 11.93116132422491}, "checkpoint_dir_name": "checkpoint_000069"}
{"custom_metrics": {"collisions_mean": 49.72, "collisions_min": 0, "collisions_max": 132, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4561175926909622, "policy_loss": 0.031945912077509124, "vf_loss": 2.702181323506366, "vf_explained_var": -0.12611856686657874, "kl": 0.0, "entropy": 24.756846696480938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 122670.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled": 532500, "num_agent_steps_trained": 532500}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -331.5990926324275, "episode_reward_mean": -211.64306744369006, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 49.72, "collisions_min": 0, "collisions_max": 132, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.737807690856827, "mean_inference_ms": 10.4262996552524, "mean_action_processing_ms": 0.5206364179432568, "mean_env_wait_ms": 1.0126026602248737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8308193683624268, "StateBufferConnector_ms": 0.006228923797607422, "ViewRequirementAgentConnector_ms": 0.24319243431091309}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -331.5990926324275, "episode_reward_mean": -211.64306744369006, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-118.37626398151957, -179.0471928702894, -283.61562143890586, -254.50662977850763, -270.0872567560369, -231.45250252210184, -136.9867846399265, -129.4643858895971, -218.0027400142778, -136.42679103146367, -230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.737807690856827, "mean_inference_ms": 10.4262996552524, "mean_action_processing_ms": 0.5206364179432568, "mean_env_wait_ms": 1.0126026602248737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8308193683624268, "StateBufferConnector_ms": 0.006228923797607422, "ViewRequirementAgentConnector_ms": 0.24319243431091309}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532500, "num_agent_steps_trained": 532500, "num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.586674673417706, "num_agent_steps_trained_throughput_per_sec": 5.586674673417706, "timesteps_total": 532500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 532500, "timers": {"training_iteration_time_ms": 1352200.858, "sample_time_ms": 32418.761, "load_time_ms": 0.975, "load_throughput": 2564507.924, "learn_time_ms": 1319779.433, "learn_throughput": 1.894, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 177500, "num_env_steps_trained": 177500, "num_agent_steps_sampled": 532500, "num_agent_steps_trained": 532500}, "done": false, "episodes_total": 710, "training_iteration": 71, "trial_id": "2532e_00097", "date": "2024-03-14_21-46-07", "timestamp": 1710449167, "time_this_iter_s": 1342.482233762741, "time_total_s": 101484.56487989426, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 101484.56487989426, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 36.004352385946504, "ram_util_percent": 11.984163607760882}, "checkpoint_dir_name": "checkpoint_000070"}
{"custom_metrics": {"collisions_mean": 53.36, "collisions_min": 0, "collisions_max": 168, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.6430355442302493, "policy_loss": 0.010134396141384268, "vf_loss": 3.0982184588909147, "vf_explained_var": -0.0521261107647556, "kl": 0.0, "entropy": 25.11201309664496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 124410.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -338.6497348977986, "episode_reward_mean": -217.67719211954278, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.36, "collisions_min": 0, "collisions_max": 168, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7363117434982465, "mean_inference_ms": 10.417321624317799, "mean_action_processing_ms": 0.5201569259768286, "mean_env_wait_ms": 1.0118009973781987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8326077461242676, "StateBufferConnector_ms": 0.006237506866455078, "ViewRequirementAgentConnector_ms": 0.24459266662597656}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -338.6497348977986, "episode_reward_mean": -217.67719211954278, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-230.1818487961465, -232.63946736043482, -207.03788945298007, -208.40985068807632, -300.85809027748536, -220.72642368690234, -123.1869400488012, -231.31693469384297, -175.2857031051611, -225.52125324467505, -214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7363117434982465, "mean_inference_ms": 10.417321624317799, "mean_action_processing_ms": 0.5201569259768286, "mean_env_wait_ms": 1.0118009973781987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8326077461242676, "StateBufferConnector_ms": 0.006237506866455078, "ViewRequirementAgentConnector_ms": 0.24459266662597656}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.632385715381114, "num_agent_steps_trained_throughput_per_sec": 5.632385715381114, "timesteps_total": 540000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 1348014.003, "sample_time_ms": 32329.616, "load_time_ms": 0.871, "load_throughput": 2870608.848, "learn_time_ms": 1315681.829, "learn_throughput": 1.9, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 720, "training_iteration": 72, "trial_id": "2532e_00097", "date": "2024-03-14_22-08-20", "timestamp": 1710450500, "time_this_iter_s": 1331.5869863033295, "time_total_s": 102816.15186619759, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 102816.15186619759, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 35.997567424643044, "ram_util_percent": 11.9555790586991}, "checkpoint_dir_name": "checkpoint_000071"}
{"custom_metrics": {"collisions_mean": 54.34, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.5013605542914492, "policy_loss": 0.023167425921138633, "vf_loss": 2.804680032360143, "vf_explained_var": -0.12706181886552395, "kl": 0.0, "entropy": 24.939581219903353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 126150.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 182500, "num_env_steps_trained": 182500, "num_agent_steps_sampled": 547500, "num_agent_steps_trained": 547500}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -345.6289914421168, "episode_reward_mean": -218.42550408639076, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 54.34, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7348525907267385, "mean_inference_ms": 10.408494000923488, "mean_action_processing_ms": 0.5196921166108188, "mean_env_wait_ms": 1.0110078053931042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8328685760498047, "StateBufferConnector_ms": 0.006244659423828125, "ViewRequirementAgentConnector_ms": 0.24478888511657715}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -345.6289914421168, "episode_reward_mean": -218.42550408639076, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-214.3752876299324, -171.95518906684518, -249.97942058670233, -266.8711183848302, -117.12120227022815, -228.40742112467026, -233.69388045067294, -212.06242024716798, -156.72319468792682, -220.51095316958475, -157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7348525907267385, "mean_inference_ms": 10.408494000923488, "mean_action_processing_ms": 0.5196921166108188, "mean_env_wait_ms": 1.0110078053931042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8328685760498047, "StateBufferConnector_ms": 0.006244659423828125, "ViewRequirementAgentConnector_ms": 0.24478888511657715}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 547500, "num_agent_steps_trained": 547500, "num_env_steps_sampled": 182500, "num_env_steps_trained": 182500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.538722971779347, "num_agent_steps_trained_throughput_per_sec": 5.538722971779347, "timesteps_total": 547500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 547500, "timers": {"training_iteration_time_ms": 1345950.234, "sample_time_ms": 32309.757, "load_time_ms": 0.877, "load_throughput": 2850165.806, "learn_time_ms": 1313637.935, "learn_throughput": 1.903, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 182500, "num_env_steps_trained": 182500, "num_agent_steps_sampled": 547500, "num_agent_steps_trained": 547500}, "done": false, "episodes_total": 730, "training_iteration": 73, "trial_id": "2532e_00097", "date": "2024-03-14_22-30-55", "timestamp": 1710451855, "time_this_iter_s": 1354.1047353744507, "time_total_s": 104170.25660157204, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 104170.25660157204, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 35.9215625, "ram_util_percent": 11.901770833333336}, "checkpoint_dir_name": "checkpoint_000072"}
{"custom_metrics": {"collisions_mean": 55.26, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4570436361074532, "policy_loss": 0.030929705226558378, "vf_loss": 2.705866494278113, "vf_explained_var": -0.11196621509119012, "kl": 0.0, "entropy": 25.02296671264473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 127890.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 185000, "num_env_steps_trained": 185000, "num_agent_steps_sampled": 555000, "num_agent_steps_trained": 555000}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -345.6289914421168, "episode_reward_mean": -219.70136937466918, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.26, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7334129297841536, "mean_inference_ms": 10.399706406371822, "mean_action_processing_ms": 0.5192314571815555, "mean_env_wait_ms": 1.0102214868778228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.834465742111206, "StateBufferConnector_ms": 0.006450176239013672, "ViewRequirementAgentConnector_ms": 0.24565839767456055}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -345.6289914421168, "episode_reward_mean": -219.70136937466918, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-157.8573942806285, -214.1063294560522, -249.29759947330746, -243.78337147840148, -221.35525165492948, -186.47011993261057, -152.70563146203634, -212.1565922108983, -202.20380444712993, -222.10142348213733, -237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7334129297841536, "mean_inference_ms": 10.399706406371822, "mean_action_processing_ms": 0.5192314571815555, "mean_env_wait_ms": 1.0102214868778228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.834465742111206, "StateBufferConnector_ms": 0.006450176239013672, "ViewRequirementAgentConnector_ms": 0.24565839767456055}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 555000, "num_agent_steps_trained": 555000, "num_env_steps_sampled": 185000, "num_env_steps_trained": 185000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.541159629120954, "num_agent_steps_trained_throughput_per_sec": 5.541159629120954, "timesteps_total": 555000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 555000, "timers": {"training_iteration_time_ms": 1345267.457, "sample_time_ms": 32275.749, "load_time_ms": 0.841, "load_throughput": 2971143.602, "learn_time_ms": 1312989.199, "learn_throughput": 1.904, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 185000, "num_env_steps_trained": 185000, "num_agent_steps_sampled": 555000, "num_agent_steps_trained": 555000}, "done": false, "episodes_total": 740, "training_iteration": 74, "trial_id": "2532e_00097", "date": "2024-03-14_22-53-29", "timestamp": 1710453209, "time_this_iter_s": 1353.5093367099762, "time_total_s": 105523.76593828201, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 105523.76593828201, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 35.887187499999996, "ram_util_percent": 11.890312500000004}, "checkpoint_dir_name": "checkpoint_000073"}
{"custom_metrics": {"collisions_mean": 55.54, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.5560891949092628, "policy_loss": 0.0282197233698941, "vf_loss": 2.8989344438602185, "vf_explained_var": -0.0989694961186113, "kl": 0.0, "entropy": 24.781454791145762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 129630.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 187500, "num_env_steps_trained": 187500, "num_agent_steps_sampled": 562500, "num_agent_steps_trained": 562500}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -221.82135797173854, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.54, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.731922734226373, "mean_inference_ms": 10.390626140938997, "mean_action_processing_ms": 0.5187441078702232, "mean_env_wait_ms": 1.009410017776398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8323371410369873, "StateBufferConnector_ms": 0.006422281265258789, "ViewRequirementAgentConnector_ms": 0.2445385456085205}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -221.82135797173854, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-237.82389700652652, -223.04405168266427, -255.38518056873204, -226.51887786528192, -156.2545275583338, -174.24040297524982, -217.64553138166397, -263.3308255918955, -252.39178481307002, -205.2919405579412, -192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.731922734226373, "mean_inference_ms": 10.390626140938997, "mean_action_processing_ms": 0.5187441078702232, "mean_env_wait_ms": 1.009410017776398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8323371410369873, "StateBufferConnector_ms": 0.006422281265258789, "ViewRequirementAgentConnector_ms": 0.2445385456085205}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 562500, "num_agent_steps_trained": 562500, "num_env_steps_sampled": 187500, "num_env_steps_trained": 187500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.591098438674126, "num_agent_steps_trained_throughput_per_sec": 5.591098438674126, "timesteps_total": 562500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 562500, "timers": {"training_iteration_time_ms": 1343490.056, "sample_time_ms": 32149.564, "load_time_ms": 0.824, "load_throughput": 3033547.417, "learn_time_ms": 1311338.006, "learn_throughput": 1.906, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 187500, "num_env_steps_trained": 187500, "num_agent_steps_sampled": 562500, "num_agent_steps_trained": 562500}, "done": false, "episodes_total": 750, "training_iteration": 75, "trial_id": "2532e_00097", "date": "2024-03-14_23-15-51", "timestamp": 1710454551, "time_this_iter_s": 1341.4199261665344, "time_total_s": 106865.18586444855, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 106865.18586444855, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 35.58796636889122, "ram_util_percent": 11.670467682606414}, "checkpoint_dir_name": "checkpoint_000074"}
{"custom_metrics": {"collisions_mean": 54.1, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3515640071998671, "policy_loss": 0.028555995760078744, "vf_loss": 2.510236354951543, "vf_explained_var": -0.1951838370712324, "kl": 0.0, "entropy": 23.756130948559992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 131370.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 570000, "num_agent_steps_trained": 570000}, "sampler_results": {"episode_reward_max": -107.24042415656751, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -218.81728745335255, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 54.1, "collisions_min": 0, "collisions_max": 176, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7304237318428193, "mean_inference_ms": 10.38138046835694, "mean_action_processing_ms": 0.5182421726312344, "mean_env_wait_ms": 1.0085834707667134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8310601711273193, "StateBufferConnector_ms": 0.0063974857330322266, "ViewRequirementAgentConnector_ms": 0.24370718002319336}}, "episode_reward_max": -107.24042415656751, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -218.81728745335255, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-192.61934914415258, -141.72198335862475, -137.7930869975005, -217.78196080786572, -220.82502483769443, -184.4170760252791, -187.1909836949916, -312.9740612954421, -107.24042415656751, -222.74876910426346, -120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7304237318428193, "mean_inference_ms": 10.38138046835694, "mean_action_processing_ms": 0.5182421726312344, "mean_env_wait_ms": 1.0085834707667134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8310601711273193, "StateBufferConnector_ms": 0.0063974857330322266, "ViewRequirementAgentConnector_ms": 0.24370718002319336}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 570000, "num_agent_steps_trained": 570000, "num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.653996935353163, "num_agent_steps_trained_throughput_per_sec": 5.653996935353163, "timesteps_total": 570000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 570000, "timers": {"training_iteration_time_ms": 1340667.591, "sample_time_ms": 32059.95, "load_time_ms": 0.8, "load_throughput": 3124574.63, "learn_time_ms": 1308605.174, "learn_throughput": 1.91, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 190000, "num_env_steps_trained": 190000, "num_agent_steps_sampled": 570000, "num_agent_steps_trained": 570000}, "done": false, "episodes_total": 760, "training_iteration": 76, "trial_id": "2532e_00097", "date": "2024-03-14_23-37-59", "timestamp": 1710455879, "time_this_iter_s": 1326.4972157478333, "time_total_s": 108191.68308019638, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 108191.68308019638, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 34.5671974522293, "ram_util_percent": 10.370700636942676}, "checkpoint_dir_name": "checkpoint_000075"}
{"custom_metrics": {"collisions_mean": 55.02, "collisions_min": 0, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.263617789901354, "policy_loss": 0.0358859580588238, "vf_loss": 2.3294621521414354, "vf_explained_var": -0.17095584818001452, "kl": 0.0, "entropy": 24.506927699604255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 133110.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 192500, "num_env_steps_trained": 192500, "num_agent_steps_sampled": 577500, "num_agent_steps_trained": 577500}, "sampler_results": {"episode_reward_max": -110.74768938572123, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -219.49411318967054, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 55.02, "collisions_min": 0, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7289918805809612, "mean_inference_ms": 10.372552671809544, "mean_action_processing_ms": 0.5177762167123419, "mean_env_wait_ms": 1.0077906412997344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8316102027893066, "StateBufferConnector_ms": 0.006410837173461914, "ViewRequirementAgentConnector_ms": 0.24482393264770508}}, "episode_reward_max": -110.74768938572123, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -219.49411318967054, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-120.98502595942321, -226.42294350838543, -265.10736497907374, -149.61862709239887, -221.78278979852348, -257.92605432105427, -206.50098675354437, -254.33923506777217, -127.16102911337634, -229.7811998050612, -250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7289918805809612, "mean_inference_ms": 10.372552671809544, "mean_action_processing_ms": 0.5177762167123419, "mean_env_wait_ms": 1.0077906412997344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8316102027893066, "StateBufferConnector_ms": 0.006410837173461914, "ViewRequirementAgentConnector_ms": 0.24482393264770508}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 577500, "num_agent_steps_trained": 577500, "num_env_steps_sampled": 192500, "num_env_steps_trained": 192500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.685061876640781, "num_agent_steps_trained_throughput_per_sec": 5.685061876640781, "timesteps_total": 577500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 577500, "timers": {"training_iteration_time_ms": 1338722.127, "sample_time_ms": 32098.473, "load_time_ms": 0.8, "load_throughput": 3124853.975, "learn_time_ms": 1306621.22, "learn_throughput": 1.913, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 192500, "num_env_steps_trained": 192500, "num_agent_steps_sampled": 577500, "num_agent_steps_trained": 577500}, "done": false, "episodes_total": 770, "training_iteration": 77, "trial_id": "2532e_00097", "date": "2024-03-15_00-00-00", "timestamp": 1710457200, "time_this_iter_s": 1319.2488205432892, "time_total_s": 109510.93190073967, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 109510.93190073967, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 34.60549626467449, "ram_util_percent": 10.322945570971186}, "checkpoint_dir_name": "checkpoint_000076"}
{"custom_metrics": {"collisions_mean": 53.24, "collisions_min": 0, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.101337116223428, "policy_loss": 0.030214479680162394, "vf_loss": 2.032316485158671, "vf_explained_var": -0.10345227978695398, "kl": 0.0, "entropy": 24.322256175951026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 134850.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 195000, "num_env_steps_trained": 195000, "num_agent_steps_sampled": 585000, "num_agent_steps_trained": 585000}, "sampler_results": {"episode_reward_max": -110.74768938572123, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -216.23158381621818, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.24, "collisions_min": 0, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7275734588451053, "mean_inference_ms": 10.363897879095363, "mean_action_processing_ms": 0.5173103047801051, "mean_env_wait_ms": 1.0070026882474814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8292207717895508, "StateBufferConnector_ms": 0.0063877105712890625, "ViewRequirementAgentConnector_ms": 0.24401116371154785}}, "episode_reward_max": -110.74768938572123, "episode_reward_min": -357.9404524688659, "episode_reward_mean": -216.23158381621818, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-250.9162463768292, -230.32002105534474, -297.8627153937858, -180.66428522878118, -241.350050789007, -208.5307494007896, -225.2465673642865, -239.19871583361348, -259.2152786928968, -331.5990926324275, -183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7275734588451053, "mean_inference_ms": 10.363897879095363, "mean_action_processing_ms": 0.5173103047801051, "mean_env_wait_ms": 1.0070026882474814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8292207717895508, "StateBufferConnector_ms": 0.0063877105712890625, "ViewRequirementAgentConnector_ms": 0.24401116371154785}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 585000, "num_agent_steps_trained": 585000, "num_env_steps_sampled": 195000, "num_env_steps_trained": 195000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.666274488801581, "num_agent_steps_trained_throughput_per_sec": 5.666274488801581, "timesteps_total": 585000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 585000, "timers": {"training_iteration_time_ms": 1336949.072, "sample_time_ms": 32060.031, "load_time_ms": 0.793, "load_throughput": 3153991.458, "learn_time_ms": 1304886.655, "learn_throughput": 1.916, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 195000, "num_env_steps_trained": 195000, "num_agent_steps_sampled": 585000, "num_agent_steps_trained": 585000}, "done": false, "episodes_total": 780, "training_iteration": 78, "trial_id": "2532e_00097", "date": "2024-03-15_00-22-04", "timestamp": 1710458524, "time_this_iter_s": 1323.6229548454285, "time_total_s": 110834.5548555851, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 110834.5548555851, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 34.99222990952635, "ram_util_percent": 11.135763704097924}, "checkpoint_dir_name": "checkpoint_000077"}
{"custom_metrics": {"collisions_mean": 52.44, "collisions_min": 0, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4471616745468807, "policy_loss": 0.02401426649898633, "vf_loss": 2.700237901697214, "vf_explained_var": -0.04085291826176917, "kl": 0.0, "entropy": 24.768676886065254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 136590.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 197500, "num_env_steps_trained": 197500, "num_agent_steps_sampled": 592500, "num_agent_steps_trained": 592500}, "sampler_results": {"episode_reward_max": -110.74768938572123, "episode_reward_min": -375.263978989952, "episode_reward_mean": -214.74284189220492, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 52.44, "collisions_min": 0, "collisions_max": 202, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7261667280716921, "mean_inference_ms": 10.35524784731376, "mean_action_processing_ms": 0.5168546235287705, "mean_env_wait_ms": 1.0062329776153316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8286354541778564, "StateBufferConnector_ms": 0.006371736526489258, "ViewRequirementAgentConnector_ms": 0.24345874786376953}}, "episode_reward_max": -110.74768938572123, "episode_reward_min": -375.263978989952, "episode_reward_mean": -214.74284189220492, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-183.03828812307825, -138.3420142897738, -141.82497958389666, -233.51666611467394, -263.5921084580825, -149.89121129949487, -217.36260525078234, -236.78519290709605, -193.87961944639267, -293.218033955039, -125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7261667280716921, "mean_inference_ms": 10.35524784731376, "mean_action_processing_ms": 0.5168546235287705, "mean_env_wait_ms": 1.0062329776153316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8286354541778564, "StateBufferConnector_ms": 0.006371736526489258, "ViewRequirementAgentConnector_ms": 0.24345874786376953}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592500, "num_agent_steps_trained": 592500, "num_env_steps_sampled": 197500, "num_env_steps_trained": 197500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.666515838388564, "num_agent_steps_trained_throughput_per_sec": 5.666515838388564, "timesteps_total": 592500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 592500, "timers": {"training_iteration_time_ms": 1335774.862, "sample_time_ms": 32019.012, "load_time_ms": 0.744, "load_throughput": 3358129.704, "learn_time_ms": 1303753.48, "learn_throughput": 1.918, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 197500, "num_env_steps_trained": 197500, "num_agent_steps_sampled": 592500, "num_agent_steps_trained": 592500}, "done": false, "episodes_total": 790, "training_iteration": 79, "trial_id": "2532e_00097", "date": "2024-03-15_00-44-09", "timestamp": 1710459849, "time_this_iter_s": 1323.5667126178741, "time_total_s": 112158.12156820297, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 112158.12156820297, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 34.77993613624268, "ram_util_percent": 10.63847791378393}, "checkpoint_dir_name": "checkpoint_000078"}
{"custom_metrics": {"collisions_mean": 53.68, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4274729256970466, "policy_loss": 0.023640988209156385, "vf_loss": 2.6635893012172187, "vf_explained_var": -0.05882807994025877, "kl": 0.0, "entropy": 25.00554236488781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 138330.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": -110.74768938572123, "episode_reward_min": -397.823612446319, "episode_reward_mean": -217.0659195025915, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 53.68, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7247678602217962, "mean_inference_ms": 10.346662771215724, "mean_action_processing_ms": 0.5163924939375549, "mean_env_wait_ms": 1.0054646064981532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8266952037811279, "StateBufferConnector_ms": 0.0063571929931640625, "ViewRequirementAgentConnector_ms": 0.2427058219909668}}, "episode_reward_max": -110.74768938572123, "episode_reward_min": -397.823612446319, "episode_reward_mean": -217.0659195025915, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-125.84841672039482, -222.66770892665636, -175.33353022170877, -227.93034199048722, -235.89315694285142, -275.9832528975827, -255.8327225656641, -241.4815496963259, -219.5073895719495, -223.74106104313066, -244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7247678602217962, "mean_inference_ms": 10.346662771215724, "mean_action_processing_ms": 0.5163924939375549, "mean_env_wait_ms": 1.0054646064981532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8266952037811279, "StateBufferConnector_ms": 0.0063571929931640625, "ViewRequirementAgentConnector_ms": 0.2427058219909668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.67354380386028, "num_agent_steps_trained_throughput_per_sec": 5.67354380386028, "timesteps_total": 600000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 1333794.569, "sample_time_ms": 31972.375, "load_time_ms": 0.768, "load_throughput": 3253315.131, "learn_time_ms": 1301819.79, "learn_throughput": 1.92, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 800, "training_iteration": 80, "trial_id": "2532e_00097", "date": "2024-03-15_01-06-12", "timestamp": 1710461172, "time_this_iter_s": 1321.927133321762, "time_total_s": 113480.04870152473, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 113480.04870152473, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 34.55841320553781, "ram_util_percent": 10.394941427050055}, "checkpoint_dir_name": "checkpoint_000079"}
{"custom_metrics": {"collisions_mean": 52.8, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4324541950776328, "policy_loss": 0.015724609253510574, "vf_loss": 2.6880609070432597, "vf_explained_var": -0.07989539438965677, "kl": 0.0, "entropy": 24.488643465370966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 140070.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 202500, "num_env_steps_trained": 202500, "num_agent_steps_sampled": 607500, "num_agent_steps_trained": 607500}, "sampler_results": {"episode_reward_max": -110.74768938572123, "episode_reward_min": -397.823612446319, "episode_reward_mean": -215.47860634169493, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 52.8, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.723418332748676, "mean_inference_ms": 10.338506096851988, "mean_action_processing_ms": 0.5159508387166121, "mean_env_wait_ms": 1.004709079804895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8269526958465576, "StateBufferConnector_ms": 0.00635838508605957, "ViewRequirementAgentConnector_ms": 0.24321532249450684}}, "episode_reward_max": -110.74768938572123, "episode_reward_min": -397.823612446319, "episode_reward_mean": -215.47860634169493, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-244.95359474110177, -210.42961334056622, -209.61740018661845, -212.692002295485, -338.6497348977986, -305.5615626267193, -257.50392589501166, -259.92819094153367, -198.80372883952558, -323.2388827435428, -210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.723418332748676, "mean_inference_ms": 10.338506096851988, "mean_action_processing_ms": 0.5159508387166121, "mean_env_wait_ms": 1.004709079804895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8269526958465576, "StateBufferConnector_ms": 0.00635838508605957, "ViewRequirementAgentConnector_ms": 0.24321532249450684}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 607500, "num_agent_steps_trained": 607500, "num_env_steps_sampled": 202500, "num_env_steps_trained": 202500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.6639639444306935, "num_agent_steps_trained_throughput_per_sec": 5.6639639444306935, "timesteps_total": 607500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 607500, "timers": {"training_iteration_time_ms": 1331962.648, "sample_time_ms": 32009.476, "load_time_ms": 0.769, "load_throughput": 3252205.198, "learn_time_ms": 1299950.779, "learn_throughput": 1.923, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 202500, "num_env_steps_trained": 202500, "num_agent_steps_sampled": 607500, "num_agent_steps_trained": 607500}, "done": false, "episodes_total": 810, "training_iteration": 81, "trial_id": "2532e_00097", "date": "2024-03-15_01-28-17", "timestamp": 1710462497, "time_this_iter_s": 1324.1629612445831, "time_total_s": 114804.21166276932, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 114804.21166276932, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 34.49829787234043, "ram_util_percent": 10.38372340425532}, "checkpoint_dir_name": "checkpoint_000080"}
{"custom_metrics": {"collisions_mean": 48.18, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4035572992238998, "policy_loss": 0.03464935386055631, "vf_loss": 2.597325533911072, "vf_explained_var": -0.059620129308481325, "kl": 0.0, "entropy": 24.208405654731838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 141810.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 205000, "num_env_steps_trained": 205000, "num_agent_steps_sampled": 615000, "num_agent_steps_trained": 615000}, "sampler_results": {"episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -209.29566792172068, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 48.18, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7220348686329976, "mean_inference_ms": 10.330182586566016, "mean_action_processing_ms": 0.5154900509496105, "mean_env_wait_ms": 1.0039481757346156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8247838020324707, "StateBufferConnector_ms": 0.006326913833618164, "ViewRequirementAgentConnector_ms": 0.2419576644897461}}, "episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -209.29566792172068, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-210.26467129558688, -191.4428326670074, -221.22438450694338, -139.00086288741872, -241.44516091876636, -243.93743431736962, -345.6289914421168, -227.3002544441743, -159.60080424077623, -250.15020131914227, -234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7220348686329976, "mean_inference_ms": 10.330182586566016, "mean_action_processing_ms": 0.5154900509496105, "mean_env_wait_ms": 1.0039481757346156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8247838020324707, "StateBufferConnector_ms": 0.006326913833618164, "ViewRequirementAgentConnector_ms": 0.2419576644897461}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 615000, "num_agent_steps_trained": 615000, "num_env_steps_sampled": 205000, "num_env_steps_trained": 205000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.657964893759247, "num_agent_steps_trained_throughput_per_sec": 5.657964893759247, "timesteps_total": 615000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 615000, "timers": {"training_iteration_time_ms": 1331360.65, "sample_time_ms": 31909.441, "load_time_ms": 0.809, "load_throughput": 3092050.012, "learn_time_ms": 1299448.775, "learn_throughput": 1.924, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 205000, "num_env_steps_trained": 205000, "num_agent_steps_sampled": 615000, "num_agent_steps_trained": 615000}, "done": false, "episodes_total": 820, "training_iteration": 82, "trial_id": "2532e_00097", "date": "2024-03-15_01-50-23", "timestamp": 1710463823, "time_this_iter_s": 1325.566957950592, "time_total_s": 116129.77862071991, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 116129.77862071991, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 34.52603613177471, "ram_util_percent": 10.396599362380448}, "checkpoint_dir_name": "checkpoint_000081"}
{"custom_metrics": {"collisions_mean": 45.76, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3086821685725791, "policy_loss": 0.02805562988084195, "vf_loss": 2.429823001568345, "vf_explained_var": -0.21061371273692997, "kl": 0.0, "entropy": 24.419381308281558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 143550.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 207500, "num_env_steps_trained": 207500, "num_agent_steps_sampled": 622500, "num_agent_steps_trained": 622500}, "sampler_results": {"episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -205.40375637181697, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 45.76, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7206211376741607, "mean_inference_ms": 10.321853320640503, "mean_action_processing_ms": 0.5150241704736536, "mean_env_wait_ms": 1.0031890100138905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8232383728027344, "StateBufferConnector_ms": 0.006304502487182617, "ViewRequirementAgentConnector_ms": 0.24097776412963867}}, "episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -205.40375637181697, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-234.4705203986876, -195.37454743848204, -248.38798530752808, -270.9598065946101, -245.98476461570448, -239.4693548381608, -132.7914739818823, -240.5266016165238, -242.87592745674598, -148.4456341980827, -158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7206211376741607, "mean_inference_ms": 10.321853320640503, "mean_action_processing_ms": 0.5150241704736536, "mean_env_wait_ms": 1.0031890100138905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8232383728027344, "StateBufferConnector_ms": 0.006304502487182617, "ViewRequirementAgentConnector_ms": 0.24097776412963867}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 622500, "num_agent_steps_trained": 622500, "num_env_steps_sampled": 207500, "num_env_steps_trained": 207500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.65583324282933, "num_agent_steps_trained_throughput_per_sec": 5.65583324282933, "timesteps_total": 622500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 622500, "timers": {"training_iteration_time_ms": 1328556.831, "sample_time_ms": 31849.584, "load_time_ms": 0.81, "load_throughput": 3087406.884, "learn_time_ms": 1296704.818, "learn_throughput": 1.928, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 207500, "num_env_steps_trained": 207500, "num_agent_steps_sampled": 622500, "num_agent_steps_trained": 622500}, "done": false, "episodes_total": 830, "training_iteration": 83, "trial_id": "2532e_00097", "date": "2024-03-15_02-12-30", "timestamp": 1710465150, "time_this_iter_s": 1326.0664887428284, "time_total_s": 117455.84510946274, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 117455.84510946274, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 34.61483253588517, "ram_util_percent": 10.372886762360448}, "checkpoint_dir_name": "checkpoint_000082"}
{"custom_metrics": {"collisions_mean": 44.16, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.1691806240885079, "policy_loss": 0.02913409907012193, "vf_loss": 2.1630906341062195, "vf_explained_var": -0.1047029242775906, "kl": 0.0, "entropy": 24.54034433474486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 145290.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -202.46120135383487, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 44.16, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7191296033202155, "mean_inference_ms": 10.313122050335428, "mean_action_processing_ms": 0.5145244208972535, "mean_env_wait_ms": 1.0024001837384415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8190913200378418, "StateBufferConnector_ms": 0.006064891815185547, "ViewRequirementAgentConnector_ms": 0.23892712593078613}}, "episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -202.46120135383487, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-158.74248692604252, -241.33747196334505, -123.89400415250701, -165.61696058965174, -309.70172566468887, -246.42050083989756, -183.9889794098914, -259.03102188327773, -227.36277368689372, -357.9404524688659, -129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7191296033202155, "mean_inference_ms": 10.313122050335428, "mean_action_processing_ms": 0.5145244208972535, "mean_env_wait_ms": 1.0024001837384415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8190913200378418, "StateBufferConnector_ms": 0.006064891815185547, "ViewRequirementAgentConnector_ms": 0.23892712593078613}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.669649050288572, "num_agent_steps_trained_throughput_per_sec": 5.669649050288572, "timesteps_total": 630000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 1325489.42, "sample_time_ms": 31689.74, "load_time_ms": 0.83, "load_throughput": 3010294.835, "learn_time_ms": 1293797.215, "learn_throughput": 1.932, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 210000, "num_env_steps_trained": 210000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 840, "training_iteration": 84, "trial_id": "2532e_00097", "date": "2024-03-15_02-34-33", "timestamp": 1710466473, "time_this_iter_s": 1322.8352284431458, "time_total_s": 118778.68033790588, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 118778.68033790588, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 34.62422790202343, "ram_util_percent": 10.315921192758253}, "checkpoint_dir_name": "checkpoint_000083"}
{"custom_metrics": {"collisions_mean": 44.24, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4811500224710346, "policy_loss": 0.02170045872743445, "vf_loss": 2.7691165369303747, "vf_explained_var": -0.031530083527510196, "kl": 0.0, "entropy": 24.91307896361954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 147030.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 212500, "num_env_steps_trained": 212500, "num_agent_steps_sampled": 637500, "num_agent_steps_trained": 637500}, "sampler_results": {"episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -203.12302522301994, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 44.24, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7176970647996177, "mean_inference_ms": 10.304636728774854, "mean_action_processing_ms": 0.5140493246256771, "mean_env_wait_ms": 1.0016403462148344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8215303421020508, "StateBufferConnector_ms": 0.006091117858886719, "ViewRequirementAgentConnector_ms": 0.24001765251159668}}, "episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -203.12302522301994, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-129.94854922831587, -198.3143393256001, -244.21706629677473, -212.33028198375632, -135.05788071860115, -270.9377247757259, -209.31852760840653, -173.5925481422163, -227.0553606976481, -110.74768938572123, -133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7176970647996177, "mean_inference_ms": 10.304636728774854, "mean_action_processing_ms": 0.5140493246256771, "mean_env_wait_ms": 1.0016403462148344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8215303421020508, "StateBufferConnector_ms": 0.006091117858886719, "ViewRequirementAgentConnector_ms": 0.24001765251159668}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 637500, "num_agent_steps_trained": 637500, "num_env_steps_sampled": 212500, "num_env_steps_trained": 212500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.667855827080573, "num_agent_steps_trained_throughput_per_sec": 5.667855827080573, "timesteps_total": 637500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 637500, "timers": {"training_iteration_time_ms": 1323672.794, "sample_time_ms": 31705.518, "load_time_ms": 0.828, "load_throughput": 3018961.794, "learn_time_ms": 1291964.806, "learn_throughput": 1.935, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 212500, "num_env_steps_trained": 212500, "num_agent_steps_sampled": 637500, "num_agent_steps_trained": 637500}, "done": false, "episodes_total": 850, "training_iteration": 85, "trial_id": "2532e_00097", "date": "2024-03-15_02-56-38", "timestamp": 1710467798, "time_this_iter_s": 1323.2536993026733, "time_total_s": 120101.93403720856, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 120101.93403720856, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 34.6315593400745, "ram_util_percent": 10.331931878658862}, "checkpoint_dir_name": "checkpoint_000084"}
{"custom_metrics": {"collisions_mean": 43.18, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.3230119775078826, "policy_loss": 0.03143552810250749, "vf_loss": 2.4505990307564023, "vf_explained_var": -0.19441597835085858, "kl": 0.0, "entropy": 24.584291079948688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 148770.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 215000, "num_env_steps_trained": 215000, "num_agent_steps_sampled": 645000, "num_agent_steps_trained": 645000}, "sampler_results": {"episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -203.6941600379045, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 43.18, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7162789395931066, "mean_inference_ms": 10.296223744815086, "mean_action_processing_ms": 0.5135745397572137, "mean_env_wait_ms": 1.0008975146443446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.821542501449585, "StateBufferConnector_ms": 0.006112813949584961, "ViewRequirementAgentConnector_ms": 0.2399888038635254}}, "episode_reward_max": -99.47794684123137, "episode_reward_min": -397.823612446319, "episode_reward_mean": -203.6941600379045, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-133.56359705031423, -140.05171515301893, -229.28338058756776, -222.16539652435605, -121.04773395843779, -348.29476926686385, -221.9367762411711, -257.0174982201835, -181.7713024099517, -137.86312364231165, -161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7162789395931066, "mean_inference_ms": 10.296223744815086, "mean_action_processing_ms": 0.5135745397572137, "mean_env_wait_ms": 1.0008975146443446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.821542501449585, "StateBufferConnector_ms": 0.006112813949584961, "ViewRequirementAgentConnector_ms": 0.2399888038635254}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 645000, "num_agent_steps_trained": 645000, "num_env_steps_sampled": 215000, "num_env_steps_trained": 215000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.69660973082533, "num_agent_steps_trained_throughput_per_sec": 5.69660973082533, "timesteps_total": 645000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 645000, "timers": {"training_iteration_time_ms": 1322680.525, "sample_time_ms": 31674.063, "load_time_ms": 0.793, "load_throughput": 3151716.261, "learn_time_ms": 1291004.044, "learn_throughput": 1.936, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 215000, "num_env_steps_trained": 215000, "num_agent_steps_sampled": 645000, "num_agent_steps_trained": 645000}, "done": false, "episodes_total": 860, "training_iteration": 86, "trial_id": "2532e_00097", "date": "2024-03-15_03-18-35", "timestamp": 1710469115, "time_this_iter_s": 1316.5745570659637, "time_total_s": 121418.50859427452, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 121418.50859427452, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 34.610160427807486, "ram_util_percent": 10.375828877005349}, "checkpoint_dir_name": "checkpoint_000085"}
{"custom_metrics": {"collisions_mean": 40.78, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 0.9920071928020588, "policy_loss": 0.03506513580883286, "vf_loss": 1.8156736291002953, "vf_explained_var": 0.007007045410145288, "kl": 0.0, "entropy": 24.10813497346023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 150510.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 217500, "num_env_steps_trained": 217500, "num_agent_steps_sampled": 652500, "num_agent_steps_trained": 652500}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -397.823612446319, "episode_reward_mean": -201.613816103375, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 40.78, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7148206889648892, "mean_inference_ms": 10.287609215302453, "mean_action_processing_ms": 0.5130738267772109, "mean_env_wait_ms": 1.000143369965311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8191514015197754, "StateBufferConnector_ms": 0.006087779998779297, "ViewRequirementAgentConnector_ms": 0.23813581466674805}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -397.823612446319, "episode_reward_mean": -201.613816103375, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-161.68448636993548, -171.34738921275536, -160.67528501581432, -175.7635520806018, -143.137434246656, -143.8811391647039, -260.2992398426425, -213.1344185517773, -180.49923849962437, -122.95013606886513, -182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7148206889648892, "mean_inference_ms": 10.287609215302453, "mean_action_processing_ms": 0.5130738267772109, "mean_env_wait_ms": 1.000143369965311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8191514015197754, "StateBufferConnector_ms": 0.006087779998779297, "ViewRequirementAgentConnector_ms": 0.23813581466674805}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652500, "num_agent_steps_trained": 652500, "num_env_steps_sampled": 217500, "num_env_steps_trained": 217500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.721738765701115, "num_agent_steps_trained_throughput_per_sec": 5.721738765701115, "timesteps_total": 652500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 652500, "timers": {"training_iteration_time_ms": 1321834.876, "sample_time_ms": 31559.183, "load_time_ms": 0.792, "load_throughput": 3157410.419, "learn_time_ms": 1290273.256, "learn_throughput": 1.938, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 217500, "num_env_steps_trained": 217500, "num_agent_steps_sampled": 652500, "num_agent_steps_trained": 652500}, "done": false, "episodes_total": 870, "training_iteration": 87, "trial_id": "2532e_00097", "date": "2024-03-15_03-40-27", "timestamp": 1710470427, "time_this_iter_s": 1310.792319059372, "time_total_s": 122729.3009133339, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 122729.3009133339, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.63623655913978, "ram_util_percent": 10.351989247311831}, "checkpoint_dir_name": "checkpoint_000086"}
{"custom_metrics": {"collisions_mean": 41.24, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.2657255991841077, "policy_loss": 0.03495007889805597, "vf_loss": 2.3352371489950294, "vf_explained_var": -0.02418829644548482, "kl": 0.0, "entropy": 24.825830108817968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 152250.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -397.823612446319, "episode_reward_mean": -203.42881502793708, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 41.24, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7134295625622178, "mean_inference_ms": 10.279426171142276, "mean_action_processing_ms": 0.5126044144578832, "mean_env_wait_ms": 0.9994282110108539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8190145492553711, "StateBufferConnector_ms": 0.006088972091674805, "ViewRequirementAgentConnector_ms": 0.23788714408874512}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -397.823612446319, "episode_reward_mean": -203.42881502793708, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-182.4179849780779, -122.46938522314773, -237.8597882006281, -264.58905901848993, -375.263978989952, -206.61546581195577, -300.8355593252572, -251.26895737854542, -215.9713350162222, -158.73801642415955, -229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7134295625622178, "mean_inference_ms": 10.279426171142276, "mean_action_processing_ms": 0.5126044144578832, "mean_env_wait_ms": 0.9994282110108539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8190145492553711, "StateBufferConnector_ms": 0.006088972091674805, "ViewRequirementAgentConnector_ms": 0.23788714408874512}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.71028691477946, "num_agent_steps_trained_throughput_per_sec": 5.71028691477946, "timesteps_total": 660000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 1320814.686, "sample_time_ms": 31614.907, "load_time_ms": 0.791, "load_throughput": 3159408.238, "learn_time_ms": 1289197.34, "learn_throughput": 1.939, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 880, "training_iteration": 88, "trial_id": "2532e_00097", "date": "2024-03-15_04-02-21", "timestamp": 1710471741, "time_this_iter_s": 1313.4210646152496, "time_total_s": 124042.72197794914, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 124042.72197794914, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 34.63536977491961, "ram_util_percent": 10.3438370846731}, "checkpoint_dir_name": "checkpoint_000087"}
{"custom_metrics": {"collisions_mean": 38.54, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.343413253124782, "policy_loss": 0.019436940013420306, "vf_loss": 2.512073596768167, "vf_explained_var": 0.0014509843683790887, "kl": 0.0, "entropy": 25.19080385010818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 153990.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 222500, "num_env_steps_trained": 222500, "num_agent_steps_sampled": 667500, "num_agent_steps_trained": 667500}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -397.823612446319, "episode_reward_mean": -200.1927173311752, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 38.54, "collisions_min": 0, "collisions_max": 214, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7119775567064743, "mean_inference_ms": 10.270901511335701, "mean_action_processing_ms": 0.5120978835042052, "mean_env_wait_ms": 0.9986900922727219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8159568309783936, "StateBufferConnector_ms": 0.0060272216796875, "ViewRequirementAgentConnector_ms": 0.23571372032165527}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -397.823612446319, "episode_reward_mean": -200.1927173311752, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-229.5344971879223, -211.4930920660478, -127.03772959754242, -273.6919124257957, -235.9654713592156, -139.29332158274642, -200.3213239092258, -246.76675978208377, -397.823612446319, -221.83076011007142, -133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7119775567064743, "mean_inference_ms": 10.270901511335701, "mean_action_processing_ms": 0.5120978835042052, "mean_env_wait_ms": 0.9986900922727219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8159568309783936, "StateBufferConnector_ms": 0.0060272216796875, "ViewRequirementAgentConnector_ms": 0.23571372032165527}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 667500, "num_agent_steps_trained": 667500, "num_env_steps_sampled": 222500, "num_env_steps_trained": 222500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.712633838437892, "num_agent_steps_trained_throughput_per_sec": 5.712633838437892, "timesteps_total": 667500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 667500, "timers": {"training_iteration_time_ms": 1319746.174, "sample_time_ms": 31462.821, "load_time_ms": 0.84, "load_throughput": 2975105.689, "learn_time_ms": 1288280.867, "learn_throughput": 1.941, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 222500, "num_env_steps_trained": 222500, "num_agent_steps_sampled": 667500, "num_agent_steps_trained": 667500}, "done": false, "episodes_total": 890, "training_iteration": 89, "trial_id": "2532e_00097", "date": "2024-03-15_04-24-15", "timestamp": 1710473055, "time_this_iter_s": 1312.881513595581, "time_total_s": 125355.60349154472, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 125355.60349154472, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 34.501127214170694, "ram_util_percent": 10.266774020397209}, "checkpoint_dir_name": "checkpoint_000088"}
{"custom_metrics": {"collisions_mean": 34.18, "collisions_min": 0, "collisions_max": 104, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.155262630550999, "policy_loss": 0.03480426939150811, "vf_loss": 2.1259246283649715, "vf_explained_var": -0.1644303614380716, "kl": 0.0, "entropy": 24.909012737493406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 155730.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 675000, "num_agent_steps_trained": 675000}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -321.57667405189017, "episode_reward_mean": -194.2997110258876, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 34.18, "collisions_min": 0, "collisions_max": 104, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.710513858312671, "mean_inference_ms": 10.262331205839741, "mean_action_processing_ms": 0.51158820000189, "mean_env_wait_ms": 0.9979533522754228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8144562244415283, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.23451781272888184}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -321.57667405189017, "episode_reward_mean": -194.2997110258876, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-133.54783983132884, -226.12971891734733, -258.44926122832766, -255.30912949416097, -175.09324012136534, -112.2042276821081, -128.01942859122337, -321.57667405189017, -216.69975833142655, -218.45853623791993, -259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.710513858312671, "mean_inference_ms": 10.262331205839741, "mean_action_processing_ms": 0.51158820000189, "mean_env_wait_ms": 0.9979533522754228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8144562244415283, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.23451781272888184}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 675000, "num_agent_steps_trained": 675000, "num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.699982616122811, "num_agent_steps_trained_throughput_per_sec": 5.699982616122811, "timesteps_total": 675000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 675000, "timers": {"training_iteration_time_ms": 1319133.012, "sample_time_ms": 31391.206, "load_time_ms": 0.815, "load_throughput": 3067267.302, "learn_time_ms": 1287739.361, "learn_throughput": 1.941, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 225000, "num_env_steps_trained": 225000, "num_agent_steps_sampled": 675000, "num_agent_steps_trained": 675000}, "done": false, "episodes_total": 900, "training_iteration": 90, "trial_id": "2532e_00097", "date": "2024-03-15_04-46-11", "timestamp": 1710474371, "time_this_iter_s": 1315.7954518795013, "time_total_s": 126671.39894342422, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 126671.39894342422, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 34.50251740760579, "ram_util_percent": 10.26732726298875}, "checkpoint_dir_name": "checkpoint_000089"}
{"custom_metrics": {"collisions_mean": 34.66, "collisions_min": 0, "collisions_max": 104, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.396582384556318, "policy_loss": 0.02762721270274628, "vf_loss": 2.59741514347408, "vf_explained_var": -0.18051835949393524, "kl": 0.0, "entropy": 26.02486427350976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 157470.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 227500, "num_env_steps_trained": 227500, "num_agent_steps_sampled": 682500, "num_agent_steps_trained": 682500}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -195.24669358095073, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 34.66, "collisions_min": 0, "collisions_max": 104, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7090735180986258, "mean_inference_ms": 10.253778334248468, "mean_action_processing_ms": 0.5110831281416608, "mean_env_wait_ms": 0.9972317560455022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8147435188293457, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.23447799682617188}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -195.24669358095073, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-259.5452997260537, -200.146246369513, -232.3481013144576, -224.56941051845456, -166.008221424763, -99.47794684123137, -135.213310791249, -259.5247258658765, -210.59942752510347, -155.65210413376863, -199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7090735180986258, "mean_inference_ms": 10.253778334248468, "mean_action_processing_ms": 0.5110831281416608, "mean_env_wait_ms": 0.9972317560455022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8147435188293457, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.23447799682617188}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 682500, "num_agent_steps_trained": 682500, "num_env_steps_sampled": 227500, "num_env_steps_trained": 227500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.7152857271219775, "num_agent_steps_trained_throughput_per_sec": 5.7152857271219775, "timesteps_total": 682500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 682500, "timers": {"training_iteration_time_ms": 1317943.95, "sample_time_ms": 31350.519, "load_time_ms": 0.86, "load_throughput": 2908590.608, "learn_time_ms": 1286590.942, "learn_throughput": 1.943, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 227500, "num_env_steps_trained": 227500, "num_agent_steps_sampled": 682500, "num_agent_steps_trained": 682500}, "done": false, "episodes_total": 910, "training_iteration": 91, "trial_id": "2532e_00097", "date": "2024-03-15_05-08-04", "timestamp": 1710475684, "time_this_iter_s": 1312.272314786911, "time_total_s": 127983.67125821114, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 127983.67125821114, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 34.567113733905586, "ram_util_percent": 10.23047210300429}, "checkpoint_dir_name": "checkpoint_000090"}
{"custom_metrics": {"collisions_mean": 35.44, "collisions_min": 0, "collisions_max": 104, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.306730622247172, "policy_loss": 0.03716431253364888, "vf_loss": 2.4088376619178673, "vf_explained_var": -0.015162538317428238, "kl": 0.0, "entropy": 25.529361871741283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 159210.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 690000, "num_agent_steps_trained": 690000}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -195.8399918783753, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 35.44, "collisions_min": 0, "collisions_max": 104, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7076475928072439, "mean_inference_ms": 10.245342569545192, "mean_action_processing_ms": 0.5105816094313446, "mean_env_wait_ms": 0.9965167780865385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.812877893447876, "StateBufferConnector_ms": 0.0059778690338134766, "ViewRequirementAgentConnector_ms": 0.2334439754486084}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -195.8399918783753, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-199.61024932213812, -258.7298838151587, -174.78780103994802, -137.284785926273, -109.32194259141487, -175.48533965906486, -203.10516631129062, -284.59351746572395, -104.56034658868184, -193.32541032923805, -251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7076475928072439, "mean_inference_ms": 10.245342569545192, "mean_action_processing_ms": 0.5105816094313446, "mean_env_wait_ms": 0.9965167780865385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.812877893447876, "StateBufferConnector_ms": 0.0059778690338134766, "ViewRequirementAgentConnector_ms": 0.2334439754486084}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 690000, "num_agent_steps_trained": 690000, "num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.737742556292855, "num_agent_steps_trained_throughput_per_sec": 5.737742556292855, "timesteps_total": 690000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 690000, "timers": {"training_iteration_time_ms": 1316100.882, "sample_time_ms": 31322.86, "load_time_ms": 0.821, "load_throughput": 3043673.623, "learn_time_ms": 1284775.568, "learn_throughput": 1.946, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 230000, "num_env_steps_trained": 230000, "num_agent_steps_sampled": 690000, "num_agent_steps_trained": 690000}, "done": false, "episodes_total": 920, "training_iteration": 92, "trial_id": "2532e_00097", "date": "2024-03-15_05-29-53", "timestamp": 1710476993, "time_this_iter_s": 1307.1362931728363, "time_total_s": 129290.80755138397, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 129290.80755138397, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 34.607162089391494, "ram_util_percent": 10.393322563274099}, "checkpoint_dir_name": "checkpoint_000091"}
{"custom_metrics": {"collisions_mean": 35.02, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.1569108688382261, "policy_loss": 0.022885660751958258, "vf_loss": 2.151665959635685, "vf_explained_var": -0.028668225496664815, "kl": 0.0, "entropy": 24.746269147149448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 160950.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled": 697500, "num_agent_steps_trained": 697500}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -195.15532134908818, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 35.02, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7062467508252095, "mean_inference_ms": 10.237004411997935, "mean_action_processing_ms": 0.51008899677654, "mean_env_wait_ms": 0.9958134564130401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.813016414642334, "StateBufferConnector_ms": 0.0059697628021240234, "ViewRequirementAgentConnector_ms": 0.23380374908447266}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -195.15532134908818, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-251.36558413004445, -185.18807332772747, -224.52019965985633, -184.36964735180962, -170.55200418097363, -127.70693461512566, -153.87994905585572, -204.55075357680673, -215.91515043533767, -186.98281831465968, -253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7062467508252095, "mean_inference_ms": 10.237004411997935, "mean_action_processing_ms": 0.51008899677654, "mean_env_wait_ms": 0.9958134564130401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.813016414642334, "StateBufferConnector_ms": 0.0059697628021240234, "ViewRequirementAgentConnector_ms": 0.23380374908447266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 697500, "num_agent_steps_trained": 697500, "num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.7049027498198965, "num_agent_steps_trained_throughput_per_sec": 5.7049027498198965, "timesteps_total": 697500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 697500, "timers": {"training_iteration_time_ms": 1314960.296, "sample_time_ms": 31303.441, "load_time_ms": 0.882, "load_throughput": 2833300.008, "learn_time_ms": 1283654.341, "learn_throughput": 1.948, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 232500, "num_env_steps_trained": 232500, "num_agent_steps_sampled": 697500, "num_agent_steps_trained": 697500}, "done": false, "episodes_total": 930, "training_iteration": 93, "trial_id": "2532e_00097", "date": "2024-03-15_05-51-49", "timestamp": 1710478309, "time_this_iter_s": 1314.660629272461, "time_total_s": 130605.46818065643, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 130605.46818065643, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 34.61172376873662, "ram_util_percent": 10.360171306209851}, "checkpoint_dir_name": "checkpoint_000092"}
{"custom_metrics": {"collisions_mean": 36.06, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.357981099200906, "policy_loss": 0.0348497294919865, "vf_loss": 2.510470418152453, "vf_explained_var": -0.036337506668321015, "kl": 0.0, "entropy": 25.972529452970658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 162690.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 235000, "num_env_steps_trained": 235000, "num_agent_steps_sampled": 705000, "num_agent_steps_trained": 705000}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -198.59772622126675, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 36.06, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7048608905677523, "mean_inference_ms": 10.228751696774687, "mean_action_processing_ms": 0.5095945964607626, "mean_env_wait_ms": 0.9951135396593104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8125607967376709, "StateBufferConnector_ms": 0.00595855712890625, "ViewRequirementAgentConnector_ms": 0.2327561378479004}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -320.25622201855316, "episode_reward_mean": -198.59772622126675, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-253.5381603937093, -235.3373774000316, -320.25622201855316, -226.31964319757614, -229.73141745224189, -197.25929811106064, -111.59076623865383, -224.18717496272978, -298.6292852989559, -243.3694194300592, -145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7048608905677523, "mean_inference_ms": 10.228751696774687, "mean_action_processing_ms": 0.5095945964607626, "mean_env_wait_ms": 0.9951135396593104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8125607967376709, "StateBufferConnector_ms": 0.00595855712890625, "ViewRequirementAgentConnector_ms": 0.2327561378479004}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 705000, "num_agent_steps_trained": 705000, "num_env_steps_sampled": 235000, "num_env_steps_trained": 235000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.701212427217484, "num_agent_steps_trained_throughput_per_sec": 5.701212427217484, "timesteps_total": 705000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 705000, "timers": {"training_iteration_time_ms": 1314227.942, "sample_time_ms": 31269.345, "load_time_ms": 0.859, "load_throughput": 2911336.313, "learn_time_ms": 1282956.13, "learn_throughput": 1.949, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 235000, "num_env_steps_trained": 235000, "num_agent_steps_sampled": 705000, "num_agent_steps_trained": 705000}, "done": false, "episodes_total": 940, "training_iteration": 94, "trial_id": "2532e_00097", "date": "2024-03-15_06-13-45", "timestamp": 1710479625, "time_this_iter_s": 1315.5115766525269, "time_total_s": 131920.97975730896, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 131920.97975730896, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 34.61805034815211, "ram_util_percent": 10.336261381896092}, "checkpoint_dir_name": "checkpoint_000093"}
{"custom_metrics": {"collisions_mean": 32.9, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.1511003914227624, "policy_loss": 0.040611352349214, "vf_loss": 2.107009129217644, "vf_explained_var": -0.014311154272364474, "kl": 0.0, "entropy": 25.248943288298857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 164430.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 237500, "num_env_steps_trained": 237500, "num_agent_steps_sampled": 712500, "num_agent_steps_trained": 712500}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -307.48156770791223, "episode_reward_mean": -193.07308667440026, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 32.9, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7034326078283328, "mean_inference_ms": 10.220322851175961, "mean_action_processing_ms": 0.5090790466089197, "mean_env_wait_ms": 0.99439706479973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8080182075500488, "StateBufferConnector_ms": 0.005907773971557617, "ViewRequirementAgentConnector_ms": 0.23067164421081543}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -307.48156770791223, "episode_reward_mean": -193.07308667440026, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-145.3952666279263, -209.01839589538912, -200.66040017050022, -178.35615821869084, -240.68747618905854, -307.48156770791223, -201.9423062392466, -209.9717531965122, -144.7887328945743, -130.3313925114177, -211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7034326078283328, "mean_inference_ms": 10.220322851175961, "mean_action_processing_ms": 0.5090790466089197, "mean_env_wait_ms": 0.99439706479973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8080182075500488, "StateBufferConnector_ms": 0.005907773971557617, "ViewRequirementAgentConnector_ms": 0.23067164421081543}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712500, "num_agent_steps_trained": 712500, "num_env_steps_sampled": 237500, "num_env_steps_trained": 237500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.70994351358012, "num_agent_steps_trained_throughput_per_sec": 5.70994351358012, "timesteps_total": 712500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 712500, "timers": {"training_iteration_time_ms": 1313252.58, "sample_time_ms": 31156.938, "load_time_ms": 0.909, "load_throughput": 2749930.503, "learn_time_ms": 1282093.127, "learn_throughput": 1.95, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 237500, "num_env_steps_trained": 237500, "num_agent_steps_sampled": 712500, "num_agent_steps_trained": 712500}, "done": false, "episodes_total": 950, "training_iteration": 95, "trial_id": "2532e_00097", "date": "2024-03-15_06-35-39", "timestamp": 1710480939, "time_this_iter_s": 1313.5000400543213, "time_total_s": 133234.47979736328, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 133234.47979736328, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 34.63399463806971, "ram_util_percent": 10.343699731903484}, "checkpoint_dir_name": "checkpoint_000094"}
{"custom_metrics": {"collisions_mean": 33.6, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.411689025294785, "policy_loss": 0.03504652437090274, "vf_loss": 2.612000838684282, "vf_explained_var": -0.21753811730050493, "kl": 0.0, "entropy": 26.79109140703048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 166170.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": -88.20458492983092, "episode_reward_min": -367.85663262035246, "episode_reward_mean": -194.94766998148722, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 33.6, "collisions_min": 0, "collisions_max": 100, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7019984439840443, "mean_inference_ms": 10.21195300481899, "mean_action_processing_ms": 0.5085682230385288, "mean_env_wait_ms": 0.9936850897014444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8076009750366211, "StateBufferConnector_ms": 0.005883932113647461, "ViewRequirementAgentConnector_ms": 0.23053979873657227}}, "episode_reward_max": -88.20458492983092, "episode_reward_min": -367.85663262035246, "episode_reward_mean": -194.94766998148722, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-211.29989497559933, -244.44189554938058, -180.0300974773012, -152.4515137439986, -181.9142527901128, -229.9183059366977, -169.9125595120256, -127.05983926532897, -199.72795542094389, -88.20458492983092, -209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7019984439840443, "mean_inference_ms": 10.21195300481899, "mean_action_processing_ms": 0.5085682230385288, "mean_env_wait_ms": 0.9936850897014444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8076009750366211, "StateBufferConnector_ms": 0.005883932113647461, "ViewRequirementAgentConnector_ms": 0.23053979873657227}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.693884319897865, "num_agent_steps_trained_throughput_per_sec": 5.693884319897865, "timesteps_total": 720000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 1313315.599, "sample_time_ms": 31120.335, "load_time_ms": 0.902, "load_throughput": 2771957.28, "learn_time_ms": 1282192.776, "learn_throughput": 1.95, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 960, "training_iteration": 96, "trial_id": "2532e_00097", "date": "2024-03-15_06-57-37", "timestamp": 1710482257, "time_this_iter_s": 1317.204751253128, "time_total_s": 134551.6845486164, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 134551.6845486164, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 34.57909090909091, "ram_util_percent": 10.240320855614973}, "checkpoint_dir_name": "checkpoint_000095"}
{"custom_metrics": {"collisions_mean": 36.22, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4910901710377664, "policy_loss": 0.041278612255868125, "vf_loss": 2.7508296685143447, "vf_explained_var": 0.07495782097865795, "kl": 0.0, "entropy": 26.773582574690895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 167910.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 242500, "num_env_steps_trained": 242500, "num_agent_steps_sampled": 727500, "num_agent_steps_trained": 727500}, "sampler_results": {"episode_reward_max": -94.46693795866027, "episode_reward_min": -367.85663262035246, "episode_reward_mean": -199.02301732067423, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 36.22, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.700529297447675, "mean_inference_ms": 10.203403457304812, "mean_action_processing_ms": 0.5080364622109037, "mean_env_wait_ms": 0.9929532289586721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8051633834838867, "StateBufferConnector_ms": 0.00584864616394043, "ViewRequirementAgentConnector_ms": 0.2286849021911621}}, "episode_reward_max": -94.46693795866027, "episode_reward_min": -367.85663262035246, "episode_reward_mean": -199.02301732067423, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-209.15507436341537, -181.4000230917158, -204.83859045048692, -149.3620189522665, -248.13310150966427, -110.72169912507229, -230.54526111771187, -218.98334096636117, -137.22092419265027, -224.51217774023962, -174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.700529297447675, "mean_inference_ms": 10.203403457304812, "mean_action_processing_ms": 0.5080364622109037, "mean_env_wait_ms": 0.9929532289586721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8051633834838867, "StateBufferConnector_ms": 0.00584864616394043, "ViewRequirementAgentConnector_ms": 0.2286849021911621}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 727500, "num_agent_steps_trained": 727500, "num_env_steps_sampled": 242500, "num_env_steps_trained": 242500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.730563909182892, "num_agent_steps_trained_throughput_per_sec": 5.730563909182892, "timesteps_total": 727500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 727500, "timers": {"training_iteration_time_ms": 1313113.735, "sample_time_ms": 30997.532, "load_time_ms": 0.931, "load_throughput": 2684870.055, "learn_time_ms": 1282113.69, "learn_throughput": 1.95, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 242500, "num_env_steps_trained": 242500, "num_agent_steps_sampled": 727500, "num_agent_steps_trained": 727500}, "done": false, "episodes_total": 970, "training_iteration": 97, "trial_id": "2532e_00097", "date": "2024-03-15_07-19-27", "timestamp": 1710483567, "time_this_iter_s": 1308.7737698554993, "time_total_s": 135860.4583184719, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 135860.4583184719, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 34.532490586336735, "ram_util_percent": 10.353146853146853}, "checkpoint_dir_name": "checkpoint_000096"}
{"custom_metrics": {"collisions_mean": 37.0, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4607519374587628, "policy_loss": 0.05634113682444668, "vf_loss": 2.664687600406422, "vf_explained_var": -0.07826926040238348, "kl": 0.0, "entropy": 26.98754613810572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 169650.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 245000, "num_env_steps_trained": 245000, "num_agent_steps_sampled": 735000, "num_agent_steps_trained": 735000}, "sampler_results": {"episode_reward_max": -94.46693795866027, "episode_reward_min": -367.85663262035246, "episode_reward_mean": -201.9068795777105, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 37.0, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6991385403020671, "mean_inference_ms": 10.195175802721932, "mean_action_processing_ms": 0.5075354102194104, "mean_env_wait_ms": 0.9922574911162237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8076634407043457, "StateBufferConnector_ms": 0.005899667739868164, "ViewRequirementAgentConnector_ms": 0.2305769920349121}}, "episode_reward_max": -94.46693795866027, "episode_reward_min": -367.85663262035246, "episode_reward_mean": -201.9068795777105, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-174.49043938512065, -126.06981753698895, -168.33820424024316, -170.8940394496837, -234.99347254434898, -201.28817189877884, -232.93406420944956, -246.7759720283607, -209.16350309969235, -227.47207629758068, -185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6991385403020671, "mean_inference_ms": 10.195175802721932, "mean_action_processing_ms": 0.5075354102194104, "mean_env_wait_ms": 0.9922574911162237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8076634407043457, "StateBufferConnector_ms": 0.005899667739868164, "ViewRequirementAgentConnector_ms": 0.2305769920349121}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 735000, "num_agent_steps_trained": 735000, "num_env_steps_sampled": 245000, "num_env_steps_trained": 245000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.718069250210826, "num_agent_steps_trained_throughput_per_sec": 5.718069250210826, "timesteps_total": 735000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 735000, "timers": {"training_iteration_time_ms": 1312934.977, "sample_time_ms": 31057.448, "load_time_ms": 0.938, "load_throughput": 2666571.726, "learn_time_ms": 1281875.002, "learn_throughput": 1.95, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 245000, "num_env_steps_trained": 245000, "num_agent_steps_sampled": 735000, "num_agent_steps_trained": 735000}, "done": false, "episodes_total": 980, "training_iteration": 98, "trial_id": "2532e_00097", "date": "2024-03-15_07-41-19", "timestamp": 1710484879, "time_this_iter_s": 1311.6335196495056, "time_total_s": 137172.0918381214, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 137172.0918381214, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 34.61219119226638, "ram_util_percent": 10.33984962406015}, "checkpoint_dir_name": "checkpoint_000097"}
{"custom_metrics": {"collisions_mean": 38.28, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.7192306003763458, "policy_loss": 0.04783252448100468, "vf_loss": 3.171261376125374, "vf_explained_var": -0.03134017268131519, "kl": 0.0, "entropy": 28.991604462985336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 171390.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 247500, "num_env_steps_trained": 247500, "num_agent_steps_sampled": 742500, "num_agent_steps_trained": 742500}, "sampler_results": {"episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -206.1803569258087, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 38.28, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.697810161444213, "mean_inference_ms": 10.187367593376592, "mean_action_processing_ms": 0.5070648817131224, "mean_env_wait_ms": 0.9915979049432397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8086800575256348, "StateBufferConnector_ms": 0.0059239864349365234, "ViewRequirementAgentConnector_ms": 0.23122334480285645}}, "episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -206.1803569258087, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-185.63640108062023, -220.86952843235565, -150.9490363487699, -293.6659519142725, -134.90361849085096, -176.54931317983346, -150.37431144005248, -103.47095328048641, -170.58397234029107, -107.45476343067496, -266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.697810161444213, "mean_inference_ms": 10.187367593376592, "mean_action_processing_ms": 0.5070648817131224, "mean_env_wait_ms": 0.9915979049432397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8086800575256348, "StateBufferConnector_ms": 0.0059239864349365234, "ViewRequirementAgentConnector_ms": 0.23122334480285645}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 742500, "num_agent_steps_trained": 742500, "num_env_steps_sampled": 247500, "num_env_steps_trained": 247500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.722089243135595, "num_agent_steps_trained_throughput_per_sec": 5.722089243135595, "timesteps_total": 742500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 742500, "timers": {"training_iteration_time_ms": 1312718.032, "sample_time_ms": 31135.029, "load_time_ms": 0.923, "load_throughput": 2709708.763, "learn_time_ms": 1281580.518, "learn_throughput": 1.951, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 247500, "num_env_steps_trained": 247500, "num_agent_steps_sampled": 742500, "num_agent_steps_trained": 742500}, "done": false, "episodes_total": 990, "training_iteration": 99, "trial_id": "2532e_00097", "date": "2024-03-15_08-03-11", "timestamp": 1710486191, "time_this_iter_s": 1310.7121078968048, "time_total_s": 138482.80394601822, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 138482.80394601822, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 34.63209677419355, "ram_util_percent": 10.239193548387098}, "checkpoint_dir_name": "checkpoint_000098"}
{"custom_metrics": {"collisions_mean": 38.98, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4774319313504016, "policy_loss": 0.06726925864671196, "vf_loss": 2.6756010407774613, "vf_explained_var": -0.17373441879091592, "kl": 0.0, "entropy": 28.62648772097182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 173130.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000}, "sampler_results": {"episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -208.63458519230096, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 38.98, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059, -138.28339537704974, -195.9679887267599, -280.1241310829839, -126.62862059669517, -183.5053797820211, -280.36849643378423, -289.6548429627556, -142.90760861487064, -186.6460892437413, -115.79412376676146], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6965202203866498, "mean_inference_ms": 10.17981881950689, "mean_action_processing_ms": 0.5066082011932462, "mean_env_wait_ms": 0.9909609962954646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8095154762268066, "StateBufferConnector_ms": 0.005930900573730469, "ViewRequirementAgentConnector_ms": 0.23164057731628418}}, "episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -208.63458519230096, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-266.7744284381144, -196.41167854566413, -167.7590264320058, -276.99909398656223, -289.85187675748097, -221.90931489887703, -101.04714346626236, -238.6717595996532, -213.05270513191678, -167.70904273688217, -172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059, -138.28339537704974, -195.9679887267599, -280.1241310829839, -126.62862059669517, -183.5053797820211, -280.36849643378423, -289.6548429627556, -142.90760861487064, -186.6460892437413, -115.79412376676146], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6965202203866498, "mean_inference_ms": 10.17981881950689, "mean_action_processing_ms": 0.5066082011932462, "mean_env_wait_ms": 0.9909609962954646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8095154762268066, "StateBufferConnector_ms": 0.005930900573730469, "ViewRequirementAgentConnector_ms": 0.23164057731628418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000, "num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.7207576805553915, "num_agent_steps_trained_throughput_per_sec": 5.7207576805553915, "timesteps_total": 750000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 750000, "timers": {"training_iteration_time_ms": 1312240.199, "sample_time_ms": 31161.822, "load_time_ms": 0.916, "load_throughput": 2728393.006, "learn_time_ms": 1281075.884, "learn_throughput": 1.951, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 250000, "num_env_steps_trained": 250000, "num_agent_steps_sampled": 750000, "num_agent_steps_trained": 750000}, "done": false, "episodes_total": 1000, "training_iteration": 100, "trial_id": "2532e_00097", "date": "2024-03-15_08-25-03", "timestamp": 1710487503, "time_this_iter_s": 1311.0171029567719, "time_total_s": 139793.821048975, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 139793.821048975, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 34.618689581095595, "ram_util_percent": 10.403437164339422}, "checkpoint_dir_name": "checkpoint_000099"}
{"custom_metrics": {"collisions_mean": 37.48, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.4600365526083021, "policy_loss": 0.050721928085757144, "vf_loss": 2.6739919771579492, "vf_explained_var": -0.07073460748825951, "kl": 0.0, "entropy": 27.54265290731671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 174870.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 252500, "num_env_steps_trained": 252500, "num_agent_steps_sampled": 757500, "num_agent_steps_trained": 757500}, "sampler_results": {"episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -207.3963034155726, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 37.48, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059, -138.28339537704974, -195.9679887267599, -280.1241310829839, -126.62862059669517, -183.5053797820211, -280.36849643378423, -289.6548429627556, -142.90760861487064, -186.6460892437413, -115.79412376676146, -309.2684215038896, -128.3222624060012, -224.74292503416146, -212.4290289997519, -197.76579719433315, -255.46550506267522, -104.53617942786896, -252.4818273301613, -112.79619619769078, -218.54974916405334], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6952340939261417, "mean_inference_ms": 10.172414730171713, "mean_action_processing_ms": 0.5061542607530783, "mean_env_wait_ms": 0.9903331918612994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8075852394104004, "StateBufferConnector_ms": 0.005911350250244141, "ViewRequirementAgentConnector_ms": 0.23032689094543457}}, "episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -207.3963034155726, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-172.79636150850962, -197.1309932721783, -265.4539570293155, -175.2917113119899, -117.73173476031731, -207.26334740577954, -215.77133867499603, -209.65537269316007, -223.1040646092678, -218.21574298740657, -226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059, -138.28339537704974, -195.9679887267599, -280.1241310829839, -126.62862059669517, -183.5053797820211, -280.36849643378423, -289.6548429627556, -142.90760861487064, -186.6460892437413, -115.79412376676146, -309.2684215038896, -128.3222624060012, -224.74292503416146, -212.4290289997519, -197.76579719433315, -255.46550506267522, -104.53617942786896, -252.4818273301613, -112.79619619769078, -218.54974916405334], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6952340939261417, "mean_inference_ms": 10.172414730171713, "mean_action_processing_ms": 0.5061542607530783, "mean_env_wait_ms": 0.9903331918612994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8075852394104004, "StateBufferConnector_ms": 0.005911350250244141, "ViewRequirementAgentConnector_ms": 0.23032689094543457}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 757500, "num_agent_steps_trained": 757500, "num_env_steps_sampled": 252500, "num_env_steps_trained": 252500, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.7314872871166385, "num_agent_steps_trained_throughput_per_sec": 5.7314872871166385, "timesteps_total": 757500, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 757500, "timers": {"training_iteration_time_ms": 1311869.251, "sample_time_ms": 31152.673, "load_time_ms": 0.868, "load_throughput": 2881653.292, "learn_time_ms": 1280714.135, "learn_throughput": 1.952, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 252500, "num_env_steps_trained": 252500, "num_agent_steps_sampled": 757500, "num_agent_steps_trained": 757500}, "done": false, "episodes_total": 1010, "training_iteration": 101, "trial_id": "2532e_00097", "date": "2024-03-15_08-46-52", "timestamp": 1710488812, "time_this_iter_s": 1308.5628354549408, "time_total_s": 141102.38388442993, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 141102.38388442993, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 34.591760904684975, "ram_util_percent": 10.377921378567583}, "checkpoint_dir_name": "checkpoint_000100"}
{"custom_metrics": {"collisions_mean": 34.98, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.0, "cur_lr": 0.0004043384655338905, "total_loss": 1.0238843774717388, "policy_loss": 0.06001767446608122, "vf_loss": 1.8288122454936477, "vf_explained_var": -0.1237886435341561, "kl": 0.0, "entropy": 25.911237550055844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 176610.5, "diff_num_grad_updates_vs_sampler_policy": 869.5}}, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 765000, "num_agent_steps_trained": 765000}, "sampler_results": {"episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -203.08166516541743, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"collisions_mean": 34.98, "collisions_min": 0, "collisions_max": 106, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059, -138.28339537704974, -195.9679887267599, -280.1241310829839, -126.62862059669517, -183.5053797820211, -280.36849643378423, -289.6548429627556, -142.90760861487064, -186.6460892437413, -115.79412376676146, -309.2684215038896, -128.3222624060012, -224.74292503416146, -212.4290289997519, -197.76579719433315, -255.46550506267522, -104.53617942786896, -252.4818273301613, -112.79619619769078, -218.54974916405334, -105.0364379094795, -128.55721443421606, -135.88418060916706, -191.69155449814372, -108.9675567182095, -172.2428813360255, -213.79068584773077, -136.15992723696587, -183.22350634238953, -195.3968543050799], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6940017323539303, "mean_inference_ms": 10.165329494725304, "mean_action_processing_ms": 0.5057257614167608, "mean_env_wait_ms": 0.989733207449646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8091614246368408, "StateBufferConnector_ms": 0.005922794342041016, "ViewRequirementAgentConnector_ms": 0.23090815544128418}}, "episode_reward_max": -94.46693795866027, "episode_reward_min": -408.0389348369806, "episode_reward_mean": -203.08166516541743, "episode_len_mean": 250.0, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-226.00054447417548, -106.34182060058146, -134.83907767195277, -248.01540308209695, -152.03867503902754, -261.7989389574074, -132.64586025028723, -94.46693795866027, -203.67519838628672, -212.51493369975034, -259.79058309988244, -204.7851478786, -259.5895529739893, -206.07889631127222, -246.67189772061494, -240.4214883072328, -265.2340293611887, -223.76926309267287, -127.60426810076953, -215.32647501982726, -107.16819105441016, -160.87043884484382, -229.87971747470556, -196.79073492564345, -237.19069084505648, -202.72041915524105, -129.93559392985168, -126.28102053586133, -235.9062431645022, -161.0117598868107, -203.34157795416544, -95.39023212578212, -367.85663262035246, -308.7626025199757, -154.73222957122303, -207.0094779153584, -227.84363648750605, -98.99542192835878, -228.30840476439428, -263.8515644728115, -166.04145052668528, -297.86060869882016, -200.45239235540507, -206.15794945725727, -178.63585183384816, -289.56829437549857, -227.7458527357919, -192.9009284034886, -208.84999333977123, -224.28231179334892, -225.33411083436536, -216.32441398492102, -216.7587968455286, -171.64335085874515, -219.83475191134, -257.8815442366899, -240.90842999763484, -251.62884893911115, -216.51819371494372, -186.4259958899273, -151.09454831524644, -230.40326809370816, -283.1752930023654, -219.23894443025006, -260.24553896009843, -239.9114666656734, -133.6120361338183, -234.567495679128, -408.0389348369806, -259.4799693828059, -138.28339537704974, -195.9679887267599, -280.1241310829839, -126.62862059669517, -183.5053797820211, -280.36849643378423, -289.6548429627556, -142.90760861487064, -186.6460892437413, -115.79412376676146, -309.2684215038896, -128.3222624060012, -224.74292503416146, -212.4290289997519, -197.76579719433315, -255.46550506267522, -104.53617942786896, -252.4818273301613, -112.79619619769078, -218.54974916405334, -105.0364379094795, -128.55721443421606, -135.88418060916706, -191.69155449814372, -108.9675567182095, -172.2428813360255, -213.79068584773077, -136.15992723696587, -183.22350634238953, -195.3968543050799], "episode_lengths": [250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250, 250]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6940017323539303, "mean_inference_ms": 10.165329494725304, "mean_action_processing_ms": 0.5057257614167608, "mean_env_wait_ms": 0.989733207449646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8091614246368408, "StateBufferConnector_ms": 0.005922794342041016, "ViewRequirementAgentConnector_ms": 0.23090815544128418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 765000, "num_agent_steps_trained": 765000, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled_this_iter": 7500, "num_agent_steps_trained_this_iter": 7500, "num_agent_steps_sampled_throughput_per_sec": 5.678065126530201, "num_agent_steps_trained_throughput_per_sec": 5.678065126530201, "timesteps_total": 765000, "num_steps_trained_this_iter": 7500, "agent_timesteps_total": 765000, "timers": {"training_iteration_time_ms": 1313243.07, "sample_time_ms": 31209.555, "load_time_ms": 0.907, "load_throughput": 2755712.071, "learn_time_ms": 1282031.023, "learn_throughput": 1.95, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 765000, "num_agent_steps_trained": 765000}, "done": false, "episodes_total": 1020, "training_iteration": 102, "trial_id": "2532e_00097", "date": "2024-03-15_09-08-55", "timestamp": 1710490135, "time_this_iter_s": 1320.8745558261871, "time_total_s": 142423.25844025612, "pid": 78088, "hostname": "tikgpu07", "node_ip": "129.132.190.192", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "marl_env", "env_config": {"env_type": "marl", "task_model": "mpe_spread", "task_configs": {"task_0": {"model": {"n_workers": 3, "n_hidden_state": 16, "episode_length": 25, "communication_type": "neighbours", "communication_range": 3, "reward_calculation": "individual_distance", "grid_size": 2}}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.00040433846553389037, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 7500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "marl_env", "actor_config": {"model": "TransformerConv", "rounds": 8, "dropout": 0.06856941518216475}, "critic_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0.049776467251812034}, "encoding_config": {"type": "encoding_small", "encoding_size": 32}, "recurrent_actor": 0, "recurrent_critic": 0, "use_cuda": false, "info": {"env_config": "env_config_mpe_spread_2.yaml", "actor_config": "model_Transformer.yaml", "critic_config": "model_Transformer.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fb3d26f30a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.0, "kl_target": 0.010355059558284389, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.5270452061777405, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.1, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9174270627347995, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.mpe_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 142423.25844025612, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 34.61039445628998, "ram_util_percent": 10.425959488272921}, "checkpoint_dir_name": "checkpoint_000101"}
