{"custom_metrics": {"reward_total_mean": -53.21875, "reward_total_min": -63, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.084228515625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3125, "reward_score_mean": 0.084228515625, "reward_score_min": 0.0078125, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0008365429151557455, "total_loss": 5.705003388722738, "policy_loss": -0.1269878440226118, "vf_loss": 9.307038942972818, "vf_explained_var": -0.004448451101779938, "kl": 0.06249837877141616, "entropy": 95.61446812947591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -63.0, "episode_reward_mean": -53.21875, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -53.21875, "reward_total_min": -63, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.084228515625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3125, "reward_score_mean": 0.084228515625, "reward_score_min": 0.0078125, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -57.0, -54.0, -58.0, -48.0, -61.0, -50.0, -47.0, -62.0, -58.0, -54.0, -62.0, -45.0, -59.0, -45.0, -43.0, -56.0, -52.0, -52.0, -55.0, -48.0, -63.0, -37.0, -58.0, -61.0, -59.0, -52.0, -63.0, -48.0, -53.0, -24.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4733590094434352, "mean_inference_ms": 31.00943611844009, "mean_action_processing_ms": 1.2112918652986224, "mean_env_wait_ms": 0.6892202425653706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6631754338741302, "StateBufferConnector_ms": 0.005172938108444214, "ViewRequirementAgentConnector_ms": 0.4838317632675171}}, "episode_reward_max": -24.0, "episode_reward_min": -63.0, "episode_reward_mean": -53.21875, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -57.0, -54.0, -58.0, -48.0, -61.0, -50.0, -47.0, -62.0, -58.0, -54.0, -62.0, -45.0, -59.0, -45.0, -43.0, -56.0, -52.0, -52.0, -55.0, -48.0, -63.0, -37.0, -58.0, -61.0, -59.0, -52.0, -63.0, -48.0, -53.0, -24.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4733590094434352, "mean_inference_ms": 31.00943611844009, "mean_action_processing_ms": 1.2112918652986224, "mean_env_wait_ms": 0.6892202425653706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6631754338741302, "StateBufferConnector_ms": 0.005172938108444214, "ViewRequirementAgentConnector_ms": 0.4838317632675171}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.734380387570169, "num_agent_steps_trained_throughput_per_sec": 2.734380387570169, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 512, "timers": {"training_iteration_time_ms": 187245.305, "sample_time_ms": 18740.006, "load_time_ms": 0.592, "load_throughput": 864526.428, "learn_time_ms": 168496.293, "learn_throughput": 3.039, "synch_weights_time_ms": 0.004}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 512, "num_agent_steps_trained": 512}, "done": false, "episodes_total": 32, "training_iteration": 1, "trial_id": "02b4f_00268", "date": "2024-02-27_12-52-30", "timestamp": 1709034750, "time_this_iter_s": 187.2475941181183, "time_total_s": 187.2475941181183, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 187.2475941181183, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.922348484848484, "ram_util_percent": 13.154545454545453}, "checkpoint_dir_name": "checkpoint_000000"}
{"custom_metrics": {"reward_total_mean": -50.515625, "reward_total_min": -63, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1053466796875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.1053466796875, "reward_score_min": 0.0078125, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0008365429151557455, "total_loss": 5.424067191282908, "policy_loss": -0.12817456014454365, "vf_loss": 8.860539722442628, "vf_explained_var": -0.03967496951421102, "kl": 0.03978855194052241, "entropy": 95.44803549448649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "sampler_results": {"episode_reward_max": -9.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.515625, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.515625, "reward_total_min": -63, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1053466796875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.1053466796875, "reward_score_min": 0.0078125, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -57.0, -54.0, -58.0, -48.0, -61.0, -50.0, -47.0, -62.0, -58.0, -54.0, -62.0, -45.0, -59.0, -45.0, -43.0, -56.0, -52.0, -52.0, -55.0, -48.0, -63.0, -37.0, -58.0, -61.0, -59.0, -52.0, -63.0, -48.0, -53.0, -24.0, -62.0, -60.0, -47.0, -60.0, -52.0, -48.0, -47.0, -60.0, -59.0, -49.0, -62.0, -47.0, -50.0, -59.0, -51.0, -9.0, -55.0, -36.0, -33.0, -30.0, -42.0, -52.0, -63.0, -49.0, -52.0, -30.0, -60.0, -53.0, -43.0, -29.0, -44.0, -54.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4180767566882406, "mean_inference_ms": 29.64072157674309, "mean_action_processing_ms": 1.1504092418489467, "mean_env_wait_ms": 0.6803427906478006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6597895175218582, "StateBufferConnector_ms": 0.03693476319313049, "ViewRequirementAgentConnector_ms": 0.4476543515920639}}, "episode_reward_max": -9.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.515625, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -57.0, -54.0, -58.0, -48.0, -61.0, -50.0, -47.0, -62.0, -58.0, -54.0, -62.0, -45.0, -59.0, -45.0, -43.0, -56.0, -52.0, -52.0, -55.0, -48.0, -63.0, -37.0, -58.0, -61.0, -59.0, -52.0, -63.0, -48.0, -53.0, -24.0, -62.0, -60.0, -47.0, -60.0, -52.0, -48.0, -47.0, -60.0, -59.0, -49.0, -62.0, -47.0, -50.0, -59.0, -51.0, -9.0, -55.0, -36.0, -33.0, -30.0, -42.0, -52.0, -63.0, -49.0, -52.0, -30.0, -60.0, -53.0, -43.0, -29.0, -44.0, -54.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4180767566882406, "mean_inference_ms": 29.64072157674309, "mean_action_processing_ms": 1.1504092418489467, "mean_env_wait_ms": 0.6803427906478006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6597895175218582, "StateBufferConnector_ms": 0.03693476319313049, "ViewRequirementAgentConnector_ms": 0.4476543515920639}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.6658816893950132, "num_agent_steps_trained_throughput_per_sec": 2.6658816893950132, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 189650.904, "sample_time_ms": 17179.9, "load_time_ms": 0.444, "load_throughput": 1152083.502, "learn_time_ms": 172465.964, "learn_throughput": 2.969, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "episodes_total": 64, "training_iteration": 2, "trial_id": "02b4f_00268", "date": "2024-02-27_12-56-08", "timestamp": 1709034968, "time_this_iter_s": 192.10119247436523, "time_total_s": 379.3487865924835, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 379.3487865924835, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 23.861812297734627, "ram_util_percent": 13.19967637540453}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.697916666666664, "reward_total_min": -63, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10392252604166667, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.10392252604166667, "reward_score_min": 0.0078125, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.438227907816569, "policy_loss": -0.12978798858821392, "vf_loss": 8.879655130704244, "vf_explained_var": -0.1015351802110672, "kl": 0.03501836761449253, "entropy": 95.37232348124186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "sampler_results": {"episode_reward_max": -9.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.697916666666664, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.697916666666664, "reward_total_min": -63, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10392252604166667, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.10392252604166667, "reward_score_min": 0.0078125, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -57.0, -54.0, -58.0, -48.0, -61.0, -50.0, -47.0, -62.0, -58.0, -54.0, -62.0, -45.0, -59.0, -45.0, -43.0, -56.0, -52.0, -52.0, -55.0, -48.0, -63.0, -37.0, -58.0, -61.0, -59.0, -52.0, -63.0, -48.0, -53.0, -24.0, -62.0, -60.0, -47.0, -60.0, -52.0, -48.0, -47.0, -60.0, -59.0, -49.0, -62.0, -47.0, -50.0, -59.0, -51.0, -9.0, -55.0, -36.0, -33.0, -30.0, -42.0, -52.0, -63.0, -49.0, -52.0, -30.0, -60.0, -53.0, -43.0, -29.0, -44.0, -54.0, -45.0, -55.0, -41.0, -51.0, -49.0, -63.0, -47.0, -58.0, -62.0, -45.0, -55.0, -30.0, -57.0, -63.0, -49.0, -48.0, -62.0, -61.0, -32.0, -49.0, -56.0, -27.0, -55.0, -35.0, -44.0, -28.0, -58.0, -58.0, -60.0, -57.0, -62.0, -60.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.386471414824934, "mean_inference_ms": 29.07836774868675, "mean_action_processing_ms": 1.105971075993746, "mean_env_wait_ms": 0.6815615838212272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6603633364041647, "StateBufferConnector_ms": 0.026237716277440388, "ViewRequirementAgentConnector_ms": 0.4392472406228383}}, "episode_reward_max": -9.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.697916666666664, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -57.0, -54.0, -58.0, -48.0, -61.0, -50.0, -47.0, -62.0, -58.0, -54.0, -62.0, -45.0, -59.0, -45.0, -43.0, -56.0, -52.0, -52.0, -55.0, -48.0, -63.0, -37.0, -58.0, -61.0, -59.0, -52.0, -63.0, -48.0, -53.0, -24.0, -62.0, -60.0, -47.0, -60.0, -52.0, -48.0, -47.0, -60.0, -59.0, -49.0, -62.0, -47.0, -50.0, -59.0, -51.0, -9.0, -55.0, -36.0, -33.0, -30.0, -42.0, -52.0, -63.0, -49.0, -52.0, -30.0, -60.0, -53.0, -43.0, -29.0, -44.0, -54.0, -45.0, -55.0, -41.0, -51.0, -49.0, -63.0, -47.0, -58.0, -62.0, -45.0, -55.0, -30.0, -57.0, -63.0, -49.0, -48.0, -62.0, -61.0, -32.0, -49.0, -56.0, -27.0, -55.0, -35.0, -44.0, -28.0, -58.0, -58.0, -60.0, -57.0, -62.0, -60.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.386471414824934, "mean_inference_ms": 29.07836774868675, "mean_action_processing_ms": 1.105971075993746, "mean_env_wait_ms": 0.6815615838212272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6603633364041647, "StateBufferConnector_ms": 0.026237716277440388, "ViewRequirementAgentConnector_ms": 0.4392472406228383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.4263818070249066, "num_agent_steps_trained_throughput_per_sec": 2.4263818070249066, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 1536, "timers": {"training_iteration_time_ms": 196771.846, "sample_time_ms": 16958.896, "load_time_ms": 0.402, "load_throughput": 1273463.322, "learn_time_ms": 179809.239, "learn_throughput": 2.847, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 1536, "num_agent_steps_trained": 1536}, "done": false, "episodes_total": 96, "training_iteration": 3, "trial_id": "02b4f_00268", "date": "2024-02-27_12-59-39", "timestamp": 1709035179, "time_this_iter_s": 211.02120327949524, "time_total_s": 590.3699898719788, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 590.3699898719788, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.035016835016833, "ram_util_percent": 13.171043771043772}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.41, "reward_total_min": -63, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113984375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.113984375, "reward_score_min": 0.0078125, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 0.6750000000000002, "cur_lr": 0.0008365429151557455, "total_loss": 5.2736917495727536, "policy_loss": -0.11683314349502325, "vf_loss": 8.590820741653442, "vf_explained_var": -0.3850061317284902, "kl": 0.027954355984422714, "entropy": 95.49688911437988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "sampler_results": {"episode_reward_max": -9.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.41, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.41, "reward_total_min": -63, "reward_total_max": -9, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.113984375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.4296875, "reward_score_mean": 0.113984375, "reward_score_min": 0.0078125, "reward_score_max": 0.4296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -53.0, -24.0, -62.0, -60.0, -47.0, -60.0, -52.0, -48.0, -47.0, -60.0, -59.0, -49.0, -62.0, -47.0, -50.0, -59.0, -51.0, -9.0, -55.0, -36.0, -33.0, -30.0, -42.0, -52.0, -63.0, -49.0, -52.0, -30.0, -60.0, -53.0, -43.0, -29.0, -44.0, -54.0, -45.0, -55.0, -41.0, -51.0, -49.0, -63.0, -47.0, -58.0, -62.0, -45.0, -55.0, -30.0, -57.0, -63.0, -49.0, -48.0, -62.0, -61.0, -32.0, -49.0, -56.0, -27.0, -55.0, -35.0, -44.0, -28.0, -58.0, -58.0, -60.0, -57.0, -62.0, -60.0, -57.0, -40.0, -38.0, -58.0, -56.0, -35.0, -45.0, -54.0, -29.0, -30.0, -56.0, -56.0, -60.0, -61.0, -59.0, -59.0, -47.0, -52.0, -58.0, -52.0, -44.0, -60.0, -60.0, -43.0, -59.0, -60.0, -34.0, -60.0, -21.0, -59.0, -51.0, -37.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3836601698291355, "mean_inference_ms": 28.397157889036233, "mean_action_processing_ms": 1.0456232404580643, "mean_env_wait_ms": 0.6847030711778731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.617171049118042, "StateBufferConnector_ms": 0.025345563888549805, "ViewRequirementAgentConnector_ms": 0.5162885189056396}}, "episode_reward_max": -9.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.41, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -53.0, -24.0, -62.0, -60.0, -47.0, -60.0, -52.0, -48.0, -47.0, -60.0, -59.0, -49.0, -62.0, -47.0, -50.0, -59.0, -51.0, -9.0, -55.0, -36.0, -33.0, -30.0, -42.0, -52.0, -63.0, -49.0, -52.0, -30.0, -60.0, -53.0, -43.0, -29.0, -44.0, -54.0, -45.0, -55.0, -41.0, -51.0, -49.0, -63.0, -47.0, -58.0, -62.0, -45.0, -55.0, -30.0, -57.0, -63.0, -49.0, -48.0, -62.0, -61.0, -32.0, -49.0, -56.0, -27.0, -55.0, -35.0, -44.0, -28.0, -58.0, -58.0, -60.0, -57.0, -62.0, -60.0, -57.0, -40.0, -38.0, -58.0, -56.0, -35.0, -45.0, -54.0, -29.0, -30.0, -56.0, -56.0, -60.0, -61.0, -59.0, -59.0, -47.0, -52.0, -58.0, -52.0, -44.0, -60.0, -60.0, -43.0, -59.0, -60.0, -34.0, -60.0, -21.0, -59.0, -51.0, -37.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3836601698291355, "mean_inference_ms": 28.397157889036233, "mean_action_processing_ms": 1.0456232404580643, "mean_env_wait_ms": 0.6847030711778731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.617171049118042, "StateBufferConnector_ms": 0.025345563888549805, "ViewRequirementAgentConnector_ms": 0.5162885189056396}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.6632821258474593, "num_agent_steps_trained_throughput_per_sec": 2.6632821258474593, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 195639.872, "sample_time_ms": 17373.001, "load_time_ms": 2.453, "load_throughput": 208736.747, "learn_time_ms": 178261.737, "learn_throughput": 2.872, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "episodes_total": 128, "training_iteration": 4, "trial_id": "02b4f_00268", "date": "2024-02-27_13-02-51", "timestamp": 1709035371, "time_this_iter_s": 192.26326298713684, "time_total_s": 782.6332528591156, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 782.6332528591156, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 24.259999999999998, "ram_util_percent": 13.175555555555555}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.12, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1084375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.1084375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 0.0008365429151557455, "total_loss": 5.307124968369802, "policy_loss": -0.11584418636436264, "vf_loss": 8.636917781829833, "vf_explained_var": -0.6895510117212932, "kl": 0.022212363974770066, "entropy": 95.17570234934489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.12, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.12, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1084375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.1084375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-29.0, -44.0, -54.0, -45.0, -55.0, -41.0, -51.0, -49.0, -63.0, -47.0, -58.0, -62.0, -45.0, -55.0, -30.0, -57.0, -63.0, -49.0, -48.0, -62.0, -61.0, -32.0, -49.0, -56.0, -27.0, -55.0, -35.0, -44.0, -28.0, -58.0, -58.0, -60.0, -57.0, -62.0, -60.0, -57.0, -40.0, -38.0, -58.0, -56.0, -35.0, -45.0, -54.0, -29.0, -30.0, -56.0, -56.0, -60.0, -61.0, -59.0, -59.0, -47.0, -52.0, -58.0, -52.0, -44.0, -60.0, -60.0, -43.0, -59.0, -60.0, -34.0, -60.0, -21.0, -59.0, -51.0, -37.0, -57.0, -48.0, -52.0, -52.0, -60.0, -63.0, -59.0, -36.0, -58.0, -57.0, -28.0, -52.0, -39.0, -47.0, -60.0, -54.0, -52.0, -36.0, -55.0, -60.0, -44.0, -56.0, -28.0, -55.0, -51.0, -44.0, -58.0, -61.0, -48.0, -48.0, -29.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4222329776548746, "mean_inference_ms": 28.421636575449156, "mean_action_processing_ms": 1.0049531105737983, "mean_env_wait_ms": 0.6851475469354233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6157879829406738, "StateBufferConnector_ms": 0.004878997802734375, "ViewRequirementAgentConnector_ms": 0.5911569595336914}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.12, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29.0, -44.0, -54.0, -45.0, -55.0, -41.0, -51.0, -49.0, -63.0, -47.0, -58.0, -62.0, -45.0, -55.0, -30.0, -57.0, -63.0, -49.0, -48.0, -62.0, -61.0, -32.0, -49.0, -56.0, -27.0, -55.0, -35.0, -44.0, -28.0, -58.0, -58.0, -60.0, -57.0, -62.0, -60.0, -57.0, -40.0, -38.0, -58.0, -56.0, -35.0, -45.0, -54.0, -29.0, -30.0, -56.0, -56.0, -60.0, -61.0, -59.0, -59.0, -47.0, -52.0, -58.0, -52.0, -44.0, -60.0, -60.0, -43.0, -59.0, -60.0, -34.0, -60.0, -21.0, -59.0, -51.0, -37.0, -57.0, -48.0, -52.0, -52.0, -60.0, -63.0, -59.0, -36.0, -58.0, -57.0, -28.0, -52.0, -39.0, -47.0, -60.0, -54.0, -52.0, -36.0, -55.0, -60.0, -44.0, -56.0, -28.0, -55.0, -51.0, -44.0, -58.0, -61.0, -48.0, -48.0, -29.0, -62.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4222329776548746, "mean_inference_ms": 28.421636575449156, "mean_action_processing_ms": 1.0049531105737983, "mean_env_wait_ms": 0.6851475469354233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6157879829406738, "StateBufferConnector_ms": 0.004878997802734375, "ViewRequirementAgentConnector_ms": 0.5911569595336914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.528637292080156, "num_agent_steps_trained_throughput_per_sec": 2.528637292080156, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 2560, "timers": {"training_iteration_time_ms": 197008.012, "sample_time_ms": 17394.403, "load_time_ms": 2.023, "load_throughput": 253139.502, "learn_time_ms": 179609.332, "learn_throughput": 2.851, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 2560, "num_agent_steps_trained": 2560}, "done": false, "episodes_total": 160, "training_iteration": 5, "trial_id": "02b4f_00268", "date": "2024-02-27_13-06-14", "timestamp": 1709035574, "time_this_iter_s": 202.50051951408386, "time_total_s": 985.1337723731995, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 985.1337723731995, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 24.084965034965034, "ram_util_percent": 13.202097902097902}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.29, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.107109375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 1.5187500000000005, "cur_lr": 0.0008365429151557455, "total_loss": 5.722829834620158, "policy_loss": -0.11626652516424656, "vf_loss": 9.294800424575806, "vf_explained_var": -0.5364761928717295, "kl": 0.017947226431004323, "entropy": 95.69215049743653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "sampler_results": {"episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.29, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.107109375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -62.0, -60.0, -57.0, -40.0, -38.0, -58.0, -56.0, -35.0, -45.0, -54.0, -29.0, -30.0, -56.0, -56.0, -60.0, -61.0, -59.0, -59.0, -47.0, -52.0, -58.0, -52.0, -44.0, -60.0, -60.0, -43.0, -59.0, -60.0, -34.0, -60.0, -21.0, -59.0, -51.0, -37.0, -57.0, -48.0, -52.0, -52.0, -60.0, -63.0, -59.0, -36.0, -58.0, -57.0, -28.0, -52.0, -39.0, -47.0, -60.0, -54.0, -52.0, -36.0, -55.0, -60.0, -44.0, -56.0, -28.0, -55.0, -51.0, -44.0, -58.0, -61.0, -48.0, -48.0, -29.0, -62.0, -64.0, -25.0, -41.0, -53.0, -61.0, -52.0, -59.0, -35.0, -33.0, -60.0, -60.0, -63.0, -47.0, -48.0, -60.0, -61.0, -15.0, -50.0, -58.0, -57.0, -60.0, -61.0, -61.0, -41.0, -46.0, -41.0, -37.0, -62.0, -51.0, -61.0, -53.0, -40.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4648641236117097, "mean_inference_ms": 28.55129384295784, "mean_action_processing_ms": 0.9857840726074403, "mean_env_wait_ms": 0.6846800664075229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5486569404602051, "StateBufferConnector_ms": 0.004850149154663086, "ViewRequirementAgentConnector_ms": 0.661491870880127}}, "episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -62.0, -60.0, -57.0, -40.0, -38.0, -58.0, -56.0, -35.0, -45.0, -54.0, -29.0, -30.0, -56.0, -56.0, -60.0, -61.0, -59.0, -59.0, -47.0, -52.0, -58.0, -52.0, -44.0, -60.0, -60.0, -43.0, -59.0, -60.0, -34.0, -60.0, -21.0, -59.0, -51.0, -37.0, -57.0, -48.0, -52.0, -52.0, -60.0, -63.0, -59.0, -36.0, -58.0, -57.0, -28.0, -52.0, -39.0, -47.0, -60.0, -54.0, -52.0, -36.0, -55.0, -60.0, -44.0, -56.0, -28.0, -55.0, -51.0, -44.0, -58.0, -61.0, -48.0, -48.0, -29.0, -62.0, -64.0, -25.0, -41.0, -53.0, -61.0, -52.0, -59.0, -35.0, -33.0, -60.0, -60.0, -63.0, -47.0, -48.0, -60.0, -61.0, -15.0, -50.0, -58.0, -57.0, -60.0, -61.0, -61.0, -41.0, -46.0, -41.0, -37.0, -62.0, -51.0, -61.0, -53.0, -40.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4648641236117097, "mean_inference_ms": 28.55129384295784, "mean_action_processing_ms": 0.9857840726074403, "mean_env_wait_ms": 0.6846800664075229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5486569404602051, "StateBufferConnector_ms": 0.004850149154663086, "ViewRequirementAgentConnector_ms": 0.661491870880127}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.899364564618057, "num_agent_steps_trained_throughput_per_sec": 2.899364564618057, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 193605.072, "sample_time_ms": 17230.857, "load_time_ms": 1.743, "load_throughput": 293686.365, "learn_time_ms": 176370.467, "learn_throughput": 2.903, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "episodes_total": 192, "training_iteration": 6, "trial_id": "02b4f_00268", "date": "2024-02-27_13-09-11", "timestamp": 1709035751, "time_this_iter_s": 176.61885333061218, "time_total_s": 1161.7526257038116, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1161.7526257038116, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.155600000000003, "ram_util_percent": 12.3016}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.21, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.107734375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 2.2781249999999997, "cur_lr": 0.0008365429151557455, "total_loss": 5.73095250527064, "policy_loss": -0.10801166985183955, "vf_loss": 9.282134413719177, "vf_explained_var": -0.9459733754396439, "kl": 0.015383167277953665, "entropy": 95.88537788391113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "sampler_results": {"episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.21, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.21, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107734375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.107734375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -51.0, -37.0, -57.0, -48.0, -52.0, -52.0, -60.0, -63.0, -59.0, -36.0, -58.0, -57.0, -28.0, -52.0, -39.0, -47.0, -60.0, -54.0, -52.0, -36.0, -55.0, -60.0, -44.0, -56.0, -28.0, -55.0, -51.0, -44.0, -58.0, -61.0, -48.0, -48.0, -29.0, -62.0, -64.0, -25.0, -41.0, -53.0, -61.0, -52.0, -59.0, -35.0, -33.0, -60.0, -60.0, -63.0, -47.0, -48.0, -60.0, -61.0, -15.0, -50.0, -58.0, -57.0, -60.0, -61.0, -61.0, -41.0, -46.0, -41.0, -37.0, -62.0, -51.0, -61.0, -53.0, -40.0, -35.0, -56.0, -51.0, -60.0, -56.0, -44.0, -37.0, -60.0, -35.0, -52.0, -41.0, -36.0, -49.0, -58.0, -48.0, -36.0, -58.0, -60.0, -28.0, -30.0, -47.0, -59.0, -58.0, -50.0, -60.0, -56.0, -58.0, -57.0, -53.0, -58.0, -59.0, -42.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.470924741922494, "mean_inference_ms": 28.417905476528166, "mean_action_processing_ms": 0.9755261098116225, "mean_env_wait_ms": 0.6729144231830901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5251576900482178, "StateBufferConnector_ms": 0.0047419071197509766, "ViewRequirementAgentConnector_ms": 0.585989236831665}}, "episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.21, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -51.0, -37.0, -57.0, -48.0, -52.0, -52.0, -60.0, -63.0, -59.0, -36.0, -58.0, -57.0, -28.0, -52.0, -39.0, -47.0, -60.0, -54.0, -52.0, -36.0, -55.0, -60.0, -44.0, -56.0, -28.0, -55.0, -51.0, -44.0, -58.0, -61.0, -48.0, -48.0, -29.0, -62.0, -64.0, -25.0, -41.0, -53.0, -61.0, -52.0, -59.0, -35.0, -33.0, -60.0, -60.0, -63.0, -47.0, -48.0, -60.0, -61.0, -15.0, -50.0, -58.0, -57.0, -60.0, -61.0, -61.0, -41.0, -46.0, -41.0, -37.0, -62.0, -51.0, -61.0, -53.0, -40.0, -35.0, -56.0, -51.0, -60.0, -56.0, -44.0, -37.0, -60.0, -35.0, -52.0, -41.0, -36.0, -49.0, -58.0, -48.0, -36.0, -58.0, -60.0, -28.0, -30.0, -47.0, -59.0, -58.0, -50.0, -60.0, -56.0, -58.0, -57.0, -53.0, -58.0, -59.0, -42.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.470924741922494, "mean_inference_ms": 28.417905476528166, "mean_action_processing_ms": 0.9755261098116225, "mean_env_wait_ms": 0.6729144231830901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5251576900482178, "StateBufferConnector_ms": 0.0047419071197509766, "ViewRequirementAgentConnector_ms": 0.585989236831665}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.7622472673712566, "num_agent_steps_trained_throughput_per_sec": 2.7622472673712566, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 3584, "timers": {"training_iteration_time_ms": 192426.675, "sample_time_ms": 17085.785, "load_time_ms": 1.539, "load_throughput": 332641.135, "learn_time_ms": 175337.528, "learn_throughput": 2.92, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 3584, "num_agent_steps_trained": 3584}, "done": false, "episodes_total": 224, "training_iteration": 7, "trial_id": "02b4f_00268", "date": "2024-02-27_13-12-16", "timestamp": 1709035936, "time_this_iter_s": 185.36122250556946, "time_total_s": 1347.113848209381, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1347.113848209381, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 21.993486590038316, "ram_util_percent": 12.172796934865898}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.29, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.107109375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.0008365429151557455, "total_loss": 5.8966424306233725, "policy_loss": -0.1035684595660617, "vf_loss": 9.532989851633708, "vf_explained_var": -0.8173648337523143, "kl": 0.011540793093167153, "entropy": 95.96205387115478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.29, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.29, "reward_total_min": -64, "reward_total_max": -15, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.107109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3828125, "reward_score_mean": 0.107109375, "reward_score_min": 0.0, "reward_score_max": 0.3828125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -29.0, -62.0, -64.0, -25.0, -41.0, -53.0, -61.0, -52.0, -59.0, -35.0, -33.0, -60.0, -60.0, -63.0, -47.0, -48.0, -60.0, -61.0, -15.0, -50.0, -58.0, -57.0, -60.0, -61.0, -61.0, -41.0, -46.0, -41.0, -37.0, -62.0, -51.0, -61.0, -53.0, -40.0, -35.0, -56.0, -51.0, -60.0, -56.0, -44.0, -37.0, -60.0, -35.0, -52.0, -41.0, -36.0, -49.0, -58.0, -48.0, -36.0, -58.0, -60.0, -28.0, -30.0, -47.0, -59.0, -58.0, -50.0, -60.0, -56.0, -58.0, -57.0, -53.0, -58.0, -59.0, -42.0, -62.0, -54.0, -41.0, -55.0, -62.0, -58.0, -60.0, -55.0, -54.0, -58.0, -38.0, -42.0, -49.0, -50.0, -38.0, -60.0, -40.0, -55.0, -35.0, -48.0, -49.0, -59.0, -57.0, -26.0, -35.0, -60.0, -58.0, -62.0, -60.0, -52.0, -50.0, -59.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4458797694503516, "mean_inference_ms": 28.061724821015932, "mean_action_processing_ms": 0.9715103693622277, "mean_env_wait_ms": 0.6601946566531443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4667806625366211, "StateBufferConnector_ms": 0.008744001388549805, "ViewRequirementAgentConnector_ms": 0.5581192970275879}}, "episode_reward_max": -15.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.29, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -29.0, -62.0, -64.0, -25.0, -41.0, -53.0, -61.0, -52.0, -59.0, -35.0, -33.0, -60.0, -60.0, -63.0, -47.0, -48.0, -60.0, -61.0, -15.0, -50.0, -58.0, -57.0, -60.0, -61.0, -61.0, -41.0, -46.0, -41.0, -37.0, -62.0, -51.0, -61.0, -53.0, -40.0, -35.0, -56.0, -51.0, -60.0, -56.0, -44.0, -37.0, -60.0, -35.0, -52.0, -41.0, -36.0, -49.0, -58.0, -48.0, -36.0, -58.0, -60.0, -28.0, -30.0, -47.0, -59.0, -58.0, -50.0, -60.0, -56.0, -58.0, -57.0, -53.0, -58.0, -59.0, -42.0, -62.0, -54.0, -41.0, -55.0, -62.0, -58.0, -60.0, -55.0, -54.0, -58.0, -38.0, -42.0, -49.0, -50.0, -38.0, -60.0, -40.0, -55.0, -35.0, -48.0, -49.0, -59.0, -57.0, -26.0, -35.0, -60.0, -58.0, -62.0, -60.0, -52.0, -50.0, -59.0, -46.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4458797694503516, "mean_inference_ms": 28.061724821015932, "mean_action_processing_ms": 0.9715103693622277, "mean_env_wait_ms": 0.6601946566531443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4667806625366211, "StateBufferConnector_ms": 0.008744001388549805, "ViewRequirementAgentConnector_ms": 0.5581192970275879}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.6721594588675996, "num_agent_steps_trained_throughput_per_sec": 2.6721594588675996, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 192324.002, "sample_time_ms": 16756.375, "load_time_ms": 1.383, "load_throughput": 370183.998, "learn_time_ms": 175564.562, "learn_throughput": 2.916, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 256, "training_iteration": 8, "trial_id": "02b4f_00268", "date": "2024-02-27_13-15-28", "timestamp": 1709036128, "time_this_iter_s": 191.623521566391, "time_total_s": 1538.737369775772, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1538.737369775772, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.584814814814816, "ram_util_percent": 12.1}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.44, "reward_total_min": -62, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1059375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.296875, "reward_score_mean": 0.1059375, "reward_score_min": 0.015625, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.0008365429151557455, "total_loss": 5.651988458633423, "policy_loss": -0.09985656945888574, "vf_loss": 9.135245434443156, "vf_explained_var": -0.7722313553094864, "kl": 0.011638914368777871, "entropy": 95.8841599782308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.44, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.44, "reward_total_min": -62, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1059375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.296875, "reward_score_mean": 0.1059375, "reward_score_min": 0.015625, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -53.0, -40.0, -35.0, -56.0, -51.0, -60.0, -56.0, -44.0, -37.0, -60.0, -35.0, -52.0, -41.0, -36.0, -49.0, -58.0, -48.0, -36.0, -58.0, -60.0, -28.0, -30.0, -47.0, -59.0, -58.0, -50.0, -60.0, -56.0, -58.0, -57.0, -53.0, -58.0, -59.0, -42.0, -62.0, -54.0, -41.0, -55.0, -62.0, -58.0, -60.0, -55.0, -54.0, -58.0, -38.0, -42.0, -49.0, -50.0, -38.0, -60.0, -40.0, -55.0, -35.0, -48.0, -49.0, -59.0, -57.0, -26.0, -35.0, -60.0, -58.0, -62.0, -60.0, -52.0, -50.0, -59.0, -46.0, -59.0, -44.0, -53.0, -60.0, -44.0, -49.0, -39.0, -60.0, -60.0, -58.0, -56.0, -43.0, -34.0, -33.0, -60.0, -50.0, -47.0, -53.0, -45.0, -59.0, -53.0, -48.0, -44.0, -60.0, -56.0, -37.0, -60.0, -50.0, -42.0, -52.0, -48.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4454721847785517, "mean_inference_ms": 27.910422232988694, "mean_action_processing_ms": 0.9751455459835434, "mean_env_wait_ms": 0.6550324911939995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5290250778198242, "StateBufferConnector_ms": 0.012825489044189453, "ViewRequirementAgentConnector_ms": 0.5725891590118408}}, "episode_reward_max": -26.0, "episode_reward_min": -62.0, "episode_reward_mean": -50.44, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -53.0, -40.0, -35.0, -56.0, -51.0, -60.0, -56.0, -44.0, -37.0, -60.0, -35.0, -52.0, -41.0, -36.0, -49.0, -58.0, -48.0, -36.0, -58.0, -60.0, -28.0, -30.0, -47.0, -59.0, -58.0, -50.0, -60.0, -56.0, -58.0, -57.0, -53.0, -58.0, -59.0, -42.0, -62.0, -54.0, -41.0, -55.0, -62.0, -58.0, -60.0, -55.0, -54.0, -58.0, -38.0, -42.0, -49.0, -50.0, -38.0, -60.0, -40.0, -55.0, -35.0, -48.0, -49.0, -59.0, -57.0, -26.0, -35.0, -60.0, -58.0, -62.0, -60.0, -52.0, -50.0, -59.0, -46.0, -59.0, -44.0, -53.0, -60.0, -44.0, -49.0, -39.0, -60.0, -60.0, -58.0, -56.0, -43.0, -34.0, -33.0, -60.0, -50.0, -47.0, -53.0, -45.0, -59.0, -53.0, -48.0, -44.0, -60.0, -56.0, -37.0, -60.0, -50.0, -42.0, -52.0, -48.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4454721847785517, "mean_inference_ms": 27.910422232988694, "mean_action_processing_ms": 0.9751455459835434, "mean_env_wait_ms": 0.6550324911939995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5290250778198242, "StateBufferConnector_ms": 0.012825489044189453, "ViewRequirementAgentConnector_ms": 0.5725891590118408}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.701182600080109, "num_agent_steps_trained_throughput_per_sec": 2.701182600080109, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 4608, "timers": {"training_iteration_time_ms": 192015.394, "sample_time_ms": 16997.009, "load_time_ms": 1.263, "load_throughput": 405355.554, "learn_time_ms": 175015.531, "learn_throughput": 2.925, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 4608, "num_agent_steps_trained": 4608}, "done": false, "episodes_total": 288, "training_iteration": 9, "trial_id": "02b4f_00268", "date": "2024-02-27_13-18-37", "timestamp": 1709036317, "time_this_iter_s": 189.56162905693054, "time_total_s": 1728.2989988327026, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1728.2989988327026, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 15.673033707865171, "ram_util_percent": 9.541947565543072}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.47, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.090078125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.090078125, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 3.417187499999999, "cur_lr": 0.0008365429151557455, "total_loss": 5.561943026383718, "policy_loss": -0.09429376544430852, "vf_loss": 8.97639221350352, "vf_explained_var": -0.6555395235617956, "kl": 0.012727302164920724, "entropy": 95.75299428304037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -52.47, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.47, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.090078125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.090078125, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-58.0, -59.0, -42.0, -62.0, -54.0, -41.0, -55.0, -62.0, -58.0, -60.0, -55.0, -54.0, -58.0, -38.0, -42.0, -49.0, -50.0, -38.0, -60.0, -40.0, -55.0, -35.0, -48.0, -49.0, -59.0, -57.0, -26.0, -35.0, -60.0, -58.0, -62.0, -60.0, -52.0, -50.0, -59.0, -46.0, -59.0, -44.0, -53.0, -60.0, -44.0, -49.0, -39.0, -60.0, -60.0, -58.0, -56.0, -43.0, -34.0, -33.0, -60.0, -50.0, -47.0, -53.0, -45.0, -59.0, -53.0, -48.0, -44.0, -60.0, -56.0, -37.0, -60.0, -50.0, -42.0, -52.0, -48.0, -60.0, -56.0, -63.0, -57.0, -42.0, -54.0, -54.0, -54.0, -61.0, -56.0, -60.0, -41.0, -63.0, -60.0, -52.0, -60.0, -56.0, -62.0, -60.0, -44.0, -52.0, -61.0, -59.0, -60.0, -60.0, -60.0, -58.0, -57.0, -46.0, -54.0, -43.0, -60.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.431395291516951, "mean_inference_ms": 27.716690284784207, "mean_action_processing_ms": 0.9804465243882649, "mean_env_wait_ms": 0.6540119384220675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5662996768951416, "StateBufferConnector_ms": 0.012951374053955078, "ViewRequirementAgentConnector_ms": 0.5752182006835938}}, "episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -52.47, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.0, -59.0, -42.0, -62.0, -54.0, -41.0, -55.0, -62.0, -58.0, -60.0, -55.0, -54.0, -58.0, -38.0, -42.0, -49.0, -50.0, -38.0, -60.0, -40.0, -55.0, -35.0, -48.0, -49.0, -59.0, -57.0, -26.0, -35.0, -60.0, -58.0, -62.0, -60.0, -52.0, -50.0, -59.0, -46.0, -59.0, -44.0, -53.0, -60.0, -44.0, -49.0, -39.0, -60.0, -60.0, -58.0, -56.0, -43.0, -34.0, -33.0, -60.0, -50.0, -47.0, -53.0, -45.0, -59.0, -53.0, -48.0, -44.0, -60.0, -56.0, -37.0, -60.0, -50.0, -42.0, -52.0, -48.0, -60.0, -56.0, -63.0, -57.0, -42.0, -54.0, -54.0, -54.0, -61.0, -56.0, -60.0, -41.0, -63.0, -60.0, -52.0, -60.0, -56.0, -62.0, -60.0, -44.0, -52.0, -61.0, -59.0, -60.0, -60.0, -60.0, -58.0, -57.0, -46.0, -54.0, -43.0, -60.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.431395291516951, "mean_inference_ms": 27.716690284784207, "mean_action_processing_ms": 0.9804465243882649, "mean_env_wait_ms": 0.6540119384220675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5662996768951416, "StateBufferConnector_ms": 0.012951374053955078, "ViewRequirementAgentConnector_ms": 0.5752182006835938}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.1945699721658234, "num_agent_steps_trained_throughput_per_sec": 3.1945699721658234, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 188841.048, "sample_time_ms": 16772.759, "load_time_ms": 1.23, "load_throughput": 416138.678, "learn_time_ms": 172065.537, "learn_throughput": 2.976, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "episodes_total": 320, "training_iteration": 10, "trial_id": "02b4f_00268", "date": "2024-02-27_13-21-18", "timestamp": 1709036478, "time_this_iter_s": 160.27695322036743, "time_total_s": 1888.57595205307, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 1888.57595205307, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 16.069603524229077, "ram_util_percent": 9.241409691629956}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.73, "reward_total_min": -63, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095859375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3125, "reward_score_mean": 0.095859375, "reward_score_min": 0.0078125, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.3678673585255945, "policy_loss": -0.08965502740660061, "vf_loss": 8.649207230408987, "vf_explained_var": -0.5851383725802104, "kl": 0.009629525400911613, "entropy": 95.6469731648763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.73, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.73, "reward_total_min": -63, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095859375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3125, "reward_score_mean": 0.095859375, "reward_score_min": 0.0078125, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-52.0, -50.0, -59.0, -46.0, -59.0, -44.0, -53.0, -60.0, -44.0, -49.0, -39.0, -60.0, -60.0, -58.0, -56.0, -43.0, -34.0, -33.0, -60.0, -50.0, -47.0, -53.0, -45.0, -59.0, -53.0, -48.0, -44.0, -60.0, -56.0, -37.0, -60.0, -50.0, -42.0, -52.0, -48.0, -60.0, -56.0, -63.0, -57.0, -42.0, -54.0, -54.0, -54.0, -61.0, -56.0, -60.0, -41.0, -63.0, -60.0, -52.0, -60.0, -56.0, -62.0, -60.0, -44.0, -52.0, -61.0, -59.0, -60.0, -60.0, -60.0, -58.0, -57.0, -46.0, -54.0, -43.0, -60.0, -60.0, -54.0, -42.0, -50.0, -32.0, -48.0, -45.0, -47.0, -29.0, -28.0, -52.0, -53.0, -43.0, -55.0, -42.0, -59.0, -62.0, -60.0, -57.0, -59.0, -59.0, -38.0, -46.0, -24.0, -60.0, -49.0, -56.0, -48.0, -59.0, -49.0, -47.0, -59.0, -54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4199944268059004, "mean_inference_ms": 27.675341471138108, "mean_action_processing_ms": 0.9827418025292926, "mean_env_wait_ms": 0.6595233595471135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6197633743286133, "StateBufferConnector_ms": 0.01762866973876953, "ViewRequirementAgentConnector_ms": 0.5277981758117676}}, "episode_reward_max": -24.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.73, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-52.0, -50.0, -59.0, -46.0, -59.0, -44.0, -53.0, -60.0, -44.0, -49.0, -39.0, -60.0, -60.0, -58.0, -56.0, -43.0, -34.0, -33.0, -60.0, -50.0, -47.0, -53.0, -45.0, -59.0, -53.0, -48.0, -44.0, -60.0, -56.0, -37.0, -60.0, -50.0, -42.0, -52.0, -48.0, -60.0, -56.0, -63.0, -57.0, -42.0, -54.0, -54.0, -54.0, -61.0, -56.0, -60.0, -41.0, -63.0, -60.0, -52.0, -60.0, -56.0, -62.0, -60.0, -44.0, -52.0, -61.0, -59.0, -60.0, -60.0, -60.0, -58.0, -57.0, -46.0, -54.0, -43.0, -60.0, -60.0, -54.0, -42.0, -50.0, -32.0, -48.0, -45.0, -47.0, -29.0, -28.0, -52.0, -53.0, -43.0, -55.0, -42.0, -59.0, -62.0, -60.0, -57.0, -59.0, -59.0, -38.0, -46.0, -24.0, -60.0, -49.0, -56.0, -48.0, -59.0, -49.0, -47.0, -59.0, -54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4199944268059004, "mean_inference_ms": 27.675341471138108, "mean_action_processing_ms": 0.9827418025292926, "mean_env_wait_ms": 0.6595233595471135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6197633743286133, "StateBufferConnector_ms": 0.01762866973876953, "ViewRequirementAgentConnector_ms": 0.5277981758117676}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 2.871727415029151, "num_agent_steps_trained_throughput_per_sec": 2.871727415029151, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 5632, "timers": {"training_iteration_time_ms": 187945.505, "sample_time_ms": 16519.645, "load_time_ms": 1.202, "load_throughput": 425935.905, "learn_time_ms": 171423.915, "learn_throughput": 2.987, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 5632, "num_agent_steps_trained": 5632}, "done": false, "episodes_total": 352, "training_iteration": 11, "trial_id": "02b4f_00268", "date": "2024-02-27_13-24-16", "timestamp": 1709036656, "time_this_iter_s": 178.2947132587433, "time_total_s": 2066.8706653118134, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2066.8706653118134, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 15.18373015873016, "ram_util_percent": 9.266666666666666}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.47, "reward_total_min": -63, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.097890625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3125, "reward_score_mean": 0.097890625, "reward_score_min": 0.0078125, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.338233462969462, "policy_loss": -0.08605572159091632, "vf_loss": 8.594602700074514, "vf_explained_var": -0.5398409138123195, "kl": 0.009807027245118257, "entropy": 95.8205499013265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.47, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.47, "reward_total_min": -63, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.097890625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3125, "reward_score_mean": 0.097890625, "reward_score_min": 0.0078125, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-42.0, -52.0, -48.0, -60.0, -56.0, -63.0, -57.0, -42.0, -54.0, -54.0, -54.0, -61.0, -56.0, -60.0, -41.0, -63.0, -60.0, -52.0, -60.0, -56.0, -62.0, -60.0, -44.0, -52.0, -61.0, -59.0, -60.0, -60.0, -60.0, -58.0, -57.0, -46.0, -54.0, -43.0, -60.0, -60.0, -54.0, -42.0, -50.0, -32.0, -48.0, -45.0, -47.0, -29.0, -28.0, -52.0, -53.0, -43.0, -55.0, -42.0, -59.0, -62.0, -60.0, -57.0, -59.0, -59.0, -38.0, -46.0, -24.0, -60.0, -49.0, -56.0, -48.0, -59.0, -49.0, -47.0, -59.0, -54.0, -62.0, -47.0, -56.0, -45.0, -63.0, -43.0, -54.0, -49.0, -58.0, -61.0, -38.0, -57.0, -41.0, -59.0, -61.0, -50.0, -52.0, -36.0, -34.0, -46.0, -54.0, -40.0, -54.0, -59.0, -38.0, -60.0, -37.0, -34.0, -61.0, -43.0, -58.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4047027874465146, "mean_inference_ms": 27.596471137888248, "mean_action_processing_ms": 0.9890997613960408, "mean_env_wait_ms": 0.6595487457753425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6157989501953125, "StateBufferConnector_ms": 0.013884305953979492, "ViewRequirementAgentConnector_ms": 0.4635045528411865}}, "episode_reward_max": -24.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.47, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.0, -52.0, -48.0, -60.0, -56.0, -63.0, -57.0, -42.0, -54.0, -54.0, -54.0, -61.0, -56.0, -60.0, -41.0, -63.0, -60.0, -52.0, -60.0, -56.0, -62.0, -60.0, -44.0, -52.0, -61.0, -59.0, -60.0, -60.0, -60.0, -58.0, -57.0, -46.0, -54.0, -43.0, -60.0, -60.0, -54.0, -42.0, -50.0, -32.0, -48.0, -45.0, -47.0, -29.0, -28.0, -52.0, -53.0, -43.0, -55.0, -42.0, -59.0, -62.0, -60.0, -57.0, -59.0, -59.0, -38.0, -46.0, -24.0, -60.0, -49.0, -56.0, -48.0, -59.0, -49.0, -47.0, -59.0, -54.0, -62.0, -47.0, -56.0, -45.0, -63.0, -43.0, -54.0, -49.0, -58.0, -61.0, -38.0, -57.0, -41.0, -59.0, -61.0, -50.0, -52.0, -36.0, -34.0, -46.0, -54.0, -40.0, -54.0, -59.0, -38.0, -60.0, -37.0, -34.0, -61.0, -43.0, -58.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4047027874465146, "mean_inference_ms": 27.596471137888248, "mean_action_processing_ms": 0.9890997613960408, "mean_env_wait_ms": 0.6595487457753425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6157989501953125, "StateBufferConnector_ms": 0.013884305953979492, "ViewRequirementAgentConnector_ms": 0.4635045528411865}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 3.2223101918352572, "num_agent_steps_trained_throughput_per_sec": 3.2223101918352572, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 184629.073, "sample_time_ms": 16755.367, "load_time_ms": 1.207, "load_throughput": 424336.794, "learn_time_ms": 167871.283, "learn_throughput": 3.05, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "episodes_total": 384, "training_iteration": 12, "trial_id": "02b4f_00268", "date": "2024-02-27_13-26-55", "timestamp": 1709036815, "time_this_iter_s": 158.89717268943787, "time_total_s": 2225.767838001251, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2225.767838001251, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.766666666666667, "ram_util_percent": 7.95688888888889}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.75, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.111328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.111328125, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.427817753950754, "policy_loss": -0.08685177164152265, "vf_loss": 8.730587804317475, "vf_explained_var": 0.19522613088289897, "kl": 0.010851118319061655, "entropy": 95.92721544901529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.75, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.75, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.111328125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.111328125, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-54.0, -43.0, -60.0, -60.0, -54.0, -42.0, -50.0, -32.0, -48.0, -45.0, -47.0, -29.0, -28.0, -52.0, -53.0, -43.0, -55.0, -42.0, -59.0, -62.0, -60.0, -57.0, -59.0, -59.0, -38.0, -46.0, -24.0, -60.0, -49.0, -56.0, -48.0, -59.0, -49.0, -47.0, -59.0, -54.0, -62.0, -47.0, -56.0, -45.0, -63.0, -43.0, -54.0, -49.0, -58.0, -61.0, -38.0, -57.0, -41.0, -59.0, -61.0, -50.0, -52.0, -36.0, -34.0, -46.0, -54.0, -40.0, -54.0, -59.0, -38.0, -60.0, -37.0, -34.0, -61.0, -43.0, -58.0, -45.0, -59.0, -46.0, -52.0, -56.0, -51.0, -52.0, -29.0, -53.0, -59.0, -55.0, -63.0, -59.0, -19.0, -45.0, -56.0, -56.0, -62.0, -35.0, -34.0, -38.0, -60.0, -56.0, -51.0, -57.0, -64.0, -52.0, -29.0, -60.0, -42.0, -60.0, -56.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.36394736948868, "mean_inference_ms": 27.242841568663845, "mean_action_processing_ms": 0.981275861758744, "mean_env_wait_ms": 0.6537629943398862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5209896564483643, "StateBufferConnector_ms": 0.013700246810913086, "ViewRequirementAgentConnector_ms": 0.4103531837463379}}, "episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.75, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.0, -43.0, -60.0, -60.0, -54.0, -42.0, -50.0, -32.0, -48.0, -45.0, -47.0, -29.0, -28.0, -52.0, -53.0, -43.0, -55.0, -42.0, -59.0, -62.0, -60.0, -57.0, -59.0, -59.0, -38.0, -46.0, -24.0, -60.0, -49.0, -56.0, -48.0, -59.0, -49.0, -47.0, -59.0, -54.0, -62.0, -47.0, -56.0, -45.0, -63.0, -43.0, -54.0, -49.0, -58.0, -61.0, -38.0, -57.0, -41.0, -59.0, -61.0, -50.0, -52.0, -36.0, -34.0, -46.0, -54.0, -40.0, -54.0, -59.0, -38.0, -60.0, -37.0, -34.0, -61.0, -43.0, -58.0, -45.0, -59.0, -46.0, -52.0, -56.0, -51.0, -52.0, -29.0, -53.0, -59.0, -55.0, -63.0, -59.0, -19.0, -45.0, -56.0, -56.0, -62.0, -35.0, -34.0, -38.0, -60.0, -56.0, -51.0, -57.0, -64.0, -52.0, -29.0, -60.0, -42.0, -60.0, -56.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.36394736948868, "mean_inference_ms": 27.242841568663845, "mean_action_processing_ms": 0.981275861758744, "mean_env_wait_ms": 0.6537629943398862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5209896564483643, "StateBufferConnector_ms": 0.013700246810913086, "ViewRequirementAgentConnector_ms": 0.4103531837463379}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 5.375360066448617, "num_agent_steps_trained_throughput_per_sec": 5.375360066448617, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 6656, "timers": {"training_iteration_time_ms": 173052.637, "sample_time_ms": 15900.804, "load_time_ms": 1.202, "load_throughput": 426113.389, "learn_time_ms": 157149.419, "learn_throughput": 3.258, "synch_weights_time_ms": 0.012}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 6656, "num_agent_steps_trained": 6656}, "done": false, "episodes_total": 416, "training_iteration": 13, "trial_id": "02b4f_00268", "date": "2024-02-27_13-28-30", "timestamp": 1709036910, "time_this_iter_s": 95.25737309455872, "time_total_s": 2321.02521109581, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2321.02521109581, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.703703703703704, "ram_util_percent": 6.271851851851851}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.0, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.1015625, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.194875542322794, "policy_loss": -0.09121611816808581, "vf_loss": 8.377439093589782, "vf_explained_var": 0.3664262975255648, "kl": 0.009336912669341084, "entropy": 96.07882061004639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.0, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.0, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1015625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.1015625, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -47.0, -59.0, -54.0, -62.0, -47.0, -56.0, -45.0, -63.0, -43.0, -54.0, -49.0, -58.0, -61.0, -38.0, -57.0, -41.0, -59.0, -61.0, -50.0, -52.0, -36.0, -34.0, -46.0, -54.0, -40.0, -54.0, -59.0, -38.0, -60.0, -37.0, -34.0, -61.0, -43.0, -58.0, -45.0, -59.0, -46.0, -52.0, -56.0, -51.0, -52.0, -29.0, -53.0, -59.0, -55.0, -63.0, -59.0, -19.0, -45.0, -56.0, -56.0, -62.0, -35.0, -34.0, -38.0, -60.0, -56.0, -51.0, -57.0, -64.0, -52.0, -29.0, -60.0, -42.0, -60.0, -56.0, -32.0, -59.0, -60.0, -32.0, -60.0, -38.0, -51.0, -44.0, -58.0, -52.0, -61.0, -50.0, -32.0, -49.0, -63.0, -39.0, -60.0, -54.0, -57.0, -61.0, -61.0, -49.0, -60.0, -56.0, -60.0, -37.0, -59.0, -47.0, -62.0, -56.0, -63.0, -52.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.295397068429833, "mean_inference_ms": 26.57896729384728, "mean_action_processing_ms": 0.9673417141233432, "mean_env_wait_ms": 0.6425786194555553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.41019177436828613, "StateBufferConnector_ms": 0.005058765411376953, "ViewRequirementAgentConnector_ms": 0.33117079734802246}}, "episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.0, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -47.0, -59.0, -54.0, -62.0, -47.0, -56.0, -45.0, -63.0, -43.0, -54.0, -49.0, -58.0, -61.0, -38.0, -57.0, -41.0, -59.0, -61.0, -50.0, -52.0, -36.0, -34.0, -46.0, -54.0, -40.0, -54.0, -59.0, -38.0, -60.0, -37.0, -34.0, -61.0, -43.0, -58.0, -45.0, -59.0, -46.0, -52.0, -56.0, -51.0, -52.0, -29.0, -53.0, -59.0, -55.0, -63.0, -59.0, -19.0, -45.0, -56.0, -56.0, -62.0, -35.0, -34.0, -38.0, -60.0, -56.0, -51.0, -57.0, -64.0, -52.0, -29.0, -60.0, -42.0, -60.0, -56.0, -32.0, -59.0, -60.0, -32.0, -60.0, -38.0, -51.0, -44.0, -58.0, -52.0, -61.0, -50.0, -32.0, -49.0, -63.0, -39.0, -60.0, -54.0, -57.0, -61.0, -61.0, -49.0, -60.0, -56.0, -60.0, -37.0, -59.0, -47.0, -62.0, -56.0, -63.0, -52.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.295397068429833, "mean_inference_ms": 26.57896729384728, "mean_action_processing_ms": 0.9673417141233432, "mean_env_wait_ms": 0.6425786194555553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.41019177436828613, "StateBufferConnector_ms": 0.005058765411376953, "ViewRequirementAgentConnector_ms": 0.33117079734802246}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 6.804168423420221, "num_agent_steps_trained_throughput_per_sec": 6.804168423420221, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 161353.038, "sample_time_ms": 14767.308, "load_time_ms": 0.374, "load_throughput": 1368172.559, "learn_time_ms": 146584.17, "learn_throughput": 3.493, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "episodes_total": 448, "training_iteration": 14, "trial_id": "02b4f_00268", "date": "2024-02-27_13-29-48", "timestamp": 1709036988, "time_this_iter_s": 75.25288128852844, "time_total_s": 2396.2780923843384, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2396.2780923843384, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 16.84587155963303, "ram_util_percent": 6.392660550458715}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.07, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.093203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.093203125, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.967072196801504, "policy_loss": -0.09289569665367405, "vf_loss": 9.613765128453572, "vf_explained_var": 0.430100246767203, "kl": 0.009498468032434423, "entropy": 95.89974536895753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.07, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.07, "reward_total_min": -64, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.093203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.093203125, "reward_score_min": 0.0, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -43.0, -58.0, -45.0, -59.0, -46.0, -52.0, -56.0, -51.0, -52.0, -29.0, -53.0, -59.0, -55.0, -63.0, -59.0, -19.0, -45.0, -56.0, -56.0, -62.0, -35.0, -34.0, -38.0, -60.0, -56.0, -51.0, -57.0, -64.0, -52.0, -29.0, -60.0, -42.0, -60.0, -56.0, -32.0, -59.0, -60.0, -32.0, -60.0, -38.0, -51.0, -44.0, -58.0, -52.0, -61.0, -50.0, -32.0, -49.0, -63.0, -39.0, -60.0, -54.0, -57.0, -61.0, -61.0, -49.0, -60.0, -56.0, -60.0, -37.0, -59.0, -47.0, -62.0, -56.0, -63.0, -52.0, -56.0, -48.0, -58.0, -49.0, -39.0, -58.0, -57.0, -56.0, -60.0, -59.0, -47.0, -62.0, -59.0, -57.0, -61.0, -59.0, -53.0, -60.0, -61.0, -47.0, -52.0, -42.0, -62.0, -50.0, -56.0, -64.0, -60.0, -58.0, -44.0, -44.0, -46.0, -47.0, -29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1751253930862107, "mean_inference_ms": 25.502298049958398, "mean_action_processing_ms": 0.9362931986958394, "mean_env_wait_ms": 0.6221128102550337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28620409965515137, "StateBufferConnector_ms": 0.004408836364746094, "ViewRequirementAgentConnector_ms": 0.24010348320007324}}, "episode_reward_max": -19.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.07, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -43.0, -58.0, -45.0, -59.0, -46.0, -52.0, -56.0, -51.0, -52.0, -29.0, -53.0, -59.0, -55.0, -63.0, -59.0, -19.0, -45.0, -56.0, -56.0, -62.0, -35.0, -34.0, -38.0, -60.0, -56.0, -51.0, -57.0, -64.0, -52.0, -29.0, -60.0, -42.0, -60.0, -56.0, -32.0, -59.0, -60.0, -32.0, -60.0, -38.0, -51.0, -44.0, -58.0, -52.0, -61.0, -50.0, -32.0, -49.0, -63.0, -39.0, -60.0, -54.0, -57.0, -61.0, -61.0, -49.0, -60.0, -56.0, -60.0, -37.0, -59.0, -47.0, -62.0, -56.0, -63.0, -52.0, -56.0, -48.0, -58.0, -49.0, -39.0, -58.0, -57.0, -56.0, -60.0, -59.0, -47.0, -62.0, -59.0, -57.0, -61.0, -59.0, -53.0, -60.0, -61.0, -47.0, -52.0, -42.0, -62.0, -50.0, -56.0, -64.0, -60.0, -58.0, -44.0, -44.0, -46.0, -47.0, -29.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1751253930862107, "mean_inference_ms": 25.502298049958398, "mean_action_processing_ms": 0.9362931986958394, "mean_env_wait_ms": 0.6221128102550337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.28620409965515137, "StateBufferConnector_ms": 0.004408836364746094, "ViewRequirementAgentConnector_ms": 0.24010348320007324}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.975686638869049, "num_agent_steps_trained_throughput_per_sec": 7.975686638869049, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 7680, "timers": {"training_iteration_time_ms": 147524.487, "sample_time_ms": 13515.757, "load_time_ms": 0.367, "load_throughput": 1395920.208, "learn_time_ms": 134007.193, "learn_throughput": 3.821, "synch_weights_time_ms": 0.011}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 7680, "num_agent_steps_trained": 7680}, "done": false, "episodes_total": 480, "training_iteration": 15, "trial_id": "02b4f_00268", "date": "2024-02-27_13-30-52", "timestamp": 1709037052, "time_this_iter_s": 64.19991517066956, "time_total_s": 2460.478007555008, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2460.478007555008, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.307608695652178, "ram_util_percent": 6.389130434782608}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.5, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.08984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.08984375, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.080411740144094, "policy_loss": -0.0879727693585058, "vf_loss": 8.186227810382842, "vf_explained_var": 0.48384617269039154, "kl": 0.009698446979336129, "entropy": 95.89072945912679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.5, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.5, "reward_total_min": -64, "reward_total_max": -24, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.08984375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3125, "reward_score_mean": 0.08984375, "reward_score_min": 0.0, "reward_score_max": 0.3125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-42.0, -60.0, -56.0, -32.0, -59.0, -60.0, -32.0, -60.0, -38.0, -51.0, -44.0, -58.0, -52.0, -61.0, -50.0, -32.0, -49.0, -63.0, -39.0, -60.0, -54.0, -57.0, -61.0, -61.0, -49.0, -60.0, -56.0, -60.0, -37.0, -59.0, -47.0, -62.0, -56.0, -63.0, -52.0, -56.0, -48.0, -58.0, -49.0, -39.0, -58.0, -57.0, -56.0, -60.0, -59.0, -47.0, -62.0, -59.0, -57.0, -61.0, -59.0, -53.0, -60.0, -61.0, -47.0, -52.0, -42.0, -62.0, -50.0, -56.0, -64.0, -60.0, -58.0, -44.0, -44.0, -46.0, -47.0, -29.0, -57.0, -64.0, -60.0, -54.0, -42.0, -55.0, -64.0, -49.0, -24.0, -41.0, -39.0, -51.0, -64.0, -59.0, -56.0, -46.0, -58.0, -59.0, -44.0, -60.0, -49.0, -48.0, -60.0, -60.0, -59.0, -40.0, -59.0, -62.0, -54.0, -37.0, -50.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0485925248456636, "mean_inference_ms": 24.42617392563973, "mean_action_processing_ms": 0.9029779408544212, "mean_env_wait_ms": 0.6000485561733117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24857544898986816, "StateBufferConnector_ms": 0.0042154788970947266, "ViewRequirementAgentConnector_ms": 0.2057018280029297}}, "episode_reward_max": -24.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.5, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.0, -60.0, -56.0, -32.0, -59.0, -60.0, -32.0, -60.0, -38.0, -51.0, -44.0, -58.0, -52.0, -61.0, -50.0, -32.0, -49.0, -63.0, -39.0, -60.0, -54.0, -57.0, -61.0, -61.0, -49.0, -60.0, -56.0, -60.0, -37.0, -59.0, -47.0, -62.0, -56.0, -63.0, -52.0, -56.0, -48.0, -58.0, -49.0, -39.0, -58.0, -57.0, -56.0, -60.0, -59.0, -47.0, -62.0, -59.0, -57.0, -61.0, -59.0, -53.0, -60.0, -61.0, -47.0, -52.0, -42.0, -62.0, -50.0, -56.0, -64.0, -60.0, -58.0, -44.0, -44.0, -46.0, -47.0, -29.0, -57.0, -64.0, -60.0, -54.0, -42.0, -55.0, -64.0, -49.0, -24.0, -41.0, -39.0, -51.0, -64.0, -59.0, -56.0, -46.0, -58.0, -59.0, -44.0, -60.0, -49.0, -48.0, -60.0, -60.0, -59.0, -40.0, -59.0, -62.0, -54.0, -37.0, -50.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0485925248456636, "mean_inference_ms": 24.42617392563973, "mean_action_processing_ms": 0.9029779408544212, "mean_env_wait_ms": 0.6000485561733117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24857544898986816, "StateBufferConnector_ms": 0.0042154788970947266, "ViewRequirementAgentConnector_ms": 0.2057018280029297}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.9653809260734025, "num_agent_steps_trained_throughput_per_sec": 7.9653809260734025, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 136293.263, "sample_time_ms": 12397.049, "load_time_ms": 0.358, "load_throughput": 1430701.964, "learn_time_ms": 123894.723, "learn_throughput": 4.133, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 512, "training_iteration": 16, "trial_id": "02b4f_00268", "date": "2024-02-27_13-31-56", "timestamp": 1709037116, "time_this_iter_s": 64.28292179107666, "time_total_s": 2524.7609293460846, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2524.7609293460846, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.28901098901099, "ram_util_percent": 6.390109890109889}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.27, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.099453125, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 5.027309213081995, "policy_loss": -0.09385291375219822, "vf_loss": 8.110286609331768, "vf_explained_var": 0.617016472419103, "kl": 0.009749569240674376, "entropy": 95.83020273844402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "sampler_results": {"episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.27, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.27, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099453125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.099453125, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-56.0, -63.0, -52.0, -56.0, -48.0, -58.0, -49.0, -39.0, -58.0, -57.0, -56.0, -60.0, -59.0, -47.0, -62.0, -59.0, -57.0, -61.0, -59.0, -53.0, -60.0, -61.0, -47.0, -52.0, -42.0, -62.0, -50.0, -56.0, -64.0, -60.0, -58.0, -44.0, -44.0, -46.0, -47.0, -29.0, -57.0, -64.0, -60.0, -54.0, -42.0, -55.0, -64.0, -49.0, -24.0, -41.0, -39.0, -51.0, -64.0, -59.0, -56.0, -46.0, -58.0, -59.0, -44.0, -60.0, -49.0, -48.0, -60.0, -60.0, -59.0, -40.0, -59.0, -62.0, -54.0, -37.0, -50.0, -34.0, -57.0, -52.0, -48.0, -51.0, -49.0, -51.0, -44.0, -61.0, -25.0, -41.0, -48.0, -48.0, -49.0, -62.0, -51.0, -39.0, -39.0, -46.0, -57.0, -51.0, -36.0, -51.0, -49.0, -20.0, -62.0, -49.0, -61.0, -59.0, -34.0, -49.0, -60.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.925034527985229, "mean_inference_ms": 23.4082464362445, "mean_action_processing_ms": 0.870368190993642, "mean_env_wait_ms": 0.577313495340856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22312378883361816, "StateBufferConnector_ms": 0.0038368701934814453, "ViewRequirementAgentConnector_ms": 0.15118908882141113}}, "episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.27, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -63.0, -52.0, -56.0, -48.0, -58.0, -49.0, -39.0, -58.0, -57.0, -56.0, -60.0, -59.0, -47.0, -62.0, -59.0, -57.0, -61.0, -59.0, -53.0, -60.0, -61.0, -47.0, -52.0, -42.0, -62.0, -50.0, -56.0, -64.0, -60.0, -58.0, -44.0, -44.0, -46.0, -47.0, -29.0, -57.0, -64.0, -60.0, -54.0, -42.0, -55.0, -64.0, -49.0, -24.0, -41.0, -39.0, -51.0, -64.0, -59.0, -56.0, -46.0, -58.0, -59.0, -44.0, -60.0, -49.0, -48.0, -60.0, -60.0, -59.0, -40.0, -59.0, -62.0, -54.0, -37.0, -50.0, -34.0, -57.0, -52.0, -48.0, -51.0, -49.0, -51.0, -44.0, -61.0, -25.0, -41.0, -48.0, -48.0, -49.0, -62.0, -51.0, -39.0, -39.0, -46.0, -57.0, -51.0, -36.0, -51.0, -49.0, -20.0, -62.0, -49.0, -61.0, -59.0, -34.0, -49.0, -60.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.925034527985229, "mean_inference_ms": 23.4082464362445, "mean_action_processing_ms": 0.870368190993642, "mean_env_wait_ms": 0.577313495340856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22312378883361816, "StateBufferConnector_ms": 0.0038368701934814453, "ViewRequirementAgentConnector_ms": 0.15118908882141113}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 8.00166394145368, "num_agent_steps_trained_throughput_per_sec": 8.00166394145368, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8704, "timers": {"training_iteration_time_ms": 124156.297, "sample_time_ms": 11275.378, "load_time_ms": 0.351, "load_throughput": 1457996.909, "learn_time_ms": 112879.464, "learn_throughput": 4.536, "synch_weights_time_ms": 0.01}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 8704, "num_agent_steps_trained": 8704}, "done": false, "episodes_total": 544, "training_iteration": 17, "trial_id": "02b4f_00268", "date": "2024-02-27_13-33-00", "timestamp": 1709037180, "time_this_iter_s": 63.991560220718384, "time_total_s": 2588.752489566803, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2588.752489566803, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.264835164835162, "ram_util_percent": 6.267032967032964}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.73, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.103671875, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 4.724569010734558, "policy_loss": -0.08685939743493994, "vf_loss": 7.615324532985687, "vf_explained_var": 0.7128510018189748, "kl": 0.00970185090896416, "entropy": 95.87116641998291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "sampler_results": {"episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.73, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.73, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.103671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.103671875, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-44.0, -46.0, -47.0, -29.0, -57.0, -64.0, -60.0, -54.0, -42.0, -55.0, -64.0, -49.0, -24.0, -41.0, -39.0, -51.0, -64.0, -59.0, -56.0, -46.0, -58.0, -59.0, -44.0, -60.0, -49.0, -48.0, -60.0, -60.0, -59.0, -40.0, -59.0, -62.0, -54.0, -37.0, -50.0, -34.0, -57.0, -52.0, -48.0, -51.0, -49.0, -51.0, -44.0, -61.0, -25.0, -41.0, -48.0, -48.0, -49.0, -62.0, -51.0, -39.0, -39.0, -46.0, -57.0, -51.0, -36.0, -51.0, -49.0, -20.0, -62.0, -49.0, -61.0, -59.0, -34.0, -49.0, -60.0, -39.0, -59.0, -52.0, -40.0, -26.0, -41.0, -59.0, -59.0, -61.0, -53.0, -58.0, -59.0, -52.0, -47.0, -48.0, -44.0, -59.0, -57.0, -64.0, -63.0, -58.0, -45.0, -61.0, -40.0, -57.0, -50.0, -58.0, -44.0, -60.0, -61.0, -61.0, -58.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8142613236236587, "mean_inference_ms": 22.501262992874455, "mean_action_processing_ms": 0.8411615149352383, "mean_env_wait_ms": 0.5567682126666882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.21813678741455078, "StateBufferConnector_ms": 0.0037288665771484375, "ViewRequirementAgentConnector_ms": 0.14713335037231445}}, "episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.73, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.0, -46.0, -47.0, -29.0, -57.0, -64.0, -60.0, -54.0, -42.0, -55.0, -64.0, -49.0, -24.0, -41.0, -39.0, -51.0, -64.0, -59.0, -56.0, -46.0, -58.0, -59.0, -44.0, -60.0, -49.0, -48.0, -60.0, -60.0, -59.0, -40.0, -59.0, -62.0, -54.0, -37.0, -50.0, -34.0, -57.0, -52.0, -48.0, -51.0, -49.0, -51.0, -44.0, -61.0, -25.0, -41.0, -48.0, -48.0, -49.0, -62.0, -51.0, -39.0, -39.0, -46.0, -57.0, -51.0, -36.0, -51.0, -49.0, -20.0, -62.0, -49.0, -61.0, -59.0, -34.0, -49.0, -60.0, -39.0, -59.0, -52.0, -40.0, -26.0, -41.0, -59.0, -59.0, -61.0, -53.0, -58.0, -59.0, -52.0, -47.0, -48.0, -44.0, -59.0, -57.0, -64.0, -63.0, -58.0, -45.0, -61.0, -40.0, -57.0, -50.0, -58.0, -44.0, -60.0, -61.0, -61.0, -58.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8142613236236587, "mean_inference_ms": 22.501262992874455, "mean_action_processing_ms": 0.8411615149352383, "mean_env_wait_ms": 0.5567682126666882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.21813678741455078, "StateBufferConnector_ms": 0.0037288665771484375, "ViewRequirementAgentConnector_ms": 0.14713335037231445}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.951212396213348, "num_agent_steps_trained_throughput_per_sec": 7.951212396213348, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 111435.036, "sample_time_ms": 10321.004, "load_time_ms": 0.346, "load_throughput": 1478168.811, "learn_time_ms": 101112.616, "learn_throughput": 5.064, "synch_weights_time_ms": 0.009}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "episodes_total": 576, "training_iteration": 18, "trial_id": "02b4f_00268", "date": "2024-02-27_13-34-05", "timestamp": 1709037245, "time_this_iter_s": 64.39739894866943, "time_total_s": 2653.1498885154724, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2653.1498885154724, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.80879120879121, "ram_util_percent": 6.309890109890108}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.89, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.102421875, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 5.125781250000001, "cur_lr": 0.0008365429151557455, "total_loss": 4.957773017883301, "policy_loss": -0.08075593709945679, "vf_loss": 7.956678791840871, "vf_explained_var": 0.9092359438538551, "kl": 0.012366630617578096, "entropy": 95.8790630976359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "sampler_results": {"episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.89, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.89, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.102421875, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-54.0, -37.0, -50.0, -34.0, -57.0, -52.0, -48.0, -51.0, -49.0, -51.0, -44.0, -61.0, -25.0, -41.0, -48.0, -48.0, -49.0, -62.0, -51.0, -39.0, -39.0, -46.0, -57.0, -51.0, -36.0, -51.0, -49.0, -20.0, -62.0, -49.0, -61.0, -59.0, -34.0, -49.0, -60.0, -39.0, -59.0, -52.0, -40.0, -26.0, -41.0, -59.0, -59.0, -61.0, -53.0, -58.0, -59.0, -52.0, -47.0, -48.0, -44.0, -59.0, -57.0, -64.0, -63.0, -58.0, -45.0, -61.0, -40.0, -57.0, -50.0, -58.0, -44.0, -60.0, -61.0, -61.0, -58.0, -57.0, -59.0, -35.0, -63.0, -51.0, -58.0, -43.0, -63.0, -51.0, -49.0, -42.0, -48.0, -60.0, -42.0, -59.0, -62.0, -47.0, -58.0, -50.0, -44.0, -63.0, -58.0, -39.0, -59.0, -55.0, -48.0, -57.0, -50.0, -38.0, -61.0, -58.0, -47.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7142060410953595, "mean_inference_ms": 21.688359831919183, "mean_action_processing_ms": 0.8146303645001645, "mean_env_wait_ms": 0.5379401123118152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2110447883605957, "StateBufferConnector_ms": 0.003602743148803711, "ViewRequirementAgentConnector_ms": 0.1387345790863037}}, "episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.89, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-54.0, -37.0, -50.0, -34.0, -57.0, -52.0, -48.0, -51.0, -49.0, -51.0, -44.0, -61.0, -25.0, -41.0, -48.0, -48.0, -49.0, -62.0, -51.0, -39.0, -39.0, -46.0, -57.0, -51.0, -36.0, -51.0, -49.0, -20.0, -62.0, -49.0, -61.0, -59.0, -34.0, -49.0, -60.0, -39.0, -59.0, -52.0, -40.0, -26.0, -41.0, -59.0, -59.0, -61.0, -53.0, -58.0, -59.0, -52.0, -47.0, -48.0, -44.0, -59.0, -57.0, -64.0, -63.0, -58.0, -45.0, -61.0, -40.0, -57.0, -50.0, -58.0, -44.0, -60.0, -61.0, -61.0, -58.0, -57.0, -59.0, -35.0, -63.0, -51.0, -58.0, -43.0, -63.0, -51.0, -49.0, -42.0, -48.0, -60.0, -42.0, -59.0, -62.0, -47.0, -58.0, -50.0, -44.0, -63.0, -58.0, -39.0, -59.0, -55.0, -48.0, -57.0, -50.0, -38.0, -61.0, -58.0, -47.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7142060410953595, "mean_inference_ms": 21.688359831919183, "mean_action_processing_ms": 0.8146303645001645, "mean_env_wait_ms": 0.5379401123118152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2110447883605957, "StateBufferConnector_ms": 0.003602743148803711, "ViewRequirementAgentConnector_ms": 0.1387345790863037}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 8.013798361976098, "num_agent_steps_trained_throughput_per_sec": 8.013798361976098, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 9728, "timers": {"training_iteration_time_ms": 98869.361, "sample_time_ms": 8917.341, "load_time_ms": 0.339, "load_throughput": 1511673.693, "learn_time_ms": 89950.663, "learn_throughput": 5.692, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 9728, "num_agent_steps_trained": 9728}, "done": false, "episodes_total": 608, "training_iteration": 19, "trial_id": "02b4f_00268", "date": "2024-02-27_13-35-09", "timestamp": 1709037309, "time_this_iter_s": 63.89527130126953, "time_total_s": 2717.045159816742, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2717.045159816742, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 16.50879120879121, "ram_util_percent": 6.337362637362639}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.52, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0975, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.0975, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.460699892044067, "policy_loss": -0.0794078287978967, "vf_loss": 7.16729211807251, "vf_explained_var": 0.9579905365904172, "kl": 0.007615601850920939, "entropy": 96.02590630849203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.52, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.52, "reward_total_min": -64, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0975, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.0975, "reward_score_min": 0.0, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-34.0, -49.0, -60.0, -39.0, -59.0, -52.0, -40.0, -26.0, -41.0, -59.0, -59.0, -61.0, -53.0, -58.0, -59.0, -52.0, -47.0, -48.0, -44.0, -59.0, -57.0, -64.0, -63.0, -58.0, -45.0, -61.0, -40.0, -57.0, -50.0, -58.0, -44.0, -60.0, -61.0, -61.0, -58.0, -57.0, -59.0, -35.0, -63.0, -51.0, -58.0, -43.0, -63.0, -51.0, -49.0, -42.0, -48.0, -60.0, -42.0, -59.0, -62.0, -47.0, -58.0, -50.0, -44.0, -63.0, -58.0, -39.0, -59.0, -55.0, -48.0, -57.0, -50.0, -38.0, -61.0, -58.0, -47.0, -48.0, -42.0, -55.0, -47.0, -34.0, -63.0, -32.0, -60.0, -25.0, -52.0, -40.0, -58.0, -48.0, -58.0, -61.0, -59.0, -52.0, -48.0, -36.0, -49.0, -40.0, -59.0, -46.0, -60.0, -51.0, -63.0, -46.0, -37.0, -54.0, -50.0, -54.0, -59.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.625749866756798, "mean_inference_ms": 20.96637909236628, "mean_action_processing_ms": 0.7912624994524348, "mean_env_wait_ms": 0.5214450503350675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.21684837341308594, "StateBufferConnector_ms": 0.0036907196044921875, "ViewRequirementAgentConnector_ms": 0.14517951011657715}}, "episode_reward_max": -25.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.52, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-34.0, -49.0, -60.0, -39.0, -59.0, -52.0, -40.0, -26.0, -41.0, -59.0, -59.0, -61.0, -53.0, -58.0, -59.0, -52.0, -47.0, -48.0, -44.0, -59.0, -57.0, -64.0, -63.0, -58.0, -45.0, -61.0, -40.0, -57.0, -50.0, -58.0, -44.0, -60.0, -61.0, -61.0, -58.0, -57.0, -59.0, -35.0, -63.0, -51.0, -58.0, -43.0, -63.0, -51.0, -49.0, -42.0, -48.0, -60.0, -42.0, -59.0, -62.0, -47.0, -58.0, -50.0, -44.0, -63.0, -58.0, -39.0, -59.0, -55.0, -48.0, -57.0, -50.0, -38.0, -61.0, -58.0, -47.0, -48.0, -42.0, -55.0, -47.0, -34.0, -63.0, -32.0, -60.0, -25.0, -52.0, -40.0, -58.0, -48.0, -58.0, -61.0, -59.0, -52.0, -48.0, -36.0, -49.0, -40.0, -59.0, -46.0, -60.0, -51.0, -63.0, -46.0, -37.0, -54.0, -50.0, -54.0, -59.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.625749866756798, "mean_inference_ms": 20.96637909236628, "mean_action_processing_ms": 0.7912624994524348, "mean_env_wait_ms": 0.5214450503350675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.21684837341308594, "StateBufferConnector_ms": 0.0036907196044921875, "ViewRequirementAgentConnector_ms": 0.14517951011657715}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.867903363209354, "num_agent_steps_trained_throughput_per_sec": 7.867903363209354, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 89349.616, "sample_time_ms": 7965.791, "load_time_ms": 0.272, "load_throughput": 1882436.578, "learn_time_ms": 81382.588, "learn_throughput": 6.291, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "episodes_total": 640, "training_iteration": 20, "trial_id": "02b4f_00268", "date": "2024-02-27_13-36-14", "timestamp": 1709037374, "time_this_iter_s": 65.07940578460693, "time_total_s": 2782.124565601349, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2782.124565601349, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.143478260869564, "ram_util_percent": 6.267391304347829}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.58, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09703125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.09703125, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.760150428613027, "policy_loss": -0.063772949265937, "vf_loss": 7.588835461934408, "vf_explained_var": 0.9608940824866294, "kl": 0.010247226680548394, "entropy": 95.77404206593832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.58, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.58, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09703125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.09703125, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -61.0, -58.0, -57.0, -59.0, -35.0, -63.0, -51.0, -58.0, -43.0, -63.0, -51.0, -49.0, -42.0, -48.0, -60.0, -42.0, -59.0, -62.0, -47.0, -58.0, -50.0, -44.0, -63.0, -58.0, -39.0, -59.0, -55.0, -48.0, -57.0, -50.0, -38.0, -61.0, -58.0, -47.0, -48.0, -42.0, -55.0, -47.0, -34.0, -63.0, -32.0, -60.0, -25.0, -52.0, -40.0, -58.0, -48.0, -58.0, -61.0, -59.0, -52.0, -48.0, -36.0, -49.0, -40.0, -59.0, -46.0, -60.0, -51.0, -63.0, -46.0, -37.0, -54.0, -50.0, -54.0, -59.0, -56.0, -54.0, -45.0, -26.0, -59.0, -60.0, -56.0, -44.0, -38.0, -54.0, -62.0, -58.0, -60.0, -29.0, -60.0, -55.0, -57.0, -59.0, -49.0, -45.0, -54.0, -59.0, -59.0, -53.0, -54.0, -59.0, -62.0, -26.0, -53.0, -57.0, -45.0, -62.0, -49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.547461666788077, "mean_inference_ms": 20.324054018971093, "mean_action_processing_ms": 0.7707462483923831, "mean_env_wait_ms": 0.5070879040285801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22241735458374023, "StateBufferConnector_ms": 0.003793478012084961, "ViewRequirementAgentConnector_ms": 0.15049076080322266}}, "episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.58, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -61.0, -58.0, -57.0, -59.0, -35.0, -63.0, -51.0, -58.0, -43.0, -63.0, -51.0, -49.0, -42.0, -48.0, -60.0, -42.0, -59.0, -62.0, -47.0, -58.0, -50.0, -44.0, -63.0, -58.0, -39.0, -59.0, -55.0, -48.0, -57.0, -50.0, -38.0, -61.0, -58.0, -47.0, -48.0, -42.0, -55.0, -47.0, -34.0, -63.0, -32.0, -60.0, -25.0, -52.0, -40.0, -58.0, -48.0, -58.0, -61.0, -59.0, -52.0, -48.0, -36.0, -49.0, -40.0, -59.0, -46.0, -60.0, -51.0, -63.0, -46.0, -37.0, -54.0, -50.0, -54.0, -59.0, -56.0, -54.0, -45.0, -26.0, -59.0, -60.0, -56.0, -44.0, -38.0, -54.0, -62.0, -58.0, -60.0, -29.0, -60.0, -55.0, -57.0, -59.0, -49.0, -45.0, -54.0, -59.0, -59.0, -53.0, -54.0, -59.0, -62.0, -26.0, -53.0, -57.0, -45.0, -62.0, -49.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.547461666788077, "mean_inference_ms": 20.324054018971093, "mean_action_processing_ms": 0.7707462483923831, "mean_env_wait_ms": 0.5070879040285801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22241735458374023, "StateBufferConnector_ms": 0.003793478012084961, "ViewRequirementAgentConnector_ms": 0.15049076080322266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.939685056785947, "num_agent_steps_trained_throughput_per_sec": 7.939685056785947, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 10752, "timers": {"training_iteration_time_ms": 77969.244, "sample_time_ms": 6865.473, "load_time_ms": 0.266, "load_throughput": 1923062.28, "learn_time_ms": 71102.566, "learn_throughput": 7.201, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 10752, "num_agent_steps_trained": 10752}, "done": false, "episodes_total": 672, "training_iteration": 21, "trial_id": "02b4f_00268", "date": "2024-02-27_13-37-18", "timestamp": 1709037438, "time_this_iter_s": 64.49087524414062, "time_total_s": 2846.6154408454895, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2846.6154408454895, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.68478260869565, "ram_util_percent": 6.317391304347824}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.33, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098984375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.098984375, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 5.023534280061722, "policy_loss": -0.0729546939022839, "vf_loss": 8.051866233348846, "vf_explained_var": 0.9732246985038121, "kl": 0.008041701182085281, "entropy": 96.0791399637858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "sampler_results": {"episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.33, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.33, "reward_total_min": -63, "reward_total_max": -25, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098984375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3046875, "reward_score_mean": 0.098984375, "reward_score_min": 0.0078125, "reward_score_max": 0.3046875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -58.0, -47.0, -48.0, -42.0, -55.0, -47.0, -34.0, -63.0, -32.0, -60.0, -25.0, -52.0, -40.0, -58.0, -48.0, -58.0, -61.0, -59.0, -52.0, -48.0, -36.0, -49.0, -40.0, -59.0, -46.0, -60.0, -51.0, -63.0, -46.0, -37.0, -54.0, -50.0, -54.0, -59.0, -56.0, -54.0, -45.0, -26.0, -59.0, -60.0, -56.0, -44.0, -38.0, -54.0, -62.0, -58.0, -60.0, -29.0, -60.0, -55.0, -57.0, -59.0, -49.0, -45.0, -54.0, -59.0, -59.0, -53.0, -54.0, -59.0, -62.0, -26.0, -53.0, -57.0, -45.0, -62.0, -49.0, -47.0, -50.0, -36.0, -56.0, -62.0, -56.0, -60.0, -56.0, -39.0, -46.0, -61.0, -48.0, -61.0, -55.0, -61.0, -61.0, -61.0, -44.0, -51.0, -28.0, -61.0, -51.0, -61.0, -41.0, -52.0, -36.0, -41.0, -60.0, -55.0, -48.0, -60.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4773003747703295, "mean_inference_ms": 19.745874877427305, "mean_action_processing_ms": 0.752338475410323, "mean_env_wait_ms": 0.4942364196238259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2240898609161377, "StateBufferConnector_ms": 0.0038225650787353516, "ViewRequirementAgentConnector_ms": 0.1523425579071045}}, "episode_reward_max": -25.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.33, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -58.0, -47.0, -48.0, -42.0, -55.0, -47.0, -34.0, -63.0, -32.0, -60.0, -25.0, -52.0, -40.0, -58.0, -48.0, -58.0, -61.0, -59.0, -52.0, -48.0, -36.0, -49.0, -40.0, -59.0, -46.0, -60.0, -51.0, -63.0, -46.0, -37.0, -54.0, -50.0, -54.0, -59.0, -56.0, -54.0, -45.0, -26.0, -59.0, -60.0, -56.0, -44.0, -38.0, -54.0, -62.0, -58.0, -60.0, -29.0, -60.0, -55.0, -57.0, -59.0, -49.0, -45.0, -54.0, -59.0, -59.0, -53.0, -54.0, -59.0, -62.0, -26.0, -53.0, -57.0, -45.0, -62.0, -49.0, -47.0, -50.0, -36.0, -56.0, -62.0, -56.0, -60.0, -56.0, -39.0, -46.0, -61.0, -48.0, -61.0, -55.0, -61.0, -61.0, -61.0, -44.0, -51.0, -28.0, -61.0, -51.0, -61.0, -41.0, -52.0, -36.0, -41.0, -60.0, -55.0, -48.0, -60.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4773003747703295, "mean_inference_ms": 19.745874877427305, "mean_action_processing_ms": 0.752338475410323, "mean_env_wait_ms": 0.4942364196238259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2240898609161377, "StateBufferConnector_ms": 0.0038225650787353516, "ViewRequirementAgentConnector_ms": 0.1523425579071045}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 8.019947372461868, "num_agent_steps_trained_throughput_per_sec": 8.019947372461868, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 68464.105, "sample_time_ms": 5564.654, "load_time_ms": 0.26, "load_throughput": 1965480.183, "learn_time_ms": 62898.756, "learn_throughput": 8.14, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "episodes_total": 704, "training_iteration": 22, "trial_id": "02b4f_00268", "date": "2024-02-27_13-38-22", "timestamp": 1709037502, "time_this_iter_s": 63.84553337097168, "time_total_s": 2910.460974216461, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2910.460974216461, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.61888888888889, "ram_util_percent": 6.2299999999999995}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.86, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10265625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.10265625, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.571286376317342, "policy_loss": -0.06795963991122941, "vf_loss": 7.347640057404836, "vf_explained_var": 0.9869686384995778, "kl": 0.005842946155523047, "entropy": 95.97471090952556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.86, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10265625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.10265625, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-50.0, -54.0, -59.0, -56.0, -54.0, -45.0, -26.0, -59.0, -60.0, -56.0, -44.0, -38.0, -54.0, -62.0, -58.0, -60.0, -29.0, -60.0, -55.0, -57.0, -59.0, -49.0, -45.0, -54.0, -59.0, -59.0, -53.0, -54.0, -59.0, -62.0, -26.0, -53.0, -57.0, -45.0, -62.0, -49.0, -47.0, -50.0, -36.0, -56.0, -62.0, -56.0, -60.0, -56.0, -39.0, -46.0, -61.0, -48.0, -61.0, -55.0, -61.0, -61.0, -61.0, -44.0, -51.0, -28.0, -61.0, -51.0, -61.0, -41.0, -52.0, -36.0, -41.0, -60.0, -55.0, -48.0, -60.0, -58.0, -61.0, -51.0, -43.0, -48.0, -36.0, -59.0, -43.0, -60.0, -53.0, -43.0, -61.0, -57.0, -45.0, -43.0, -63.0, -32.0, -58.0, -45.0, -58.0, -47.0, -27.0, -39.0, -41.0, -50.0, -61.0, -48.0, -50.0, -58.0, -45.0, -33.0, -50.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.413924658043969, "mean_inference_ms": 19.22188204289989, "mean_action_processing_ms": 0.7357053181253693, "mean_env_wait_ms": 0.48264120274600175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2264726161956787, "StateBufferConnector_ms": 0.0038444995880126953, "ViewRequirementAgentConnector_ms": 0.15552282333374023}}, "episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, -54.0, -59.0, -56.0, -54.0, -45.0, -26.0, -59.0, -60.0, -56.0, -44.0, -38.0, -54.0, -62.0, -58.0, -60.0, -29.0, -60.0, -55.0, -57.0, -59.0, -49.0, -45.0, -54.0, -59.0, -59.0, -53.0, -54.0, -59.0, -62.0, -26.0, -53.0, -57.0, -45.0, -62.0, -49.0, -47.0, -50.0, -36.0, -56.0, -62.0, -56.0, -60.0, -56.0, -39.0, -46.0, -61.0, -48.0, -61.0, -55.0, -61.0, -61.0, -61.0, -44.0, -51.0, -28.0, -61.0, -51.0, -61.0, -41.0, -52.0, -36.0, -41.0, -60.0, -55.0, -48.0, -60.0, -58.0, -61.0, -51.0, -43.0, -48.0, -36.0, -59.0, -43.0, -60.0, -53.0, -43.0, -61.0, -57.0, -45.0, -43.0, -63.0, -32.0, -58.0, -45.0, -58.0, -47.0, -27.0, -39.0, -41.0, -50.0, -61.0, -48.0, -50.0, -58.0, -45.0, -33.0, -50.0, -34.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.413924658043969, "mean_inference_ms": 19.22188204289989, "mean_action_processing_ms": 0.7357053181253693, "mean_env_wait_ms": 0.48264120274600175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2264726161956787, "StateBufferConnector_ms": 0.0038444995880126953, "ViewRequirementAgentConnector_ms": 0.15552282333374023}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.922214278960919, "num_agent_steps_trained_throughput_per_sec": 7.922214278960919, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 11776, "timers": {"training_iteration_time_ms": 65402.004, "sample_time_ms": 5294.114, "load_time_ms": 0.259, "load_throughput": 1977607.19, "learn_time_ms": 60107.225, "learn_throughput": 8.518, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 11776, "num_agent_steps_trained": 11776}, "done": false, "episodes_total": 736, "training_iteration": 23, "trial_id": "02b4f_00268", "date": "2024-02-27_13-39-27", "timestamp": 1709037567, "time_this_iter_s": 64.63308310508728, "time_total_s": 2975.0940573215485, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 2975.0940573215485, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.33260869565217, "ram_util_percent": 6.293478260869563}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.99, "reward_total_min": -63, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109453125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.109453125, "reward_score_min": 0.0078125, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.702388479312261, "policy_loss": -0.06934234835983565, "vf_loss": 5.991371885935465, "vf_explained_var": 0.9914629360040029, "kl": 0.003310673549742706, "entropy": 95.83553333282471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.99, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.99, "reward_total_min": -63, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.109453125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.109453125, "reward_score_min": 0.0078125, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -45.0, -62.0, -49.0, -47.0, -50.0, -36.0, -56.0, -62.0, -56.0, -60.0, -56.0, -39.0, -46.0, -61.0, -48.0, -61.0, -55.0, -61.0, -61.0, -61.0, -44.0, -51.0, -28.0, -61.0, -51.0, -61.0, -41.0, -52.0, -36.0, -41.0, -60.0, -55.0, -48.0, -60.0, -58.0, -61.0, -51.0, -43.0, -48.0, -36.0, -59.0, -43.0, -60.0, -53.0, -43.0, -61.0, -57.0, -45.0, -43.0, -63.0, -32.0, -58.0, -45.0, -58.0, -47.0, -27.0, -39.0, -41.0, -50.0, -61.0, -48.0, -50.0, -58.0, -45.0, -33.0, -50.0, -34.0, -51.0, -40.0, -53.0, -57.0, -55.0, -40.0, -28.0, -50.0, -41.0, -62.0, -57.0, -56.0, -54.0, -55.0, -45.0, -54.0, -63.0, -39.0, -32.0, -46.0, -47.0, -42.0, -39.0, -44.0, -29.0, -58.0, -59.0, -51.0, -59.0, -58.0, -58.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.356537722354879, "mean_inference_ms": 18.745115665564725, "mean_action_processing_ms": 0.7206335317040508, "mean_env_wait_ms": 0.472147180129331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22792530059814453, "StateBufferConnector_ms": 0.0038979053497314453, "ViewRequirementAgentConnector_ms": 0.1582183837890625}}, "episode_reward_max": -27.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.99, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -45.0, -62.0, -49.0, -47.0, -50.0, -36.0, -56.0, -62.0, -56.0, -60.0, -56.0, -39.0, -46.0, -61.0, -48.0, -61.0, -55.0, -61.0, -61.0, -61.0, -44.0, -51.0, -28.0, -61.0, -51.0, -61.0, -41.0, -52.0, -36.0, -41.0, -60.0, -55.0, -48.0, -60.0, -58.0, -61.0, -51.0, -43.0, -48.0, -36.0, -59.0, -43.0, -60.0, -53.0, -43.0, -61.0, -57.0, -45.0, -43.0, -63.0, -32.0, -58.0, -45.0, -58.0, -47.0, -27.0, -39.0, -41.0, -50.0, -61.0, -48.0, -50.0, -58.0, -45.0, -33.0, -50.0, -34.0, -51.0, -40.0, -53.0, -57.0, -55.0, -40.0, -28.0, -50.0, -41.0, -62.0, -57.0, -56.0, -54.0, -55.0, -45.0, -54.0, -63.0, -39.0, -32.0, -46.0, -47.0, -42.0, -39.0, -44.0, -29.0, -58.0, -59.0, -51.0, -59.0, -58.0, -58.0, -59.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.356537722354879, "mean_inference_ms": 18.745115665564725, "mean_action_processing_ms": 0.7206335317040508, "mean_env_wait_ms": 0.472147180129331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22792530059814453, "StateBufferConnector_ms": 0.0038979053497314453, "ViewRequirementAgentConnector_ms": 0.1582183837890625}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.947792152775471, "num_agent_steps_trained_throughput_per_sec": 7.947792152775471, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 64319.245, "sample_time_ms": 5095.435, "load_time_ms": 0.249, "load_throughput": 2057567.929, "learn_time_ms": 59223.176, "learn_throughput": 8.645, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 768, "training_iteration": 24, "trial_id": "02b4f_00268", "date": "2024-02-27_13-40-31", "timestamp": 1709037631, "time_this_iter_s": 64.42509841918945, "time_total_s": 3039.519155740738, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3039.519155740738, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.807608695652174, "ram_util_percent": 6.376086956521739}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.48, "reward_total_min": -63, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1134375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.1134375, "reward_score_min": 0.0078125, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.8305108388264975, "policy_loss": -0.07096240033085148, "vf_loss": 6.176097150643667, "vf_explained_var": 0.9907879744966824, "kl": 0.005162439133471318, "entropy": 95.77237135569254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.48, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.48, "reward_total_min": -63, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1134375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.1134375, "reward_score_min": 0.0078125, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-55.0, -48.0, -60.0, -58.0, -61.0, -51.0, -43.0, -48.0, -36.0, -59.0, -43.0, -60.0, -53.0, -43.0, -61.0, -57.0, -45.0, -43.0, -63.0, -32.0, -58.0, -45.0, -58.0, -47.0, -27.0, -39.0, -41.0, -50.0, -61.0, -48.0, -50.0, -58.0, -45.0, -33.0, -50.0, -34.0, -51.0, -40.0, -53.0, -57.0, -55.0, -40.0, -28.0, -50.0, -41.0, -62.0, -57.0, -56.0, -54.0, -55.0, -45.0, -54.0, -63.0, -39.0, -32.0, -46.0, -47.0, -42.0, -39.0, -44.0, -29.0, -58.0, -59.0, -51.0, -59.0, -58.0, -58.0, -59.0, -58.0, -53.0, -60.0, -54.0, -62.0, -54.0, -39.0, -37.0, -53.0, -59.0, -47.0, -38.0, -41.0, -58.0, -63.0, -59.0, -43.0, -44.0, -30.0, -51.0, -58.0, -58.0, -47.0, -61.0, -41.0, -35.0, -57.0, -44.0, -50.0, -29.0, -60.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3040172417272227, "mean_inference_ms": 18.308876836328224, "mean_action_processing_ms": 0.7068747955119029, "mean_env_wait_ms": 0.4625751353227182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2276463508605957, "StateBufferConnector_ms": 0.003888845443725586, "ViewRequirementAgentConnector_ms": 0.1575477123260498}}, "episode_reward_max": -27.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.48, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55.0, -48.0, -60.0, -58.0, -61.0, -51.0, -43.0, -48.0, -36.0, -59.0, -43.0, -60.0, -53.0, -43.0, -61.0, -57.0, -45.0, -43.0, -63.0, -32.0, -58.0, -45.0, -58.0, -47.0, -27.0, -39.0, -41.0, -50.0, -61.0, -48.0, -50.0, -58.0, -45.0, -33.0, -50.0, -34.0, -51.0, -40.0, -53.0, -57.0, -55.0, -40.0, -28.0, -50.0, -41.0, -62.0, -57.0, -56.0, -54.0, -55.0, -45.0, -54.0, -63.0, -39.0, -32.0, -46.0, -47.0, -42.0, -39.0, -44.0, -29.0, -58.0, -59.0, -51.0, -59.0, -58.0, -58.0, -59.0, -58.0, -53.0, -60.0, -54.0, -62.0, -54.0, -39.0, -37.0, -53.0, -59.0, -47.0, -38.0, -41.0, -58.0, -63.0, -59.0, -43.0, -44.0, -30.0, -51.0, -58.0, -58.0, -47.0, -61.0, -41.0, -35.0, -57.0, -44.0, -50.0, -29.0, -60.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3040172417272227, "mean_inference_ms": 18.308876836328224, "mean_action_processing_ms": 0.7068747955119029, "mean_env_wait_ms": 0.4625751353227182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2276463508605957, "StateBufferConnector_ms": 0.003888845443725586, "ViewRequirementAgentConnector_ms": 0.1575477123260498}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.901786321773837, "num_agent_steps_trained_throughput_per_sec": 7.901786321773837, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 12800, "timers": {"training_iteration_time_ms": 64379.282, "sample_time_ms": 5098.898, "load_time_ms": 0.251, "load_throughput": 2038621.272, "learn_time_ms": 59279.738, "learn_throughput": 8.637, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 12800, "num_agent_steps_trained": 12800}, "done": false, "episodes_total": 800, "training_iteration": 25, "trial_id": "02b4f_00268", "date": "2024-02-27_13-41-36", "timestamp": 1709037696, "time_this_iter_s": 64.80031895637512, "time_total_s": 3104.319474697113, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3104.319474697113, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.516304347826086, "ram_util_percent": 6.24782608695652}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.14, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10828125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.10828125, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.9638554950555167, "policy_loss": -0.06366055360995233, "vf_loss": 6.378806952635447, "vf_explained_var": 0.9903671314318975, "kl": 0.005070457225066242, "entropy": 95.9548407872518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.14, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.14, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10828125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.10828125, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-45.0, -33.0, -50.0, -34.0, -51.0, -40.0, -53.0, -57.0, -55.0, -40.0, -28.0, -50.0, -41.0, -62.0, -57.0, -56.0, -54.0, -55.0, -45.0, -54.0, -63.0, -39.0, -32.0, -46.0, -47.0, -42.0, -39.0, -44.0, -29.0, -58.0, -59.0, -51.0, -59.0, -58.0, -58.0, -59.0, -58.0, -53.0, -60.0, -54.0, -62.0, -54.0, -39.0, -37.0, -53.0, -59.0, -47.0, -38.0, -41.0, -58.0, -63.0, -59.0, -43.0, -44.0, -30.0, -51.0, -58.0, -58.0, -47.0, -61.0, -41.0, -35.0, -57.0, -44.0, -50.0, -29.0, -60.0, -61.0, -58.0, -31.0, -54.0, -59.0, -55.0, -50.0, -62.0, -41.0, -62.0, -60.0, -53.0, -56.0, -41.0, -48.0, -57.0, -54.0, -62.0, -47.0, -43.0, -60.0, -62.0, -29.0, -59.0, -63.0, -59.0, -45.0, -56.0, -56.0, -50.0, -60.0, -32.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2552879588998653, "mean_inference_ms": 17.906236686842746, "mean_action_processing_ms": 0.6941004340950903, "mean_env_wait_ms": 0.4536526269176136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22565817832946777, "StateBufferConnector_ms": 0.0038590431213378906, "ViewRequirementAgentConnector_ms": 0.15533947944641113}}, "episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.14, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -33.0, -50.0, -34.0, -51.0, -40.0, -53.0, -57.0, -55.0, -40.0, -28.0, -50.0, -41.0, -62.0, -57.0, -56.0, -54.0, -55.0, -45.0, -54.0, -63.0, -39.0, -32.0, -46.0, -47.0, -42.0, -39.0, -44.0, -29.0, -58.0, -59.0, -51.0, -59.0, -58.0, -58.0, -59.0, -58.0, -53.0, -60.0, -54.0, -62.0, -54.0, -39.0, -37.0, -53.0, -59.0, -47.0, -38.0, -41.0, -58.0, -63.0, -59.0, -43.0, -44.0, -30.0, -51.0, -58.0, -58.0, -47.0, -61.0, -41.0, -35.0, -57.0, -44.0, -50.0, -29.0, -60.0, -61.0, -58.0, -31.0, -54.0, -59.0, -55.0, -50.0, -62.0, -41.0, -62.0, -60.0, -53.0, -56.0, -41.0, -48.0, -57.0, -54.0, -62.0, -47.0, -43.0, -60.0, -62.0, -29.0, -59.0, -63.0, -59.0, -45.0, -56.0, -56.0, -50.0, -60.0, -32.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2552879588998653, "mean_inference_ms": 17.906236686842746, "mean_action_processing_ms": 0.6941004340950903, "mean_env_wait_ms": 0.4536526269176136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22565817832946777, "StateBufferConnector_ms": 0.0038590431213378906, "ViewRequirementAgentConnector_ms": 0.15533947944641113}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.936388931505086, "num_agent_steps_trained_throughput_per_sec": 7.936388931505086, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 64402.763, "sample_time_ms": 5090.213, "load_time_ms": 0.25, "load_throughput": 2051670.63, "learn_time_ms": 59311.899, "learn_throughput": 8.632, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "episodes_total": 832, "training_iteration": 26, "trial_id": "02b4f_00268", "date": "2024-02-27_13-42-41", "timestamp": 1709037761, "time_this_iter_s": 64.51770234107971, "time_total_s": 3168.8371770381927, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3168.8371770381927, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.613186813186815, "ram_util_percent": 6.290109890109887}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.87, "reward_total_min": -63, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102578125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.102578125, "reward_score_min": 0.0078125, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.7678193310896555, "policy_loss": -0.06070364901485543, "vf_loss": 5.977998091777166, "vf_explained_var": 0.9938482026259104, "kl": 0.011784764124643713, "entropy": 95.83546396891276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "sampler_results": {"episode_reward_max": -29.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.87, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.87, "reward_total_min": -63, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102578125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.102578125, "reward_score_min": 0.0078125, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -58.0, -58.0, -59.0, -58.0, -53.0, -60.0, -54.0, -62.0, -54.0, -39.0, -37.0, -53.0, -59.0, -47.0, -38.0, -41.0, -58.0, -63.0, -59.0, -43.0, -44.0, -30.0, -51.0, -58.0, -58.0, -47.0, -61.0, -41.0, -35.0, -57.0, -44.0, -50.0, -29.0, -60.0, -61.0, -58.0, -31.0, -54.0, -59.0, -55.0, -50.0, -62.0, -41.0, -62.0, -60.0, -53.0, -56.0, -41.0, -48.0, -57.0, -54.0, -62.0, -47.0, -43.0, -60.0, -62.0, -29.0, -59.0, -63.0, -59.0, -45.0, -56.0, -56.0, -50.0, -60.0, -32.0, -43.0, -39.0, -59.0, -59.0, -57.0, -35.0, -51.0, -47.0, -38.0, -60.0, -49.0, -52.0, -46.0, -61.0, -32.0, -62.0, -48.0, -42.0, -41.0, -50.0, -32.0, -47.0, -60.0, -48.0, -44.0, -53.0, -43.0, -61.0, -55.0, -59.0, -63.0, -41.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.209083222424333, "mean_inference_ms": 17.52915141796067, "mean_action_processing_ms": 0.6818654972336303, "mean_env_wait_ms": 0.4450185409700527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.21886467933654785, "StateBufferConnector_ms": 0.0037245750427246094, "ViewRequirementAgentConnector_ms": 0.1460893154144287}}, "episode_reward_max": -29.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.87, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -58.0, -58.0, -59.0, -58.0, -53.0, -60.0, -54.0, -62.0, -54.0, -39.0, -37.0, -53.0, -59.0, -47.0, -38.0, -41.0, -58.0, -63.0, -59.0, -43.0, -44.0, -30.0, -51.0, -58.0, -58.0, -47.0, -61.0, -41.0, -35.0, -57.0, -44.0, -50.0, -29.0, -60.0, -61.0, -58.0, -31.0, -54.0, -59.0, -55.0, -50.0, -62.0, -41.0, -62.0, -60.0, -53.0, -56.0, -41.0, -48.0, -57.0, -54.0, -62.0, -47.0, -43.0, -60.0, -62.0, -29.0, -59.0, -63.0, -59.0, -45.0, -56.0, -56.0, -50.0, -60.0, -32.0, -43.0, -39.0, -59.0, -59.0, -57.0, -35.0, -51.0, -47.0, -38.0, -60.0, -49.0, -52.0, -46.0, -61.0, -32.0, -62.0, -48.0, -42.0, -41.0, -50.0, -32.0, -47.0, -60.0, -48.0, -44.0, -53.0, -43.0, -61.0, -55.0, -59.0, -63.0, -41.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.209083222424333, "mean_inference_ms": 17.52915141796067, "mean_action_processing_ms": 0.6818654972336303, "mean_env_wait_ms": 0.4450185409700527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.21886467933654785, "StateBufferConnector_ms": 0.0037245750427246094, "ViewRequirementAgentConnector_ms": 0.1460893154144287}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.985286494683494, "num_agent_steps_trained_throughput_per_sec": 7.985286494683494, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 13824, "timers": {"training_iteration_time_ms": 64415.889, "sample_time_ms": 5087.289, "load_time_ms": 0.249, "load_throughput": 2057962.288, "learn_time_ms": 59327.957, "learn_throughput": 8.63, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 13824, "num_agent_steps_trained": 13824}, "done": false, "episodes_total": 864, "training_iteration": 27, "trial_id": "02b4f_00268", "date": "2024-02-27_13-43-45", "timestamp": 1709037825, "time_this_iter_s": 64.12263989448547, "time_total_s": 3232.959816932678, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3232.959816932678, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.459340659340658, "ram_util_percent": 6.368131868131867}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.75, "reward_total_min": -64, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.095703125, "reward_score_min": 0.0, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 5.504771582285563, "policy_loss": -0.06936824657022952, "vf_loss": 8.819248922665913, "vf_explained_var": 0.981501649816831, "kl": 0.00775854051510881, "entropy": 95.74749908447265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "sampler_results": {"episode_reward_max": -29.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.75, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.75, "reward_total_min": -64, "reward_total_max": -29, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.095703125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2734375, "reward_score_mean": 0.095703125, "reward_score_min": 0.0, "reward_score_max": 0.2734375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-50.0, -29.0, -60.0, -61.0, -58.0, -31.0, -54.0, -59.0, -55.0, -50.0, -62.0, -41.0, -62.0, -60.0, -53.0, -56.0, -41.0, -48.0, -57.0, -54.0, -62.0, -47.0, -43.0, -60.0, -62.0, -29.0, -59.0, -63.0, -59.0, -45.0, -56.0, -56.0, -50.0, -60.0, -32.0, -43.0, -39.0, -59.0, -59.0, -57.0, -35.0, -51.0, -47.0, -38.0, -60.0, -49.0, -52.0, -46.0, -61.0, -32.0, -62.0, -48.0, -42.0, -41.0, -50.0, -32.0, -47.0, -60.0, -48.0, -44.0, -53.0, -43.0, -61.0, -55.0, -59.0, -63.0, -41.0, -48.0, -60.0, -64.0, -50.0, -42.0, -60.0, -48.0, -53.0, -62.0, -59.0, -61.0, -60.0, -59.0, -59.0, -60.0, -51.0, -57.0, -44.0, -58.0, -50.0, -62.0, -54.0, -53.0, -49.0, -63.0, -38.0, -53.0, -47.0, -60.0, -30.0, -55.0, -45.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.16652371355094, "mean_inference_ms": 17.181496275054066, "mean_action_processing_ms": 0.6706334198191339, "mean_env_wait_ms": 0.43711984431225454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2216358184814453, "StateBufferConnector_ms": 0.0037870407104492188, "ViewRequirementAgentConnector_ms": 0.15042972564697266}}, "episode_reward_max": -29.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.75, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, -29.0, -60.0, -61.0, -58.0, -31.0, -54.0, -59.0, -55.0, -50.0, -62.0, -41.0, -62.0, -60.0, -53.0, -56.0, -41.0, -48.0, -57.0, -54.0, -62.0, -47.0, -43.0, -60.0, -62.0, -29.0, -59.0, -63.0, -59.0, -45.0, -56.0, -56.0, -50.0, -60.0, -32.0, -43.0, -39.0, -59.0, -59.0, -57.0, -35.0, -51.0, -47.0, -38.0, -60.0, -49.0, -52.0, -46.0, -61.0, -32.0, -62.0, -48.0, -42.0, -41.0, -50.0, -32.0, -47.0, -60.0, -48.0, -44.0, -53.0, -43.0, -61.0, -55.0, -59.0, -63.0, -41.0, -48.0, -60.0, -64.0, -50.0, -42.0, -60.0, -48.0, -53.0, -62.0, -59.0, -61.0, -60.0, -59.0, -59.0, -60.0, -51.0, -57.0, -44.0, -58.0, -50.0, -62.0, -54.0, -53.0, -49.0, -63.0, -38.0, -53.0, -47.0, -60.0, -30.0, -55.0, -45.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.16652371355094, "mean_inference_ms": 17.181496275054066, "mean_action_processing_ms": 0.6706334198191339, "mean_env_wait_ms": 0.43711984431225454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2216358184814453, "StateBufferConnector_ms": 0.0037870407104492188, "ViewRequirementAgentConnector_ms": 0.15042972564697266}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 8.056127737553542, "num_agent_steps_trained_throughput_per_sec": 8.056127737553542, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 64332.029, "sample_time_ms": 5107.994, "load_time_ms": 0.251, "load_throughput": 2038621.272, "learn_time_ms": 59223.391, "learn_throughput": 8.645, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "episodes_total": 896, "training_iteration": 28, "trial_id": "02b4f_00268", "date": "2024-02-27_13-44-48", "timestamp": 1709037888, "time_this_iter_s": 63.55877900123596, "time_total_s": 3296.518595933914, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3296.518595933914, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.205555555555556, "ram_util_percent": 6.208888888888889}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.59, "reward_total_min": -64, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.104765625, "reward_score_min": 0.0, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.391387816270193, "policy_loss": -0.07262177343169848, "vf_loss": 7.047474050521851, "vf_explained_var": 0.9839385792613029, "kl": 0.007462326614426395, "entropy": 95.80681851704915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "sampler_results": {"episode_reward_max": -17.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.59, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.59, "reward_total_min": -64, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104765625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.104765625, "reward_score_min": 0.0, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-50.0, -60.0, -32.0, -43.0, -39.0, -59.0, -59.0, -57.0, -35.0, -51.0, -47.0, -38.0, -60.0, -49.0, -52.0, -46.0, -61.0, -32.0, -62.0, -48.0, -42.0, -41.0, -50.0, -32.0, -47.0, -60.0, -48.0, -44.0, -53.0, -43.0, -61.0, -55.0, -59.0, -63.0, -41.0, -48.0, -60.0, -64.0, -50.0, -42.0, -60.0, -48.0, -53.0, -62.0, -59.0, -61.0, -60.0, -59.0, -59.0, -60.0, -51.0, -57.0, -44.0, -58.0, -50.0, -62.0, -54.0, -53.0, -49.0, -63.0, -38.0, -53.0, -47.0, -60.0, -30.0, -55.0, -45.0, -60.0, -50.0, -60.0, -60.0, -52.0, -53.0, -59.0, -60.0, -47.0, -51.0, -51.0, -17.0, -60.0, -39.0, -46.0, -55.0, -47.0, -59.0, -47.0, -62.0, -33.0, -48.0, -46.0, -36.0, -44.0, -51.0, -53.0, -63.0, -34.0, -39.0, -50.0, -47.0, -47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1273733603608007, "mean_inference_ms": 16.862997295455287, "mean_action_processing_ms": 0.6603285025998343, "mean_env_wait_ms": 0.42989921280213084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22248482704162598, "StateBufferConnector_ms": 0.003806591033935547, "ViewRequirementAgentConnector_ms": 0.1528313159942627}}, "episode_reward_max": -17.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.59, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, -60.0, -32.0, -43.0, -39.0, -59.0, -59.0, -57.0, -35.0, -51.0, -47.0, -38.0, -60.0, -49.0, -52.0, -46.0, -61.0, -32.0, -62.0, -48.0, -42.0, -41.0, -50.0, -32.0, -47.0, -60.0, -48.0, -44.0, -53.0, -43.0, -61.0, -55.0, -59.0, -63.0, -41.0, -48.0, -60.0, -64.0, -50.0, -42.0, -60.0, -48.0, -53.0, -62.0, -59.0, -61.0, -60.0, -59.0, -59.0, -60.0, -51.0, -57.0, -44.0, -58.0, -50.0, -62.0, -54.0, -53.0, -49.0, -63.0, -38.0, -53.0, -47.0, -60.0, -30.0, -55.0, -45.0, -60.0, -50.0, -60.0, -60.0, -52.0, -53.0, -59.0, -60.0, -47.0, -51.0, -51.0, -17.0, -60.0, -39.0, -46.0, -55.0, -47.0, -59.0, -47.0, -62.0, -33.0, -48.0, -46.0, -36.0, -44.0, -51.0, -53.0, -63.0, -34.0, -39.0, -50.0, -47.0, -47.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1273733603608007, "mean_inference_ms": 16.862997295455287, "mean_action_processing_ms": 0.6603285025998343, "mean_env_wait_ms": 0.42989921280213084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22248482704162598, "StateBufferConnector_ms": 0.003806591033935547, "ViewRequirementAgentConnector_ms": 0.1528313159942627}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.820051065122007, "num_agent_steps_trained_throughput_per_sec": 7.820051065122007, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 14848, "timers": {"training_iteration_time_ms": 64490.321, "sample_time_ms": 5154.445, "load_time_ms": 0.256, "load_throughput": 2000264.203, "learn_time_ms": 59335.216, "learn_throughput": 8.629, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 14848, "num_agent_steps_trained": 14848}, "done": false, "episodes_total": 928, "training_iteration": 29, "trial_id": "02b4f_00268", "date": "2024-02-27_13-45-54", "timestamp": 1709037954, "time_this_iter_s": 65.4774227142334, "time_total_s": 3361.9960186481476, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3361.9960186481476, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 17.824731182795702, "ram_util_percent": 5.362365591397848}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.06, "reward_total_min": -64, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.10109375, "reward_score_min": 0.0, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.284278202056885, "policy_loss": -0.06719970821092526, "vf_loss": 6.891219731171926, "vf_explained_var": 0.9882914220293363, "kl": 0.005533621103495534, "entropy": 95.6787181854248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "sampler_results": {"episode_reward_max": -17.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.06, "reward_total_min": -64, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10109375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.10109375, "reward_score_min": 0.0, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -63.0, -41.0, -48.0, -60.0, -64.0, -50.0, -42.0, -60.0, -48.0, -53.0, -62.0, -59.0, -61.0, -60.0, -59.0, -59.0, -60.0, -51.0, -57.0, -44.0, -58.0, -50.0, -62.0, -54.0, -53.0, -49.0, -63.0, -38.0, -53.0, -47.0, -60.0, -30.0, -55.0, -45.0, -60.0, -50.0, -60.0, -60.0, -52.0, -53.0, -59.0, -60.0, -47.0, -51.0, -51.0, -17.0, -60.0, -39.0, -46.0, -55.0, -47.0, -59.0, -47.0, -62.0, -33.0, -48.0, -46.0, -36.0, -44.0, -51.0, -53.0, -63.0, -34.0, -39.0, -50.0, -47.0, -47.0, -47.0, -18.0, -49.0, -39.0, -27.0, -44.0, -55.0, -61.0, -57.0, -62.0, -51.0, -56.0, -58.0, -37.0, -63.0, -61.0, -61.0, -38.0, -58.0, -62.0, -39.0, -43.0, -63.0, -36.0, -51.0, -59.0, -60.0, -58.0, -49.0, -24.0, -62.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.091813147463903, "mean_inference_ms": 16.57090284489218, "mean_action_processing_ms": 0.6510533528984248, "mean_env_wait_ms": 0.42355757452491594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22821950912475586, "StateBufferConnector_ms": 0.0039348602294921875, "ViewRequirementAgentConnector_ms": 0.16246628761291504}}, "episode_reward_max": -17.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -63.0, -41.0, -48.0, -60.0, -64.0, -50.0, -42.0, -60.0, -48.0, -53.0, -62.0, -59.0, -61.0, -60.0, -59.0, -59.0, -60.0, -51.0, -57.0, -44.0, -58.0, -50.0, -62.0, -54.0, -53.0, -49.0, -63.0, -38.0, -53.0, -47.0, -60.0, -30.0, -55.0, -45.0, -60.0, -50.0, -60.0, -60.0, -52.0, -53.0, -59.0, -60.0, -47.0, -51.0, -51.0, -17.0, -60.0, -39.0, -46.0, -55.0, -47.0, -59.0, -47.0, -62.0, -33.0, -48.0, -46.0, -36.0, -44.0, -51.0, -53.0, -63.0, -34.0, -39.0, -50.0, -47.0, -47.0, -47.0, -18.0, -49.0, -39.0, -27.0, -44.0, -55.0, -61.0, -57.0, -62.0, -51.0, -56.0, -58.0, -37.0, -63.0, -61.0, -61.0, -38.0, -58.0, -62.0, -39.0, -43.0, -63.0, -36.0, -51.0, -59.0, -60.0, -58.0, -49.0, -24.0, -62.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.091813147463903, "mean_inference_ms": 16.57090284489218, "mean_action_processing_ms": 0.6510533528984248, "mean_env_wait_ms": 0.42355757452491594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22821950912475586, "StateBufferConnector_ms": 0.0039348602294921875, "ViewRequirementAgentConnector_ms": 0.16246628761291504}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.823137075479698, "num_agent_steps_trained_throughput_per_sec": 7.823137075479698, "timesteps_total": 15360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 64527.558, "sample_time_ms": 5156.58, "load_time_ms": 0.258, "load_throughput": 1986571.367, "learn_time_ms": 59370.304, "learn_throughput": 8.624, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "episodes_total": 960, "training_iteration": 30, "trial_id": "02b4f_00268", "date": "2024-02-27_13-46-59", "timestamp": 1709038019, "time_this_iter_s": 65.45443964004517, "time_total_s": 3427.4504582881927, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3427.4504582881927, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.507526881720427, "ram_util_percent": 5.2451612903225815}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.81, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118671875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.118671875, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 6.151145017147064, "policy_loss": -0.09004841170584162, "vf_loss": 9.8790807167689, "vf_explained_var": 0.9858427032828331, "kl": 0.008326075985776053, "entropy": 95.7266835530599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "sampler_results": {"episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.81, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.81, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118671875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.118671875, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-30.0, -55.0, -45.0, -60.0, -50.0, -60.0, -60.0, -52.0, -53.0, -59.0, -60.0, -47.0, -51.0, -51.0, -17.0, -60.0, -39.0, -46.0, -55.0, -47.0, -59.0, -47.0, -62.0, -33.0, -48.0, -46.0, -36.0, -44.0, -51.0, -53.0, -63.0, -34.0, -39.0, -50.0, -47.0, -47.0, -47.0, -18.0, -49.0, -39.0, -27.0, -44.0, -55.0, -61.0, -57.0, -62.0, -51.0, -56.0, -58.0, -37.0, -63.0, -61.0, -61.0, -38.0, -58.0, -62.0, -39.0, -43.0, -63.0, -36.0, -51.0, -59.0, -60.0, -58.0, -49.0, -24.0, -62.0, -55.0, -54.0, -58.0, -59.0, -35.0, -54.0, -57.0, -61.0, -41.0, -47.0, -23.0, -52.0, -46.0, -46.0, -52.0, -26.0, -40.0, -41.0, -60.0, -48.0, -49.0, -53.0, -44.0, -50.0, -34.0, -53.0, -59.0, -44.0, -33.0, -29.0, -54.0, -59.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.059727393893598, "mean_inference_ms": 16.303257258721416, "mean_action_processing_ms": 0.6427322189184522, "mean_env_wait_ms": 0.4179567391975638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23393535614013672, "StateBufferConnector_ms": 0.004045009613037109, "ViewRequirementAgentConnector_ms": 0.16819119453430176}}, "episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.81, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30.0, -55.0, -45.0, -60.0, -50.0, -60.0, -60.0, -52.0, -53.0, -59.0, -60.0, -47.0, -51.0, -51.0, -17.0, -60.0, -39.0, -46.0, -55.0, -47.0, -59.0, -47.0, -62.0, -33.0, -48.0, -46.0, -36.0, -44.0, -51.0, -53.0, -63.0, -34.0, -39.0, -50.0, -47.0, -47.0, -47.0, -18.0, -49.0, -39.0, -27.0, -44.0, -55.0, -61.0, -57.0, -62.0, -51.0, -56.0, -58.0, -37.0, -63.0, -61.0, -61.0, -38.0, -58.0, -62.0, -39.0, -43.0, -63.0, -36.0, -51.0, -59.0, -60.0, -58.0, -49.0, -24.0, -62.0, -55.0, -54.0, -58.0, -59.0, -35.0, -54.0, -57.0, -61.0, -41.0, -47.0, -23.0, -52.0, -46.0, -46.0, -52.0, -26.0, -40.0, -41.0, -60.0, -48.0, -49.0, -53.0, -44.0, -50.0, -34.0, -53.0, -59.0, -44.0, -33.0, -29.0, -54.0, -59.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.059727393893598, "mean_inference_ms": 16.303257258721416, "mean_action_processing_ms": 0.6427322189184522, "mean_env_wait_ms": 0.4179567391975638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23393535614013672, "StateBufferConnector_ms": 0.004045009613037109, "ViewRequirementAgentConnector_ms": 0.16819119453430176}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.820330061082031, "num_agent_steps_trained_throughput_per_sec": 7.820330061082031, "timesteps_total": 15872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 15872, "timers": {"training_iteration_time_ms": 64625.975, "sample_time_ms": 5177.294, "load_time_ms": 0.265, "load_throughput": 1935018.605, "learn_time_ms": 59447.978, "learn_throughput": 8.613, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 15872, "num_agent_steps_trained": 15872}, "done": false, "episodes_total": 992, "training_iteration": 31, "trial_id": "02b4f_00268", "date": "2024-02-27_13-48-05", "timestamp": 1709038085, "time_this_iter_s": 65.47517824172974, "time_total_s": 3492.9256365299225, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3492.9256365299225, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.35698924731183, "ram_util_percent": 5.241935483870967}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.57, "reward_total_min": -63, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112734375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.359375, "reward_score_mean": 0.112734375, "reward_score_min": 0.0078125, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.453608057896296, "policy_loss": -0.06056876579920451, "vf_loss": 5.558859260876973, "vf_explained_var": 0.9921389852960905, "kl": 0.004986753302449824, "entropy": 95.55247497558594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": -18.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.57, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.57, "reward_total_min": -63, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112734375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.359375, "reward_score_mean": 0.112734375, "reward_score_min": 0.0078125, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-39.0, -50.0, -47.0, -47.0, -47.0, -18.0, -49.0, -39.0, -27.0, -44.0, -55.0, -61.0, -57.0, -62.0, -51.0, -56.0, -58.0, -37.0, -63.0, -61.0, -61.0, -38.0, -58.0, -62.0, -39.0, -43.0, -63.0, -36.0, -51.0, -59.0, -60.0, -58.0, -49.0, -24.0, -62.0, -55.0, -54.0, -58.0, -59.0, -35.0, -54.0, -57.0, -61.0, -41.0, -47.0, -23.0, -52.0, -46.0, -46.0, -52.0, -26.0, -40.0, -41.0, -60.0, -48.0, -49.0, -53.0, -44.0, -50.0, -34.0, -53.0, -59.0, -44.0, -33.0, -29.0, -54.0, -59.0, -61.0, -57.0, -57.0, -60.0, -31.0, -53.0, -45.0, -33.0, -53.0, -60.0, -43.0, -39.0, -57.0, -47.0, -50.0, -58.0, -37.0, -43.0, -50.0, -60.0, -56.0, -47.0, -60.0, -50.0, -58.0, -61.0, -60.0, -60.0, -59.0, -53.0, -45.0, -45.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0302731758173813, "mean_inference_ms": 16.05260507677756, "mean_action_processing_ms": 0.6350826215431742, "mean_env_wait_ms": 0.4129044438865136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23914074897766113, "StateBufferConnector_ms": 0.004172325134277344, "ViewRequirementAgentConnector_ms": 0.1759488582611084}}, "episode_reward_max": -18.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.57, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-39.0, -50.0, -47.0, -47.0, -47.0, -18.0, -49.0, -39.0, -27.0, -44.0, -55.0, -61.0, -57.0, -62.0, -51.0, -56.0, -58.0, -37.0, -63.0, -61.0, -61.0, -38.0, -58.0, -62.0, -39.0, -43.0, -63.0, -36.0, -51.0, -59.0, -60.0, -58.0, -49.0, -24.0, -62.0, -55.0, -54.0, -58.0, -59.0, -35.0, -54.0, -57.0, -61.0, -41.0, -47.0, -23.0, -52.0, -46.0, -46.0, -52.0, -26.0, -40.0, -41.0, -60.0, -48.0, -49.0, -53.0, -44.0, -50.0, -34.0, -53.0, -59.0, -44.0, -33.0, -29.0, -54.0, -59.0, -61.0, -57.0, -57.0, -60.0, -31.0, -53.0, -45.0, -33.0, -53.0, -60.0, -43.0, -39.0, -57.0, -47.0, -50.0, -58.0, -37.0, -43.0, -50.0, -60.0, -56.0, -47.0, -60.0, -50.0, -58.0, -61.0, -60.0, -60.0, -59.0, -53.0, -45.0, -45.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0302731758173813, "mean_inference_ms": 16.05260507677756, "mean_action_processing_ms": 0.6350826215431742, "mean_env_wait_ms": 0.4129044438865136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23914074897766113, "StateBufferConnector_ms": 0.004172325134277344, "ViewRequirementAgentConnector_ms": 0.1759488582611084}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.81576047599119, "num_agent_steps_trained_throughput_per_sec": 7.81576047599119, "timesteps_total": 16384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 64792.758, "sample_time_ms": 5214.983, "load_time_ms": 0.262, "load_throughput": 1956170.202, "learn_time_ms": 59577.075, "learn_throughput": 8.594, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 1024, "training_iteration": 32, "trial_id": "02b4f_00268", "date": "2024-02-27_13-49-11", "timestamp": 1709038151, "time_this_iter_s": 65.51344466209412, "time_total_s": 3558.4390811920166, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3558.4390811920166, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.614893617021277, "ram_util_percent": 5.293617021276595}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.06, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.10890625, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.948049344619115, "policy_loss": -0.056705807863424225, "vf_loss": 6.34085073073705, "vf_explained_var": 0.9899909575780232, "kl": 0.0051969175069398205, "entropy": 95.43678862253824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "sampler_results": {"episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.06, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10890625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.10890625, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -24.0, -62.0, -55.0, -54.0, -58.0, -59.0, -35.0, -54.0, -57.0, -61.0, -41.0, -47.0, -23.0, -52.0, -46.0, -46.0, -52.0, -26.0, -40.0, -41.0, -60.0, -48.0, -49.0, -53.0, -44.0, -50.0, -34.0, -53.0, -59.0, -44.0, -33.0, -29.0, -54.0, -59.0, -61.0, -57.0, -57.0, -60.0, -31.0, -53.0, -45.0, -33.0, -53.0, -60.0, -43.0, -39.0, -57.0, -47.0, -50.0, -58.0, -37.0, -43.0, -50.0, -60.0, -56.0, -47.0, -60.0, -50.0, -58.0, -61.0, -60.0, -60.0, -59.0, -53.0, -45.0, -45.0, -62.0, -51.0, -53.0, -59.0, -63.0, -56.0, -11.0, -64.0, -61.0, -51.0, -58.0, -63.0, -57.0, -57.0, -29.0, -44.0, -57.0, -61.0, -34.0, -48.0, -62.0, -46.0, -52.0, -45.0, -37.0, -39.0, -57.0, -41.0, -55.0, -60.0, -62.0, -54.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0029228142323157, "mean_inference_ms": 15.818019412633417, "mean_action_processing_ms": 0.6279689594022108, "mean_env_wait_ms": 0.408186801635118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24071812629699707, "StateBufferConnector_ms": 0.00422978401184082, "ViewRequirementAgentConnector_ms": 0.17554211616516113}}, "episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -24.0, -62.0, -55.0, -54.0, -58.0, -59.0, -35.0, -54.0, -57.0, -61.0, -41.0, -47.0, -23.0, -52.0, -46.0, -46.0, -52.0, -26.0, -40.0, -41.0, -60.0, -48.0, -49.0, -53.0, -44.0, -50.0, -34.0, -53.0, -59.0, -44.0, -33.0, -29.0, -54.0, -59.0, -61.0, -57.0, -57.0, -60.0, -31.0, -53.0, -45.0, -33.0, -53.0, -60.0, -43.0, -39.0, -57.0, -47.0, -50.0, -58.0, -37.0, -43.0, -50.0, -60.0, -56.0, -47.0, -60.0, -50.0, -58.0, -61.0, -60.0, -60.0, -59.0, -53.0, -45.0, -45.0, -62.0, -51.0, -53.0, -59.0, -63.0, -56.0, -11.0, -64.0, -61.0, -51.0, -58.0, -63.0, -57.0, -57.0, -29.0, -44.0, -57.0, -61.0, -34.0, -48.0, -62.0, -46.0, -52.0, -45.0, -37.0, -39.0, -57.0, -41.0, -55.0, -60.0, -62.0, -54.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0029228142323157, "mean_inference_ms": 15.818019412633417, "mean_action_processing_ms": 0.6279689594022108, "mean_env_wait_ms": 0.408186801635118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24071812629699707, "StateBufferConnector_ms": 0.00422978401184082, "ViewRequirementAgentConnector_ms": 0.17554211616516113}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.765105712567631, "num_agent_steps_trained_throughput_per_sec": 7.765105712567631, "timesteps_total": 16896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16896, "timers": {"training_iteration_time_ms": 64923.518, "sample_time_ms": 5218.464, "load_time_ms": 0.268, "load_throughput": 1908365.456, "learn_time_ms": 59704.339, "learn_throughput": 8.576, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 16896, "num_agent_steps_trained": 16896}, "done": false, "episodes_total": 1056, "training_iteration": 33, "trial_id": "02b4f_00268", "date": "2024-02-27_13-50-21", "timestamp": 1709038221, "time_this_iter_s": 65.94076251983643, "time_total_s": 3624.379843711853, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3624.379843711853, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.580000000000002, "ram_util_percent": 5.398999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.28, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.099375, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.9830747147401175, "policy_loss": -0.06604686959957083, "vf_loss": 6.425820074478785, "vf_explained_var": 0.9910548324386279, "kl": 0.004057178609536194, "entropy": 95.45046914418539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "sampler_results": {"episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.28, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.099375, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-29.0, -54.0, -59.0, -61.0, -57.0, -57.0, -60.0, -31.0, -53.0, -45.0, -33.0, -53.0, -60.0, -43.0, -39.0, -57.0, -47.0, -50.0, -58.0, -37.0, -43.0, -50.0, -60.0, -56.0, -47.0, -60.0, -50.0, -58.0, -61.0, -60.0, -60.0, -59.0, -53.0, -45.0, -45.0, -62.0, -51.0, -53.0, -59.0, -63.0, -56.0, -11.0, -64.0, -61.0, -51.0, -58.0, -63.0, -57.0, -57.0, -29.0, -44.0, -57.0, -61.0, -34.0, -48.0, -62.0, -46.0, -52.0, -45.0, -37.0, -39.0, -57.0, -41.0, -55.0, -60.0, -62.0, -54.0, -58.0, -53.0, -46.0, -53.0, -45.0, -39.0, -57.0, -49.0, -57.0, -32.0, -39.0, -50.0, -58.0, -62.0, -42.0, -26.0, -60.0, -55.0, -46.0, -47.0, -48.0, -57.0, -57.0, -62.0, -45.0, -60.0, -59.0, -60.0, -58.0, -49.0, -61.0, -61.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9775346589622393, "mean_inference_ms": 15.598970415532474, "mean_action_processing_ms": 0.6213450458797425, "mean_env_wait_ms": 0.4038237423838543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24391555786132812, "StateBufferConnector_ms": 0.004294872283935547, "ViewRequirementAgentConnector_ms": 0.1834118366241455}}, "episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-29.0, -54.0, -59.0, -61.0, -57.0, -57.0, -60.0, -31.0, -53.0, -45.0, -33.0, -53.0, -60.0, -43.0, -39.0, -57.0, -47.0, -50.0, -58.0, -37.0, -43.0, -50.0, -60.0, -56.0, -47.0, -60.0, -50.0, -58.0, -61.0, -60.0, -60.0, -59.0, -53.0, -45.0, -45.0, -62.0, -51.0, -53.0, -59.0, -63.0, -56.0, -11.0, -64.0, -61.0, -51.0, -58.0, -63.0, -57.0, -57.0, -29.0, -44.0, -57.0, -61.0, -34.0, -48.0, -62.0, -46.0, -52.0, -45.0, -37.0, -39.0, -57.0, -41.0, -55.0, -60.0, -62.0, -54.0, -58.0, -53.0, -46.0, -53.0, -45.0, -39.0, -57.0, -49.0, -57.0, -32.0, -39.0, -50.0, -58.0, -62.0, -42.0, -26.0, -60.0, -55.0, -46.0, -47.0, -48.0, -57.0, -57.0, -62.0, -45.0, -60.0, -59.0, -60.0, -58.0, -49.0, -61.0, -61.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9775346589622393, "mean_inference_ms": 15.598970415532474, "mean_action_processing_ms": 0.6213450458797425, "mean_env_wait_ms": 0.4038237423838543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24391555786132812, "StateBufferConnector_ms": 0.004294872283935547, "ViewRequirementAgentConnector_ms": 0.1834118366241455}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.72725236197636, "num_agent_steps_trained_throughput_per_sec": 7.72725236197636, "timesteps_total": 17408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 65107.377, "sample_time_ms": 5238.16, "load_time_ms": 0.275, "load_throughput": 1861388.271, "learn_time_ms": 59868.477, "learn_throughput": 8.552, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "episodes_total": 1088, "training_iteration": 34, "trial_id": "02b4f_00268", "date": "2024-02-27_13-51-28", "timestamp": 1709038288, "time_this_iter_s": 66.2641065120697, "time_total_s": 3690.6439502239227, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3690.6439502239227, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.73191489361702, "ram_util_percent": 5.321276595744681}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.25, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.099609375, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.3960527817408246, "policy_loss": -0.07739166906103492, "vf_loss": 5.500947380065918, "vf_explained_var": 0.993549245595932, "kl": 0.004398703211549623, "entropy": 95.50907491048177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "sampler_results": {"episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.25, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.25, "reward_total_min": -64, "reward_total_max": -11, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.4140625, "reward_score_mean": 0.099609375, "reward_score_min": 0.0, "reward_score_max": 0.4140625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-53.0, -45.0, -45.0, -62.0, -51.0, -53.0, -59.0, -63.0, -56.0, -11.0, -64.0, -61.0, -51.0, -58.0, -63.0, -57.0, -57.0, -29.0, -44.0, -57.0, -61.0, -34.0, -48.0, -62.0, -46.0, -52.0, -45.0, -37.0, -39.0, -57.0, -41.0, -55.0, -60.0, -62.0, -54.0, -58.0, -53.0, -46.0, -53.0, -45.0, -39.0, -57.0, -49.0, -57.0, -32.0, -39.0, -50.0, -58.0, -62.0, -42.0, -26.0, -60.0, -55.0, -46.0, -47.0, -48.0, -57.0, -57.0, -62.0, -45.0, -60.0, -59.0, -60.0, -58.0, -49.0, -61.0, -61.0, -38.0, -50.0, -58.0, -59.0, -51.0, -57.0, -59.0, -46.0, -55.0, -51.0, -58.0, -63.0, -38.0, -28.0, -49.0, -62.0, -59.0, -46.0, -32.0, -56.0, -53.0, -53.0, -59.0, -43.0, -42.0, -44.0, -57.0, -60.0, -50.0, -50.0, -37.0, -62.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9539347034993408, "mean_inference_ms": 15.394619167863716, "mean_action_processing_ms": 0.615193781976968, "mean_env_wait_ms": 0.399810394542956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24672555923461914, "StateBufferConnector_ms": 0.004370927810668945, "ViewRequirementAgentConnector_ms": 0.18757963180541992}}, "episode_reward_max": -11.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.25, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-53.0, -45.0, -45.0, -62.0, -51.0, -53.0, -59.0, -63.0, -56.0, -11.0, -64.0, -61.0, -51.0, -58.0, -63.0, -57.0, -57.0, -29.0, -44.0, -57.0, -61.0, -34.0, -48.0, -62.0, -46.0, -52.0, -45.0, -37.0, -39.0, -57.0, -41.0, -55.0, -60.0, -62.0, -54.0, -58.0, -53.0, -46.0, -53.0, -45.0, -39.0, -57.0, -49.0, -57.0, -32.0, -39.0, -50.0, -58.0, -62.0, -42.0, -26.0, -60.0, -55.0, -46.0, -47.0, -48.0, -57.0, -57.0, -62.0, -45.0, -60.0, -59.0, -60.0, -58.0, -49.0, -61.0, -61.0, -38.0, -50.0, -58.0, -59.0, -51.0, -57.0, -59.0, -46.0, -55.0, -51.0, -58.0, -63.0, -38.0, -28.0, -49.0, -62.0, -59.0, -46.0, -32.0, -56.0, -53.0, -53.0, -59.0, -43.0, -42.0, -44.0, -57.0, -60.0, -50.0, -50.0, -37.0, -62.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9539347034993408, "mean_inference_ms": 15.394619167863716, "mean_action_processing_ms": 0.615193781976968, "mean_env_wait_ms": 0.399810394542956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24672555923461914, "StateBufferConnector_ms": 0.004370927810668945, "ViewRequirementAgentConnector_ms": 0.18757963180541992}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.709287784831813, "num_agent_steps_trained_throughput_per_sec": 7.709287784831813, "timesteps_total": 17920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 17920, "timers": {"training_iteration_time_ms": 65269.17, "sample_time_ms": 5286.036, "load_time_ms": 0.275, "load_throughput": 1863003.078, "learn_time_ms": 59982.404, "learn_throughput": 8.536, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 17920, "num_agent_steps_trained": 17920}, "done": false, "episodes_total": 1120, "training_iteration": 35, "trial_id": "02b4f_00268", "date": "2024-02-27_13-52-34", "timestamp": 1709038354, "time_this_iter_s": 66.41831517219543, "time_total_s": 3757.062265396118, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3757.062265396118, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.770212765957446, "ram_util_percent": 5.341489361702125}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.02, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.09359375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.250284415483475, "policy_loss": -0.0747933010570705, "vf_loss": 6.797512563069661, "vf_explained_var": 0.9883234947919846, "kl": 0.009720679568330066, "entropy": 95.74995778401693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.02, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.02, "reward_total_min": -64, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09359375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.296875, "reward_score_mean": 0.09359375, "reward_score_min": 0.0, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -62.0, -54.0, -58.0, -53.0, -46.0, -53.0, -45.0, -39.0, -57.0, -49.0, -57.0, -32.0, -39.0, -50.0, -58.0, -62.0, -42.0, -26.0, -60.0, -55.0, -46.0, -47.0, -48.0, -57.0, -57.0, -62.0, -45.0, -60.0, -59.0, -60.0, -58.0, -49.0, -61.0, -61.0, -38.0, -50.0, -58.0, -59.0, -51.0, -57.0, -59.0, -46.0, -55.0, -51.0, -58.0, -63.0, -38.0, -28.0, -49.0, -62.0, -59.0, -46.0, -32.0, -56.0, -53.0, -53.0, -59.0, -43.0, -42.0, -44.0, -57.0, -60.0, -50.0, -50.0, -37.0, -62.0, -57.0, -60.0, -59.0, -43.0, -52.0, -48.0, -51.0, -54.0, -61.0, -58.0, -56.0, -41.0, -49.0, -59.0, -50.0, -40.0, -49.0, -58.0, -58.0, -64.0, -38.0, -55.0, -51.0, -49.0, -50.0, -51.0, -52.0, -51.0, -56.0, -59.0, -60.0, -51.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9320914597978827, "mean_inference_ms": 15.203720542763914, "mean_action_processing_ms": 0.6094802711111962, "mean_env_wait_ms": 0.3960971383818714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24904346466064453, "StateBufferConnector_ms": 0.004465818405151367, "ViewRequirementAgentConnector_ms": 0.19387125968933105}}, "episode_reward_max": -26.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.02, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -62.0, -54.0, -58.0, -53.0, -46.0, -53.0, -45.0, -39.0, -57.0, -49.0, -57.0, -32.0, -39.0, -50.0, -58.0, -62.0, -42.0, -26.0, -60.0, -55.0, -46.0, -47.0, -48.0, -57.0, -57.0, -62.0, -45.0, -60.0, -59.0, -60.0, -58.0, -49.0, -61.0, -61.0, -38.0, -50.0, -58.0, -59.0, -51.0, -57.0, -59.0, -46.0, -55.0, -51.0, -58.0, -63.0, -38.0, -28.0, -49.0, -62.0, -59.0, -46.0, -32.0, -56.0, -53.0, -53.0, -59.0, -43.0, -42.0, -44.0, -57.0, -60.0, -50.0, -50.0, -37.0, -62.0, -57.0, -60.0, -59.0, -43.0, -52.0, -48.0, -51.0, -54.0, -61.0, -58.0, -56.0, -41.0, -49.0, -59.0, -50.0, -40.0, -49.0, -58.0, -58.0, -64.0, -38.0, -55.0, -51.0, -49.0, -50.0, -51.0, -52.0, -51.0, -56.0, -59.0, -60.0, -51.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9320914597978827, "mean_inference_ms": 15.203720542763914, "mean_action_processing_ms": 0.6094802711111962, "mean_env_wait_ms": 0.3960971383818714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24904346466064453, "StateBufferConnector_ms": 0.004465818405151367, "ViewRequirementAgentConnector_ms": 0.19387125968933105}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.729079098712908, "num_agent_steps_trained_throughput_per_sec": 7.729079098712908, "timesteps_total": 18432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 65442.208, "sample_time_ms": 5315.038, "load_time_ms": 0.28, "load_throughput": 1828112.41, "learn_time_ms": 60126.427, "learn_throughput": 8.515, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "episodes_total": 1152, "training_iteration": 36, "trial_id": "02b4f_00268", "date": "2024-02-27_13-53-40", "timestamp": 1709038420, "time_this_iter_s": 66.24809670448303, "time_total_s": 3823.310362100601, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3823.310362100601, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.904255319148938, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.17, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.092421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.092421875, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.314178371429444, "policy_loss": -0.06623146204898754, "vf_loss": 6.940405849615733, "vf_explained_var": 0.9935257449746132, "kl": 0.00529650492579461, "entropy": 95.6296911239624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.17, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.17, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.092421875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.092421875, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -61.0, -61.0, -38.0, -50.0, -58.0, -59.0, -51.0, -57.0, -59.0, -46.0, -55.0, -51.0, -58.0, -63.0, -38.0, -28.0, -49.0, -62.0, -59.0, -46.0, -32.0, -56.0, -53.0, -53.0, -59.0, -43.0, -42.0, -44.0, -57.0, -60.0, -50.0, -50.0, -37.0, -62.0, -57.0, -60.0, -59.0, -43.0, -52.0, -48.0, -51.0, -54.0, -61.0, -58.0, -56.0, -41.0, -49.0, -59.0, -50.0, -40.0, -49.0, -58.0, -58.0, -64.0, -38.0, -55.0, -51.0, -49.0, -50.0, -51.0, -52.0, -51.0, -56.0, -59.0, -60.0, -51.0, -60.0, -22.0, -47.0, -59.0, -60.0, -63.0, -48.0, -57.0, -56.0, -40.0, -62.0, -50.0, -60.0, -56.0, -56.0, -39.0, -35.0, -61.0, -60.0, -54.0, -63.0, -50.0, -36.0, -57.0, -58.0, -61.0, -55.0, -61.0, -37.0, -45.0, -62.0, -44.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9112177339759073, "mean_inference_ms": 15.022462671494576, "mean_action_processing_ms": 0.6040539851385158, "mean_env_wait_ms": 0.392583325697206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24605655670166016, "StateBufferConnector_ms": 0.004391193389892578, "ViewRequirementAgentConnector_ms": 0.18855905532836914}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.17, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -61.0, -61.0, -38.0, -50.0, -58.0, -59.0, -51.0, -57.0, -59.0, -46.0, -55.0, -51.0, -58.0, -63.0, -38.0, -28.0, -49.0, -62.0, -59.0, -46.0, -32.0, -56.0, -53.0, -53.0, -59.0, -43.0, -42.0, -44.0, -57.0, -60.0, -50.0, -50.0, -37.0, -62.0, -57.0, -60.0, -59.0, -43.0, -52.0, -48.0, -51.0, -54.0, -61.0, -58.0, -56.0, -41.0, -49.0, -59.0, -50.0, -40.0, -49.0, -58.0, -58.0, -64.0, -38.0, -55.0, -51.0, -49.0, -50.0, -51.0, -52.0, -51.0, -56.0, -59.0, -60.0, -51.0, -60.0, -22.0, -47.0, -59.0, -60.0, -63.0, -48.0, -57.0, -56.0, -40.0, -62.0, -50.0, -60.0, -56.0, -56.0, -39.0, -35.0, -61.0, -60.0, -54.0, -63.0, -50.0, -36.0, -57.0, -58.0, -61.0, -55.0, -61.0, -37.0, -45.0, -62.0, -44.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9112177339759073, "mean_inference_ms": 15.022462671494576, "mean_action_processing_ms": 0.6040539851385158, "mean_env_wait_ms": 0.392583325697206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24605655670166016, "StateBufferConnector_ms": 0.004391193389892578, "ViewRequirementAgentConnector_ms": 0.18855905532836914}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.830335826353792, "num_agent_steps_trained_throughput_per_sec": 7.830335826353792, "timesteps_total": 18944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 18944, "timers": {"training_iteration_time_ms": 65569.086, "sample_time_ms": 5356.92, "load_time_ms": 0.281, "load_throughput": 1820981.64, "learn_time_ms": 60211.415, "learn_throughput": 8.503, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 18944, "num_agent_steps_trained": 18944}, "done": false, "episodes_total": 1184, "training_iteration": 37, "trial_id": "02b4f_00268", "date": "2024-02-27_13-54-46", "timestamp": 1709038486, "time_this_iter_s": 65.39146566390991, "time_total_s": 3888.701827764511, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3888.701827764511, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.94731182795699, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.86, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.09484375, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.8108420173327127, "policy_loss": -0.07704899491121371, "vf_loss": 6.164874597390493, "vf_explained_var": 0.9919273421168328, "kl": 0.004308585927715451, "entropy": 95.40629971822104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.86, "reward_total_min": -64, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.09484375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.328125, "reward_score_mean": 0.09484375, "reward_score_min": 0.0, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-50.0, -37.0, -62.0, -57.0, -60.0, -59.0, -43.0, -52.0, -48.0, -51.0, -54.0, -61.0, -58.0, -56.0, -41.0, -49.0, -59.0, -50.0, -40.0, -49.0, -58.0, -58.0, -64.0, -38.0, -55.0, -51.0, -49.0, -50.0, -51.0, -52.0, -51.0, -56.0, -59.0, -60.0, -51.0, -60.0, -22.0, -47.0, -59.0, -60.0, -63.0, -48.0, -57.0, -56.0, -40.0, -62.0, -50.0, -60.0, -56.0, -56.0, -39.0, -35.0, -61.0, -60.0, -54.0, -63.0, -50.0, -36.0, -57.0, -58.0, -61.0, -55.0, -61.0, -37.0, -45.0, -62.0, -44.0, -57.0, -33.0, -56.0, -52.0, -61.0, -43.0, -58.0, -61.0, -63.0, -62.0, -56.0, -61.0, -56.0, -59.0, -44.0, -60.0, -53.0, -43.0, -53.0, -57.0, -52.0, -33.0, -38.0, -50.0, -47.0, -62.0, -61.0, -35.0, -32.0, -48.0, -51.0, -43.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8912719232328892, "mean_inference_ms": 14.850507007522097, "mean_action_processing_ms": 0.598899075519713, "mean_env_wait_ms": 0.3891943383181193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24459218978881836, "StateBufferConnector_ms": 0.004317283630371094, "ViewRequirementAgentConnector_ms": 0.18434667587280273}}, "episode_reward_max": -22.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.0, -37.0, -62.0, -57.0, -60.0, -59.0, -43.0, -52.0, -48.0, -51.0, -54.0, -61.0, -58.0, -56.0, -41.0, -49.0, -59.0, -50.0, -40.0, -49.0, -58.0, -58.0, -64.0, -38.0, -55.0, -51.0, -49.0, -50.0, -51.0, -52.0, -51.0, -56.0, -59.0, -60.0, -51.0, -60.0, -22.0, -47.0, -59.0, -60.0, -63.0, -48.0, -57.0, -56.0, -40.0, -62.0, -50.0, -60.0, -56.0, -56.0, -39.0, -35.0, -61.0, -60.0, -54.0, -63.0, -50.0, -36.0, -57.0, -58.0, -61.0, -55.0, -61.0, -37.0, -45.0, -62.0, -44.0, -57.0, -33.0, -56.0, -52.0, -61.0, -43.0, -58.0, -61.0, -63.0, -62.0, -56.0, -61.0, -56.0, -59.0, -44.0, -60.0, -53.0, -43.0, -53.0, -57.0, -52.0, -33.0, -38.0, -50.0, -47.0, -62.0, -61.0, -35.0, -32.0, -48.0, -51.0, -43.0, -33.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8912719232328892, "mean_inference_ms": 14.850507007522097, "mean_action_processing_ms": 0.598899075519713, "mean_env_wait_ms": 0.3891943383181193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24459218978881836, "StateBufferConnector_ms": 0.004317283630371094, "ViewRequirementAgentConnector_ms": 0.18434667587280273}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.7201238064921265, "num_agent_steps_trained_throughput_per_sec": 7.7201238064921265, "timesteps_total": 19456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 65845.693, "sample_time_ms": 5388.808, "load_time_ms": 0.287, "load_throughput": 1781257.173, "learn_time_ms": 60456.109, "learn_throughput": 8.469, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "episodes_total": 1216, "training_iteration": 38, "trial_id": "02b4f_00268", "date": "2024-02-27_13-55-52", "timestamp": 1709038552, "time_this_iter_s": 66.32493996620178, "time_total_s": 3955.026767730713, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 3955.026767730713, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.903191489361703, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.21, "reward_total_min": -63, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099921875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.328125, "reward_score_mean": 0.099921875, "reward_score_min": 0.0078125, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.983342415094375, "policy_loss": -0.06743153585121035, "vf_loss": 7.958163269360861, "vf_explained_var": 0.9876241212089857, "kl": 0.009716295069287244, "entropy": 95.62805894215902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "sampler_results": {"episode_reward_max": -22.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.21, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.21, "reward_total_min": -63, "reward_total_max": -22, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.099921875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.328125, "reward_score_mean": 0.099921875, "reward_score_min": 0.0078125, "reward_score_max": 0.328125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -60.0, -51.0, -60.0, -22.0, -47.0, -59.0, -60.0, -63.0, -48.0, -57.0, -56.0, -40.0, -62.0, -50.0, -60.0, -56.0, -56.0, -39.0, -35.0, -61.0, -60.0, -54.0, -63.0, -50.0, -36.0, -57.0, -58.0, -61.0, -55.0, -61.0, -37.0, -45.0, -62.0, -44.0, -57.0, -33.0, -56.0, -52.0, -61.0, -43.0, -58.0, -61.0, -63.0, -62.0, -56.0, -61.0, -56.0, -59.0, -44.0, -60.0, -53.0, -43.0, -53.0, -57.0, -52.0, -33.0, -38.0, -50.0, -47.0, -62.0, -61.0, -35.0, -32.0, -48.0, -51.0, -43.0, -33.0, -51.0, -42.0, -38.0, -26.0, -60.0, -59.0, -31.0, -30.0, -60.0, -63.0, -57.0, -47.0, -54.0, -60.0, -55.0, -48.0, -34.0, -55.0, -45.0, -33.0, -49.0, -60.0, -50.0, -61.0, -50.0, -59.0, -50.0, -58.0, -59.0, -61.0, -38.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8719018256681539, "mean_inference_ms": 14.685613531217868, "mean_action_processing_ms": 0.5938940586557933, "mean_env_wait_ms": 0.3858828266627944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23966145515441895, "StateBufferConnector_ms": 0.004194498062133789, "ViewRequirementAgentConnector_ms": 0.17426753044128418}}, "episode_reward_max": -22.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.21, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -60.0, -51.0, -60.0, -22.0, -47.0, -59.0, -60.0, -63.0, -48.0, -57.0, -56.0, -40.0, -62.0, -50.0, -60.0, -56.0, -56.0, -39.0, -35.0, -61.0, -60.0, -54.0, -63.0, -50.0, -36.0, -57.0, -58.0, -61.0, -55.0, -61.0, -37.0, -45.0, -62.0, -44.0, -57.0, -33.0, -56.0, -52.0, -61.0, -43.0, -58.0, -61.0, -63.0, -62.0, -56.0, -61.0, -56.0, -59.0, -44.0, -60.0, -53.0, -43.0, -53.0, -57.0, -52.0, -33.0, -38.0, -50.0, -47.0, -62.0, -61.0, -35.0, -32.0, -48.0, -51.0, -43.0, -33.0, -51.0, -42.0, -38.0, -26.0, -60.0, -59.0, -31.0, -30.0, -60.0, -63.0, -57.0, -47.0, -54.0, -60.0, -55.0, -48.0, -34.0, -55.0, -45.0, -33.0, -49.0, -60.0, -50.0, -61.0, -50.0, -59.0, -50.0, -58.0, -59.0, -61.0, -38.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8719018256681539, "mean_inference_ms": 14.685613531217868, "mean_action_processing_ms": 0.5938940586557933, "mean_env_wait_ms": 0.3858828266627944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23966145515441895, "StateBufferConnector_ms": 0.004194498062133789, "ViewRequirementAgentConnector_ms": 0.17426753044128418}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.912502202759747, "num_agent_steps_trained_throughput_per_sec": 7.912502202759747, "timesteps_total": 19968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 65769.192, "sample_time_ms": 5380.26, "load_time_ms": 0.29, "load_throughput": 1767476.253, "learn_time_ms": 60388.15, "learn_throughput": 8.478, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "done": false, "episodes_total": 1248, "training_iteration": 39, "trial_id": "02b4f_00268", "date": "2024-02-27_13-56-57", "timestamp": 1709038617, "time_this_iter_s": 64.71243333816528, "time_total_s": 4019.739201068878, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4019.739201068878, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.671739130434784, "ram_util_percent": 5.297826086956522}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.3, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10703125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.10703125, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.207720200220744, "policy_loss": -0.05754585467899839, "vf_loss": 6.68600130478541, "vf_explained_var": 0.9926998779177666, "kl": 0.011010092988735865, "entropy": 95.59747746785482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.3, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.3, "reward_total_min": -63, "reward_total_max": -26, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10703125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.296875, "reward_score_mean": 0.10703125, "reward_score_min": 0.0078125, "reward_score_max": 0.296875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-45.0, -62.0, -44.0, -57.0, -33.0, -56.0, -52.0, -61.0, -43.0, -58.0, -61.0, -63.0, -62.0, -56.0, -61.0, -56.0, -59.0, -44.0, -60.0, -53.0, -43.0, -53.0, -57.0, -52.0, -33.0, -38.0, -50.0, -47.0, -62.0, -61.0, -35.0, -32.0, -48.0, -51.0, -43.0, -33.0, -51.0, -42.0, -38.0, -26.0, -60.0, -59.0, -31.0, -30.0, -60.0, -63.0, -57.0, -47.0, -54.0, -60.0, -55.0, -48.0, -34.0, -55.0, -45.0, -33.0, -49.0, -60.0, -50.0, -61.0, -50.0, -59.0, -50.0, -58.0, -59.0, -61.0, -38.0, -61.0, -37.0, -44.0, -60.0, -47.0, -42.0, -60.0, -60.0, -27.0, -46.0, -61.0, -39.0, -57.0, -60.0, -52.0, -57.0, -51.0, -42.0, -50.0, -41.0, -39.0, -51.0, -60.0, -39.0, -46.0, -62.0, -42.0, -60.0, -38.0, -61.0, -58.0, -59.0, -54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.853229381557058, "mean_inference_ms": 14.527972570226561, "mean_action_processing_ms": 0.589086350493773, "mean_env_wait_ms": 0.38265021553826645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23954439163208008, "StateBufferConnector_ms": 0.0041658878326416016, "ViewRequirementAgentConnector_ms": 0.17147231101989746}}, "episode_reward_max": -26.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.3, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -62.0, -44.0, -57.0, -33.0, -56.0, -52.0, -61.0, -43.0, -58.0, -61.0, -63.0, -62.0, -56.0, -61.0, -56.0, -59.0, -44.0, -60.0, -53.0, -43.0, -53.0, -57.0, -52.0, -33.0, -38.0, -50.0, -47.0, -62.0, -61.0, -35.0, -32.0, -48.0, -51.0, -43.0, -33.0, -51.0, -42.0, -38.0, -26.0, -60.0, -59.0, -31.0, -30.0, -60.0, -63.0, -57.0, -47.0, -54.0, -60.0, -55.0, -48.0, -34.0, -55.0, -45.0, -33.0, -49.0, -60.0, -50.0, -61.0, -50.0, -59.0, -50.0, -58.0, -59.0, -61.0, -38.0, -61.0, -37.0, -44.0, -60.0, -47.0, -42.0, -60.0, -60.0, -27.0, -46.0, -61.0, -39.0, -57.0, -60.0, -52.0, -57.0, -51.0, -42.0, -50.0, -41.0, -39.0, -51.0, -60.0, -39.0, -46.0, -62.0, -42.0, -60.0, -38.0, -61.0, -58.0, -59.0, -54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.853229381557058, "mean_inference_ms": 14.527972570226561, "mean_action_processing_ms": 0.589086350493773, "mean_env_wait_ms": 0.38265021553826645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23954439163208008, "StateBufferConnector_ms": 0.0041658878326416016, "ViewRequirementAgentConnector_ms": 0.17147231101989746}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.918635907213073, "num_agent_steps_trained_throughput_per_sec": 7.918635907213073, "timesteps_total": 20480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 65690.264, "sample_time_ms": 5382.823, "load_time_ms": 0.284, "load_throughput": 1800371.938, "learn_time_ms": 60306.665, "learn_throughput": 8.49, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 1280, "training_iteration": 40, "trial_id": "02b4f_00268", "date": "2024-02-27_13-58-02", "timestamp": 1709038682, "time_this_iter_s": 64.6623113155365, "time_total_s": 4084.4015123844147, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4084.4015123844147, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.742391304347827, "ram_util_percent": 5.354347826086955}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.28, "reward_total_min": -63, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.115, "reward_score_min": 0.0078125, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.174576850732167, "policy_loss": -0.08193266466259956, "vf_loss": 6.72741097609202, "vf_explained_var": 0.9910995264848074, "kl": 0.0065035901030725315, "entropy": 95.52009258270263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "sampler_results": {"episode_reward_max": -23.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.28, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.28, "reward_total_min": -63, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.115, "reward_score_min": 0.0078125, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -51.0, -43.0, -33.0, -51.0, -42.0, -38.0, -26.0, -60.0, -59.0, -31.0, -30.0, -60.0, -63.0, -57.0, -47.0, -54.0, -60.0, -55.0, -48.0, -34.0, -55.0, -45.0, -33.0, -49.0, -60.0, -50.0, -61.0, -50.0, -59.0, -50.0, -58.0, -59.0, -61.0, -38.0, -61.0, -37.0, -44.0, -60.0, -47.0, -42.0, -60.0, -60.0, -27.0, -46.0, -61.0, -39.0, -57.0, -60.0, -52.0, -57.0, -51.0, -42.0, -50.0, -41.0, -39.0, -51.0, -60.0, -39.0, -46.0, -62.0, -42.0, -60.0, -38.0, -61.0, -58.0, -59.0, -54.0, -59.0, -55.0, -45.0, -42.0, -58.0, -25.0, -49.0, -35.0, -53.0, -59.0, -51.0, -31.0, -51.0, -54.0, -59.0, -33.0, -54.0, -48.0, -35.0, -51.0, -60.0, -62.0, -51.0, -56.0, -54.0, -40.0, -23.0, -62.0, -38.0, -57.0, -52.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8347231713194412, "mean_inference_ms": 14.374580338569803, "mean_action_processing_ms": 0.5842565954274654, "mean_env_wait_ms": 0.37933617060892544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2323458194732666, "StateBufferConnector_ms": 0.004040718078613281, "ViewRequirementAgentConnector_ms": 0.1603374481201172}}, "episode_reward_max": -23.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.28, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -51.0, -43.0, -33.0, -51.0, -42.0, -38.0, -26.0, -60.0, -59.0, -31.0, -30.0, -60.0, -63.0, -57.0, -47.0, -54.0, -60.0, -55.0, -48.0, -34.0, -55.0, -45.0, -33.0, -49.0, -60.0, -50.0, -61.0, -50.0, -59.0, -50.0, -58.0, -59.0, -61.0, -38.0, -61.0, -37.0, -44.0, -60.0, -47.0, -42.0, -60.0, -60.0, -27.0, -46.0, -61.0, -39.0, -57.0, -60.0, -52.0, -57.0, -51.0, -42.0, -50.0, -41.0, -39.0, -51.0, -60.0, -39.0, -46.0, -62.0, -42.0, -60.0, -38.0, -61.0, -58.0, -59.0, -54.0, -59.0, -55.0, -45.0, -42.0, -58.0, -25.0, -49.0, -35.0, -53.0, -59.0, -51.0, -31.0, -51.0, -54.0, -59.0, -33.0, -54.0, -48.0, -35.0, -51.0, -60.0, -62.0, -51.0, -56.0, -54.0, -40.0, -23.0, -62.0, -38.0, -57.0, -52.0, -45.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8347231713194412, "mean_inference_ms": 14.374580338569803, "mean_action_processing_ms": 0.5842565954274654, "mean_env_wait_ms": 0.37933617060892544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2323458194732666, "StateBufferConnector_ms": 0.004040718078613281, "ViewRequirementAgentConnector_ms": 0.1603374481201172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992, "num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.9159157689132735, "num_agent_steps_trained_throughput_per_sec": 7.9159157689132735, "timesteps_total": 20992, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 20992, "timers": {"training_iteration_time_ms": 65611.21, "sample_time_ms": 5352.143, "load_time_ms": 0.284, "load_throughput": 1803698.68, "learn_time_ms": 60258.297, "learn_throughput": 8.497, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 20992, "num_env_steps_trained": 20992, "num_agent_steps_sampled": 20992, "num_agent_steps_trained": 20992}, "done": false, "episodes_total": 1312, "training_iteration": 41, "trial_id": "02b4f_00268", "date": "2024-02-27_13-59-06", "timestamp": 1709038746, "time_this_iter_s": 64.68454337120056, "time_total_s": 4149.086055755615, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4149.086055755615, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.807608695652174, "ram_util_percent": 5.399999999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.86, "reward_total_min": -62, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11046875, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.11046875, "reward_score_min": 0.015625, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.115565301974614, "policy_loss": -0.08327387118091185, "vf_loss": 6.61671339670817, "vf_explained_var": 0.9859154343605041, "kl": 0.008005332445697351, "entropy": 95.86849250793458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "sampler_results": {"episode_reward_max": -23.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.86, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.86, "reward_total_min": -62, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11046875, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.11046875, "reward_score_min": 0.015625, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -61.0, -38.0, -61.0, -37.0, -44.0, -60.0, -47.0, -42.0, -60.0, -60.0, -27.0, -46.0, -61.0, -39.0, -57.0, -60.0, -52.0, -57.0, -51.0, -42.0, -50.0, -41.0, -39.0, -51.0, -60.0, -39.0, -46.0, -62.0, -42.0, -60.0, -38.0, -61.0, -58.0, -59.0, -54.0, -59.0, -55.0, -45.0, -42.0, -58.0, -25.0, -49.0, -35.0, -53.0, -59.0, -51.0, -31.0, -51.0, -54.0, -59.0, -33.0, -54.0, -48.0, -35.0, -51.0, -60.0, -62.0, -51.0, -56.0, -54.0, -40.0, -23.0, -62.0, -38.0, -57.0, -52.0, -45.0, -47.0, -37.0, -59.0, -58.0, -40.0, -51.0, -53.0, -44.0, -59.0, -48.0, -62.0, -40.0, -60.0, -60.0, -56.0, -57.0, -58.0, -51.0, -53.0, -39.0, -61.0, -58.0, -62.0, -31.0, -60.0, -48.0, -43.0, -28.0, -43.0, -54.0, -55.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8166449395270763, "mean_inference_ms": 14.226507220173605, "mean_action_processing_ms": 0.5795047649989792, "mean_env_wait_ms": 0.3760091428496449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2277355194091797, "StateBufferConnector_ms": 0.00391840934753418, "ViewRequirementAgentConnector_ms": 0.15329456329345703}}, "episode_reward_max": -23.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.86, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -61.0, -38.0, -61.0, -37.0, -44.0, -60.0, -47.0, -42.0, -60.0, -60.0, -27.0, -46.0, -61.0, -39.0, -57.0, -60.0, -52.0, -57.0, -51.0, -42.0, -50.0, -41.0, -39.0, -51.0, -60.0, -39.0, -46.0, -62.0, -42.0, -60.0, -38.0, -61.0, -58.0, -59.0, -54.0, -59.0, -55.0, -45.0, -42.0, -58.0, -25.0, -49.0, -35.0, -53.0, -59.0, -51.0, -31.0, -51.0, -54.0, -59.0, -33.0, -54.0, -48.0, -35.0, -51.0, -60.0, -62.0, -51.0, -56.0, -54.0, -40.0, -23.0, -62.0, -38.0, -57.0, -52.0, -45.0, -47.0, -37.0, -59.0, -58.0, -40.0, -51.0, -53.0, -44.0, -59.0, -48.0, -62.0, -40.0, -60.0, -60.0, -56.0, -57.0, -58.0, -51.0, -53.0, -39.0, -61.0, -58.0, -62.0, -31.0, -60.0, -48.0, -43.0, -28.0, -43.0, -54.0, -55.0, -43.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8166449395270763, "mean_inference_ms": 14.226507220173605, "mean_action_processing_ms": 0.5795047649989792, "mean_env_wait_ms": 0.3760091428496449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2277355194091797, "StateBufferConnector_ms": 0.00391840934753418, "ViewRequirementAgentConnector_ms": 0.15329456329345703}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.992824201802397, "num_agent_steps_trained_throughput_per_sec": 7.992824201802397, "timesteps_total": 21504, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 65466.091, "sample_time_ms": 5326.134, "load_time_ms": 0.285, "load_throughput": 1794804.553, "learn_time_ms": 60139.194, "learn_throughput": 8.514, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "episodes_total": 1344, "training_iteration": 42, "trial_id": "02b4f_00268", "date": "2024-02-27_14-00-10", "timestamp": 1709038810, "time_this_iter_s": 64.0621440410614, "time_total_s": 4213.148199796677, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4213.148199796677, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.83888888888889, "ram_util_percent": 5.399999999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.65, "reward_total_min": -62, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112109375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.112109375, "reward_score_min": 0.015625, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 4.279284630219141, "policy_loss": -0.06704801823943854, "vf_loss": 6.803890144824981, "vf_explained_var": 0.9930397868156433, "kl": 0.011966476752353768, "entropy": 95.67674694061279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "sampler_results": {"episode_reward_max": -23.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.65, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.65, "reward_total_min": -62, "reward_total_max": -23, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.112109375, "reward_percentile_min": 0.015625, "reward_percentile_max": 0.3203125, "reward_score_mean": 0.112109375, "reward_score_min": 0.015625, "reward_score_max": 0.3203125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-61.0, -58.0, -59.0, -54.0, -59.0, -55.0, -45.0, -42.0, -58.0, -25.0, -49.0, -35.0, -53.0, -59.0, -51.0, -31.0, -51.0, -54.0, -59.0, -33.0, -54.0, -48.0, -35.0, -51.0, -60.0, -62.0, -51.0, -56.0, -54.0, -40.0, -23.0, -62.0, -38.0, -57.0, -52.0, -45.0, -47.0, -37.0, -59.0, -58.0, -40.0, -51.0, -53.0, -44.0, -59.0, -48.0, -62.0, -40.0, -60.0, -60.0, -56.0, -57.0, -58.0, -51.0, -53.0, -39.0, -61.0, -58.0, -62.0, -31.0, -60.0, -48.0, -43.0, -28.0, -43.0, -54.0, -55.0, -43.0, -41.0, -42.0, -58.0, -50.0, -35.0, -58.0, -61.0, -53.0, -58.0, -61.0, -53.0, -59.0, -27.0, -37.0, -59.0, -46.0, -57.0, -28.0, -59.0, -33.0, -35.0, -59.0, -41.0, -56.0, -43.0, -55.0, -35.0, -42.0, -62.0, -58.0, -51.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.799151287077948, "mean_inference_ms": 14.083809190094707, "mean_action_processing_ms": 0.574839811386758, "mean_env_wait_ms": 0.3727326168377474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22559642791748047, "StateBufferConnector_ms": 0.0038983821868896484, "ViewRequirementAgentConnector_ms": 0.15143251419067383}}, "episode_reward_max": -23.0, "episode_reward_min": -62.0, "episode_reward_mean": -49.65, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-61.0, -58.0, -59.0, -54.0, -59.0, -55.0, -45.0, -42.0, -58.0, -25.0, -49.0, -35.0, -53.0, -59.0, -51.0, -31.0, -51.0, -54.0, -59.0, -33.0, -54.0, -48.0, -35.0, -51.0, -60.0, -62.0, -51.0, -56.0, -54.0, -40.0, -23.0, -62.0, -38.0, -57.0, -52.0, -45.0, -47.0, -37.0, -59.0, -58.0, -40.0, -51.0, -53.0, -44.0, -59.0, -48.0, -62.0, -40.0, -60.0, -60.0, -56.0, -57.0, -58.0, -51.0, -53.0, -39.0, -61.0, -58.0, -62.0, -31.0, -60.0, -48.0, -43.0, -28.0, -43.0, -54.0, -55.0, -43.0, -41.0, -42.0, -58.0, -50.0, -35.0, -58.0, -61.0, -53.0, -58.0, -61.0, -53.0, -59.0, -27.0, -37.0, -59.0, -46.0, -57.0, -28.0, -59.0, -33.0, -35.0, -59.0, -41.0, -56.0, -43.0, -55.0, -35.0, -42.0, -62.0, -58.0, -51.0, -56.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.799151287077948, "mean_inference_ms": 14.083809190094707, "mean_action_processing_ms": 0.574839811386758, "mean_env_wait_ms": 0.3727326168377474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22559642791748047, "StateBufferConnector_ms": 0.0038983821868896484, "ViewRequirementAgentConnector_ms": 0.15143251419067383}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016, "num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.823852384221952, "num_agent_steps_trained_throughput_per_sec": 7.823852384221952, "timesteps_total": 22016, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22016, "timers": {"training_iteration_time_ms": 65416.583, "sample_time_ms": 5309.859, "load_time_ms": 0.277, "load_throughput": 1849843.783, "learn_time_ms": 60105.975, "learn_throughput": 8.518, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 22016, "num_env_steps_trained": 22016, "num_agent_steps_sampled": 22016, "num_agent_steps_trained": 22016}, "done": false, "episodes_total": 1376, "training_iteration": 43, "trial_id": "02b4f_00268", "date": "2024-02-27_14-01-16", "timestamp": 1709038876, "time_this_iter_s": 65.44567131996155, "time_total_s": 4278.593871116638, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4278.593871116638, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.92688172043011, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.54, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.11296875, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.8652361114819844, "policy_loss": -0.06837631252904733, "vf_loss": 6.177347751458486, "vf_explained_var": 0.9930386518438657, "kl": 0.009240808828817853, "entropy": 95.61674029032389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.54, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.54, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11296875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.11296875, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -57.0, -52.0, -45.0, -47.0, -37.0, -59.0, -58.0, -40.0, -51.0, -53.0, -44.0, -59.0, -48.0, -62.0, -40.0, -60.0, -60.0, -56.0, -57.0, -58.0, -51.0, -53.0, -39.0, -61.0, -58.0, -62.0, -31.0, -60.0, -48.0, -43.0, -28.0, -43.0, -54.0, -55.0, -43.0, -41.0, -42.0, -58.0, -50.0, -35.0, -58.0, -61.0, -53.0, -58.0, -61.0, -53.0, -59.0, -27.0, -37.0, -59.0, -46.0, -57.0, -28.0, -59.0, -33.0, -35.0, -59.0, -41.0, -56.0, -43.0, -55.0, -35.0, -42.0, -62.0, -58.0, -51.0, -56.0, -63.0, -52.0, -27.0, -51.0, -47.0, -47.0, -38.0, -61.0, -42.0, -45.0, -60.0, -53.0, -51.0, -61.0, -40.0, -47.0, -39.0, -59.0, -48.0, -56.0, -39.0, -50.0, -32.0, -59.0, -51.0, -50.0, -43.0, -38.0, -55.0, -55.0, -53.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7831968735347674, "mean_inference_ms": 13.951445069780299, "mean_action_processing_ms": 0.5706767655404278, "mean_env_wait_ms": 0.3698451270838076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2348949909210205, "StateBufferConnector_ms": 0.00406956672668457, "ViewRequirementAgentConnector_ms": 0.16361713409423828}}, "episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.54, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -57.0, -52.0, -45.0, -47.0, -37.0, -59.0, -58.0, -40.0, -51.0, -53.0, -44.0, -59.0, -48.0, -62.0, -40.0, -60.0, -60.0, -56.0, -57.0, -58.0, -51.0, -53.0, -39.0, -61.0, -58.0, -62.0, -31.0, -60.0, -48.0, -43.0, -28.0, -43.0, -54.0, -55.0, -43.0, -41.0, -42.0, -58.0, -50.0, -35.0, -58.0, -61.0, -53.0, -58.0, -61.0, -53.0, -59.0, -27.0, -37.0, -59.0, -46.0, -57.0, -28.0, -59.0, -33.0, -35.0, -59.0, -41.0, -56.0, -43.0, -55.0, -35.0, -42.0, -62.0, -58.0, -51.0, -56.0, -63.0, -52.0, -27.0, -51.0, -47.0, -47.0, -38.0, -61.0, -42.0, -45.0, -60.0, -53.0, -51.0, -61.0, -40.0, -47.0, -39.0, -59.0, -48.0, -56.0, -39.0, -50.0, -32.0, -59.0, -51.0, -50.0, -43.0, -38.0, -55.0, -55.0, -53.0, -64.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7831968735347674, "mean_inference_ms": 13.951445069780299, "mean_action_processing_ms": 0.5706767655404278, "mean_env_wait_ms": 0.3698451270838076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2348949909210205, "StateBufferConnector_ms": 0.00406956672668457, "ViewRequirementAgentConnector_ms": 0.16361713409423828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.80218637637783, "num_agent_steps_trained_throughput_per_sec": 7.80218637637783, "timesteps_total": 22528, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 65352.946, "sample_time_ms": 5308.868, "load_time_ms": 0.271, "load_throughput": 1888395.751, "learn_time_ms": 60043.348, "learn_throughput": 8.527, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "episodes_total": 1408, "training_iteration": 44, "trial_id": "02b4f_00268", "date": "2024-02-27_14-02-22", "timestamp": 1709038942, "time_this_iter_s": 65.62734127044678, "time_total_s": 4344.221212387085, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4344.221212387085, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.838709677419356, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.98, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.10953125, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 7.688671874999998, "cur_lr": 0.0008365429151557455, "total_loss": 3.980740718046824, "policy_loss": -0.059674434425930185, "vf_loss": 6.30485835870107, "vf_explained_var": 0.992622530957063, "kl": 0.012761969958288925, "entropy": 95.2289965947469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5340.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.98, "reward_total_min": -64, "reward_total_max": -27, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10953125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.2890625, "reward_score_mean": 0.10953125, "reward_score_min": 0.0, "reward_score_max": 0.2890625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -54.0, -55.0, -43.0, -41.0, -42.0, -58.0, -50.0, -35.0, -58.0, -61.0, -53.0, -58.0, -61.0, -53.0, -59.0, -27.0, -37.0, -59.0, -46.0, -57.0, -28.0, -59.0, -33.0, -35.0, -59.0, -41.0, -56.0, -43.0, -55.0, -35.0, -42.0, -62.0, -58.0, -51.0, -56.0, -63.0, -52.0, -27.0, -51.0, -47.0, -47.0, -38.0, -61.0, -42.0, -45.0, -60.0, -53.0, -51.0, -61.0, -40.0, -47.0, -39.0, -59.0, -48.0, -56.0, -39.0, -50.0, -32.0, -59.0, -51.0, -50.0, -43.0, -38.0, -55.0, -55.0, -53.0, -64.0, -61.0, -61.0, -58.0, -32.0, -51.0, -51.0, -62.0, -34.0, -60.0, -54.0, -49.0, -51.0, -57.0, -45.0, -61.0, -50.0, -31.0, -58.0, -57.0, -30.0, -57.0, -39.0, -46.0, -60.0, -64.0, -53.0, -49.0, -60.0, -43.0, -59.0, -55.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7684009908167853, "mean_inference_ms": 13.826993076758598, "mean_action_processing_ms": 0.5668688802338631, "mean_env_wait_ms": 0.367224601779549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23692011833190918, "StateBufferConnector_ms": 0.004136562347412109, "ViewRequirementAgentConnector_ms": 0.17071866989135742}}, "episode_reward_max": -27.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -54.0, -55.0, -43.0, -41.0, -42.0, -58.0, -50.0, -35.0, -58.0, -61.0, -53.0, -58.0, -61.0, -53.0, -59.0, -27.0, -37.0, -59.0, -46.0, -57.0, -28.0, -59.0, -33.0, -35.0, -59.0, -41.0, -56.0, -43.0, -55.0, -35.0, -42.0, -62.0, -58.0, -51.0, -56.0, -63.0, -52.0, -27.0, -51.0, -47.0, -47.0, -38.0, -61.0, -42.0, -45.0, -60.0, -53.0, -51.0, -61.0, -40.0, -47.0, -39.0, -59.0, -48.0, -56.0, -39.0, -50.0, -32.0, -59.0, -51.0, -50.0, -43.0, -38.0, -55.0, -55.0, -53.0, -64.0, -61.0, -61.0, -58.0, -32.0, -51.0, -51.0, -62.0, -34.0, -60.0, -54.0, -49.0, -51.0, -57.0, -45.0, -61.0, -50.0, -31.0, -58.0, -57.0, -30.0, -57.0, -39.0, -46.0, -60.0, -64.0, -53.0, -49.0, -60.0, -43.0, -59.0, -55.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7684009908167853, "mean_inference_ms": 13.826993076758598, "mean_action_processing_ms": 0.5668688802338631, "mean_env_wait_ms": 0.367224601779549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23692011833190918, "StateBufferConnector_ms": 0.004136562347412109, "ViewRequirementAgentConnector_ms": 0.17071866989135742}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040, "num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.882320055301678, "num_agent_steps_trained_throughput_per_sec": 7.882320055301678, "timesteps_total": 23040, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23040, "timers": {"training_iteration_time_ms": 65207.156, "sample_time_ms": 5287.848, "load_time_ms": 0.271, "load_throughput": 1891722.734, "learn_time_ms": 59918.582, "learn_throughput": 8.545, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 23040, "num_env_steps_trained": 23040, "num_agent_steps_sampled": 23040, "num_agent_steps_trained": 23040}, "done": false, "episodes_total": 1440, "training_iteration": 45, "trial_id": "02b4f_00268", "date": "2024-02-27_14-03-27", "timestamp": 1709039007, "time_this_iter_s": 64.96018409729004, "time_total_s": 4409.181396484375, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4409.181396484375, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.893548387096775, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.32, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0990625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.0990625, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 11.533007812499998, "cur_lr": 0.0008365429151557455, "total_loss": 3.9359498302141827, "policy_loss": -0.05673045584311088, "vf_loss": 6.149400452772777, "vf_explained_var": 0.9925125136971473, "kl": 0.012797373117168442, "entropy": 95.22180054982503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5460.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "sampler_results": {"episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.32, "reward_total_min": -64, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0990625, "reward_percentile_min": 0.0, "reward_percentile_max": 0.34375, "reward_score_mean": 0.0990625, "reward_score_min": 0.0, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -58.0, -51.0, -56.0, -63.0, -52.0, -27.0, -51.0, -47.0, -47.0, -38.0, -61.0, -42.0, -45.0, -60.0, -53.0, -51.0, -61.0, -40.0, -47.0, -39.0, -59.0, -48.0, -56.0, -39.0, -50.0, -32.0, -59.0, -51.0, -50.0, -43.0, -38.0, -55.0, -55.0, -53.0, -64.0, -61.0, -61.0, -58.0, -32.0, -51.0, -51.0, -62.0, -34.0, -60.0, -54.0, -49.0, -51.0, -57.0, -45.0, -61.0, -50.0, -31.0, -58.0, -57.0, -30.0, -57.0, -39.0, -46.0, -60.0, -64.0, -53.0, -49.0, -60.0, -43.0, -59.0, -55.0, -61.0, -61.0, -55.0, -56.0, -50.0, -62.0, -20.0, -54.0, -57.0, -59.0, -60.0, -61.0, -52.0, -62.0, -52.0, -39.0, -46.0, -61.0, -51.0, -29.0, -32.0, -57.0, -51.0, -42.0, -61.0, -60.0, -54.0, -64.0, -64.0, -48.0, -55.0, -60.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7544677227137333, "mean_inference_ms": 13.71014045559874, "mean_action_processing_ms": 0.5633676775971953, "mean_env_wait_ms": 0.3648036235317044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23894667625427246, "StateBufferConnector_ms": 0.00417327880859375, "ViewRequirementAgentConnector_ms": 0.17340755462646484}}, "episode_reward_max": -20.0, "episode_reward_min": -64.0, "episode_reward_mean": -51.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -58.0, -51.0, -56.0, -63.0, -52.0, -27.0, -51.0, -47.0, -47.0, -38.0, -61.0, -42.0, -45.0, -60.0, -53.0, -51.0, -61.0, -40.0, -47.0, -39.0, -59.0, -48.0, -56.0, -39.0, -50.0, -32.0, -59.0, -51.0, -50.0, -43.0, -38.0, -55.0, -55.0, -53.0, -64.0, -61.0, -61.0, -58.0, -32.0, -51.0, -51.0, -62.0, -34.0, -60.0, -54.0, -49.0, -51.0, -57.0, -45.0, -61.0, -50.0, -31.0, -58.0, -57.0, -30.0, -57.0, -39.0, -46.0, -60.0, -64.0, -53.0, -49.0, -60.0, -43.0, -59.0, -55.0, -61.0, -61.0, -55.0, -56.0, -50.0, -62.0, -20.0, -54.0, -57.0, -59.0, -60.0, -61.0, -52.0, -62.0, -52.0, -39.0, -46.0, -61.0, -51.0, -29.0, -32.0, -57.0, -51.0, -42.0, -61.0, -60.0, -54.0, -64.0, -64.0, -48.0, -55.0, -60.0, -35.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7544677227137333, "mean_inference_ms": 13.71014045559874, "mean_action_processing_ms": 0.5633676775971953, "mean_env_wait_ms": 0.3648036235317044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23894667625427246, "StateBufferConnector_ms": 0.00417327880859375, "ViewRequirementAgentConnector_ms": 0.17340755462646484}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.878548753298674, "num_agent_steps_trained_throughput_per_sec": 7.878548753298674, "timesteps_total": 23552, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 65081.48, "sample_time_ms": 5275.275, "load_time_ms": 0.265, "load_throughput": 1931190.331, "learn_time_ms": 59805.495, "learn_throughput": 8.561, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "episodes_total": 1472, "training_iteration": 46, "trial_id": "02b4f_00268", "date": "2024-02-27_14-04-32", "timestamp": 1709039072, "time_this_iter_s": 64.9913969039917, "time_total_s": 4474.172793388367, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4474.172793388367, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.830434782608698, "ram_util_percent": 5.399999999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.96, "reward_total_min": -64, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.101875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.101875, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 17.299511718750004, "cur_lr": 0.0008365429151557455, "total_loss": 4.148230274518331, "policy_loss": -0.059737812463815015, "vf_loss": 6.522106679280599, "vf_explained_var": 0.9927331283688545, "kl": 0.007505117980521655, "entropy": 95.26956526438396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5580.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "sampler_results": {"episode_reward_max": -16.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.96, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.96, "reward_total_min": -64, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.101875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.101875, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-55.0, -55.0, -53.0, -64.0, -61.0, -61.0, -58.0, -32.0, -51.0, -51.0, -62.0, -34.0, -60.0, -54.0, -49.0, -51.0, -57.0, -45.0, -61.0, -50.0, -31.0, -58.0, -57.0, -30.0, -57.0, -39.0, -46.0, -60.0, -64.0, -53.0, -49.0, -60.0, -43.0, -59.0, -55.0, -61.0, -61.0, -55.0, -56.0, -50.0, -62.0, -20.0, -54.0, -57.0, -59.0, -60.0, -61.0, -52.0, -62.0, -52.0, -39.0, -46.0, -61.0, -51.0, -29.0, -32.0, -57.0, -51.0, -42.0, -61.0, -60.0, -54.0, -64.0, -64.0, -48.0, -55.0, -60.0, -35.0, -63.0, -36.0, -16.0, -54.0, -46.0, -49.0, -62.0, -52.0, -59.0, -39.0, -59.0, -60.0, -44.0, -56.0, -28.0, -28.0, -59.0, -56.0, -27.0, -48.0, -57.0, -56.0, -58.0, -33.0, -27.0, -46.0, -54.0, -63.0, -42.0, -57.0, -52.0, -54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.740839599630114, "mean_inference_ms": 13.596702515075986, "mean_action_processing_ms": 0.5599275146397035, "mean_env_wait_ms": 0.36239628010050196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23676609992980957, "StateBufferConnector_ms": 0.004186391830444336, "ViewRequirementAgentConnector_ms": 0.1715075969696045}}, "episode_reward_max": -16.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.96, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-55.0, -55.0, -53.0, -64.0, -61.0, -61.0, -58.0, -32.0, -51.0, -51.0, -62.0, -34.0, -60.0, -54.0, -49.0, -51.0, -57.0, -45.0, -61.0, -50.0, -31.0, -58.0, -57.0, -30.0, -57.0, -39.0, -46.0, -60.0, -64.0, -53.0, -49.0, -60.0, -43.0, -59.0, -55.0, -61.0, -61.0, -55.0, -56.0, -50.0, -62.0, -20.0, -54.0, -57.0, -59.0, -60.0, -61.0, -52.0, -62.0, -52.0, -39.0, -46.0, -61.0, -51.0, -29.0, -32.0, -57.0, -51.0, -42.0, -61.0, -60.0, -54.0, -64.0, -64.0, -48.0, -55.0, -60.0, -35.0, -63.0, -36.0, -16.0, -54.0, -46.0, -49.0, -62.0, -52.0, -59.0, -39.0, -59.0, -60.0, -44.0, -56.0, -28.0, -28.0, -59.0, -56.0, -27.0, -48.0, -57.0, -56.0, -58.0, -33.0, -27.0, -46.0, -54.0, -63.0, -42.0, -57.0, -52.0, -54.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.740839599630114, "mean_inference_ms": 13.596702515075986, "mean_action_processing_ms": 0.5599275146397035, "mean_env_wait_ms": 0.36239628010050196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23676609992980957, "StateBufferConnector_ms": 0.004186391830444336, "ViewRequirementAgentConnector_ms": 0.1715075969696045}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064, "num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.883216065058719, "num_agent_steps_trained_throughput_per_sec": 7.883216065058719, "timesteps_total": 24064, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24064, "timers": {"training_iteration_time_ms": 65037.619, "sample_time_ms": 5264.287, "load_time_ms": 0.268, "load_throughput": 1911593.064, "learn_time_ms": 59772.61, "learn_throughput": 8.566, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 24064, "num_env_steps_trained": 24064, "num_agent_steps_sampled": 24064, "num_agent_steps_trained": 24064}, "done": false, "episodes_total": 1504, "training_iteration": 47, "trial_id": "02b4f_00268", "date": "2024-02-27_14-05-37", "timestamp": 1709039137, "time_this_iter_s": 64.95283508300781, "time_total_s": 4539.1256284713745, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4539.1256284713745, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.633695652173913, "ram_util_percent": 5.291304347826086}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.84, "reward_total_min": -64, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1184375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.1184375, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 17.299511718750004, "cur_lr": 0.0008365429151557455, "total_loss": 4.421855413913727, "policy_loss": -0.055935579165816304, "vf_loss": 7.0078764915466305, "vf_explained_var": 0.9947374870379766, "kl": 0.005544455723315083, "entropy": 95.18766606648764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5700.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": -16.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.84, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.84, "reward_total_min": -64, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1184375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.375, "reward_score_mean": 0.1184375, "reward_score_min": 0.0, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-43.0, -59.0, -55.0, -61.0, -61.0, -55.0, -56.0, -50.0, -62.0, -20.0, -54.0, -57.0, -59.0, -60.0, -61.0, -52.0, -62.0, -52.0, -39.0, -46.0, -61.0, -51.0, -29.0, -32.0, -57.0, -51.0, -42.0, -61.0, -60.0, -54.0, -64.0, -64.0, -48.0, -55.0, -60.0, -35.0, -63.0, -36.0, -16.0, -54.0, -46.0, -49.0, -62.0, -52.0, -59.0, -39.0, -59.0, -60.0, -44.0, -56.0, -28.0, -28.0, -59.0, -56.0, -27.0, -48.0, -57.0, -56.0, -58.0, -33.0, -27.0, -46.0, -54.0, -63.0, -42.0, -57.0, -52.0, -54.0, -22.0, -60.0, -38.0, -60.0, -29.0, -38.0, -58.0, -52.0, -46.0, -37.0, -46.0, -50.0, -52.0, -56.0, -41.0, -55.0, -25.0, -55.0, -22.0, -60.0, -44.0, -31.0, -43.0, -50.0, -44.0, -62.0, -22.0, -59.0, -49.0, -59.0, -54.0, -37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7278833229155368, "mean_inference_ms": 13.488935625909294, "mean_action_processing_ms": 0.556684478160931, "mean_env_wait_ms": 0.36015647882892793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23938488960266113, "StateBufferConnector_ms": 0.004205465316772461, "ViewRequirementAgentConnector_ms": 0.1725013256072998}}, "episode_reward_max": -16.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.84, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.0, -59.0, -55.0, -61.0, -61.0, -55.0, -56.0, -50.0, -62.0, -20.0, -54.0, -57.0, -59.0, -60.0, -61.0, -52.0, -62.0, -52.0, -39.0, -46.0, -61.0, -51.0, -29.0, -32.0, -57.0, -51.0, -42.0, -61.0, -60.0, -54.0, -64.0, -64.0, -48.0, -55.0, -60.0, -35.0, -63.0, -36.0, -16.0, -54.0, -46.0, -49.0, -62.0, -52.0, -59.0, -39.0, -59.0, -60.0, -44.0, -56.0, -28.0, -28.0, -59.0, -56.0, -27.0, -48.0, -57.0, -56.0, -58.0, -33.0, -27.0, -46.0, -54.0, -63.0, -42.0, -57.0, -52.0, -54.0, -22.0, -60.0, -38.0, -60.0, -29.0, -38.0, -58.0, -52.0, -46.0, -37.0, -46.0, -50.0, -52.0, -56.0, -41.0, -55.0, -25.0, -55.0, -22.0, -60.0, -44.0, -31.0, -43.0, -50.0, -44.0, -62.0, -22.0, -59.0, -49.0, -59.0, -54.0, -37.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7278833229155368, "mean_inference_ms": 13.488935625909294, "mean_action_processing_ms": 0.556684478160931, "mean_env_wait_ms": 0.36015647882892793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23938488960266113, "StateBufferConnector_ms": 0.004205465316772461, "ViewRequirementAgentConnector_ms": 0.1725013256072998}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.881808339534226, "num_agent_steps_trained_throughput_per_sec": 7.881808339534226, "timesteps_total": 24576, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 64901.573, "sample_time_ms": 5258.569, "load_time_ms": 0.263, "load_throughput": 1947654.315, "learn_time_ms": 59642.287, "learn_throughput": 8.585, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 1536, "training_iteration": 48, "trial_id": "02b4f_00268", "date": "2024-02-27_14-06-42", "timestamp": 1709039202, "time_this_iter_s": 64.9646418094635, "time_total_s": 4604.090270280838, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4604.090270280838, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.64021739130435, "ram_util_percent": 5.352173913043477}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -47.33, "reward_total_min": -63, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.130234375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.375, "reward_score_mean": 0.130234375, "reward_score_min": 0.0078125, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 17.299511718750004, "cur_lr": 0.0008365429151557455, "total_loss": 3.9315972248713176, "policy_loss": -0.040356523481508096, "vf_loss": 5.933356157938639, "vf_explained_var": 0.995097079873085, "kl": 0.01514225381867378, "entropy": 94.96195621490479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5820.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "sampler_results": {"episode_reward_max": -16.0, "episode_reward_min": -63.0, "episode_reward_mean": -47.33, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -47.33, "reward_total_min": -63, "reward_total_max": -16, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.130234375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.375, "reward_score_mean": 0.130234375, "reward_score_min": 0.0078125, "reward_score_max": 0.375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -55.0, -60.0, -35.0, -63.0, -36.0, -16.0, -54.0, -46.0, -49.0, -62.0, -52.0, -59.0, -39.0, -59.0, -60.0, -44.0, -56.0, -28.0, -28.0, -59.0, -56.0, -27.0, -48.0, -57.0, -56.0, -58.0, -33.0, -27.0, -46.0, -54.0, -63.0, -42.0, -57.0, -52.0, -54.0, -22.0, -60.0, -38.0, -60.0, -29.0, -38.0, -58.0, -52.0, -46.0, -37.0, -46.0, -50.0, -52.0, -56.0, -41.0, -55.0, -25.0, -55.0, -22.0, -60.0, -44.0, -31.0, -43.0, -50.0, -44.0, -62.0, -22.0, -59.0, -49.0, -59.0, -54.0, -37.0, -24.0, -54.0, -44.0, -45.0, -49.0, -31.0, -58.0, -26.0, -55.0, -37.0, -60.0, -29.0, -61.0, -42.0, -55.0, -61.0, -33.0, -56.0, -58.0, -56.0, -60.0, -39.0, -20.0, -61.0, -58.0, -42.0, -54.0, -53.0, -60.0, -47.0, -53.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.716129042414653, "mean_inference_ms": 13.38846380513115, "mean_action_processing_ms": 0.5537771520382339, "mean_env_wait_ms": 0.35819493296128857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24538373947143555, "StateBufferConnector_ms": 0.004306793212890625, "ViewRequirementAgentConnector_ms": 0.18465065956115723}}, "episode_reward_max": -16.0, "episode_reward_min": -63.0, "episode_reward_mean": -47.33, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -55.0, -60.0, -35.0, -63.0, -36.0, -16.0, -54.0, -46.0, -49.0, -62.0, -52.0, -59.0, -39.0, -59.0, -60.0, -44.0, -56.0, -28.0, -28.0, -59.0, -56.0, -27.0, -48.0, -57.0, -56.0, -58.0, -33.0, -27.0, -46.0, -54.0, -63.0, -42.0, -57.0, -52.0, -54.0, -22.0, -60.0, -38.0, -60.0, -29.0, -38.0, -58.0, -52.0, -46.0, -37.0, -46.0, -50.0, -52.0, -56.0, -41.0, -55.0, -25.0, -55.0, -22.0, -60.0, -44.0, -31.0, -43.0, -50.0, -44.0, -62.0, -22.0, -59.0, -49.0, -59.0, -54.0, -37.0, -24.0, -54.0, -44.0, -45.0, -49.0, -31.0, -58.0, -26.0, -55.0, -37.0, -60.0, -29.0, -61.0, -42.0, -55.0, -61.0, -33.0, -56.0, -58.0, -56.0, -60.0, -39.0, -20.0, -61.0, -58.0, -42.0, -54.0, -53.0, -60.0, -47.0, -53.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.716129042414653, "mean_inference_ms": 13.38846380513115, "mean_action_processing_ms": 0.5537771520382339, "mean_env_wait_ms": 0.35819493296128857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24538373947143555, "StateBufferConnector_ms": 0.004306793212890625, "ViewRequirementAgentConnector_ms": 0.18465065956115723}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088, "num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.745699034859074, "num_agent_steps_trained_throughput_per_sec": 7.745699034859074, "timesteps_total": 25088, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25088, "timers": {"training_iteration_time_ms": 65040.921, "sample_time_ms": 5292.422, "load_time_ms": 0.277, "load_throughput": 1851438.614, "learn_time_ms": 59747.778, "learn_throughput": 8.569, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 25088, "num_env_steps_trained": 25088, "num_agent_steps_sampled": 25088, "num_agent_steps_trained": 25088}, "done": false, "episodes_total": 1568, "training_iteration": 49, "trial_id": "02b4f_00268", "date": "2024-02-27_14-07-48", "timestamp": 1709039268, "time_this_iter_s": 66.10595107078552, "time_total_s": 4670.1962213516235, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4670.1962213516235, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.744680851063826, "ram_util_percent": 5.340425531914894}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.32, "reward_total_min": -63, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1225, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.34375, "reward_score_mean": 0.1225, "reward_score_min": 0.0078125, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.0008365429151557455, "total_loss": 3.763031675418218, "policy_loss": -0.040650039647395414, "vf_loss": 5.788654198249181, "vf_explained_var": 0.9913855706652005, "kl": 0.007096947258954363, "entropy": 95.17855784098307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5940.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "sampler_results": {"episode_reward_max": -20.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.32, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.32, "reward_total_min": -63, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1225, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.34375, "reward_score_mean": 0.1225, "reward_score_min": 0.0078125, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-42.0, -57.0, -52.0, -54.0, -22.0, -60.0, -38.0, -60.0, -29.0, -38.0, -58.0, -52.0, -46.0, -37.0, -46.0, -50.0, -52.0, -56.0, -41.0, -55.0, -25.0, -55.0, -22.0, -60.0, -44.0, -31.0, -43.0, -50.0, -44.0, -62.0, -22.0, -59.0, -49.0, -59.0, -54.0, -37.0, -24.0, -54.0, -44.0, -45.0, -49.0, -31.0, -58.0, -26.0, -55.0, -37.0, -60.0, -29.0, -61.0, -42.0, -55.0, -61.0, -33.0, -56.0, -58.0, -56.0, -60.0, -39.0, -20.0, -61.0, -58.0, -42.0, -54.0, -53.0, -60.0, -47.0, -53.0, -58.0, -54.0, -56.0, -62.0, -60.0, -55.0, -51.0, -60.0, -55.0, -61.0, -62.0, -53.0, -57.0, -62.0, -50.0, -60.0, -52.0, -26.0, -46.0, -63.0, -37.0, -50.0, -56.0, -38.0, -26.0, -51.0, -32.0, -49.0, -51.0, -56.0, -30.0, -61.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7043776179247183, "mean_inference_ms": 13.28957479978891, "mean_action_processing_ms": 0.5507834325928046, "mean_env_wait_ms": 0.3561432575215713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23853516578674316, "StateBufferConnector_ms": 0.0041332244873046875, "ViewRequirementAgentConnector_ms": 0.17554044723510742}}, "episode_reward_max": -20.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.32, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.0, -57.0, -52.0, -54.0, -22.0, -60.0, -38.0, -60.0, -29.0, -38.0, -58.0, -52.0, -46.0, -37.0, -46.0, -50.0, -52.0, -56.0, -41.0, -55.0, -25.0, -55.0, -22.0, -60.0, -44.0, -31.0, -43.0, -50.0, -44.0, -62.0, -22.0, -59.0, -49.0, -59.0, -54.0, -37.0, -24.0, -54.0, -44.0, -45.0, -49.0, -31.0, -58.0, -26.0, -55.0, -37.0, -60.0, -29.0, -61.0, -42.0, -55.0, -61.0, -33.0, -56.0, -58.0, -56.0, -60.0, -39.0, -20.0, -61.0, -58.0, -42.0, -54.0, -53.0, -60.0, -47.0, -53.0, -58.0, -54.0, -56.0, -62.0, -60.0, -55.0, -51.0, -60.0, -55.0, -61.0, -62.0, -53.0, -57.0, -62.0, -50.0, -60.0, -52.0, -26.0, -46.0, -63.0, -37.0, -50.0, -56.0, -38.0, -26.0, -51.0, -32.0, -49.0, -51.0, -56.0, -30.0, -61.0, -50.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7043776179247183, "mean_inference_ms": 13.28957479978891, "mean_action_processing_ms": 0.5507834325928046, "mean_env_wait_ms": 0.3561432575215713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23853516578674316, "StateBufferConnector_ms": 0.0041332244873046875, "ViewRequirementAgentConnector_ms": 0.17554044723510742}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.775972085745883, "num_agent_steps_trained_throughput_per_sec": 7.775972085745883, "timesteps_total": 25600, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 65159.546, "sample_time_ms": 5263.736, "load_time_ms": 0.282, "load_throughput": 1817590.9, "learn_time_ms": 59895.089, "learn_throughput": 8.548, "synch_weights_time_ms": 0.005}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "episodes_total": 1600, "training_iteration": 50, "trial_id": "02b4f_00268", "date": "2024-02-27_14-08-54", "timestamp": 1709039334, "time_this_iter_s": 65.84860253334045, "time_total_s": 4736.044823884964, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4736.044823884964, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.524468085106385, "ram_util_percent": 5.290425531914894}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.67, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119765625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.119765625, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.0008365429151557455, "total_loss": 3.8928600509961444, "policy_loss": -0.037620167961965004, "vf_loss": 5.949479220310847, "vf_explained_var": 0.9966374710202217, "kl": 0.008108076700591483, "entropy": 94.87752304077148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6060.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "sampler_results": {"episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.67, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.67, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.119765625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.119765625, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-49.0, -59.0, -54.0, -37.0, -24.0, -54.0, -44.0, -45.0, -49.0, -31.0, -58.0, -26.0, -55.0, -37.0, -60.0, -29.0, -61.0, -42.0, -55.0, -61.0, -33.0, -56.0, -58.0, -56.0, -60.0, -39.0, -20.0, -61.0, -58.0, -42.0, -54.0, -53.0, -60.0, -47.0, -53.0, -58.0, -54.0, -56.0, -62.0, -60.0, -55.0, -51.0, -60.0, -55.0, -61.0, -62.0, -53.0, -57.0, -62.0, -50.0, -60.0, -52.0, -26.0, -46.0, -63.0, -37.0, -50.0, -56.0, -38.0, -26.0, -51.0, -32.0, -49.0, -51.0, -56.0, -30.0, -61.0, -50.0, -46.0, -22.0, -51.0, -57.0, -58.0, -16.0, -13.0, -59.0, -51.0, -23.0, -50.0, -58.0, -33.0, -60.0, -29.0, -35.0, -60.0, -58.0, -62.0, -58.0, -57.0, -30.0, -50.0, -60.0, -55.0, -58.0, -50.0, -26.0, -30.0, -61.0, -60.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6930357206541464, "mean_inference_ms": 13.194414226016743, "mean_action_processing_ms": 0.5478996499803419, "mean_env_wait_ms": 0.3541530667332859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23702096939086914, "StateBufferConnector_ms": 0.00412750244140625, "ViewRequirementAgentConnector_ms": 0.17414188385009766}}, "episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.67, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-49.0, -59.0, -54.0, -37.0, -24.0, -54.0, -44.0, -45.0, -49.0, -31.0, -58.0, -26.0, -55.0, -37.0, -60.0, -29.0, -61.0, -42.0, -55.0, -61.0, -33.0, -56.0, -58.0, -56.0, -60.0, -39.0, -20.0, -61.0, -58.0, -42.0, -54.0, -53.0, -60.0, -47.0, -53.0, -58.0, -54.0, -56.0, -62.0, -60.0, -55.0, -51.0, -60.0, -55.0, -61.0, -62.0, -53.0, -57.0, -62.0, -50.0, -60.0, -52.0, -26.0, -46.0, -63.0, -37.0, -50.0, -56.0, -38.0, -26.0, -51.0, -32.0, -49.0, -51.0, -56.0, -30.0, -61.0, -50.0, -46.0, -22.0, -51.0, -57.0, -58.0, -16.0, -13.0, -59.0, -51.0, -23.0, -50.0, -58.0, -33.0, -60.0, -29.0, -35.0, -60.0, -58.0, -62.0, -58.0, -57.0, -30.0, -50.0, -60.0, -55.0, -58.0, -50.0, -26.0, -30.0, -61.0, -60.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6930357206541464, "mean_inference_ms": 13.194414226016743, "mean_action_processing_ms": 0.5478996499803419, "mean_env_wait_ms": 0.3541530667332859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23702096939086914, "StateBufferConnector_ms": 0.00412750244140625, "ViewRequirementAgentConnector_ms": 0.17414188385009766}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112, "num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.724532644231432, "num_agent_steps_trained_throughput_per_sec": 7.724532644231432, "timesteps_total": 26112, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26112, "timers": {"training_iteration_time_ms": 65319.794, "sample_time_ms": 5286.949, "load_time_ms": 0.275, "load_throughput": 1863326.376, "learn_time_ms": 60032.13, "learn_throughput": 8.529, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 26112, "num_env_steps_trained": 26112, "num_agent_steps_sampled": 26112, "num_agent_steps_trained": 26112}, "done": false, "episodes_total": 1632, "training_iteration": 51, "trial_id": "02b4f_00268", "date": "2024-02-27_14-10-01", "timestamp": 1709039401, "time_this_iter_s": 66.2872154712677, "time_total_s": 4802.332039356232, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4802.332039356232, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.666315789473686, "ram_util_percent": 5.3631578947368395}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.16, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.108125, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.0008365429151557455, "total_loss": 3.794772692521413, "policy_loss": -0.03842171480258306, "vf_loss": 5.775760396321615, "vf_explained_var": 0.9952605585257213, "kl": 0.008544958562943739, "entropy": 95.07656822204589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6180.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "sampler_results": {"episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.16, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.16, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.108125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.108125, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-60.0, -47.0, -53.0, -58.0, -54.0, -56.0, -62.0, -60.0, -55.0, -51.0, -60.0, -55.0, -61.0, -62.0, -53.0, -57.0, -62.0, -50.0, -60.0, -52.0, -26.0, -46.0, -63.0, -37.0, -50.0, -56.0, -38.0, -26.0, -51.0, -32.0, -49.0, -51.0, -56.0, -30.0, -61.0, -50.0, -46.0, -22.0, -51.0, -57.0, -58.0, -16.0, -13.0, -59.0, -51.0, -23.0, -50.0, -58.0, -33.0, -60.0, -29.0, -35.0, -60.0, -58.0, -62.0, -58.0, -57.0, -30.0, -50.0, -60.0, -55.0, -58.0, -50.0, -26.0, -30.0, -61.0, -60.0, -61.0, -59.0, -21.0, -41.0, -46.0, -58.0, -36.0, -62.0, -62.0, -27.0, -61.0, -51.0, -53.0, -58.0, -50.0, -34.0, -62.0, -57.0, -60.0, -32.0, -59.0, -60.0, -57.0, -50.0, -49.0, -62.0, -60.0, -63.0, -48.0, -57.0, -61.0, -62.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6819980913663033, "mean_inference_ms": 13.101853612286847, "mean_action_processing_ms": 0.5450591974789333, "mean_env_wait_ms": 0.35216768552649597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23409533500671387, "StateBufferConnector_ms": 0.004073143005371094, "ViewRequirementAgentConnector_ms": 0.16640782356262207}}, "episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.16, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-60.0, -47.0, -53.0, -58.0, -54.0, -56.0, -62.0, -60.0, -55.0, -51.0, -60.0, -55.0, -61.0, -62.0, -53.0, -57.0, -62.0, -50.0, -60.0, -52.0, -26.0, -46.0, -63.0, -37.0, -50.0, -56.0, -38.0, -26.0, -51.0, -32.0, -49.0, -51.0, -56.0, -30.0, -61.0, -50.0, -46.0, -22.0, -51.0, -57.0, -58.0, -16.0, -13.0, -59.0, -51.0, -23.0, -50.0, -58.0, -33.0, -60.0, -29.0, -35.0, -60.0, -58.0, -62.0, -58.0, -57.0, -30.0, -50.0, -60.0, -55.0, -58.0, -50.0, -26.0, -30.0, -61.0, -60.0, -61.0, -59.0, -21.0, -41.0, -46.0, -58.0, -36.0, -62.0, -62.0, -27.0, -61.0, -51.0, -53.0, -58.0, -50.0, -34.0, -62.0, -57.0, -60.0, -32.0, -59.0, -60.0, -57.0, -50.0, -49.0, -62.0, -60.0, -63.0, -48.0, -57.0, -61.0, -62.0, -51.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6819980913663033, "mean_inference_ms": 13.101853612286847, "mean_action_processing_ms": 0.5450591974789333, "mean_env_wait_ms": 0.35216768552649597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23409533500671387, "StateBufferConnector_ms": 0.004073143005371094, "ViewRequirementAgentConnector_ms": 0.16640782356262207}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.662806048381117, "num_agent_steps_trained_throughput_per_sec": 7.662806048381117, "timesteps_total": 26624, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 65595.667, "sample_time_ms": 5325.42, "load_time_ms": 0.277, "load_throughput": 1849684.451, "learn_time_ms": 60269.487, "learn_throughput": 8.495, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "episodes_total": 1664, "training_iteration": 52, "trial_id": "02b4f_00268", "date": "2024-02-27_14-11-15", "timestamp": 1709039475, "time_this_iter_s": 66.82142233848572, "time_total_s": 4869.153461694717, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4869.153461694717, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.53142857142857, "ram_util_percent": 5.4}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.89, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118046875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.118046875, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.0008365429151557455, "total_loss": 4.030683183670044, "policy_loss": -0.04172493939598401, "vf_loss": 6.219997000694275, "vf_explained_var": 0.9915452688932419, "kl": 0.007059062825423242, "entropy": 95.08355986277262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6300.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "sampler_results": {"episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.89, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.89, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118046875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.118046875, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-56.0, -30.0, -61.0, -50.0, -46.0, -22.0, -51.0, -57.0, -58.0, -16.0, -13.0, -59.0, -51.0, -23.0, -50.0, -58.0, -33.0, -60.0, -29.0, -35.0, -60.0, -58.0, -62.0, -58.0, -57.0, -30.0, -50.0, -60.0, -55.0, -58.0, -50.0, -26.0, -30.0, -61.0, -60.0, -61.0, -59.0, -21.0, -41.0, -46.0, -58.0, -36.0, -62.0, -62.0, -27.0, -61.0, -51.0, -53.0, -58.0, -50.0, -34.0, -62.0, -57.0, -60.0, -32.0, -59.0, -60.0, -57.0, -50.0, -49.0, -62.0, -60.0, -63.0, -48.0, -57.0, -61.0, -62.0, -51.0, -46.0, -56.0, -35.0, -62.0, -59.0, -42.0, -36.0, -52.0, -35.0, -35.0, -16.0, -55.0, -45.0, -54.0, -61.0, -47.0, -41.0, -52.0, -53.0, -60.0, -14.0, -60.0, -40.0, -50.0, -19.0, -52.0, -59.0, -60.0, -53.0, -59.0, -56.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6721243671008552, "mean_inference_ms": 13.016446025756359, "mean_action_processing_ms": 0.5426094840400685, "mean_env_wait_ms": 0.35049302559902673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2421894073486328, "StateBufferConnector_ms": 0.00422358512878418, "ViewRequirementAgentConnector_ms": 0.17869925498962402}}, "episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -48.89, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-56.0, -30.0, -61.0, -50.0, -46.0, -22.0, -51.0, -57.0, -58.0, -16.0, -13.0, -59.0, -51.0, -23.0, -50.0, -58.0, -33.0, -60.0, -29.0, -35.0, -60.0, -58.0, -62.0, -58.0, -57.0, -30.0, -50.0, -60.0, -55.0, -58.0, -50.0, -26.0, -30.0, -61.0, -60.0, -61.0, -59.0, -21.0, -41.0, -46.0, -58.0, -36.0, -62.0, -62.0, -27.0, -61.0, -51.0, -53.0, -58.0, -50.0, -34.0, -62.0, -57.0, -60.0, -32.0, -59.0, -60.0, -57.0, -50.0, -49.0, -62.0, -60.0, -63.0, -48.0, -57.0, -61.0, -62.0, -51.0, -46.0, -56.0, -35.0, -62.0, -59.0, -42.0, -36.0, -52.0, -35.0, -35.0, -16.0, -55.0, -45.0, -54.0, -61.0, -47.0, -41.0, -52.0, -53.0, -60.0, -14.0, -60.0, -40.0, -50.0, -19.0, -52.0, -59.0, -60.0, -53.0, -59.0, -56.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6721243671008552, "mean_inference_ms": 13.016446025756359, "mean_action_processing_ms": 0.5426094840400685, "mean_env_wait_ms": 0.35049302559902673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2421894073486328, "StateBufferConnector_ms": 0.00422358512878418, "ViewRequirementAgentConnector_ms": 0.17869925498962402}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136, "num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.750925884472377, "num_agent_steps_trained_throughput_per_sec": 7.750925884472377, "timesteps_total": 27136, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27136, "timers": {"training_iteration_time_ms": 65657.239, "sample_time_ms": 5359.585, "load_time_ms": 0.283, "load_throughput": 1810083.992, "learn_time_ms": 60296.889, "learn_throughput": 8.491, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 27136, "num_env_steps_trained": 27136, "num_agent_steps_sampled": 27136, "num_agent_steps_trained": 27136}, "done": false, "episodes_total": 1696, "training_iteration": 53, "trial_id": "02b4f_00268", "date": "2024-02-27_14-12-21", "timestamp": 1709039541, "time_this_iter_s": 66.06132197380066, "time_total_s": 4935.214783668518, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 4935.214783668518, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.844086021505376, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.59, "reward_total_min": -63, "reward_total_max": -14, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104765625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.390625, "reward_score_mean": 0.104765625, "reward_score_min": 0.0078125, "reward_score_max": 0.390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.0008365429151557455, "total_loss": 3.589647497733434, "policy_loss": -0.04325620966653029, "vf_loss": 5.658869783083598, "vf_explained_var": 0.9927885989348094, "kl": 0.0036430292657915605, "entropy": 95.1054277420044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6420.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "sampler_results": {"episode_reward_max": -14.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.59, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.59, "reward_total_min": -63, "reward_total_max": -14, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.104765625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.390625, "reward_score_mean": 0.104765625, "reward_score_min": 0.0078125, "reward_score_max": 0.390625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-30.0, -61.0, -60.0, -61.0, -59.0, -21.0, -41.0, -46.0, -58.0, -36.0, -62.0, -62.0, -27.0, -61.0, -51.0, -53.0, -58.0, -50.0, -34.0, -62.0, -57.0, -60.0, -32.0, -59.0, -60.0, -57.0, -50.0, -49.0, -62.0, -60.0, -63.0, -48.0, -57.0, -61.0, -62.0, -51.0, -46.0, -56.0, -35.0, -62.0, -59.0, -42.0, -36.0, -52.0, -35.0, -35.0, -16.0, -55.0, -45.0, -54.0, -61.0, -47.0, -41.0, -52.0, -53.0, -60.0, -14.0, -60.0, -40.0, -50.0, -19.0, -52.0, -59.0, -60.0, -53.0, -59.0, -56.0, -62.0, -36.0, -60.0, -51.0, -62.0, -25.0, -53.0, -55.0, -55.0, -50.0, -49.0, -56.0, -59.0, -55.0, -21.0, -62.0, -52.0, -40.0, -54.0, -61.0, -57.0, -56.0, -57.0, -53.0, -34.0, -58.0, -55.0, -62.0, -60.0, -41.0, -51.0, -52.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6629095219622787, "mean_inference_ms": 12.93560655956811, "mean_action_processing_ms": 0.5403431791952079, "mean_env_wait_ms": 0.3489602322788957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24541115760803223, "StateBufferConnector_ms": 0.0042607784271240234, "ViewRequirementAgentConnector_ms": 0.18498659133911133}}, "episode_reward_max": -14.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.59, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-30.0, -61.0, -60.0, -61.0, -59.0, -21.0, -41.0, -46.0, -58.0, -36.0, -62.0, -62.0, -27.0, -61.0, -51.0, -53.0, -58.0, -50.0, -34.0, -62.0, -57.0, -60.0, -32.0, -59.0, -60.0, -57.0, -50.0, -49.0, -62.0, -60.0, -63.0, -48.0, -57.0, -61.0, -62.0, -51.0, -46.0, -56.0, -35.0, -62.0, -59.0, -42.0, -36.0, -52.0, -35.0, -35.0, -16.0, -55.0, -45.0, -54.0, -61.0, -47.0, -41.0, -52.0, -53.0, -60.0, -14.0, -60.0, -40.0, -50.0, -19.0, -52.0, -59.0, -60.0, -53.0, -59.0, -56.0, -62.0, -36.0, -60.0, -51.0, -62.0, -25.0, -53.0, -55.0, -55.0, -50.0, -49.0, -56.0, -59.0, -55.0, -21.0, -62.0, -52.0, -40.0, -54.0, -61.0, -57.0, -56.0, -57.0, -53.0, -34.0, -58.0, -55.0, -62.0, -60.0, -41.0, -51.0, -52.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6629095219622787, "mean_inference_ms": 12.93560655956811, "mean_action_processing_ms": 0.5403431791952079, "mean_env_wait_ms": 0.3489602322788957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24541115760803223, "StateBufferConnector_ms": 0.0042607784271240234, "ViewRequirementAgentConnector_ms": 0.18498659133911133}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.747874962698073, "num_agent_steps_trained_throughput_per_sec": 7.747874962698073, "timesteps_total": 27648, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 65703.24, "sample_time_ms": 5356.035, "load_time_ms": 0.285, "load_throughput": 1797659.173, "learn_time_ms": 60346.437, "learn_throughput": 8.484, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "episodes_total": 1728, "training_iteration": 54, "trial_id": "02b4f_00268", "date": "2024-02-27_14-13-27", "timestamp": 1709039607, "time_this_iter_s": 66.08742785453796, "time_total_s": 5001.302211523056, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5001.302211523056, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.948936170212768, "ram_util_percent": 5.285106382978723}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.13, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.116171875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.116171875, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.0008365429151557455, "total_loss": 3.9416638990243276, "policy_loss": -0.044860791756461064, "vf_loss": 6.179216978947322, "vf_explained_var": 0.9959926977753639, "kl": 0.004732040758012731, "entropy": 95.09759203592937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6540.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "sampler_results": {"episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.13, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.13, "reward_total_min": -63, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.116171875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.116171875, "reward_score_min": 0.0078125, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-57.0, -61.0, -62.0, -51.0, -46.0, -56.0, -35.0, -62.0, -59.0, -42.0, -36.0, -52.0, -35.0, -35.0, -16.0, -55.0, -45.0, -54.0, -61.0, -47.0, -41.0, -52.0, -53.0, -60.0, -14.0, -60.0, -40.0, -50.0, -19.0, -52.0, -59.0, -60.0, -53.0, -59.0, -56.0, -62.0, -36.0, -60.0, -51.0, -62.0, -25.0, -53.0, -55.0, -55.0, -50.0, -49.0, -56.0, -59.0, -55.0, -21.0, -62.0, -52.0, -40.0, -54.0, -61.0, -57.0, -56.0, -57.0, -53.0, -34.0, -58.0, -55.0, -62.0, -60.0, -41.0, -51.0, -52.0, -60.0, -53.0, -42.0, -53.0, -53.0, -38.0, -13.0, -53.0, -60.0, -59.0, -33.0, -56.0, -40.0, -56.0, -62.0, -51.0, -38.0, -25.0, -59.0, -58.0, -55.0, -60.0, -34.0, -28.0, -49.0, -36.0, -23.0, -63.0, -62.0, -48.0, -28.0, -56.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6542102288077911, "mean_inference_ms": 12.85894238129697, "mean_action_processing_ms": 0.5382281551816203, "mean_env_wait_ms": 0.34754441632851985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24882769584655762, "StateBufferConnector_ms": 0.004330635070800781, "ViewRequirementAgentConnector_ms": 0.19202303886413574}}, "episode_reward_max": -13.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.13, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-57.0, -61.0, -62.0, -51.0, -46.0, -56.0, -35.0, -62.0, -59.0, -42.0, -36.0, -52.0, -35.0, -35.0, -16.0, -55.0, -45.0, -54.0, -61.0, -47.0, -41.0, -52.0, -53.0, -60.0, -14.0, -60.0, -40.0, -50.0, -19.0, -52.0, -59.0, -60.0, -53.0, -59.0, -56.0, -62.0, -36.0, -60.0, -51.0, -62.0, -25.0, -53.0, -55.0, -55.0, -50.0, -49.0, -56.0, -59.0, -55.0, -21.0, -62.0, -52.0, -40.0, -54.0, -61.0, -57.0, -56.0, -57.0, -53.0, -34.0, -58.0, -55.0, -62.0, -60.0, -41.0, -51.0, -52.0, -60.0, -53.0, -42.0, -53.0, -53.0, -38.0, -13.0, -53.0, -60.0, -59.0, -33.0, -56.0, -40.0, -56.0, -62.0, -51.0, -38.0, -25.0, -59.0, -58.0, -55.0, -60.0, -34.0, -28.0, -49.0, -36.0, -23.0, -63.0, -62.0, -48.0, -28.0, -56.0, -60.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6542102288077911, "mean_inference_ms": 12.85894238129697, "mean_action_processing_ms": 0.5382281551816203, "mean_env_wait_ms": 0.34754441632851985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24882769584655762, "StateBufferConnector_ms": 0.004330635070800781, "ViewRequirementAgentConnector_ms": 0.19202303886413574}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160, "num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.743970549104161, "num_agent_steps_trained_throughput_per_sec": 7.743970549104161, "timesteps_total": 28160, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28160, "timers": {"training_iteration_time_ms": 65819.286, "sample_time_ms": 5387.836, "load_time_ms": 0.295, "load_throughput": 1734359.27, "learn_time_ms": 60430.655, "learn_throughput": 8.473, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 28160, "num_env_steps_trained": 28160, "num_agent_steps_sampled": 28160, "num_agent_steps_trained": 28160}, "done": false, "episodes_total": 1760, "training_iteration": 55, "trial_id": "02b4f_00268", "date": "2024-02-27_14-14-33", "timestamp": 1709039673, "time_this_iter_s": 66.12069463729858, "time_total_s": 5067.422906160355, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5067.422906160355, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.393617021276597, "ram_util_percent": 5.308510638297871}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.25, "reward_total_min": -64, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.115234375, "reward_score_min": 0.0, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 25.949267578124992, "cur_lr": 0.0008365429151557455, "total_loss": 4.2229618241389595, "policy_loss": -0.029139080705742042, "vf_loss": 6.26411922176679, "vf_explained_var": 0.9974026337265969, "kl": 0.012920660087346018, "entropy": 95.25351270039876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6660.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": -13.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.25, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.25, "reward_total_min": -64, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.115234375, "reward_score_min": 0.0, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-53.0, -59.0, -56.0, -62.0, -36.0, -60.0, -51.0, -62.0, -25.0, -53.0, -55.0, -55.0, -50.0, -49.0, -56.0, -59.0, -55.0, -21.0, -62.0, -52.0, -40.0, -54.0, -61.0, -57.0, -56.0, -57.0, -53.0, -34.0, -58.0, -55.0, -62.0, -60.0, -41.0, -51.0, -52.0, -60.0, -53.0, -42.0, -53.0, -53.0, -38.0, -13.0, -53.0, -60.0, -59.0, -33.0, -56.0, -40.0, -56.0, -62.0, -51.0, -38.0, -25.0, -59.0, -58.0, -55.0, -60.0, -34.0, -28.0, -49.0, -36.0, -23.0, -63.0, -62.0, -48.0, -28.0, -56.0, -60.0, -64.0, -40.0, -57.0, -48.0, -57.0, -28.0, -49.0, -53.0, -42.0, -58.0, -31.0, -57.0, -43.0, -60.0, -53.0, -29.0, -26.0, -54.0, -29.0, -49.0, -58.0, -57.0, -37.0, -53.0, -60.0, -31.0, -48.0, -51.0, -64.0, -61.0, -53.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6454845641425395, "mean_inference_ms": 12.783400528112402, "mean_action_processing_ms": 0.5360510777314046, "mean_env_wait_ms": 0.3460853657646179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24574685096740723, "StateBufferConnector_ms": 0.004254341125488281, "ViewRequirementAgentConnector_ms": 0.18540668487548828}}, "episode_reward_max": -13.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.25, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-53.0, -59.0, -56.0, -62.0, -36.0, -60.0, -51.0, -62.0, -25.0, -53.0, -55.0, -55.0, -50.0, -49.0, -56.0, -59.0, -55.0, -21.0, -62.0, -52.0, -40.0, -54.0, -61.0, -57.0, -56.0, -57.0, -53.0, -34.0, -58.0, -55.0, -62.0, -60.0, -41.0, -51.0, -52.0, -60.0, -53.0, -42.0, -53.0, -53.0, -38.0, -13.0, -53.0, -60.0, -59.0, -33.0, -56.0, -40.0, -56.0, -62.0, -51.0, -38.0, -25.0, -59.0, -58.0, -55.0, -60.0, -34.0, -28.0, -49.0, -36.0, -23.0, -63.0, -62.0, -48.0, -28.0, -56.0, -60.0, -64.0, -40.0, -57.0, -48.0, -57.0, -28.0, -49.0, -53.0, -42.0, -58.0, -31.0, -57.0, -43.0, -60.0, -53.0, -29.0, -26.0, -54.0, -29.0, -49.0, -58.0, -57.0, -37.0, -53.0, -60.0, -31.0, -48.0, -51.0, -64.0, -61.0, -53.0, -39.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6454845641425395, "mean_inference_ms": 12.783400528112402, "mean_action_processing_ms": 0.5360510777314046, "mean_env_wait_ms": 0.3460853657646179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24574685096740723, "StateBufferConnector_ms": 0.004254341125488281, "ViewRequirementAgentConnector_ms": 0.18540668487548828}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.73615077432092, "num_agent_steps_trained_throughput_per_sec": 7.73615077432092, "timesteps_total": 28672, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 65938.905, "sample_time_ms": 5384.764, "load_time_ms": 0.301, "load_throughput": 1702055.677, "learn_time_ms": 60553.335, "learn_throughput": 8.455, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 1792, "training_iteration": 56, "trial_id": "02b4f_00268", "date": "2024-02-27_14-15-39", "timestamp": 1709039739, "time_this_iter_s": 66.18754196166992, "time_total_s": 5133.6104481220245, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5133.6104481220245, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.693617021276598, "ram_util_percent": 5.3702127659574455}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.06, "reward_total_min": -64, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.11671875, "reward_score_min": 0.0, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 38.9239013671875, "cur_lr": 0.0008365429151557455, "total_loss": 3.6857286343971887, "policy_loss": -0.029946792436142764, "vf_loss": 5.809439651171366, "vf_explained_var": 0.9977174177765846, "kl": 0.0021364145035525453, "entropy": 95.32124474843343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6780.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "sampler_results": {"episode_reward_max": -13.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.06, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.06, "reward_total_min": -64, "reward_total_max": -13, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11671875, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3984375, "reward_score_mean": 0.11671875, "reward_score_min": 0.0, "reward_score_max": 0.3984375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-41.0, -51.0, -52.0, -60.0, -53.0, -42.0, -53.0, -53.0, -38.0, -13.0, -53.0, -60.0, -59.0, -33.0, -56.0, -40.0, -56.0, -62.0, -51.0, -38.0, -25.0, -59.0, -58.0, -55.0, -60.0, -34.0, -28.0, -49.0, -36.0, -23.0, -63.0, -62.0, -48.0, -28.0, -56.0, -60.0, -64.0, -40.0, -57.0, -48.0, -57.0, -28.0, -49.0, -53.0, -42.0, -58.0, -31.0, -57.0, -43.0, -60.0, -53.0, -29.0, -26.0, -54.0, -29.0, -49.0, -58.0, -57.0, -37.0, -53.0, -60.0, -31.0, -48.0, -51.0, -64.0, -61.0, -53.0, -39.0, -37.0, -55.0, -54.0, -56.0, -60.0, -63.0, -61.0, -60.0, -31.0, -61.0, -56.0, -59.0, -37.0, -60.0, -35.0, -61.0, -60.0, -49.0, -59.0, -54.0, -51.0, -51.0, -36.0, -37.0, -55.0, -36.0, -60.0, -57.0, -38.0, -57.0, -60.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6369954921414256, "mean_inference_ms": 12.71019025476196, "mean_action_processing_ms": 0.5339111655923198, "mean_env_wait_ms": 0.34464418652942347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2447214126586914, "StateBufferConnector_ms": 0.00424647331237793, "ViewRequirementAgentConnector_ms": 0.18301820755004883}}, "episode_reward_max": -13.0, "episode_reward_min": -64.0, "episode_reward_mean": -49.06, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.0, -51.0, -52.0, -60.0, -53.0, -42.0, -53.0, -53.0, -38.0, -13.0, -53.0, -60.0, -59.0, -33.0, -56.0, -40.0, -56.0, -62.0, -51.0, -38.0, -25.0, -59.0, -58.0, -55.0, -60.0, -34.0, -28.0, -49.0, -36.0, -23.0, -63.0, -62.0, -48.0, -28.0, -56.0, -60.0, -64.0, -40.0, -57.0, -48.0, -57.0, -28.0, -49.0, -53.0, -42.0, -58.0, -31.0, -57.0, -43.0, -60.0, -53.0, -29.0, -26.0, -54.0, -29.0, -49.0, -58.0, -57.0, -37.0, -53.0, -60.0, -31.0, -48.0, -51.0, -64.0, -61.0, -53.0, -39.0, -37.0, -55.0, -54.0, -56.0, -60.0, -63.0, -61.0, -60.0, -31.0, -61.0, -56.0, -59.0, -37.0, -60.0, -35.0, -61.0, -60.0, -49.0, -59.0, -54.0, -51.0, -51.0, -36.0, -37.0, -55.0, -36.0, -60.0, -57.0, -38.0, -57.0, -60.0, -53.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6369954921414256, "mean_inference_ms": 12.71019025476196, "mean_action_processing_ms": 0.5339111655923198, "mean_env_wait_ms": 0.34464418652942347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2447214126586914, "StateBufferConnector_ms": 0.00424647331237793, "ViewRequirementAgentConnector_ms": 0.18301820755004883}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184, "num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.8469820490998705, "num_agent_steps_trained_throughput_per_sec": 7.8469820490998705, "timesteps_total": 29184, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29184, "timers": {"training_iteration_time_ms": 65968.895, "sample_time_ms": 5397.093, "load_time_ms": 0.298, "load_throughput": 1718261.84, "learn_time_ms": 60571.015, "learn_throughput": 8.453, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 29184, "num_env_steps_trained": 29184, "num_agent_steps_sampled": 29184, "num_agent_steps_trained": 29184}, "done": false, "episodes_total": 1824, "training_iteration": 57, "trial_id": "02b4f_00268", "date": "2024-02-27_14-16-45", "timestamp": 1709039805, "time_this_iter_s": 65.25275683403015, "time_total_s": 5198.863204956055, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5198.863204956055, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.802150537634404, "ram_util_percent": 5.3462365591397845}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -48.87, "reward_total_min": -64, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.359375, "reward_score_mean": 0.118203125, "reward_score_min": 0.0, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.0008365429151557455, "total_loss": 3.5366962969303133, "policy_loss": -0.04774035750500237, "vf_loss": 5.598448890447616, "vf_explained_var": 0.9967085992296537, "kl": 0.004308243490231689, "entropy": 95.19342727661133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6900.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "sampler_results": {"episode_reward_max": -18.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.87, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -48.87, "reward_total_min": -64, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.118203125, "reward_percentile_min": 0.0, "reward_percentile_max": 0.359375, "reward_score_mean": 0.118203125, "reward_score_min": 0.0, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-48.0, -28.0, -56.0, -60.0, -64.0, -40.0, -57.0, -48.0, -57.0, -28.0, -49.0, -53.0, -42.0, -58.0, -31.0, -57.0, -43.0, -60.0, -53.0, -29.0, -26.0, -54.0, -29.0, -49.0, -58.0, -57.0, -37.0, -53.0, -60.0, -31.0, -48.0, -51.0, -64.0, -61.0, -53.0, -39.0, -37.0, -55.0, -54.0, -56.0, -60.0, -63.0, -61.0, -60.0, -31.0, -61.0, -56.0, -59.0, -37.0, -60.0, -35.0, -61.0, -60.0, -49.0, -59.0, -54.0, -51.0, -51.0, -36.0, -37.0, -55.0, -36.0, -60.0, -57.0, -38.0, -57.0, -60.0, -53.0, -63.0, -55.0, -35.0, -59.0, -20.0, -61.0, -60.0, -22.0, -63.0, -58.0, -56.0, -60.0, -32.0, -39.0, -32.0, -62.0, -51.0, -43.0, -60.0, -33.0, -58.0, -34.0, -23.0, -46.0, -53.0, -45.0, -18.0, -56.0, -46.0, -39.0, -60.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.628690618754133, "mean_inference_ms": 12.638934609245911, "mean_action_processing_ms": 0.5318047220665856, "mean_env_wait_ms": 0.3432371475973444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2427358627319336, "StateBufferConnector_ms": 0.004195451736450195, "ViewRequirementAgentConnector_ms": 0.17910146713256836}}, "episode_reward_max": -18.0, "episode_reward_min": -64.0, "episode_reward_mean": -48.87, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-48.0, -28.0, -56.0, -60.0, -64.0, -40.0, -57.0, -48.0, -57.0, -28.0, -49.0, -53.0, -42.0, -58.0, -31.0, -57.0, -43.0, -60.0, -53.0, -29.0, -26.0, -54.0, -29.0, -49.0, -58.0, -57.0, -37.0, -53.0, -60.0, -31.0, -48.0, -51.0, -64.0, -61.0, -53.0, -39.0, -37.0, -55.0, -54.0, -56.0, -60.0, -63.0, -61.0, -60.0, -31.0, -61.0, -56.0, -59.0, -37.0, -60.0, -35.0, -61.0, -60.0, -49.0, -59.0, -54.0, -51.0, -51.0, -36.0, -37.0, -55.0, -36.0, -60.0, -57.0, -38.0, -57.0, -60.0, -53.0, -63.0, -55.0, -35.0, -59.0, -20.0, -61.0, -60.0, -22.0, -63.0, -58.0, -56.0, -60.0, -32.0, -39.0, -32.0, -62.0, -51.0, -43.0, -60.0, -33.0, -58.0, -34.0, -23.0, -46.0, -53.0, -45.0, -18.0, -56.0, -46.0, -39.0, -60.0, -55.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.628690618754133, "mean_inference_ms": 12.638934609245911, "mean_action_processing_ms": 0.5318047220665856, "mean_env_wait_ms": 0.3432371475973444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2427358627319336, "StateBufferConnector_ms": 0.004195451736450195, "ViewRequirementAgentConnector_ms": 0.17910146713256836}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.80760174763198, "num_agent_steps_trained_throughput_per_sec": 7.80760174763198, "timesteps_total": 29696, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 66030.636, "sample_time_ms": 5409.571, "load_time_ms": 0.294, "load_throughput": 1739134.798, "learn_time_ms": 60620.299, "learn_throughput": 8.446, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "episodes_total": 1856, "training_iteration": 58, "trial_id": "02b4f_00268", "date": "2024-02-27_14-17-50", "timestamp": 1709039870, "time_this_iter_s": 65.58196544647217, "time_total_s": 5264.445170402527, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5264.445170402527, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.71505376344086, "ram_util_percent": 5.306451612903223}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.42, "reward_total_min": -64, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.359375, "reward_score_mean": 0.10609375, "reward_score_min": 0.0, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.0008365429151557455, "total_loss": 5.242083495855331, "policy_loss": -0.05010189401606719, "vf_loss": 8.235255066553751, "vf_explained_var": 0.9960564583539963, "kl": 0.007340338306407798, "entropy": 95.3030548731486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7020.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "sampler_results": {"episode_reward_max": -18.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.42, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.42, "reward_total_min": -64, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10609375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.359375, "reward_score_mean": 0.10609375, "reward_score_min": 0.0, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-64.0, -61.0, -53.0, -39.0, -37.0, -55.0, -54.0, -56.0, -60.0, -63.0, -61.0, -60.0, -31.0, -61.0, -56.0, -59.0, -37.0, -60.0, -35.0, -61.0, -60.0, -49.0, -59.0, -54.0, -51.0, -51.0, -36.0, -37.0, -55.0, -36.0, -60.0, -57.0, -38.0, -57.0, -60.0, -53.0, -63.0, -55.0, -35.0, -59.0, -20.0, -61.0, -60.0, -22.0, -63.0, -58.0, -56.0, -60.0, -32.0, -39.0, -32.0, -62.0, -51.0, -43.0, -60.0, -33.0, -58.0, -34.0, -23.0, -46.0, -53.0, -45.0, -18.0, -56.0, -46.0, -39.0, -60.0, -55.0, -55.0, -53.0, -53.0, -48.0, -47.0, -40.0, -37.0, -58.0, -57.0, -48.0, -60.0, -60.0, -49.0, -60.0, -57.0, -52.0, -53.0, -58.0, -46.0, -58.0, -50.0, -61.0, -51.0, -56.0, -47.0, -62.0, -36.0, -49.0, -62.0, -56.0, -48.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6212186939911617, "mean_inference_ms": 12.567351538861326, "mean_action_processing_ms": 0.5295820273888612, "mean_env_wait_ms": 0.341682689025127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23403429985046387, "StateBufferConnector_ms": 0.004056692123413086, "ViewRequirementAgentConnector_ms": 0.1688370704650879}}, "episode_reward_max": -18.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.42, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-64.0, -61.0, -53.0, -39.0, -37.0, -55.0, -54.0, -56.0, -60.0, -63.0, -61.0, -60.0, -31.0, -61.0, -56.0, -59.0, -37.0, -60.0, -35.0, -61.0, -60.0, -49.0, -59.0, -54.0, -51.0, -51.0, -36.0, -37.0, -55.0, -36.0, -60.0, -57.0, -38.0, -57.0, -60.0, -53.0, -63.0, -55.0, -35.0, -59.0, -20.0, -61.0, -60.0, -22.0, -63.0, -58.0, -56.0, -60.0, -32.0, -39.0, -32.0, -62.0, -51.0, -43.0, -60.0, -33.0, -58.0, -34.0, -23.0, -46.0, -53.0, -45.0, -18.0, -56.0, -46.0, -39.0, -60.0, -55.0, -55.0, -53.0, -53.0, -48.0, -47.0, -40.0, -37.0, -58.0, -57.0, -48.0, -60.0, -60.0, -49.0, -60.0, -57.0, -52.0, -53.0, -58.0, -46.0, -58.0, -50.0, -61.0, -51.0, -56.0, -47.0, -62.0, -36.0, -49.0, -62.0, -56.0, -48.0, -42.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6212186939911617, "mean_inference_ms": 12.567351538861326, "mean_action_processing_ms": 0.5295820273888612, "mean_env_wait_ms": 0.341682689025127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23403429985046387, "StateBufferConnector_ms": 0.004056692123413086, "ViewRequirementAgentConnector_ms": 0.1688370704650879}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208, "num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.929809100919374, "num_agent_steps_trained_throughput_per_sec": 7.929809100919374, "timesteps_total": 30208, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30208, "timers": {"training_iteration_time_ms": 65877.166, "sample_time_ms": 5354.594, "load_time_ms": 0.275, "load_throughput": 1860743.131, "learn_time_ms": 60521.829, "learn_throughput": 8.46, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 30208, "num_env_steps_trained": 30208, "num_agent_steps_sampled": 30208, "num_agent_steps_trained": 30208}, "done": false, "episodes_total": 1888, "training_iteration": 59, "trial_id": "02b4f_00268", "date": "2024-02-27_14-18-55", "timestamp": 1709039935, "time_this_iter_s": 64.57118797302246, "time_total_s": 5329.016358375549, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5329.016358375549, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.80879120879121, "ram_util_percent": 5.328571428571429}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.45, "reward_total_min": -63, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098046875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.359375, "reward_score_mean": 0.098046875, "reward_score_min": 0.0078125, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 19.46195068359375, "cur_lr": 0.0008365429151557455, "total_loss": 3.7996542791525525, "policy_loss": -0.04323473889380693, "vf_loss": 6.074869165817897, "vf_explained_var": 0.9911998748779297, "kl": 0.0022815694578628533, "entropy": 95.25334650675455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7140.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "sampler_results": {"episode_reward_max": -18.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.45, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.45, "reward_total_min": -63, "reward_total_max": -18, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.098046875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.359375, "reward_score_mean": 0.098046875, "reward_score_min": 0.0078125, "reward_score_max": 0.359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-38.0, -57.0, -60.0, -53.0, -63.0, -55.0, -35.0, -59.0, -20.0, -61.0, -60.0, -22.0, -63.0, -58.0, -56.0, -60.0, -32.0, -39.0, -32.0, -62.0, -51.0, -43.0, -60.0, -33.0, -58.0, -34.0, -23.0, -46.0, -53.0, -45.0, -18.0, -56.0, -46.0, -39.0, -60.0, -55.0, -55.0, -53.0, -53.0, -48.0, -47.0, -40.0, -37.0, -58.0, -57.0, -48.0, -60.0, -60.0, -49.0, -60.0, -57.0, -52.0, -53.0, -58.0, -46.0, -58.0, -50.0, -61.0, -51.0, -56.0, -47.0, -62.0, -36.0, -49.0, -62.0, -56.0, -48.0, -42.0, -53.0, -63.0, -50.0, -53.0, -53.0, -55.0, -62.0, -53.0, -61.0, -59.0, -37.0, -60.0, -51.0, -33.0, -60.0, -58.0, -63.0, -61.0, -57.0, -54.0, -31.0, -59.0, -61.0, -57.0, -59.0, -60.0, -61.0, -60.0, -58.0, -50.0, -58.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6134037695862853, "mean_inference_ms": 12.495150848645924, "mean_action_processing_ms": 0.5272226070855625, "mean_env_wait_ms": 0.3399932478115892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22681474685668945, "StateBufferConnector_ms": 0.00392913818359375, "ViewRequirementAgentConnector_ms": 0.15920138359069824}}, "episode_reward_max": -18.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.45, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-38.0, -57.0, -60.0, -53.0, -63.0, -55.0, -35.0, -59.0, -20.0, -61.0, -60.0, -22.0, -63.0, -58.0, -56.0, -60.0, -32.0, -39.0, -32.0, -62.0, -51.0, -43.0, -60.0, -33.0, -58.0, -34.0, -23.0, -46.0, -53.0, -45.0, -18.0, -56.0, -46.0, -39.0, -60.0, -55.0, -55.0, -53.0, -53.0, -48.0, -47.0, -40.0, -37.0, -58.0, -57.0, -48.0, -60.0, -60.0, -49.0, -60.0, -57.0, -52.0, -53.0, -58.0, -46.0, -58.0, -50.0, -61.0, -51.0, -56.0, -47.0, -62.0, -36.0, -49.0, -62.0, -56.0, -48.0, -42.0, -53.0, -63.0, -50.0, -53.0, -53.0, -55.0, -62.0, -53.0, -61.0, -59.0, -37.0, -60.0, -51.0, -33.0, -60.0, -58.0, -63.0, -61.0, -57.0, -54.0, -31.0, -59.0, -61.0, -57.0, -59.0, -60.0, -61.0, -60.0, -58.0, -50.0, -58.0, -61.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6134037695862853, "mean_inference_ms": 12.495150848645924, "mean_action_processing_ms": 0.5272226070855625, "mean_env_wait_ms": 0.3399932478115892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22681474685668945, "StateBufferConnector_ms": 0.00392913818359375, "ViewRequirementAgentConnector_ms": 0.15920138359069824}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.871093791062407, "num_agent_steps_trained_throughput_per_sec": 7.871093791062407, "timesteps_total": 30720, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 65797.594, "sample_time_ms": 5354.232, "load_time_ms": 0.27, "load_throughput": 1898915.596, "learn_time_ms": 60442.636, "learn_throughput": 8.471, "synch_weights_time_ms": 0.008}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "episodes_total": 1920, "training_iteration": 60, "trial_id": "02b4f_00268", "date": "2024-02-27_14-20-00", "timestamp": 1709040000, "time_this_iter_s": 65.05280804634094, "time_total_s": 5394.06916642189, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5394.06916642189, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.846236559139786, "ram_util_percent": 5.360215053763439}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -51.72, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0959375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.0959375, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 4.620500073830287, "policy_loss": -0.06475573061034083, "vf_loss": 7.330851680040359, "vf_explained_var": 0.9952716891964276, "kl": 0.010423590696409139, "entropy": 95.08461596171061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7260.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "sampler_results": {"episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.72, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -51.72, "reward_total_min": -63, "reward_total_max": -28, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0959375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.28125, "reward_score_mean": 0.0959375, "reward_score_min": 0.0078125, "reward_score_max": 0.28125, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, -39.0, -60.0, -55.0, -55.0, -53.0, -53.0, -48.0, -47.0, -40.0, -37.0, -58.0, -57.0, -48.0, -60.0, -60.0, -49.0, -60.0, -57.0, -52.0, -53.0, -58.0, -46.0, -58.0, -50.0, -61.0, -51.0, -56.0, -47.0, -62.0, -36.0, -49.0, -62.0, -56.0, -48.0, -42.0, -53.0, -63.0, -50.0, -53.0, -53.0, -55.0, -62.0, -53.0, -61.0, -59.0, -37.0, -60.0, -51.0, -33.0, -60.0, -58.0, -63.0, -61.0, -57.0, -54.0, -31.0, -59.0, -61.0, -57.0, -59.0, -60.0, -61.0, -60.0, -58.0, -50.0, -58.0, -61.0, -56.0, -61.0, -62.0, -62.0, -36.0, -52.0, -61.0, -49.0, -39.0, -42.0, -28.0, -62.0, -61.0, -38.0, -44.0, -33.0, -60.0, -50.0, -50.0, -32.0, -29.0, -61.0, -46.0, -31.0, -47.0, -62.0, -47.0, -32.0, -53.0, -47.0, -47.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6049711642746427, "mean_inference_ms": 12.421207749868849, "mean_action_processing_ms": 0.524651804680741, "mean_env_wait_ms": 0.3380744873051323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2142195701599121, "StateBufferConnector_ms": 0.0036840438842773438, "ViewRequirementAgentConnector_ms": 0.14055275917053223}}, "episode_reward_max": -28.0, "episode_reward_min": -63.0, "episode_reward_mean": -51.72, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, -39.0, -60.0, -55.0, -55.0, -53.0, -53.0, -48.0, -47.0, -40.0, -37.0, -58.0, -57.0, -48.0, -60.0, -60.0, -49.0, -60.0, -57.0, -52.0, -53.0, -58.0, -46.0, -58.0, -50.0, -61.0, -51.0, -56.0, -47.0, -62.0, -36.0, -49.0, -62.0, -56.0, -48.0, -42.0, -53.0, -63.0, -50.0, -53.0, -53.0, -55.0, -62.0, -53.0, -61.0, -59.0, -37.0, -60.0, -51.0, -33.0, -60.0, -58.0, -63.0, -61.0, -57.0, -54.0, -31.0, -59.0, -61.0, -57.0, -59.0, -60.0, -61.0, -60.0, -58.0, -50.0, -58.0, -61.0, -56.0, -61.0, -62.0, -62.0, -36.0, -52.0, -61.0, -49.0, -39.0, -42.0, -28.0, -62.0, -61.0, -38.0, -44.0, -33.0, -60.0, -50.0, -50.0, -32.0, -29.0, -61.0, -46.0, -31.0, -47.0, -62.0, -47.0, -32.0, -53.0, -47.0, -47.0, -52.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6049711642746427, "mean_inference_ms": 12.421207749868849, "mean_action_processing_ms": 0.524651804680741, "mean_env_wait_ms": 0.3380744873051323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2142195701599121, "StateBufferConnector_ms": 0.0036840438842773438, "ViewRequirementAgentConnector_ms": 0.14055275917053223}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232, "num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.908541956182271, "num_agent_steps_trained_throughput_per_sec": 7.908541956182271, "timesteps_total": 31232, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31232, "timers": {"training_iteration_time_ms": 65643.377, "sample_time_ms": 5315.389, "load_time_ms": 0.27, "load_throughput": 1893557.577, "learn_time_ms": 60327.266, "learn_throughput": 8.487, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 31232, "num_env_steps_trained": 31232, "num_agent_steps_sampled": 31232, "num_agent_steps_trained": 31232}, "done": false, "episodes_total": 1952, "training_iteration": 61, "trial_id": "02b4f_00268", "date": "2024-02-27_14-21-05", "timestamp": 1709040065, "time_this_iter_s": 64.7449061870575, "time_total_s": 5458.814072608948, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5458.814072608948, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.94347826086957, "ram_util_percent": 5.399999999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.76, "reward_total_min": -63, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1034375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.1034375, "reward_score_min": 0.0078125, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 3.943693000078201, "policy_loss": -0.06331032584421337, "vf_loss": 6.249973261356354, "vf_explained_var": 0.9927316884199778, "kl": 0.010176710076331356, "entropy": 95.05633188883463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7380.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.76, "reward_total_min": -63, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.1034375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.1034375, "reward_score_min": 0.0078125, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-62.0, -56.0, -48.0, -42.0, -53.0, -63.0, -50.0, -53.0, -53.0, -55.0, -62.0, -53.0, -61.0, -59.0, -37.0, -60.0, -51.0, -33.0, -60.0, -58.0, -63.0, -61.0, -57.0, -54.0, -31.0, -59.0, -61.0, -57.0, -59.0, -60.0, -61.0, -60.0, -58.0, -50.0, -58.0, -61.0, -56.0, -61.0, -62.0, -62.0, -36.0, -52.0, -61.0, -49.0, -39.0, -42.0, -28.0, -62.0, -61.0, -38.0, -44.0, -33.0, -60.0, -50.0, -50.0, -32.0, -29.0, -61.0, -46.0, -31.0, -47.0, -62.0, -47.0, -32.0, -53.0, -47.0, -47.0, -52.0, -47.0, -53.0, -58.0, -47.0, -59.0, -60.0, -62.0, -62.0, -21.0, -62.0, -60.0, -36.0, -25.0, -59.0, -48.0, -30.0, -54.0, -47.0, -55.0, -30.0, -39.0, -48.0, -24.0, -41.0, -48.0, -58.0, -55.0, -57.0, -59.0, -42.0, -57.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5964690452301706, "mean_inference_ms": 12.356254481690206, "mean_action_processing_ms": 0.5223862504551923, "mean_env_wait_ms": 0.33644606561647317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22388625144958496, "StateBufferConnector_ms": 0.003927946090698242, "ViewRequirementAgentConnector_ms": 0.15505480766296387}}, "episode_reward_max": -21.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-62.0, -56.0, -48.0, -42.0, -53.0, -63.0, -50.0, -53.0, -53.0, -55.0, -62.0, -53.0, -61.0, -59.0, -37.0, -60.0, -51.0, -33.0, -60.0, -58.0, -63.0, -61.0, -57.0, -54.0, -31.0, -59.0, -61.0, -57.0, -59.0, -60.0, -61.0, -60.0, -58.0, -50.0, -58.0, -61.0, -56.0, -61.0, -62.0, -62.0, -36.0, -52.0, -61.0, -49.0, -39.0, -42.0, -28.0, -62.0, -61.0, -38.0, -44.0, -33.0, -60.0, -50.0, -50.0, -32.0, -29.0, -61.0, -46.0, -31.0, -47.0, -62.0, -47.0, -32.0, -53.0, -47.0, -47.0, -52.0, -47.0, -53.0, -58.0, -47.0, -59.0, -60.0, -62.0, -62.0, -21.0, -62.0, -60.0, -36.0, -25.0, -59.0, -48.0, -30.0, -54.0, -47.0, -55.0, -30.0, -39.0, -48.0, -24.0, -41.0, -48.0, -58.0, -55.0, -57.0, -59.0, -42.0, -57.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5964690452301706, "mean_inference_ms": 12.356254481690206, "mean_action_processing_ms": 0.5223862504551923, "mean_env_wait_ms": 0.33644606561647317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22388625144958496, "StateBufferConnector_ms": 0.003927946090698242, "ViewRequirementAgentConnector_ms": 0.15505480766296387}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.748960686865023, "num_agent_steps_trained_throughput_per_sec": 7.748960686865023, "timesteps_total": 31744, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 65569.092, "sample_time_ms": 5346.505, "load_time_ms": 0.265, "load_throughput": 1931016.678, "learn_time_ms": 60221.898, "learn_throughput": 8.502, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "episodes_total": 1984, "training_iteration": 62, "trial_id": "02b4f_00268", "date": "2024-02-27_14-22-11", "timestamp": 1709040131, "time_this_iter_s": 66.07848739624023, "time_total_s": 5524.892560005188, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5524.892560005188, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.93655913978495, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.23, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115390625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.115390625, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 3.9185903509457907, "policy_loss": -0.053991888153056306, "vf_loss": 6.195865837732951, "vf_explained_var": 0.9944883306821187, "kl": 0.010116190779018316, "entropy": 94.81409498850505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "sampler_results": {"episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.23, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.23, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.115390625, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.115390625, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-58.0, -50.0, -58.0, -61.0, -56.0, -61.0, -62.0, -62.0, -36.0, -52.0, -61.0, -49.0, -39.0, -42.0, -28.0, -62.0, -61.0, -38.0, -44.0, -33.0, -60.0, -50.0, -50.0, -32.0, -29.0, -61.0, -46.0, -31.0, -47.0, -62.0, -47.0, -32.0, -53.0, -47.0, -47.0, -52.0, -47.0, -53.0, -58.0, -47.0, -59.0, -60.0, -62.0, -62.0, -21.0, -62.0, -60.0, -36.0, -25.0, -59.0, -48.0, -30.0, -54.0, -47.0, -55.0, -30.0, -39.0, -48.0, -24.0, -41.0, -48.0, -58.0, -55.0, -57.0, -59.0, -42.0, -57.0, -62.0, -17.0, -49.0, -57.0, -51.0, -38.0, -56.0, -61.0, -63.0, -59.0, -60.0, -48.0, -50.0, -39.0, -23.0, -60.0, -59.0, -59.0, -57.0, -61.0, -51.0, -41.0, -55.0, -53.0, -59.0, -60.0, -61.0, -28.0, -53.0, -35.0, -29.0, -49.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5883192104934702, "mean_inference_ms": 12.294663916946947, "mean_action_processing_ms": 0.5202742569298364, "mean_env_wait_ms": 0.33494127155357367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22709345817565918, "StateBufferConnector_ms": 0.003973245620727539, "ViewRequirementAgentConnector_ms": 0.15826201438903809}}, "episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.23, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-58.0, -50.0, -58.0, -61.0, -56.0, -61.0, -62.0, -62.0, -36.0, -52.0, -61.0, -49.0, -39.0, -42.0, -28.0, -62.0, -61.0, -38.0, -44.0, -33.0, -60.0, -50.0, -50.0, -32.0, -29.0, -61.0, -46.0, -31.0, -47.0, -62.0, -47.0, -32.0, -53.0, -47.0, -47.0, -52.0, -47.0, -53.0, -58.0, -47.0, -59.0, -60.0, -62.0, -62.0, -21.0, -62.0, -60.0, -36.0, -25.0, -59.0, -48.0, -30.0, -54.0, -47.0, -55.0, -30.0, -39.0, -48.0, -24.0, -41.0, -48.0, -58.0, -55.0, -57.0, -59.0, -42.0, -57.0, -62.0, -17.0, -49.0, -57.0, -51.0, -38.0, -56.0, -61.0, -63.0, -59.0, -60.0, -48.0, -50.0, -39.0, -23.0, -60.0, -59.0, -59.0, -57.0, -61.0, -51.0, -41.0, -55.0, -53.0, -59.0, -60.0, -61.0, -28.0, -53.0, -35.0, -29.0, -49.0, -58.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5883192104934702, "mean_inference_ms": 12.294663916946947, "mean_action_processing_ms": 0.5202742569298364, "mean_env_wait_ms": 0.33494127155357367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.22709345817565918, "StateBufferConnector_ms": 0.003973245620727539, "ViewRequirementAgentConnector_ms": 0.15826201438903809}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256, "num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.815219083039022, "num_agent_steps_trained_throughput_per_sec": 7.815219083039022, "timesteps_total": 32256, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32256, "timers": {"training_iteration_time_ms": 65514.749, "sample_time_ms": 5312.846, "load_time_ms": 0.264, "load_throughput": 1938162.137, "learn_time_ms": 60201.214, "learn_throughput": 8.505, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 32256, "num_env_steps_trained": 32256, "num_agent_steps_sampled": 32256, "num_agent_steps_trained": 32256}, "done": false, "episodes_total": 2016, "training_iteration": 63, "trial_id": "02b4f_00268", "date": "2024-02-27_14-23-16", "timestamp": 1709040196, "time_this_iter_s": 65.51793479919434, "time_total_s": 5590.410494804382, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5590.410494804382, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.903225806451616, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.76, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.11125, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 4.881398683786392, "policy_loss": -0.06750138150528073, "vf_loss": 7.780364187558492, "vf_explained_var": 0.9943762918313345, "kl": 0.008632783424627722, "entropy": 94.8664986928304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7620.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.76, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.76, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.11125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.11125, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-53.0, -47.0, -47.0, -52.0, -47.0, -53.0, -58.0, -47.0, -59.0, -60.0, -62.0, -62.0, -21.0, -62.0, -60.0, -36.0, -25.0, -59.0, -48.0, -30.0, -54.0, -47.0, -55.0, -30.0, -39.0, -48.0, -24.0, -41.0, -48.0, -58.0, -55.0, -57.0, -59.0, -42.0, -57.0, -62.0, -17.0, -49.0, -57.0, -51.0, -38.0, -56.0, -61.0, -63.0, -59.0, -60.0, -48.0, -50.0, -39.0, -23.0, -60.0, -59.0, -59.0, -57.0, -61.0, -51.0, -41.0, -55.0, -53.0, -59.0, -60.0, -61.0, -28.0, -53.0, -35.0, -29.0, -49.0, -58.0, -48.0, -59.0, -63.0, -37.0, -19.0, -62.0, -47.0, -52.0, -55.0, -58.0, -59.0, -56.0, -30.0, -53.0, -51.0, -56.0, -57.0, -49.0, -48.0, -55.0, -59.0, -34.0, -45.0, -34.0, -47.0, -61.0, -59.0, -59.0, -45.0, -51.0, -43.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5813384895951685, "mean_inference_ms": 12.23936590957068, "mean_action_processing_ms": 0.5185328975398649, "mean_env_wait_ms": 0.3337596430210712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24057936668395996, "StateBufferConnector_ms": 0.004244804382324219, "ViewRequirementAgentConnector_ms": 0.1793215274810791}}, "episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.76, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-53.0, -47.0, -47.0, -52.0, -47.0, -53.0, -58.0, -47.0, -59.0, -60.0, -62.0, -62.0, -21.0, -62.0, -60.0, -36.0, -25.0, -59.0, -48.0, -30.0, -54.0, -47.0, -55.0, -30.0, -39.0, -48.0, -24.0, -41.0, -48.0, -58.0, -55.0, -57.0, -59.0, -42.0, -57.0, -62.0, -17.0, -49.0, -57.0, -51.0, -38.0, -56.0, -61.0, -63.0, -59.0, -60.0, -48.0, -50.0, -39.0, -23.0, -60.0, -59.0, -59.0, -57.0, -61.0, -51.0, -41.0, -55.0, -53.0, -59.0, -60.0, -61.0, -28.0, -53.0, -35.0, -29.0, -49.0, -58.0, -48.0, -59.0, -63.0, -37.0, -19.0, -62.0, -47.0, -52.0, -55.0, -58.0, -59.0, -56.0, -30.0, -53.0, -51.0, -56.0, -57.0, -49.0, -48.0, -55.0, -59.0, -34.0, -45.0, -34.0, -47.0, -61.0, -59.0, -59.0, -45.0, -51.0, -43.0, -62.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5813384895951685, "mean_inference_ms": 12.23936590957068, "mean_action_processing_ms": 0.5185328975398649, "mean_env_wait_ms": 0.3337596430210712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.24057936668395996, "StateBufferConnector_ms": 0.004244804382324219, "ViewRequirementAgentConnector_ms": 0.1793215274810791}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.7089028627084275, "num_agent_steps_trained_throughput_per_sec": 7.7089028627084275, "timesteps_total": 32768, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 65548.157, "sample_time_ms": 5322.575, "load_time_ms": 0.264, "load_throughput": 1940614.177, "learn_time_ms": 60224.894, "learn_throughput": 8.501, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 2048, "training_iteration": 64, "trial_id": "02b4f_00268", "date": "2024-02-27_14-24-23", "timestamp": 1709040263, "time_this_iter_s": 66.42139744758606, "time_total_s": 5656.831892251968, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5656.831892251968, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.926595744680853, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -49.98, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10953125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.10953125, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 4.152313176790873, "policy_loss": -0.06690284001330535, "vf_loss": 6.58514754374822, "vf_explained_var": 0.9957961410284042, "kl": 0.010447531363038791, "entropy": 94.58226515452067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7740.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "sampler_results": {"episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.98, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -49.98, "reward_total_min": -63, "reward_total_max": -17, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10953125, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3671875, "reward_score_mean": 0.10953125, "reward_score_min": 0.0078125, "reward_score_max": 0.3671875, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-59.0, -42.0, -57.0, -62.0, -17.0, -49.0, -57.0, -51.0, -38.0, -56.0, -61.0, -63.0, -59.0, -60.0, -48.0, -50.0, -39.0, -23.0, -60.0, -59.0, -59.0, -57.0, -61.0, -51.0, -41.0, -55.0, -53.0, -59.0, -60.0, -61.0, -28.0, -53.0, -35.0, -29.0, -49.0, -58.0, -48.0, -59.0, -63.0, -37.0, -19.0, -62.0, -47.0, -52.0, -55.0, -58.0, -59.0, -56.0, -30.0, -53.0, -51.0, -56.0, -57.0, -49.0, -48.0, -55.0, -59.0, -34.0, -45.0, -34.0, -47.0, -61.0, -59.0, -59.0, -45.0, -51.0, -43.0, -62.0, -47.0, -35.0, -54.0, -60.0, -52.0, -59.0, -38.0, -34.0, -60.0, -55.0, -56.0, -20.0, -51.0, -60.0, -59.0, -36.0, -38.0, -52.0, -57.0, -27.0, -59.0, -62.0, -56.0, -54.0, -39.0, -51.0, -58.0, -63.0, -28.0, -54.0, -60.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5742548120445223, "mean_inference_ms": 12.181326341267669, "mean_action_processing_ms": 0.5167190795852318, "mean_env_wait_ms": 0.3324952585597679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2352297306060791, "StateBufferConnector_ms": 0.004088401794433594, "ViewRequirementAgentConnector_ms": 0.16938042640686035}}, "episode_reward_max": -17.0, "episode_reward_min": -63.0, "episode_reward_mean": -49.98, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-59.0, -42.0, -57.0, -62.0, -17.0, -49.0, -57.0, -51.0, -38.0, -56.0, -61.0, -63.0, -59.0, -60.0, -48.0, -50.0, -39.0, -23.0, -60.0, -59.0, -59.0, -57.0, -61.0, -51.0, -41.0, -55.0, -53.0, -59.0, -60.0, -61.0, -28.0, -53.0, -35.0, -29.0, -49.0, -58.0, -48.0, -59.0, -63.0, -37.0, -19.0, -62.0, -47.0, -52.0, -55.0, -58.0, -59.0, -56.0, -30.0, -53.0, -51.0, -56.0, -57.0, -49.0, -48.0, -55.0, -59.0, -34.0, -45.0, -34.0, -47.0, -61.0, -59.0, -59.0, -45.0, -51.0, -43.0, -62.0, -47.0, -35.0, -54.0, -60.0, -52.0, -59.0, -38.0, -34.0, -60.0, -55.0, -56.0, -20.0, -51.0, -60.0, -59.0, -36.0, -38.0, -52.0, -57.0, -27.0, -59.0, -62.0, -56.0, -54.0, -39.0, -51.0, -58.0, -63.0, -28.0, -54.0, -60.0, -32.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5742548120445223, "mean_inference_ms": 12.181326341267669, "mean_action_processing_ms": 0.5167190795852318, "mean_env_wait_ms": 0.3324952585597679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2352297306060791, "StateBufferConnector_ms": 0.004088401794433594, "ViewRequirementAgentConnector_ms": 0.16938042640686035}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280, "num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.8051365989629, "num_agent_steps_trained_throughput_per_sec": 7.8051365989629, "timesteps_total": 33280, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33280, "timers": {"training_iteration_time_ms": 65496.345, "sample_time_ms": 5280.03, "load_time_ms": 0.262, "load_throughput": 1956170.202, "learn_time_ms": 60215.636, "learn_throughput": 8.503, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 33280, "num_env_steps_trained": 33280, "num_agent_steps_sampled": 33280, "num_agent_steps_trained": 33280}, "done": false, "episodes_total": 2080, "training_iteration": 65, "trial_id": "02b4f_00268", "date": "2024-02-27_14-25-28", "timestamp": 1709040328, "time_this_iter_s": 65.60252714157104, "time_total_s": 5722.434419393539, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5722.434419393539, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.910638297872342, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.5, "reward_total_min": -63, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10546875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.10546875, "reward_score_min": 0.0078125, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 3.5134272376696267, "policy_loss": -0.06788183841854334, "vf_loss": 5.629941240946452, "vf_explained_var": 0.9920968150099119, "kl": 0.006271488240539232, "entropy": 94.9898057937622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7860.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "sampler_results": {"episode_reward_max": -19.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.5, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.5, "reward_total_min": -63, "reward_total_max": -19, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10546875, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.3515625, "reward_score_mean": 0.10546875, "reward_score_min": 0.0078125, "reward_score_max": 0.3515625, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-35.0, -29.0, -49.0, -58.0, -48.0, -59.0, -63.0, -37.0, -19.0, -62.0, -47.0, -52.0, -55.0, -58.0, -59.0, -56.0, -30.0, -53.0, -51.0, -56.0, -57.0, -49.0, -48.0, -55.0, -59.0, -34.0, -45.0, -34.0, -47.0, -61.0, -59.0, -59.0, -45.0, -51.0, -43.0, -62.0, -47.0, -35.0, -54.0, -60.0, -52.0, -59.0, -38.0, -34.0, -60.0, -55.0, -56.0, -20.0, -51.0, -60.0, -59.0, -36.0, -38.0, -52.0, -57.0, -27.0, -59.0, -62.0, -56.0, -54.0, -39.0, -51.0, -58.0, -63.0, -28.0, -54.0, -60.0, -32.0, -57.0, -44.0, -55.0, -60.0, -47.0, -36.0, -57.0, -60.0, -50.0, -33.0, -49.0, -55.0, -58.0, -48.0, -63.0, -59.0, -53.0, -58.0, -62.0, -63.0, -62.0, -48.0, -53.0, -60.0, -55.0, -40.0, -55.0, -62.0, -46.0, -51.0, -44.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5675556146727994, "mean_inference_ms": 12.12519789203262, "mean_action_processing_ms": 0.5150077625877943, "mean_env_wait_ms": 0.33132185753093846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23770809173583984, "StateBufferConnector_ms": 0.00414729118347168, "ViewRequirementAgentConnector_ms": 0.17286109924316406}}, "episode_reward_max": -19.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.5, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-35.0, -29.0, -49.0, -58.0, -48.0, -59.0, -63.0, -37.0, -19.0, -62.0, -47.0, -52.0, -55.0, -58.0, -59.0, -56.0, -30.0, -53.0, -51.0, -56.0, -57.0, -49.0, -48.0, -55.0, -59.0, -34.0, -45.0, -34.0, -47.0, -61.0, -59.0, -59.0, -45.0, -51.0, -43.0, -62.0, -47.0, -35.0, -54.0, -60.0, -52.0, -59.0, -38.0, -34.0, -60.0, -55.0, -56.0, -20.0, -51.0, -60.0, -59.0, -36.0, -38.0, -52.0, -57.0, -27.0, -59.0, -62.0, -56.0, -54.0, -39.0, -51.0, -58.0, -63.0, -28.0, -54.0, -60.0, -32.0, -57.0, -44.0, -55.0, -60.0, -47.0, -36.0, -57.0, -60.0, -50.0, -33.0, -49.0, -55.0, -58.0, -48.0, -63.0, -59.0, -53.0, -58.0, -62.0, -63.0, -62.0, -48.0, -53.0, -60.0, -55.0, -40.0, -55.0, -62.0, -46.0, -51.0, -44.0, -57.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5675556146727994, "mean_inference_ms": 12.12519789203262, "mean_action_processing_ms": 0.5150077625877943, "mean_env_wait_ms": 0.33132185753093846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23770809173583984, "StateBufferConnector_ms": 0.00414729118347168, "ViewRequirementAgentConnector_ms": 0.17286109924316406}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.839145596346051, "num_agent_steps_trained_throughput_per_sec": 7.839145596346051, "timesteps_total": 33792, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 65409.39, "sample_time_ms": 5278.993, "load_time_ms": 0.261, "load_throughput": 1961530.552, "learn_time_ms": 60129.717, "learn_throughput": 8.515, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "episodes_total": 2112, "training_iteration": 66, "trial_id": "02b4f_00268", "date": "2024-02-27_14-26-34", "timestamp": 1709040394, "time_this_iter_s": 65.31795310974121, "time_total_s": 5787.752372503281, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5787.752372503281, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.913043478260867, "ram_util_percent": 5.399999999999999}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.85, "reward_total_min": -63, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102734375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.34375, "reward_score_mean": 0.102734375, "reward_score_min": 0.0078125, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 3.58401571114858, "policy_loss": -0.06599778688202301, "vf_loss": 5.7475595593452455, "vf_explained_var": 0.9905967752138773, "kl": 0.005774128397125089, "entropy": 95.32215881347656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7980.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "sampler_results": {"episode_reward_max": -20.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.85, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.85, "reward_total_min": -63, "reward_total_max": -20, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.102734375, "reward_percentile_min": 0.0078125, "reward_percentile_max": 0.34375, "reward_score_mean": 0.102734375, "reward_score_min": 0.0078125, "reward_score_max": 0.34375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-45.0, -51.0, -43.0, -62.0, -47.0, -35.0, -54.0, -60.0, -52.0, -59.0, -38.0, -34.0, -60.0, -55.0, -56.0, -20.0, -51.0, -60.0, -59.0, -36.0, -38.0, -52.0, -57.0, -27.0, -59.0, -62.0, -56.0, -54.0, -39.0, -51.0, -58.0, -63.0, -28.0, -54.0, -60.0, -32.0, -57.0, -44.0, -55.0, -60.0, -47.0, -36.0, -57.0, -60.0, -50.0, -33.0, -49.0, -55.0, -58.0, -48.0, -63.0, -59.0, -53.0, -58.0, -62.0, -63.0, -62.0, -48.0, -53.0, -60.0, -55.0, -40.0, -55.0, -62.0, -46.0, -51.0, -44.0, -57.0, -47.0, -59.0, -60.0, -62.0, -62.0, -55.0, -47.0, -21.0, -62.0, -45.0, -51.0, -62.0, -55.0, -35.0, -35.0, -60.0, -61.0, -58.0, -59.0, -50.0, -54.0, -62.0, -61.0, -60.0, -60.0, -41.0, -22.0, -29.0, -44.0, -61.0, -30.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5609433542919018, "mean_inference_ms": 12.070355805804136, "mean_action_processing_ms": 0.5133208120587557, "mean_env_wait_ms": 0.33017066254564265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2368934154510498, "StateBufferConnector_ms": 0.004138946533203125, "ViewRequirementAgentConnector_ms": 0.1699810028076172}}, "episode_reward_max": -20.0, "episode_reward_min": -63.0, "episode_reward_mean": -50.85, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.0, -51.0, -43.0, -62.0, -47.0, -35.0, -54.0, -60.0, -52.0, -59.0, -38.0, -34.0, -60.0, -55.0, -56.0, -20.0, -51.0, -60.0, -59.0, -36.0, -38.0, -52.0, -57.0, -27.0, -59.0, -62.0, -56.0, -54.0, -39.0, -51.0, -58.0, -63.0, -28.0, -54.0, -60.0, -32.0, -57.0, -44.0, -55.0, -60.0, -47.0, -36.0, -57.0, -60.0, -50.0, -33.0, -49.0, -55.0, -58.0, -48.0, -63.0, -59.0, -53.0, -58.0, -62.0, -63.0, -62.0, -48.0, -53.0, -60.0, -55.0, -40.0, -55.0, -62.0, -46.0, -51.0, -44.0, -57.0, -47.0, -59.0, -60.0, -62.0, -62.0, -55.0, -47.0, -21.0, -62.0, -45.0, -51.0, -62.0, -55.0, -35.0, -35.0, -60.0, -61.0, -58.0, -59.0, -50.0, -54.0, -62.0, -61.0, -60.0, -60.0, -41.0, -22.0, -29.0, -44.0, -61.0, -30.0, -48.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5609433542919018, "mean_inference_ms": 12.070355805804136, "mean_action_processing_ms": 0.5133208120587557, "mean_env_wait_ms": 0.33017066254564265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2368934154510498, "StateBufferConnector_ms": 0.004138946533203125, "ViewRequirementAgentConnector_ms": 0.1699810028076172}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304, "num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.801829337463862, "num_agent_steps_trained_throughput_per_sec": 7.801829337463862, "timesteps_total": 34304, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34304, "timers": {"training_iteration_time_ms": 65447.153, "sample_time_ms": 5282.641, "load_time_ms": 0.26, "load_throughput": 1969265.152, "learn_time_ms": 60163.832, "learn_throughput": 8.51, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 34304, "num_env_steps_trained": 34304, "num_agent_steps_sampled": 34304, "num_agent_steps_trained": 34304}, "done": false, "episodes_total": 2144, "training_iteration": 67, "trial_id": "02b4f_00268", "date": "2024-02-27_14-27-39", "timestamp": 1709040459, "time_this_iter_s": 65.63033819198608, "time_total_s": 5853.382710695267, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5853.382710695267, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.957446808510635, "ram_util_percent": 5.399999999999998}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -52.04, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0934375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.0934375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 3.5075475672880807, "policy_loss": -0.06727959224954247, "vf_loss": 5.615161055326462, "vf_explained_var": 0.9961877405643463, "kl": 0.006555098312668722, "entropy": 95.18493626912435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.04, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -52.04, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.0934375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.0934375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-28.0, -54.0, -60.0, -32.0, -57.0, -44.0, -55.0, -60.0, -47.0, -36.0, -57.0, -60.0, -50.0, -33.0, -49.0, -55.0, -58.0, -48.0, -63.0, -59.0, -53.0, -58.0, -62.0, -63.0, -62.0, -48.0, -53.0, -60.0, -55.0, -40.0, -55.0, -62.0, -46.0, -51.0, -44.0, -57.0, -47.0, -59.0, -60.0, -62.0, -62.0, -55.0, -47.0, -21.0, -62.0, -45.0, -51.0, -62.0, -55.0, -35.0, -35.0, -60.0, -61.0, -58.0, -59.0, -50.0, -54.0, -62.0, -61.0, -60.0, -60.0, -41.0, -22.0, -29.0, -44.0, -61.0, -30.0, -48.0, -63.0, -53.0, -60.0, -37.0, -38.0, -62.0, -54.0, -62.0, -48.0, -63.0, -47.0, -61.0, -48.0, -64.0, -57.0, -50.0, -46.0, -42.0, -46.0, -61.0, -59.0, -59.0, -50.0, -62.0, -61.0, -49.0, -53.0, -39.0, -56.0, -61.0, -60.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5542347931307696, "mean_inference_ms": 12.015842846627224, "mean_action_processing_ms": 0.5115881771974008, "mean_env_wait_ms": 0.3289674371843436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23317527770996094, "StateBufferConnector_ms": 0.004060983657836914, "ViewRequirementAgentConnector_ms": 0.16448426246643066}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -52.04, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-28.0, -54.0, -60.0, -32.0, -57.0, -44.0, -55.0, -60.0, -47.0, -36.0, -57.0, -60.0, -50.0, -33.0, -49.0, -55.0, -58.0, -48.0, -63.0, -59.0, -53.0, -58.0, -62.0, -63.0, -62.0, -48.0, -53.0, -60.0, -55.0, -40.0, -55.0, -62.0, -46.0, -51.0, -44.0, -57.0, -47.0, -59.0, -60.0, -62.0, -62.0, -55.0, -47.0, -21.0, -62.0, -45.0, -51.0, -62.0, -55.0, -35.0, -35.0, -60.0, -61.0, -58.0, -59.0, -50.0, -54.0, -62.0, -61.0, -60.0, -60.0, -41.0, -22.0, -29.0, -44.0, -61.0, -30.0, -48.0, -63.0, -53.0, -60.0, -37.0, -38.0, -62.0, -54.0, -62.0, -48.0, -63.0, -47.0, -61.0, -48.0, -64.0, -57.0, -50.0, -46.0, -42.0, -46.0, -61.0, -59.0, -59.0, -50.0, -62.0, -61.0, -49.0, -53.0, -39.0, -56.0, -61.0, -60.0, -41.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5542347931307696, "mean_inference_ms": 12.015842846627224, "mean_action_processing_ms": 0.5115881771974008, "mean_env_wait_ms": 0.3289674371843436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23317527770996094, "StateBufferConnector_ms": 0.004060983657836914, "ViewRequirementAgentConnector_ms": 0.16448426246643066}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.8529319641148225, "num_agent_steps_trained_throughput_per_sec": 7.8529319641148225, "timesteps_total": 34816, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 65409.3, "sample_time_ms": 5233.26, "load_time_ms": 0.26, "load_throughput": 1966740.222, "learn_time_ms": 60175.359, "learn_throughput": 8.508, "synch_weights_time_ms": 0.006}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "episodes_total": 2176, "training_iteration": 68, "trial_id": "02b4f_00268", "date": "2024-02-27_14-28-45", "timestamp": 1709040525, "time_this_iter_s": 65.20331382751465, "time_total_s": 5918.586024522781, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5918.586024522781, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 23.511956521739133, "ram_util_percent": 7.783695652173915}, "checkpoint_dir_name": null}
{"custom_metrics": {"reward_total_mean": -50.9, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.10234375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0, "cur_kl_coeff": 9.730975341796874, "cur_lr": 0.0008365429151557455, "total_loss": 4.535736072063446, "policy_loss": -0.05918971337378025, "vf_loss": 7.166268523534139, "vf_explained_var": 0.9964093714952469, "kl": 0.011716405552545436, "entropy": 95.05173454284667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8220.5, "diff_num_grad_updates_vs_sampler_policy": 59.5}}, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "sampler_results": {"episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.9, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"reward_total_mean": -50.9, "reward_total_min": -64, "reward_total_max": -21, "reward_lower_bound_mean": -64.0, "reward_lower_bound_min": -64, "reward_lower_bound_max": -64, "reward_upper_bound_mean": 64.0, "reward_upper_bound_min": 64, "reward_upper_bound_max": 64, "n_state_switches_mean": 1.0, "n_state_switches_min": 1, "n_state_switches_max": 1, "reward_percentile_mean": 0.10234375, "reward_percentile_min": 0.0, "reward_percentile_max": 0.3359375, "reward_score_mean": 0.10234375, "reward_score_min": 0.0, "reward_score_max": 0.3359375, "task_level_mean": 0.0, "task_level_min": 0, "task_level_max": 0}, "hist_stats": {"episode_reward": [-46.0, -51.0, -44.0, -57.0, -47.0, -59.0, -60.0, -62.0, -62.0, -55.0, -47.0, -21.0, -62.0, -45.0, -51.0, -62.0, -55.0, -35.0, -35.0, -60.0, -61.0, -58.0, -59.0, -50.0, -54.0, -62.0, -61.0, -60.0, -60.0, -41.0, -22.0, -29.0, -44.0, -61.0, -30.0, -48.0, -63.0, -53.0, -60.0, -37.0, -38.0, -62.0, -54.0, -62.0, -48.0, -63.0, -47.0, -61.0, -48.0, -64.0, -57.0, -50.0, -46.0, -42.0, -46.0, -61.0, -59.0, -59.0, -50.0, -62.0, -61.0, -49.0, -53.0, -39.0, -56.0, -61.0, -60.0, -41.0, -59.0, -31.0, -58.0, -53.0, -58.0, -29.0, -59.0, -62.0, -49.0, -41.0, -50.0, -62.0, -24.0, -47.0, -52.0, -26.0, -57.0, -52.0, -48.0, -58.0, -44.0, -46.0, -64.0, -50.0, -46.0, -59.0, -34.0, -55.0, -59.0, -51.0, -41.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5477218438237417, "mean_inference_ms": 11.962824340345119, "mean_action_processing_ms": 0.5099162196178871, "mean_env_wait_ms": 0.32780053056572145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23239421844482422, "StateBufferConnector_ms": 0.004052162170410156, "ViewRequirementAgentConnector_ms": 0.16340112686157227}}, "episode_reward_max": -21.0, "episode_reward_min": -64.0, "episode_reward_mean": -50.9, "episode_len_mean": 16.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.0, -51.0, -44.0, -57.0, -47.0, -59.0, -60.0, -62.0, -62.0, -55.0, -47.0, -21.0, -62.0, -45.0, -51.0, -62.0, -55.0, -35.0, -35.0, -60.0, -61.0, -58.0, -59.0, -50.0, -54.0, -62.0, -61.0, -60.0, -60.0, -41.0, -22.0, -29.0, -44.0, -61.0, -30.0, -48.0, -63.0, -53.0, -60.0, -37.0, -38.0, -62.0, -54.0, -62.0, -48.0, -63.0, -47.0, -61.0, -48.0, -64.0, -57.0, -50.0, -46.0, -42.0, -46.0, -61.0, -59.0, -59.0, -50.0, -62.0, -61.0, -49.0, -53.0, -39.0, -56.0, -61.0, -60.0, -41.0, -59.0, -31.0, -58.0, -53.0, -58.0, -29.0, -59.0, -62.0, -49.0, -41.0, -50.0, -62.0, -24.0, -47.0, -52.0, -26.0, -57.0, -52.0, -48.0, -58.0, -44.0, -46.0, -64.0, -50.0, -46.0, -59.0, -34.0, -55.0, -59.0, -51.0, -41.0, -38.0], "episode_lengths": [16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5477218438237417, "mean_inference_ms": 11.962824340345119, "mean_action_processing_ms": 0.5099162196178871, "mean_env_wait_ms": 0.32780053056572145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23239421844482422, "StateBufferConnector_ms": 0.004052162170410156, "ViewRequirementAgentConnector_ms": 0.16340112686157227}, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328, "num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled_this_iter": 512, "num_agent_steps_trained_this_iter": 512, "num_agent_steps_sampled_throughput_per_sec": 7.749890091466866, "num_agent_steps_trained_throughput_per_sec": 7.749890091466866, "timesteps_total": 35328, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 35328, "timers": {"training_iteration_time_ms": 65559.192, "sample_time_ms": 5251.788, "load_time_ms": 0.262, "load_throughput": 1952080.4, "learn_time_ms": 60306.71, "learn_throughput": 8.49, "synch_weights_time_ms": 0.007}, "counters": {"num_env_steps_sampled": 35328, "num_env_steps_trained": 35328, "num_agent_steps_sampled": 35328, "num_agent_steps_trained": 35328}, "done": true, "episodes_total": 2208, "training_iteration": 69, "trial_id": "02b4f_00268", "date": "2024-02-27_14-29-51", "timestamp": 1709040591, "time_this_iter_s": 66.07029962539673, "time_total_s": 5984.656324148178, "pid": 9534, "hostname": "tikgpu06", "node_ip": "129.132.190.190", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "base_env", "env_config": {"env_type": "rl", "task_model": "transmission", "task_configs": {"task_0": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_unidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_1": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "line_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_2": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0, "episode_length": 16, "grid_size": 15}}, "task_3": {"model": {"n_workers": 4, "n_hidden_state": 16, "communication_range": 2, "worker_placement": "random_multidirectional", "worker_init": "random", "reward_calculation": "shared_sum", "n_oracle_states": 5, "p_oracle_change": 0.2, "episode_length": 64, "grid_size": 15}}}}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_50_min_percentile at 0x7fad5b885870>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0008365429151557455, "grad_clip": 1, "grad_clip_by": "value", "train_batch_size": 500, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'gnn.gnn_torch_module'>", "custom_model_config": {"env_type": "base_env", "actor_config": {"model": "TransformerConv", "rounds": 1, "dropout": 0}, "critic_config": {"model": "TransformerConv", "rounds": 6, "dropout": 0}, "encoding_config": {"type": "encoding_small", "encoding_size": 16}, "recurrent_actor": 1, "recurrent_critic": 1, "use_cuda": false, "info": {"env_config": "env_config_transmission_rl_2.yaml", "actor_config": "model_Transformer_1.yaml", "critic_config": "model_Transformer_2.yaml", "encoding_config": "encoding_s.yaml"}}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7fad5d803010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "agent_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.006059427534213112, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": false, "vf_loss_coeff": 0.6252785512331038, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9811053716374268, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'callback.score_callback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 2, "num_workers": 0}, "time_since_restore": 5984.656324148178, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 26.951063829787234, "ram_util_percent": 10.14255319148936}, "checkpoint_dir_name": null}
